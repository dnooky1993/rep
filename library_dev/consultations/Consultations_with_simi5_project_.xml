<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="41867710-8dbc-4882-9d22-429c0224e9fd" activeEnvironment="Default" name="Consultations" resourceRoot="${projectDir}" soapui-version="5.7.0" abortOnError="false" runType="SEQUENTIAL" defaultScriptLanguage="Groovy" encryptionMode="Not encrypted" updated="3.10.0 2021-09-14T15:18:10Z" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:WsdlInterface" id="ebe25759-0639-4088-a715-2ec370d3c74e" wsaVersion="NONE" name="AssignmentServicePortTypeBinding" type="wsdl" bindingName="{http://emias.mos.ru/consultations/v1/assignment/soap/}AssignmentServicePortTypeBinding" soapVersion="1_2" anonymous="optional" definition="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?wsdl"><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?wsdl</con:url><con:content><![CDATA[<definitions name="assignment" targetNamespace="http://emias.mos.ru/consultations/v1/assignment/soap/" xmlns:wsp="http://www.w3.org/ns/ws-policy/" xmlns:tns="http://emias.mos.ru/consultations/v1/assignment/soap/" xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:assignment="http://emias.mos.ru/consultations/v1/assignment/" xmlns="http://schemas.xmlsoap.org/wsdl/">
  <import location="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?wsdl=assignment.wsdl" namespace="http://emias.mos.ru/consultations/v1/assignment/"></import>
  <types></types>
  <binding name="AssignmentServicePortTypeBinding" type="assignment:AssignmentServicePortType">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsp:Policy>
      <sp:SupportingTokens>
        <wsp:Policy>
          <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
            <wsp:Policy>
              <sp:NoPassword/>
            </wsp:Policy>
          </sp:UsernameToken>
        </wsp:Policy>
      </sp:SupportingTokens>
    </wsp:Policy>
    <operation name="getAssignmentsByPatient">
      <soap12:operation soapAction="getAssignmentsByPatient"/>
      <input>
        <soap12:header message="assignment:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getAssignment">
      <soap12:operation soapAction="getAssignment"/>
      <input>
        <soap12:header message="assignment:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getAssignmentByDocumentId">
      <soap12:operation soapAction="getAssignmentByDocumentId"/>
      <input>
        <soap12:header message="assignment:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getPriorities">
      <soap12:operation soapAction="getPriorities"/>
      <input>
        <soap12:header message="assignment:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getAssignmentByCareEventId">
      <soap12:operation soapAction="getAssignmentByCareEventId"/>
      <input>
        <soap12:header message="assignment:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getCancelReasons">
      <soap12:operation soapAction="getCancelReasons"/>
      <input>
        <soap12:header message="assignment:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
  </binding>
  <service name="AssignmentService">
    <port binding="tns:AssignmentServicePortTypeBinding" name="AssignmentService">
      <soap12:address location="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService"/>
    </port>
  </service>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?wsdl=assignment.wsdl</con:url><con:content><![CDATA[<definitions name="assignment" targetNamespace="http://emias.mos.ru/consultations/v1/assignment/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/" xmlns:cmn="http://emias.mos.ru/consultations/v1/common/types/" xmlns="http://schemas.xmlsoap.org/wsdl/">
  <documentation>version="1.0"</documentation>
  <types>
    <xsd:schema>
      <xsd:import namespace="http://emias.mos.ru/system/v1/faults/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.faults.xsd"/>
      <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=common-types.xsd"/>
      <xsd:import namespace="http://emias.mos.ru/consultations/v1/assignment/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=assignment-wsdl-types.xsd"/>
    </xsd:schema>
  </types>
  <message name="GetCancelReasonsInput">
    <part element="tns:GetCancelReasonsRequest" name="body"></part>
  </message>
  <message name="GetAssignmentsByPatientInput">
    <part element="tns:GetAssignmentsByPatientRequest" name="body"></part>
  </message>
  <message name="GetAssignmentInput">
    <part element="tns:GetAssignmentRequest" name="body"></part>
  </message>
  <message name="GetAssignmentByDocumentIdInput">
    <part element="tns:GetAssignmentByDocumentIdRequest" name="body"></part>
  </message>
  <message name="GetAssignmentsByPatientOutput">
    <part element="tns:GetAssignmentsByPatientResponse" name="body"></part>
  </message>
  <message name="GetCancelReasonsOutput">
    <part element="tns:GetCancelReasonsResponse" name="body"></part>
  </message>
  <message name="ConsultationsUserContextMessage">
    <part element="cmn:ConsultationsUserContext" name="header"></part>
  </message>
  <message name="GetAssignmentByCareEventIdInput">
    <part element="tns:GetAssignmentByCareEventIdRequest" name="body"></part>
  </message>
  <message name="GetPrioritiesOutput">
    <part element="tns:GetPrioritiesResponse" name="body"></part>
  </message>
  <message name="GetAssignmentByCareEventIdOutput">
    <part element="tns:GetAssignmentByCareEventIdResponse" name="body"></part>
  </message>
  <message name="GetAssignmentOutput">
    <part element="tns:GetAssignmentResponse" name="body"></part>
  </message>
  <message name="fault">
    <documentation>Ошибка</documentation>
    <part element="nsf:fault" name="body"></part>
  </message>
  <message name="GetAssignmentByDocumentIdOutput">
    <part element="tns:GetAssignmentByDocumentIdResponse" name="body"></part>
  </message>
  <message name="GetPrioritiesInput">
    <part element="tns:GetPrioritiesRequest" name="body"></part>
  </message>
  <portType name="AssignmentServicePortType">
    <operation name="getAssignmentsByPatient">
      <documentation>Запрос списка назначений на ИИ (включая данные по направлению и протоколу исследования)
 Входные параметры: идентификатор пациента.</documentation>
      <input message="tns:GetAssignmentsByPatientInput"></input>
      <output message="tns:GetAssignmentsByPatientOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getAssignment">
      <documentation>Возвращает структурированную информацию по назначению и связанные с назначением идентификаторы документов СИМИ (протокол проведения, результат расшифровки).
 Входные параметры: идентификатор назначения</documentation>
      <input message="tns:GetAssignmentInput"></input>
      <output message="tns:GetAssignmentOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getAssignmentByDocumentId">
      <documentation>Возвращает структурированную информацию по назначению и связанные с назначением идентификаторы документов СИМИ.
 Входные параметры: идентификатор документа СИМИ</documentation>
      <input message="tns:GetAssignmentByDocumentIdInput"></input>
      <output message="tns:GetAssignmentByDocumentIdOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getPriorities">
      <documentation>Возвращает справочник степени срочности
 сегодня (срочно);
 2-3 дня (не срочно);
 неделя (не срочно);
 дата (не срочно).
 Входные параметры: нет</documentation>
      <input message="tns:GetPrioritiesInput"></input>
      <output message="tns:GetPrioritiesOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getAssignmentByCareEventId">
      <documentation>Возвращает структурированную информацию по назначению и связанные с назначением идентификаторы документов СИМИ (протокол проведения, результат расшифровки).
 Входные параметры: идентификатор документа СИМИ</documentation>
      <input message="tns:GetAssignmentByCareEventIdInput"></input>
      <output message="tns:GetAssignmentByCareEventIdOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getCancelReasons">
      <documentation>Возвращет справочник причин отмены.
 Входные параметры: нет</documentation>
      <input message="tns:GetCancelReasonsInput"></input>
      <output message="tns:GetCancelReasonsOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
  </portType>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.faults.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/faults/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:uctx="http://emias.mos.ru/system/v1/userContext/" xmlns="http://emias.mos.ru/system/v1/faults/">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.xsd"/>
  <xs:import namespace="http://emias.mos.ru/system/v1/userContext/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.userContext.xsd"/>
  <!--faults-->
  <xs:element name="fault" type="BaseFault">
    <xs:annotation>
      <xs:documentation>Базовый тип ошибки</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="SecurityFault">
    <xs:annotation>
      <xs:documentation>Ошибка безопасности</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element ref="uctx:userContext"/>
          <xs:choice>
            <xs:element name="unauthorizedRequestSecurityException" type="UnauthorizedRequestSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="otherSecurityException" type="OtherSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:choice>
        </xs:sequence>
        <xs:attribute fixed="SECURITY" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="BusinessFault">
    <xs:annotation>
      <xs:documentation>Бизнес ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Коллекция Сообщений об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="hasErrors" type="xs:boolean">
            <xs:annotation>
              <xs:documentation>Признак наличия ошибок в списке сообщений</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="BUSINESS" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="UnexpectedFault">
    <xs:annotation>
      <xs:documentation>Непредвиденная ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="version" type="xs:string">
            <xs:annotation>
              <xs:documentation>Версия продукта-сервиса</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="stackTrace">
            <xs:annotation>
              <xs:documentation>Стек вызова (последние 10  записей)</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="10" name="stackTraceRecord">
                  <xs:annotation>
                    <xs:documentation>Запись StackTrace</xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="declaringClass" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование класса, содержащего метод</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="methodName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование метода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="fileName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование файла</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="lineNumber" type="xs:int">
                        <xs:annotation>
                          <xs:documentation>Номер строки кода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="UNEXPECTED" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="BaseFault">
    <xs:annotation>
      <xs:documentation>Описание базового типа описания ошибки</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--security exceptions-->
  <xs:complexType name="UnauthorizedRequestSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="requiredRights">
        <xs:annotation>
          <xs:documentation>Перечень идентификаторов недостающих Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>Идентификатор Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="UNAUTHORIZED_REQUEST_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="OtherSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="message" type="Message">
        <xs:annotation>
          <xs:documentation>Сообщение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="OTHER_SECURITY_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="SecurityExceptionTypes">
    <xs:annotation>
      <xs:documentation>Типы исключений безопасности</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="UNAUTHORIZED_REQUEST_EXCEPTION"/>
      <xs:enumeration value="OTHER_SECURITY_EXCEPTION"/>
    </xs:restriction>
  </xs:simpleType>
  <!--components-->
  <xs:simpleType name="FaultTypes">
    <xs:annotation>
      <xs:documentation>Тип ошибки</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="SECURITY">
        <xs:annotation>
          <xs:documentation>Непредвиденная ошибка приложения</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BUSINESS">
        <xs:annotation>
          <xs:documentation>Бизнес ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNEXPECTED">
        <xs:annotation>
          <xs:documentation>Ошибка безопасности</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.userContext.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/userContext/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:core="http://emias.mos.ru/system/v1/" xmlns="http://emias.mos.ru/system/v1/userContext/">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.xsd"/>
  <xs:element name="userContext" type="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="systemName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Шифр системы-потребителя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя пользователя (логин)</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRoleId" type="ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Роли пользователя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="isUserRoleSystemWide" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак "Общесистемная Роль пользователя"</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRights">
        <xs:annotation>
          <xs:documentation>Коллекция Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>ИД Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="jobExecutionId" type="ID"/>
      <xs:element minOccurs="0" name="hostIp" type="xs:string">
        <xs:annotation>
          <xs:documentation>IP адрес хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hostName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <!--error message description-->
  <xs:complexType name="ErrorMessageCollection">
    <xs:annotation>
      <xs:documentation>Коллекция сообщений об ошибках</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="message" type="ErrorMessage">
        <xs:annotation>
          <xs:documentation>Сообщение об ошибке</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="ErrorMessage">
    <xs:annotation>
      <xs:documentation>Сообщение об ошибке</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="Message">
        <xs:sequence>
          <xs:element minOccurs="0" name="parameters">
            <xs:annotation>
              <xs:documentation>Коллекция параметров сообщения</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="unbounded" name="parameter" type="KeyValuePair">
                  <xs:annotation>
                    <xs:documentation>Параметр сообщения</xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Сопутствующие сообщения об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="type" type="ErrorMessageTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип сообщения</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:simpleType name="ErrorMessageTypes">
    <xs:annotation>
      <xs:documentation>Тип сообщения об ошибке</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ERROR">
        <xs:annotation>
          <xs:documentation>Ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="WARNING">
        <xs:annotation>
          <xs:documentation>Предупреждение (не блокирующая ошибка)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="INFO">
        <xs:annotation>
          <xs:documentation>Информационное сообщение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:long"/>
  </xs:simpleType>
  <xs:complexType name="KeyValuePair">
    <xs:annotation>
      <xs:documentation>Представляет тип "ключ/значение"</xs:documentation>
    </xs:annotation>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="key" type="xs:string" use="required">
          <xs:annotation>
            <xs:documentation>Ключ</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="Message">
    <xs:annotation>
      <xs:documentation>Сообщение</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="message" type="xs:string">
        <xs:annotation>
          <xs:documentation>Текст сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=common-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/common/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/common/types/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/">
  <xsd:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.core.v1.xsd"/>
  <xsd:complexType name="RequestPageInfo">
    <xsd:sequence>
      <xsd:element default="0" minOccurs="1" name="page" type="xsd:int">
        <xsd:annotation>
          <xsd:documentation>Номер страницы</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element default="0" minOccurs="1" name="pageSize" type="xsd:int">
        <xsd:annotation>
          <xsd:documentation>Размер страницы</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ResponsePageInfo">
    <xsd:complexContent>
      <xsd:extension base="tns:RequestPageInfo">
        <xsd:sequence>
          <xsd:element default="0" minOccurs="1" name="total" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Всего записей</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="ConsultationsUserContext">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Контекст пользователя</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="employeeJobId" type="tns:EmployeeJobKey">
          <xsd:annotation>
            <xsd:documentation>Идентификатор исполнения должности</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="fullName" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>ФИО пользователя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="position" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Должность медработника</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="Priority">
    <xsd:annotation>
      <xsd:documentation>Справочник "Степень срочности"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="cito" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="longTerm" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Долгосрочное назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fromPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты начала проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="toPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты окончания проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="offset" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Количество дней, начиная от текущей даты</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="active" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак актуальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="AppointmentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор записи</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="CareEventKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор клинического события</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="PatientKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор пациента</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="AssignmentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор назначения</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:simpleType name="ReferralKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор направления</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:simpleType name="NsiKey">
    <xsd:restriction base="xsd:normalizedString"/>
  </xsd:simpleType>
  <!--<xsd:simpleType name="SpecialityKey">-->
  <!--<xsd:annotation>-->
  <!--<xsd:documentation>Идентификатор специальности</xsd:documentation>-->
  <!--</xsd:annotation>-->
  <!--<xsd:restriction base="tns:NsiKey"/>-->
  <!--</xsd:simpleType>-->
  <xsd:simpleType name="SpecializationKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор специализации</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="tns:NsiKey"/>
  </xsd:simpleType>
  <xsd:simpleType name="AvailableResourceKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор доступного ресурса</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="LpuKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="EmployeeJobKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор врача</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="CctCode">
    <xsd:annotation>
      <xsd:documentation>Идентификатор класс-кода документа</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="DocumentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор документа</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:complexType name="Lpu">
    <xsd:annotation>
      <xsd:documentation>ЛПУ</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Наименование ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Period">
    <xsd:annotation>
      <xsd:documentation>Период</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="1" minOccurs="1" name="start" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Начало периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="1" minOccurs="1" name="end" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Конец периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.core.v1.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=emias.system.v1.xsd"/>
  <!--references-->
  <xs:element name="medicalOrganizationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинской организации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="medicalFacilityId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинского учреждения</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--async operation status-->
  <xs:element name="operationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор операции</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="OperationExecutionStatus">
    <xs:annotation>
      <xs:documentation>Статус выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="isCompleted" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак окончания выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="completenessProgress" type="OperationCompletenessBase">
        <xs:annotation>
          <xs:documentation>Сведения о текущем статусе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hasSucceded" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак успешности выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
        <xs:annotation>
          <xs:documentation>Коллекция сообщений, порожденных в ходе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="id" type="ID" use="required">
      <xs:annotation>
        <xs:documentation>Идентификатор операции</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessPercentage">
    <xs:annotation>
      <xs:documentation>Описание текущего статуса выполнения операции в процентах (0%-100%)</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="OperationCompletenessBase">
        <xs:sequence>
          <xs:element name="completenessStatus">
            <xs:annotation>
              <xs:documentation>Статус (0%-100%)</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="xs:unsignedByte">
                <xs:minInclusive value="0"/>
                <xs:maxInclusive value="100"/>
              </xs:restriction>
            </xs:simpleType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessBase">
    <xs:annotation>
      <xs:documentation>Базовый абстрактный тип для описания текущего статуса выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--calling methods' options-->
  <xs:element name="options" type="Options">
    <xs:annotation>
      <xs:documentation>Параметры вызова метода</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="Options">
    <xs:annotation>
      <xs:documentation>Набор именованных значений</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="entry" type="KeyValuePair">
        <xs:annotation>
          <xs:documentation>Именованное значение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <!--pagination-->
  <xs:element name="pagingOptions" type="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType abstract="true" name="PagingResults">
    <xs:annotation>
      <xs:documentation>Список с пагинацией</xs:documentation>
    </xs:annotation>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageTotal" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Общее количество страниц</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="morePagesAvailable" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Флаг доступности других страниц с результатами для "постраничного листания" (true - если доступны еще страницы; false - иначе)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--base types-->
  <xs:complexType name="TimeInterval">
    <xs:annotation>
      <xs:documentation>Временной период (время)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время начала интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время окончания интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DatePeriod">
    <xs:annotation>
      <xs:documentation>Временной период (дата)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата начала периода</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата окончания периода</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=assignment-wsdl-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/assignment/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/" xmlns:assignment="http://emias.mos.ru/consultations/v1/assignment/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/assignment/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=assignment-types.xsd"/>
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=common-types.xsd"/>
  <xsd:element name="GetAssignmentsByPatientRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="patientId" type="common:PatientKey"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="status" type="assignment:AssignmentStatus"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentsByPatientResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="assignment:AssignmentPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="assignmentId" type="common:AssignmentKey"/>
        <xsd:element minOccurs="0" name="patientId" type="common:PatientKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="assignment:AssignmentDetails"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentByDocumentIdRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="documentId" type="common:DocumentKey"/>
        <xsd:element minOccurs="0" name="patientId" type="common:PatientKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentByDocumentIdResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="assignment:AssignmentDetails"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetPrioritiesRequest">
    <xsd:complexType>
      <xsd:sequence></xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetPrioritiesResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="assignment:ConsultationsPriority"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentByCareEventIdRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="careEventId" type="common:CareEventKey"/>
        <xsd:element minOccurs="0" name="patientId" type="common:PatientKey"/>
        <xsd:element name="includeDrafts" type="xsd:boolean"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentByCareEventIdResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="assignment:AssignmentPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetCancelReasonsRequest">
    <xsd:complexType>
      <xsd:sequence></xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetCancelReasonsResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="assignment:CancelReason"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=assignment-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/assignment/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/types/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/task/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=task-types.xsd"/>
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=common-types.xsd"/>
  <xsd:complexType name="AssignmentPage">
    <xsd:annotation>
      <xsd:documentation>Пострнаничный вывод списка назначений</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="tns:Assignment">
        <xsd:annotation>
          <xsd:documentation>Список назначений</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="paging" type="common:ResponsePageInfo">
        <xsd:annotation>
          <xsd:documentation>Пагинация</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AssignmentDetails">
    <xsd:annotation>
      <xsd:documentation>Подробная информация по назначению</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="assignment" type="tns:Assignment">
        <xsd:annotation>
          <xsd:documentation>Назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Assignment">
    <xsd:annotation>
      <xsd:documentation>Назначение</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="assignmentId" type="common:AssignmentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="documentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignmentStatus" type="tns:AssignmentStatus">
        <xsd:annotation>
          <xsd:documentation>Статус назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patientId" type="common:PatientKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="priority" type="common:Priority">
        <xsd:annotation>
          <xsd:documentation>Приоритет назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="startDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата начала действия назначения (дата создания)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="createDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата создания назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="careEventId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор КС в рамках которого было создано назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="expectedEndDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Планируемая дата завершения назначения, указанная врачом</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="endDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата завершения назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="purpose" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Цель исследования (обоснование)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="specializationId" type="common:SpecializationKey">
        <xsd:annotation>
          <xsd:documentation>Код специализации</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="specializationName" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Наименование специализации</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="diagnosis" type="tns:Diagnosis">
        <xsd:annotation>
          <xsd:documentation>Описание диагноза</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="issuedLpu" type="common:Lpu">
        <xsd:annotation>
          <xsd:documentation>Описание филиала медицинской организации, в котором создано назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="employeeJobId" type="common:EmployeeJobKey">
        <xsd:annotation>
          <xsd:documentation>ИД исполнения должности создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fio" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>ФИО пользователя создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="position" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Роль медицинского работника создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="login" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Логин пользователя создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="tasks" type="tns:AssignmentTask">
        <xsd:annotation>
          <xsd:documentation>Описание задач, связанных с назначением</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="referralDocumentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Направление на исследование в другое МО</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="citoReferral" type="tns:ConsultationsReferralInfo">
        <xsd:annotation>
          <xsd:documentation>Информация о назначении с высокой степенью срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="allowChange" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Возмоность редактирования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="allowCancel" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Возмоность отмены</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="options" type="common:Options">
        <xsd:annotation>
          <xsd:documentation>Дополнительные параметры</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ConsultationsReferralInfo">
    <xsd:annotation>
      <xsd:documentation>Информация о назначении, включенная в направление. Используется для назначений с высокой степенью срочности</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <!--<xsd:element name="referralLpuId" type="xsd:long" minOccurs="0">-->
      <!--<xsd:annotation>-->
      <!--<xsd:documentation>Идентификатор филиала медицинской организации, в который направлен пациент по назначению.</xsd:documentation>-->
      <!--</xsd:annotation>-->
      <!--</xsd:element>-->
      <!--<xsd:element name="referralLpuName" type="xsd:string" minOccurs="0">-->
      <!--<xsd:annotation>-->
      <!--<xsd:documentation>Название филиала медицинской организации, в который направлен пациент по назначению.</xsd:documentation>-->
      <!--</xsd:annotation>-->
      <!--</xsd:element>-->
      <xsd:element minOccurs="0" name="availableResourceId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор доступного ресурса, к которому направлен пациент по назначению</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AssignmentTask">
    <xsd:annotation>
      <xsd:documentation>Задача связанная с назначением</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="task:TaskKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="task:TaskType">
        <xsd:annotation>
          <xsd:documentation>Тип задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="task:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="documentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор документа, связанного с задачей</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="appointmentId" type="common:AppointmentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="comment" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Комментарий медработника</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Diagnosis">
    <xsd:annotation>
      <xsd:documentation>Диагноз</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="code" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Код диагноза</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название диагноза</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="AssignmentStatus">
    <xsd:annotation>
      <xsd:documentation>Статус назначения, определенный в архетипе Action</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="AssignmentCreated">
        <xsd:annotation>
          <xsd:documentation>Назначение создано</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="AssignmentFinished">
        <xsd:annotation>
          <xsd:documentation>Расшифровка завершена</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Cancelled">
        <xsd:annotation>
          <xsd:documentation>Исследование отменено</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="ConsultationsPriority">
    <xsd:annotation>
      <xsd:documentation>Справочник "Степень срочности"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="cito" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="longTerm" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Долгосрочное назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fromPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты начала проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="toPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты окончания проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="offset" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Количество дней, начиная от текущей даты</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="active" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак актуальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="freePeriod" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак актуальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="CancelReason">
    <xsd:annotation>
      <xsd:documentation>Справочник "Причина отмены"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actual" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак актуальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=task-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/task/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/task/types/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService?xsd=common-types.xsd"/>
  <xsd:complexType name="TaskPage">
    <xsd:annotation>
      <xsd:documentation>Пострнаничный вывод списка задач</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="tns:Task">
        <xsd:annotation>
          <xsd:documentation>Список задач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="paging" type="common:ResponsePageInfo">
        <xsd:annotation>
          <xsd:documentation>Пагинация</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="TaskKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:complexType name="Task">
    <xsd:annotation>
      <xsd:documentation>Базовый класс задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="tns:TaskKey">
        <xsd:annotation>
          <xsd:documentation>Список задач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:TaskType">
        <xsd:annotation>
          <xsd:documentation>Список задач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignmentId" type="common:AssignmentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patientId" type="common:PatientKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор паицента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignmentDocumentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор документа СИМИ (Назначение)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="parentDocumentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор документа СИМИ, который породил задачу</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="priority" type="common:Priority">
        <xsd:annotation>
          <xsd:documentation>Степень срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="cito" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак экстренности (для Cito пациентов)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="specialization" type="tns:TaskSpecialization">
        <xsd:annotation>
          <xsd:documentation>Специализация</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="createDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время создания задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="changeDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="expectedEndDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время планируемого завершения задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="endDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время завершения задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignedToLpu" type="common:LpuKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор МО, для которого создана задача</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="createUser" type="tns:TaskUser">
        <xsd:annotation>
          <xsd:documentation>Пользователь, инициировавший создание задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="updateUser" type="tns:TaskUser">
        <xsd:annotation>
          <xsd:documentation>Пользователь, последний изменивший статус</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="options" type="common:Options">
        <xsd:annotation>
          <xsd:documentation>Дополнительные параметры</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskConduct">
    <xsd:annotation>
      <xsd:documentation>Задача на проведение инструментального исследования</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Task">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="specializationId" type="common:SpecializationKey">
            <xsd:annotation>
              <xsd:documentation>Код специализации</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="purpose" type="xsd:string">
            <xsd:annotation>
              <xsd:documentation>Обоснование</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="availableResourceId" type="common:AvailableResourceKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор специализированного доступного ресурса, указывается для назначения задачи на ресурс медицинской организации</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="appointmentId" type="common:AppointmentKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор записи на прием пациента</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="careEventId" type="common:CareEventKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор клинического события</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="documentId" type="common:DocumentKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор документа СИМИ, созданный в ходе выпонения задачи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="desiredAssignmentDate" type="xsd:dateTime">
            <xsd:annotation>
              <xsd:documentation>Желаемая дата начала действия назначения</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="lastDateAppointment" type="xsd:dateTime">
            <xsd:annotation>
              <xsd:documentation>Крайняя дата доступная пациенту для самозаписи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TaskViewResult">
    <xsd:annotation>
      <xsd:documentation>Задача на просмотр результатов исследования</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Task">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="employeeJobId" type="common:EmployeeJobKey">
            <xsd:annotation>
              <xsd:documentation>Исполнение должности медработника</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TaskApprove">
    <xsd:annotation>
      <xsd:documentation>Задача на согласование направления</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Task">
        <xsd:sequence></xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TaskUser">
    <xsd:annotation>
      <xsd:documentation>Пользователь</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element minOccurs="0" name="employeeJobId" type="common:EmployeeJobKey">
        <xsd:annotation>
          <xsd:documentation>ИД исполнения должности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fio" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>ФИО пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="position" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Должность пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="login" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Логин пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskDetails">
    <xsd:annotation>
      <xsd:documentation>Подробная информация по задаче</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="task" type="tns:Task">
        <xsd:annotation>
          <xsd:documentation>Описание задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="changeLog" type="tns:TaskChangeLog">
        <xsd:annotation>
          <xsd:documentation>История изменений статуса задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskChangeLog">
    <xsd:annotation>
      <xsd:documentation>История изменений статуса задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="status" type="tns:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="changeDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="login" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Логин пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskStatusInfo">
    <xsd:annotation>
      <xsd:documentation>Идентификатор и статус задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="taskId" type="tns:TaskKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="TaskType">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Conduct">
        <xsd:annotation>
          <xsd:documentation>Проведение ИИ</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Approve">
        <xsd:annotation>
          <xsd:documentation>Согласование направления</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="ViewResult">
        <xsd:annotation>
          <xsd:documentation>Просмотр результатов назначения врачом-клиницистом</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="TaskStatus">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Created">
        <xsd:annotation>
          <xsd:documentation>Создана</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Assigned">
        <xsd:annotation>
          <xsd:documentation>Назначена</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Progress">
        <xsd:annotation>
          <xsd:documentation>В работе</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Completed">
        <xsd:annotation>
          <xsd:documentation>Выполнена</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Cancelled">
        <xsd:annotation>
          <xsd:documentation>Аннулирована</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="TaskSpecialization">
    <xsd:annotation>
      <xsd:documentation>Справочник "Степень срочности"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService</con:endpoint><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint></con:endpoints><con:operation id="48dd13fd-cbd6-4545-ba0a-de3cf2867666" isOneWay="false" action="getAssignment" name="getAssignment" bindingOperationName="getAssignment" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="4e7e5a03-cc4b-4614-8523-25bee4f95bb7" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>ConsultationAssignment6f0710c9-9f9b-4b8f-a3ca-65acdca61d9f</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="289069b2-d91b-4283-a4a4-62ff7855458c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/></con:call><con:call id="e57b21a7-3ace-4b52-b6ec-e0e82a5676a8" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/></con:call><con:call id="130868c0-87f0-45f5-8625-aad066ef9755" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/></con:call><con:call id="bd39507e-fac8-48b8-adcc-f04d228db5d9" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/></con:call><con:call id="512ce055-2082-4649-8d72-895a2b7d9c69" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/></con:call><con:call id="c516fe91-c265-4edf-a9c4-eec35747e12a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v2/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v2/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/></con:call><con:call id="46c75556-6633-4e37-bd02-859d0296e612" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>?</ass:assignmentId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentRequest"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="169fc87d-5844-4b27-aaf0-bb27afab9edf" isOneWay="false" action="getAssignmentByCareEventId" name="getAssignmentByCareEventId" bindingOperationName="getAssignmentByCareEventId" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="cb22680d-19d6-4af9-852e-397676f0ef72" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="c7c1eae2-9e74-4700-bd44-4839608add14" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="f5dd3efe-0bea-4c9c-b170-c650f96c812d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="dba91c92-fd51-4eff-b68d-ffb87c94f4ee" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="59c3bce4-5afb-4e5f-8214-f52afc805a94" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="04de7bbc-f602-441e-93dc-782d10095fb2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="60b10185-4f1a-420d-a993-ea0fcb5f7c07" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v2/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v2/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call><con:call id="bb6cd6fe-4504-491e-a683-0238b8b28f16" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>?</ass:careEventId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
         <ass:includeDrafts>?</ass:includeDrafts>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByCareEventIdRequest"/></con:call></con:operation><con:operation id="1af2df6f-f673-40be-ae94-c8dcc409e9dc" isOneWay="false" action="getAssignmentByDocumentId" name="getAssignmentByDocumentId" bindingOperationName="getAssignmentByDocumentId" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="cd6df719-f94d-4ec0-bb91-23dcd944000f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="7a5d45d0-1afe-44b9-9296-8be345968eb3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="f3e9c7f2-8e71-4810-8aa8-de804a2d0a10" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="a74bebd2-9edf-44b4-9a07-abacdac943c9" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="366b1e04-70ce-4ccf-96db-12c2b281c443" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="13b4eb1d-6b13-4c87-8a09-ba7607945ce3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="88d5b203-a00c-47b5-ad26-9bebb822e0b2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v2/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <!--1 or more repetitions:-->\r
         <ass:documentId>?</ass:documentId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
         <!--Optional:-->\r
         <ass:requestPageInfo>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:requestPageInfo>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v2/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call><con:call id="3e671344-f738-48aa-bf73-e952fd27c014" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>?</ass:documentId>\r
         <!--Optional:-->\r
         <ass:patientId>?</ass:patientId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentByDocumentIdRequest"/></con:call></con:operation><con:operation id="fd9f6748-da2e-45e8-b8e7-48d1237b1ece" isOneWay="false" action="getAssignmentsByPatient" name="getAssignmentsByPatient" bindingOperationName="getAssignmentsByPatient" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="c7594b65-903d-4ce9-b116-3fbe86623666" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="1f37838d-0c37-47c5-ba7b-c513a4d9454f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/></con:call><con:call id="35e92dfa-8920-4753-be2a-90b41780d6d6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="96301fa3-898e-45ac-9965-83ead87a5439" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/></con:call><con:call id="14f72363-2f46-4cfa-b6d6-03329148f3a3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/></con:call><con:call id="3b522d6d-0b05-4f65-b23b-cf75cf2d56ac" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/></con:call><con:call id="9b63dc3f-42bc-4d13-be50-6c7322b3c7ca" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v2/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v2/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/></con:call><con:call id="b214fa54-9dad-44ff-96bb-b3d472b82e94" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>?</ass:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ass:status>?</ass:status>\r
         <!--Optional:-->\r
         <ass:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ass:paging>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getAssignmentsByPatientRequest"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="dd454c61-f92e-4990-839c-414ed5e16ebe" isOneWay="false" action="getCancelReasons" name="getCancelReasons" bindingOperationName="getCancelReasons" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3bbff20b-d4e3-4b07-a016-ad4679aaac73" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
       
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="9201abd4-6c0e-401b-ba83-2f62d11ba3e3" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="c51bcc56-22a4-40c7-9610-94af25c5fd99" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/></con:call><con:call id="4e8fe635-1dc3-48d4-9e5e-23f76b1dec46" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/></con:call><con:call id="6234cf77-0fdb-4fd5-b8a7-53c36484d2da" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/></con:call><con:call id="dfd518a6-b48b-4780-a9e1-ec1e4fa9da63" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/></con:call><con:call id="7cc1d197-75d7-46a7-b878-9e476cb6f7ad" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v2/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v2/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/></con:call><con:call id="b0076863-03cf-401b-9421-f683706baf18" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getCancelReasonsRequest"/></con:call></con:operation><con:operation id="70d079a7-f3eb-42ae-9ce7-af3ff0ae1957" isOneWay="false" action="getPriorities" name="getPriorities" bindingOperationName="getPriorities" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="6f23e0ba-9de7-40c8-ad08-db1095e29055" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="e506b706-2dc4-4148-963f-b0765c6498bc" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/></con:call><con:call id="1f0efd03-6cb9-4819-86f0-17ac6e9fc650" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="a157aed1-5e0b-4dd8-b491-753745d75dea" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/></con:call><con:call id="2c14c4a0-7354-4ce8-95af-dffc27880622" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="b2d4c0b8-1c33-4c7b-b42b-dcd4e5b21424" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/></con:call><con:call id="4ff0d9a4-0bf3-4f53-9e72-7d73bfc5d48c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v2/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v2/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/></con:call><con:call id="569aa540-d75d-40de-b9f2-1f237e3d55d4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetPrioritiesRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/assignment/soap/AssignmentServicePortType/getPrioritiesRequest"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="0a1fd299-949f-4bcf-bf1c-aee352f0bbbf" wsaVersion="NONE" name="TaskServicePortTypeBinding" type="wsdl" bindingName="{http://emias.mos.ru/consultations/v1/task/soap/}TaskServicePortTypeBinding" soapVersion="1_2" anonymous="optional" definition="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?wsdl"><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?wsdl</con:url><con:content><![CDATA[<definitions name="task" targetNamespace="http://emias.mos.ru/consultations/v1/task/soap/" xmlns:wsp="http://www.w3.org/ns/ws-policy/" xmlns:tns="http://emias.mos.ru/consultations/v1/task/soap/" xmlns:task="http://emias.mos.ru/consultations/v1/task/" xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns="http://schemas.xmlsoap.org/wsdl/">
  <import location="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?wsdl=task.wsdl" namespace="http://emias.mos.ru/consultations/v1/task/"></import>
  <types></types>
  <binding name="TaskServicePortTypeBinding" type="task:TaskServicePortType">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsp:Policy>
      <sp:SupportingTokens>
        <wsp:Policy>
          <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
            <wsp:Policy>
              <sp:NoPassword/>
            </wsp:Policy>
          </sp:UsernameToken>
        </wsp:Policy>
      </sp:SupportingTokens>
    </wsp:Policy>
    <operation name="getPatientTasks">
      <soap12:operation soapAction="getPatientTasks"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="assignAppointment">
      <soap12:operation soapAction="assignAppointment"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="cancelAppointment">
      <soap12:operation soapAction="cancelAppointment"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getAvailableResourceTasks">
      <soap12:operation soapAction="getAvailableResourceTasks"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getPlanResourceTasks">
      <soap12:operation soapAction="getPlanResourceTasks"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getCitoResourceTasks">
      <soap12:operation soapAction="getCitoResourceTasks"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="startConduct">
      <soap12:operation soapAction="startConduct"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="cancelConduct">
      <soap12:operation soapAction="cancelConduct"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="viewResult">
      <soap12:operation soapAction="viewResult"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getAssignmentTasks">
      <soap12:operation soapAction="getAssignmentTasks"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getTask">
      <soap12:operation soapAction="getTask"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getTasksByCareEvents">
      <soap12:operation soapAction="getTasksByCareEvents"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getTasksByReferralId">
      <soap12:operation soapAction="getTasksByReferralId"/>
      <input>
        <soap12:header message="task:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
  </binding>
  <service name="TaskService">
    <port binding="tns:TaskServicePortTypeBinding" name="TaskService">
      <soap12:address location="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService"/>
    </port>
  </service>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?wsdl=task.wsdl</con:url><con:content><![CDATA[<definitions name="task" targetNamespace="http://emias.mos.ru/consultations/v1/task/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/task/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/" xmlns:cmn="http://emias.mos.ru/consultations/v1/common/types/" xmlns="http://schemas.xmlsoap.org/wsdl/">
  <documentation>version="1.0"</documentation>
  <types>
    <xsd:schema>
      <xsd:import namespace="http://emias.mos.ru/system/v1/faults/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.faults.xsd"/>
      <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=common-types.xsd"/>
      <xsd:import namespace="http://emias.mos.ru/consultations/v1/task/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=task-wsdl-types.xsd"/>
    </xsd:schema>
  </types>
  <message name="GetPatientTasksOutput">
    <part element="tns:GetPatientTasksResponse" name="body"></part>
  </message>
  <message name="AssignAppointmentOutput">
    <part element="tns:AssignAppointmentResponse" name="body"></part>
  </message>
  <message name="fault">
    <documentation>Ошибка</documentation>
    <part element="nsf:fault" name="body"></part>
  </message>
  <message name="GetPlanResourceTasksInput">
    <part element="tns:GetPlanResourceTasksRequest" name="body"></part>
  </message>
  <message name="GetTasksByReferralIdOutput">
    <part element="tns:GetTasksByReferralIdResponse" name="body"></part>
  </message>
  <message name="StartConductOutput">
    <part element="tns:StartConductResponse" name="body"></part>
  </message>
  <message name="GetTaskInput">
    <part element="tns:GetTaskRequest" name="body"></part>
  </message>
  <message name="GetAvailableResourceTasksInput">
    <part element="tns:GetAvailableResourceTasksRequest" name="body"></part>
  </message>
  <message name="GetCitoResourceTasksInput">
    <part element="tns:GetCitoResourceTasksRequest" name="body"></part>
  </message>
  <message name="GetCitoResourceTasksOutput">
    <part element="tns:GetCitoResourceTasksResponse" name="body"></part>
  </message>
  <message name="CancelConductOutput">
    <part element="tns:CancelConductResponse" name="body"></part>
  </message>
  <message name="ViewResultOutput">
    <part element="tns:ViewResultResponse" name="body"></part>
  </message>
  <message name="GetTasksByReferralIdInput">
    <part element="tns:GetTasksByReferralIdRequest" name="body"></part>
  </message>
  <message name="ConsultationsUserContextMessage">
    <part element="cmn:ConsultationsUserContext" name="header"></part>
  </message>
  <message name="GetPlanResourceTasksOutput">
    <part element="tns:GetPlanResourceTasksResponse" name="body"></part>
  </message>
  <message name="GetAssignmentTasksInput">
    <part element="tns:GetAssignmentTasksRequest" name="body"></part>
  </message>
  <message name="StartConductInput">
    <part element="tns:StartConductRequest" name="body"></part>
  </message>
  <message name="CancelConductInput">
    <part element="tns:CancelConductRequest" name="body"></part>
  </message>
  <message name="ViewResultInput">
    <part element="tns:ViewResultRequest" name="body"></part>
  </message>
  <message name="CancelAppointmentOutput">
    <part element="tns:CancelAppointmentResponse" name="body"></part>
  </message>
  <message name="GetTasksByCareEventsInput">
    <part element="tns:GetTasksByCareEventsRequest" name="body"></part>
  </message>
  <message name="GetTasksByCareEventsOutput">
    <part element="tns:GetTasksByCareEventsResponse" name="body"></part>
  </message>
  <message name="GetAvailableResourceTasksOutput">
    <part element="tns:GetAvailableResourceTasksResponse" name="body"></part>
  </message>
  <message name="GetPatientTasksInput">
    <part element="tns:GetPatientTasksRequest" name="body"></part>
  </message>
  <message name="GetTaskOutput">
    <part element="tns:GetTaskResponse" name="body"></part>
  </message>
  <message name="AssignAppointmentInput">
    <part element="tns:AssignAppointmentRequest" name="body"></part>
  </message>
  <message name="CancelAppointmentInput">
    <part element="tns:CancelAppointmentRequest" name="body"></part>
  </message>
  <message name="GetAssignmentTasksOutput">
    <part element="tns:GetAssignmentTasksResponse" name="body"></part>
  </message>
  <portType name="TaskServicePortType">
    <operation name="getPatientTasks">
      <documentation>Возвращает список задач на проведение инструментальных исследований в отношении пациента (используется для внеплановых приемов)
 @param patientId идентификатор пациента
 @param lpuId идентификатор МО (опционально)
 @param taskType тип задачи (опционально)
 @param statuses статус задачи
 @param period период
 @param paging пейджинг
 @return</documentation>
      <input message="tns:GetPatientTasksInput"></input>
      <output message="tns:GetPatientTasksOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="assignAppointment">
      <documentation>Перевести задачу в статус "Назначена"
 @param taskId идентификатор задачи
 @param appointmentId идентификатор записи
 @param availableResourceId идентификатор ДР</documentation>
      <input message="tns:AssignAppointmentInput"></input>
      <output message="tns:AssignAppointmentOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="cancelAppointment">
      <documentation>Удаление записи из задачи
 @param taskId идентификатор задачи</documentation>
      <input message="tns:CancelAppointmentInput"></input>
      <output message="tns:CancelAppointmentOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getAvailableResourceTasks">
      <documentation>Возвращает список активных задач для доступного ресурса
 @param availableResourceId идентификатор ресурса
 @param paging пагинация
 @return</documentation>
      <input message="tns:GetAvailableResourceTasksInput"></input>
      <output message="tns:GetAvailableResourceTasksOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getPlanResourceTasks">
      <documentation>Возвращает список задач на проведение консультации
 @param appointmentIds идентификатор направления
 @param paging
 @return</documentation>
      <input message="tns:GetPlanResourceTasksInput"></input>
      <output message="tns:GetPlanResourceTasksOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getCitoResourceTasks">
      <documentation>Возвращает список задач на проведение исследование экстренных пациентов (cito)
 @param availableResourceId идентификатор ресурса
 @param date дата (опционально, для выполненных задач)
 @param paging пейджинг
 @return</documentation>
      <input message="tns:GetCitoResourceTasksInput"></input>
      <output message="tns:GetCitoResourceTasksOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="startConduct">
      <documentation>Взять задачу на проведение исследований в работу
 @param taskId идентификатор задачи
 @param careEventId идентификатор клинического события
 @param availableResourceId идентификатор СДР</documentation>
      <input message="tns:StartConductInput"></input>
      <output message="tns:StartConductOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="cancelConduct">
      <documentation>Отменить работу по задаче на проведение исследование
 @param taskId идентификатор задачи
 @param availableResourceId идентификатор ДР
 @param nullCareEvent признак удаления клинического события</documentation>
      <input message="tns:CancelConductInput"></input>
      <output message="tns:CancelConductOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="viewResult">
      <documentation>Метод завершает задачу на просмотр инструментального исследования.
 @param taskId</documentation>
      <input message="tns:ViewResultInput"></input>
      <output message="tns:ViewResultOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getAssignmentTasks">
      <documentation>Получение подробной информации по задачам, связанным с назначением
 @param assignmentId идентификатор назначения
 @param statuses статусы
 @param types типы задач
 @param paging пейджинг</documentation>
      <input message="tns:GetAssignmentTasksInput"></input>
      <output message="tns:GetAssignmentTasksOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getTask">
      <documentation>Получение подробной информации по задаче
 @param taskId идентификатор задачи</documentation>
      <input message="tns:GetTaskInput"></input>
      <output message="tns:GetTaskOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getTasksByCareEvents">
      <documentation>Метод возвращает задачи по идентификаторам клинических событий (careEventIds).</documentation>
      <input message="tns:GetTasksByCareEventsInput"></input>
      <output message="tns:GetTasksByCareEventsOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getTasksByReferralId">
      <documentation>Метод возвращает задачи по направлению СУПП</documentation>
      <input message="tns:GetTasksByReferralIdInput"></input>
      <output message="tns:GetTasksByReferralIdOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
  </portType>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.faults.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/faults/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:uctx="http://emias.mos.ru/system/v1/userContext/" xmlns="http://emias.mos.ru/system/v1/faults/">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.xsd"/>
  <xs:import namespace="http://emias.mos.ru/system/v1/userContext/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.userContext.xsd"/>
  <!--faults-->
  <xs:element name="fault" type="BaseFault">
    <xs:annotation>
      <xs:documentation>Базовый тип ошибки</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="SecurityFault">
    <xs:annotation>
      <xs:documentation>Ошибка безопасности</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element ref="uctx:userContext"/>
          <xs:choice>
            <xs:element name="unauthorizedRequestSecurityException" type="UnauthorizedRequestSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="otherSecurityException" type="OtherSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:choice>
        </xs:sequence>
        <xs:attribute fixed="SECURITY" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="BusinessFault">
    <xs:annotation>
      <xs:documentation>Бизнес ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Коллекция Сообщений об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="hasErrors" type="xs:boolean">
            <xs:annotation>
              <xs:documentation>Признак наличия ошибок в списке сообщений</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="BUSINESS" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="UnexpectedFault">
    <xs:annotation>
      <xs:documentation>Непредвиденная ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="version" type="xs:string">
            <xs:annotation>
              <xs:documentation>Версия продукта-сервиса</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="stackTrace">
            <xs:annotation>
              <xs:documentation>Стек вызова (последние 10  записей)</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="10" name="stackTraceRecord">
                  <xs:annotation>
                    <xs:documentation>Запись StackTrace</xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="declaringClass" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование класса, содержащего метод</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="methodName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование метода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="fileName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование файла</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="lineNumber" type="xs:int">
                        <xs:annotation>
                          <xs:documentation>Номер строки кода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="UNEXPECTED" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="BaseFault">
    <xs:annotation>
      <xs:documentation>Описание базового типа описания ошибки</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--security exceptions-->
  <xs:complexType name="UnauthorizedRequestSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="requiredRights">
        <xs:annotation>
          <xs:documentation>Перечень идентификаторов недостающих Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>Идентификатор Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="UNAUTHORIZED_REQUEST_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="OtherSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="message" type="Message">
        <xs:annotation>
          <xs:documentation>Сообщение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="OTHER_SECURITY_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="SecurityExceptionTypes">
    <xs:annotation>
      <xs:documentation>Типы исключений безопасности</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="UNAUTHORIZED_REQUEST_EXCEPTION"/>
      <xs:enumeration value="OTHER_SECURITY_EXCEPTION"/>
    </xs:restriction>
  </xs:simpleType>
  <!--components-->
  <xs:simpleType name="FaultTypes">
    <xs:annotation>
      <xs:documentation>Тип ошибки</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="SECURITY">
        <xs:annotation>
          <xs:documentation>Непредвиденная ошибка приложения</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BUSINESS">
        <xs:annotation>
          <xs:documentation>Бизнес ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNEXPECTED">
        <xs:annotation>
          <xs:documentation>Ошибка безопасности</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.userContext.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/userContext/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:core="http://emias.mos.ru/system/v1/" xmlns="http://emias.mos.ru/system/v1/userContext/">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.xsd"/>
  <xs:element name="userContext" type="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="systemName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Шифр системы-потребителя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя пользователя (логин)</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRoleId" type="ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Роли пользователя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="isUserRoleSystemWide" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак "Общесистемная Роль пользователя"</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRights">
        <xs:annotation>
          <xs:documentation>Коллекция Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>ИД Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="jobExecutionId" type="ID"/>
      <xs:element minOccurs="0" name="hostIp" type="xs:string">
        <xs:annotation>
          <xs:documentation>IP адрес хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hostName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <!--error message description-->
  <xs:complexType name="ErrorMessageCollection">
    <xs:annotation>
      <xs:documentation>Коллекция сообщений об ошибках</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="message" type="ErrorMessage">
        <xs:annotation>
          <xs:documentation>Сообщение об ошибке</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="ErrorMessage">
    <xs:annotation>
      <xs:documentation>Сообщение об ошибке</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="Message">
        <xs:sequence>
          <xs:element minOccurs="0" name="parameters">
            <xs:annotation>
              <xs:documentation>Коллекция параметров сообщения</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="unbounded" name="parameter" type="KeyValuePair">
                  <xs:annotation>
                    <xs:documentation>Параметр сообщения</xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Сопутствующие сообщения об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="type" type="ErrorMessageTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип сообщения</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:simpleType name="ErrorMessageTypes">
    <xs:annotation>
      <xs:documentation>Тип сообщения об ошибке</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ERROR">
        <xs:annotation>
          <xs:documentation>Ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="WARNING">
        <xs:annotation>
          <xs:documentation>Предупреждение (не блокирующая ошибка)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="INFO">
        <xs:annotation>
          <xs:documentation>Информационное сообщение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:long"/>
  </xs:simpleType>
  <xs:complexType name="KeyValuePair">
    <xs:annotation>
      <xs:documentation>Представляет тип "ключ/значение"</xs:documentation>
    </xs:annotation>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="key" type="xs:string" use="required">
          <xs:annotation>
            <xs:documentation>Ключ</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="Message">
    <xs:annotation>
      <xs:documentation>Сообщение</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="message" type="xs:string">
        <xs:annotation>
          <xs:documentation>Текст сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=common-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/common/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/common/types/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/">
  <xsd:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.core.v1.xsd"/>
  <xsd:complexType name="RequestPageInfo">
    <xsd:sequence>
      <xsd:element default="0" minOccurs="1" name="page" type="xsd:int">
        <xsd:annotation>
          <xsd:documentation>Номер страницы</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element default="0" minOccurs="1" name="pageSize" type="xsd:int">
        <xsd:annotation>
          <xsd:documentation>Размер страницы</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ResponsePageInfo">
    <xsd:complexContent>
      <xsd:extension base="tns:RequestPageInfo">
        <xsd:sequence>
          <xsd:element default="0" minOccurs="1" name="total" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Всего записей</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="ConsultationsUserContext">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Контекст пользователя</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="employeeJobId" type="tns:EmployeeJobKey">
          <xsd:annotation>
            <xsd:documentation>Идентификатор исполнения должности</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="fullName" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>ФИО пользователя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="position" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Должность медработника</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="Priority">
    <xsd:annotation>
      <xsd:documentation>Справочник "Степень срочности"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="cito" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="longTerm" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Долгосрочное назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fromPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты начала проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="toPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты окончания проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="offset" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Количество дней, начиная от текущей даты</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="active" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак актуальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="AppointmentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор записи</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="CareEventKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор клинического события</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="PatientKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор пациента</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="AssignmentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор назначения</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:simpleType name="ReferralKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор направления</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:simpleType name="NsiKey">
    <xsd:restriction base="xsd:normalizedString"/>
  </xsd:simpleType>
  <!--<xsd:simpleType name="SpecialityKey">-->
  <!--<xsd:annotation>-->
  <!--<xsd:documentation>Идентификатор специальности</xsd:documentation>-->
  <!--</xsd:annotation>-->
  <!--<xsd:restriction base="tns:NsiKey"/>-->
  <!--</xsd:simpleType>-->
  <xsd:simpleType name="SpecializationKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор специализации</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="tns:NsiKey"/>
  </xsd:simpleType>
  <xsd:simpleType name="AvailableResourceKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор доступного ресурса</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="LpuKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="EmployeeJobKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор врача</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="CctCode">
    <xsd:annotation>
      <xsd:documentation>Идентификатор класс-кода документа</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="DocumentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор документа</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:complexType name="Lpu">
    <xsd:annotation>
      <xsd:documentation>ЛПУ</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Наименование ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Period">
    <xsd:annotation>
      <xsd:documentation>Период</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="1" minOccurs="1" name="start" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Начало периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="1" minOccurs="1" name="end" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Конец периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.core.v1.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=emias.system.v1.xsd"/>
  <!--references-->
  <xs:element name="medicalOrganizationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинской организации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="medicalFacilityId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинского учреждения</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--async operation status-->
  <xs:element name="operationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор операции</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="OperationExecutionStatus">
    <xs:annotation>
      <xs:documentation>Статус выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="isCompleted" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак окончания выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="completenessProgress" type="OperationCompletenessBase">
        <xs:annotation>
          <xs:documentation>Сведения о текущем статусе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hasSucceded" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак успешности выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
        <xs:annotation>
          <xs:documentation>Коллекция сообщений, порожденных в ходе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="id" type="ID" use="required">
      <xs:annotation>
        <xs:documentation>Идентификатор операции</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessPercentage">
    <xs:annotation>
      <xs:documentation>Описание текущего статуса выполнения операции в процентах (0%-100%)</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="OperationCompletenessBase">
        <xs:sequence>
          <xs:element name="completenessStatus">
            <xs:annotation>
              <xs:documentation>Статус (0%-100%)</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="xs:unsignedByte">
                <xs:minInclusive value="0"/>
                <xs:maxInclusive value="100"/>
              </xs:restriction>
            </xs:simpleType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessBase">
    <xs:annotation>
      <xs:documentation>Базовый абстрактный тип для описания текущего статуса выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--calling methods' options-->
  <xs:element name="options" type="Options">
    <xs:annotation>
      <xs:documentation>Параметры вызова метода</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="Options">
    <xs:annotation>
      <xs:documentation>Набор именованных значений</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="entry" type="KeyValuePair">
        <xs:annotation>
          <xs:documentation>Именованное значение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <!--pagination-->
  <xs:element name="pagingOptions" type="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType abstract="true" name="PagingResults">
    <xs:annotation>
      <xs:documentation>Список с пагинацией</xs:documentation>
    </xs:annotation>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageTotal" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Общее количество страниц</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="morePagesAvailable" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Флаг доступности других страниц с результатами для "постраничного листания" (true - если доступны еще страницы; false - иначе)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--base types-->
  <xs:complexType name="TimeInterval">
    <xs:annotation>
      <xs:documentation>Временной период (время)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время начала интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время окончания интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DatePeriod">
    <xs:annotation>
      <xs:documentation>Временной период (дата)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата начала периода</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата окончания периода</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=task-wsdl-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/task/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/task/" xmlns:task="http://emias.mos.ru/consultations/v1/task/types/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/task/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=task-types.xsd"/>
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=common-types.xsd"/>
  <xsd:element name="GetPatientTasksRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="patientId" type="common:PatientKey"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="specializationId" type="common:SpecializationKey"/>
        <xsd:element minOccurs="0" name="lpuId" type="common:LpuKey"/>
        <xsd:element minOccurs="0" name="taskType" type="task:TaskType"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="statuses" type="task:TaskStatus"/>
        <xsd:element minOccurs="0" name="period" type="common:Period"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
        <xsd:element minOccurs="0" name="limitByAppointment" type="xsd:boolean"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetPatientTasksResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="task:TaskPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="AssignAppointmentRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="taskId" type="task:TaskKey"/>
        <xsd:element name="appointmentId" type="common:AppointmentKey"/>
        <xsd:element name="availableResourceId" type="common:AvailableResourceKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="AssignAppointmentResponse">
    <xsd:complexType>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="CancelAppointmentRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="taskId" type="task:TaskKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="CancelAppointmentResponse">
    <xsd:complexType>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAvailableResourceTasksRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="availableResourceId" type="common:AvailableResourceKey"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAvailableResourceTasksResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="task:TaskPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetPlanResourceTasksRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="appointmentIds" type="common:AppointmentKey"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetPlanResourceTasksResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="task:TaskPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetCitoResourceTasksRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="availableResourceId" type="common:AvailableResourceKey"/>
        <xsd:element name="date" type="xsd:date"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetCitoResourceTasksResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="task:TaskPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="StartConductRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="taskId" type="task:TaskKey"/>
        <xsd:element name="careEventId" type="common:CareEventKey"/>
        <xsd:element name="availableResourceId" type="common:AvailableResourceKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="StartConductResponse">
    <xsd:complexType>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="CancelConductRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="taskId" type="task:TaskKey"/>
        <xsd:element name="availableResourceId" type="common:AvailableResourceKey"/>
        <xsd:element name="nullCareEvent" type="xsd:boolean"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="CancelConductResponse">
    <xsd:complexType>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="ViewResultRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="taskId" type="task:TaskKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="ViewResultResponse">
    <xsd:complexType>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentTasksRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="assignmentId" type="common:AssignmentKey"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="statuses" type="task:TaskStatus"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="types" type="task:TaskType"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetAssignmentTasksResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="task:TaskPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetTaskRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="taskId" type="task:TaskKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetTaskResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="task:TaskDetails"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetTasksByCareEventsRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="careEventIds" type="common:CareEventKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetTasksByCareEventsResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="task:Task"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetTasksByReferralIdRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="suppReferralId" type="common:ReferralKey"/>
        <xsd:element name="type" type="xsd:string"/>
        <xsd:element maxOccurs="unbounded" name="statuses" type="task:TaskStatus"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetTasksByReferralIdResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="task:Task"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=task-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/task/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/task/types/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/TaskService?xsd=common-types.xsd"/>
  <xsd:complexType name="TaskPage">
    <xsd:annotation>
      <xsd:documentation>Пострнаничный вывод списка задач</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="tns:Task">
        <xsd:annotation>
          <xsd:documentation>Список задач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="paging" type="common:ResponsePageInfo">
        <xsd:annotation>
          <xsd:documentation>Пагинация</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="TaskKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:complexType name="Task">
    <xsd:annotation>
      <xsd:documentation>Базовый класс задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="tns:TaskKey">
        <xsd:annotation>
          <xsd:documentation>Список задач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:TaskType">
        <xsd:annotation>
          <xsd:documentation>Список задач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignmentId" type="common:AssignmentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patientId" type="common:PatientKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор паицента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignmentDocumentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор документа СИМИ (Назначение)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="parentDocumentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор документа СИМИ, который породил задачу</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="priority" type="common:Priority">
        <xsd:annotation>
          <xsd:documentation>Степень срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="cito" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак экстренности (для Cito пациентов)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="specialization" type="tns:TaskSpecialization">
        <xsd:annotation>
          <xsd:documentation>Специализация</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="createDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время создания задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="changeDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="expectedEndDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время планируемого завершения задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="endDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время завершения задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignedToLpu" type="common:LpuKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор МО, для которого создана задача</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="createUser" type="tns:TaskUser">
        <xsd:annotation>
          <xsd:documentation>Пользователь, инициировавший создание задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="updateUser" type="tns:TaskUser">
        <xsd:annotation>
          <xsd:documentation>Пользователь, последний изменивший статус</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="options" type="common:Options">
        <xsd:annotation>
          <xsd:documentation>Дополнительные параметры</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskConduct">
    <xsd:annotation>
      <xsd:documentation>Задача на проведение инструментального исследования</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Task">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="specializationId" type="common:SpecializationKey">
            <xsd:annotation>
              <xsd:documentation>Код специализации</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="purpose" type="xsd:string">
            <xsd:annotation>
              <xsd:documentation>Обоснование</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="availableResourceId" type="common:AvailableResourceKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор специализированного доступного ресурса, указывается для назначения задачи на ресурс медицинской организации</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="appointmentId" type="common:AppointmentKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор записи на прием пациента</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="careEventId" type="common:CareEventKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор клинического события</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="documentId" type="common:DocumentKey">
            <xsd:annotation>
              <xsd:documentation>Идентификатор документа СИМИ, созданный в ходе выпонения задачи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="desiredAssignmentDate" type="xsd:dateTime">
            <xsd:annotation>
              <xsd:documentation>Желаемая дата начала действия назначения</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="lastDateAppointment" type="xsd:dateTime">
            <xsd:annotation>
              <xsd:documentation>Крайняя дата доступная пациенту для самозаписи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TaskViewResult">
    <xsd:annotation>
      <xsd:documentation>Задача на просмотр результатов исследования</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Task">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="employeeJobId" type="common:EmployeeJobKey">
            <xsd:annotation>
              <xsd:documentation>Исполнение должности медработника</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TaskApprove">
    <xsd:annotation>
      <xsd:documentation>Задача на согласование направления</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Task">
        <xsd:sequence></xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TaskUser">
    <xsd:annotation>
      <xsd:documentation>Пользователь</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element minOccurs="0" name="employeeJobId" type="common:EmployeeJobKey">
        <xsd:annotation>
          <xsd:documentation>ИД исполнения должности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fio" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>ФИО пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="position" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Должность пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="login" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Логин пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskDetails">
    <xsd:annotation>
      <xsd:documentation>Подробная информация по задаче</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="task" type="tns:Task">
        <xsd:annotation>
          <xsd:documentation>Описание задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="changeLog" type="tns:TaskChangeLog">
        <xsd:annotation>
          <xsd:documentation>История изменений статуса задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskChangeLog">
    <xsd:annotation>
      <xsd:documentation>История изменений статуса задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="status" type="tns:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="changeDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="login" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Логин пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TaskStatusInfo">
    <xsd:annotation>
      <xsd:documentation>Идентификатор и статус задачи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="taskId" type="tns:TaskKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:TaskStatus">
        <xsd:annotation>
          <xsd:documentation>Статус задачи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="TaskType">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Conduct">
        <xsd:annotation>
          <xsd:documentation>Проведение ИИ</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Approve">
        <xsd:annotation>
          <xsd:documentation>Согласование направления</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="ViewResult">
        <xsd:annotation>
          <xsd:documentation>Просмотр результатов назначения врачом-клиницистом</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="TaskStatus">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Created">
        <xsd:annotation>
          <xsd:documentation>Создана</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Assigned">
        <xsd:annotation>
          <xsd:documentation>Назначена</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Progress">
        <xsd:annotation>
          <xsd:documentation>В работе</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Completed">
        <xsd:annotation>
          <xsd:documentation>Выполнена</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Cancelled">
        <xsd:annotation>
          <xsd:documentation>Аннулирована</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="TaskSpecialization">
    <xsd:annotation>
      <xsd:documentation>Справочник "Степень срочности"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint></con:endpoints><con:operation id="af943355-17e5-4154-a6aa-9ce2d9a05de0" isOneWay="false" action="assignAppointment" name="assignAppointment" bindingOperationName="assignAppointment" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="12199883-cb12-4854-ac0c-e884f935e401" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext \rxmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>47174</task:taskId>\r
         <task:appointmentId>123456</task:appointmentId>\r
         <task:availableResourceId>18674372110</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/assignAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="3fcecc67-c3eb-4ccd-a1f7-8b9118c7bfb3" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/RBeda</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>10503235992</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>qw</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>qw</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>26857</task:taskId>\r
         <task:appointmentId>456</task:appointmentId>\r
         <task:availableResourceId>456</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/assignAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="28470454-b5a4-43ad-9372-b642c699cc26" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:appointmentId>?</task:appointmentId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/assignAppointmentRequest"/></con:call><con:call id="365e3614-7a0d-4697-8b8e-94a90890048e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:appointmentId>?</task:appointmentId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/assignAppointmentRequest"/></con:call><con:call id="3d01d947-ee92-49fa-9697-a910b29b2d44" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:appointmentId>?</task:appointmentId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/assignAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="75d9a3da-3eec-42bd-816d-7a5affc66a16" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:appointmentId>?</task:appointmentId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/assignAppointmentRequest"/></con:call></con:operation><con:operation id="7b173ac4-534b-4c08-a190-e7945d8ede8a" isOneWay="false" action="cancelAppointment" name="cancelAppointment" bindingOperationName="cancelAppointment" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="fa566dd0-330d-4f9a-a245-4a4761493016" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>
      <task:CancelAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="8c1c2ae8-a042-4f81-ab1b-2cd8631ba77d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="366fb31b-45a1-4a36-a703-3eb3a8b6480b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="ebc2c6d8-a586-42e7-85a4-f6c1beaaed82" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="ff88995b-8643-4add-b966-27a578540b90" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelAppointmentRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="555339ea-2188-46e6-a22e-67f5c43329f7" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelAppointmentRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelAppointmentRequest"/></con:call></con:operation><con:operation id="a02bc1c9-640d-4790-9e6f-bdf289cb3511" isOneWay="false" action="cancelConduct" name="cancelConduct" bindingOperationName="cancelConduct" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="20fd0a53-9556-4a4d-8bac-37accf47a079" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>
      <task:CancelConductRequest>\r
         <task:taskId>47174</task:taskId>\r
         <task:availableResourceId>18674372110</task:availableResourceId>\r
         <task:nullCareEvent>true</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="846f89b4-3603-42ef-844c-e85c5991e10a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:nullCareEvent>?</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelConductRequest"/></con:call><con:call id="ed770a1d-9384-40cc-ad9a-dc4bcc09be4c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:nullCareEvent>?</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelConductRequest"/></con:call><con:call id="2e46ae16-e7a5-48ff-9fd6-778168265b31" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:nullCareEvent>?</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelConductRequest"/></con:call><con:call id="79875864-b481-494f-a0a0-52ce04e02327" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:nullCareEvent>?</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="ba266ede-5c12-47ee-8019-cb95d209ce69" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:CancelConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:nullCareEvent>?</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/cancelConductRequest"/></con:call></con:operation><con:operation id="0d4084ee-798d-4db4-bd03-052d7fd2740a" isOneWay="false" action="getAssignmentTasks" name="getAssignmentTasks" bindingOperationName="getAssignmentTasks" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="b5f35b0d-b0b0-4048-9297-e0213b288b22" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
   
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>ConsultationAssignment9b3b3ef0-173b-49e3-aefd-47ccd77f94ca</task:assignmentId>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>Created</task:statuses>\r
         <!--Zero or more repetitions:-->\r
         <task:types>Conduct</task:types>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAssignmentTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="0ca7e2c8-8be6-46ff-bb7c-df750dca8fef" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>?</task:assignmentId>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Zero or more repetitions:-->\r
         <task:types>?</task:types>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAssignmentTasksRequest"/></con:call><con:call id="cc8e9d36-1a3e-4af0-ae93-a5ad60ac85b2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>?</task:assignmentId>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Zero or more repetitions:-->\r
         <task:types>?</task:types>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAssignmentTasksRequest"/></con:call><con:call id="b652e13b-5657-4daa-af7a-f9c32ad6557f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>?</task:assignmentId>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Zero or more repetitions:-->\r
         <task:types>?</task:types>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAssignmentTasksRequest"/></con:call><con:call id="02475297-88f2-4ddc-9c2b-bb36f7f7e7f9" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>?</task:assignmentId>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Zero or more repetitions:-->\r
         <task:types>?</task:types>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAssignmentTasksRequest"/></con:call><con:call id="109f9c14-9fbf-4de5-8526-f4444d1fa131" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>?</task:assignmentId>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Zero or more repetitions:-->\r
         <task:types>?</task:types>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAssignmentTasksRequest"/></con:call></con:operation><con:operation id="94f5bee1-7694-446f-97c7-09ab9c2b5330" isOneWay="false" action="getAvailableResourceTasks" name="getAvailableResourceTasks" bindingOperationName="getAvailableResourceTasks" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="16302e83-2eb1-4dc9-9fcd-40e4de45b95e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAvailableResourceTasksRequest"/></con:call><con:call id="11904e3a-ad66-4e1c-9bb4-64e358853ff6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAvailableResourceTasksRequest"/></con:call><con:call id="8121d799-fb21-48d1-bd71-334572b7836b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAvailableResourceTasksRequest"/></con:call><con:call id="6bc7d064-7f5d-4797-b56e-c3f476b6540c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAvailableResourceTasksRequest"/></con:call><con:call id="9ba11e44-f89c-42e3-8d1e-ef1fab5617d7" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAvailableResourceTasksRequest"/></con:call><con:call id="978fb3fb-c39b-475a-9b74-737cb4a60337" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getAvailableResourceTasksRequest"/></con:call></con:operation><con:operation id="f3c6b843-2119-44ec-bea4-cd941c9338d4" isOneWay="false" action="getCitoResourceTasks" name="getCitoResourceTasks" bindingOperationName="getCitoResourceTasks" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="b584b0cf-7d27-445d-9bf6-407f760d7ebb" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:date>?</task:date>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getCitoResourceTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="3c98542f-7425-4a5b-a9b5-301a75f86efd" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:date>?</task:date>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getCitoResourceTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="3bb38363-4e1a-47e3-a03c-f69c0eebd761" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:date>?</task:date>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getCitoResourceTasksRequest"/></con:call><con:call id="0966a75d-4a8a-4d60-a806-2e0c3652a180" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:date>?</task:date>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getCitoResourceTasksRequest"/></con:call><con:call id="1018feb6-7e72-4bcc-8cf5-e0c34cef001a" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>10503235992</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>qw</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>qw</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>10845847</task:availableResourceId>\r
         <task:date>2020-03-03</task:date>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>50</typ:pageSize>\r
         </task:paging>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getCitoResourceTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="ac4f0388-4162-4c22-b108-5f0bab7ac9e1" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>?</task:availableResourceId>\r
         <task:date>?</task:date>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getCitoResourceTasksRequest"/></con:call></con:operation><con:operation id="7b0f27b2-3c2a-4fa1-9e3a-5c7bfe108154" isOneWay="false" action="getPatientTasks" name="getPatientTasks" bindingOperationName="getPatientTasks" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="71f36996-6df4-448a-a1cc-f873af8f5ab5" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPatientTasksRequest>\r
         <task:patientId>?</task:patientId>\r
         <!--Optional:-->\r
         <task:lpuId>?</task:lpuId>\r
         <!--Optional:-->\r
         <task:taskType>?</task:taskType>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
         <!--Optional:-->\r
         <task:limitByAppointment>?</task:limitByAppointment>\r
      </task:GetPatientTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPatientTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="1ce6fe88-2dfb-41fe-9032-daca77da5420" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPatientTasksRequest>\r
         <task:patientId>?</task:patientId>\r
         <!--Optional:-->\r
         <task:lpuId>?</task:lpuId>\r
         <!--Optional:-->\r
         <task:taskType>?</task:taskType>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
         <!--Optional:-->\r
         <task:limitByAppointment>?</task:limitByAppointment>\r
      </task:GetPatientTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPatientTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="41376b9c-1c3b-4db9-83ba-6321009f5897" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPatientTasksRequest>\r
         <task:patientId>?</task:patientId>\r
         <!--Optional:-->\r
         <task:lpuId>?</task:lpuId>\r
         <!--Optional:-->\r
         <task:taskType>?</task:taskType>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
         <!--Optional:-->\r
         <task:limitByAppointment>?</task:limitByAppointment>\r
      </task:GetPatientTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPatientTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="7f49c221-22a3-4c51-8255-7ea928031b34" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r  
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPatientTasksRequest>\r
           <task:patientId>25287394</task:patientId>\r
           <task:taskType>Conduct</task:taskType>
      </task:GetPatientTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPatientTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="6f7083a2-5c2c-4be4-bc1a-a25a7ef7a745" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">
   <soap:Header>
  
   </soap:Header>
   <soap:Body>
      <task:GetPatientTasksRequest>
           <task:patientId>30000000155549</task:patientId>
      </task:GetPatientTasksRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPatientTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="4bb2f078-258c-4c72-8ca8-4f8ba22a557d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPatientTasksRequest>\r
         <task:patientId>?</task:patientId>\r
         <!--Zero or more repetitions:-->\r
         <task:specializationId>?</task:specializationId>\r
         <!--Optional:-->\r
         <task:lpuId>?</task:lpuId>\r
         <!--Optional:-->\r
         <task:taskType>?</task:taskType>\r
         <!--Zero or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
         <!--Optional:-->\r
         <task:period>\r
            <typ:start>?</typ:start>\r
            <typ:end>?</typ:end>\r
         </task:period>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
         <!--Optional:-->\r
         <task:limitByAppointment>?</task:limitByAppointment>\r
      </task:GetPatientTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPatientTasksRequest"/></con:call></con:operation><con:operation id="33448fe4-0563-4445-94c1-90a2e8cc1827" isOneWay="false" action="getPlanResourceTasks" name="getPlanResourceTasks" bindingOperationName="getPlanResourceTasks" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="70ac6b54-e478-4aa5-b640-594a8133b31d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>?</task:appointmentIds>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPlanResourceTasksRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="9e452844-0f56-420f-b612-e0d0f3b8c5a6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>?</task:appointmentIds>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPlanResourceTasksRequest"/></con:call><con:call id="1d4a3878-680c-419c-8ae4-2abde2f843df" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>?</task:appointmentIds>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPlanResourceTasksRequest"/></con:call><con:call id="e55163f1-370b-4254-9312-0bf7751cf77b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>?</task:appointmentIds>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPlanResourceTasksRequest"/></con:call><con:call id="68c11cfc-a463-44a2-a4c0-5443aa760abe" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>?</task:appointmentIds>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPlanResourceTasksRequest"/></con:call><con:call id="4a91acbe-e9e5-4cc0-aa30-5c43675c601c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>?</task:appointmentIds>\r
         <!--Optional:-->\r
         <task:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </task:paging>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getPlanResourceTasksRequest"/></con:call></con:operation><con:operation id="9ff16c1d-8344-4bb3-bc9a-deb1aa807b67" isOneWay="false" action="getTask" name="getTask" bindingOperationName="getTask" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="449702c1-ef34-4447-8445-c260c460a1f4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTaskRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="b5e080ef-a7fc-4ae3-a3dc-18313d63870d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTaskRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="62a9e74b-ab30-422d-8715-7dc7a0b739d3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTaskRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="a3e2ed40-7895-495e-8a91-d60350358882" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTaskRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="d4ffe956-e15f-41d5-9fa4-3089d868581c" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r

   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>29880</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTaskRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="99ebf2e3-ef8f-4e3c-93e3-0998c146d2b3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTaskRequest"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="fe2ce20a-1e0b-4464-a4a0-b429399baf4d" isOneWay="false" action="getTasksByCareEvents" name="getTasksByCareEvents" bindingOperationName="getTasksByCareEvents" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5d56a441-de35-4373-acf9-7d96cb2ee99b" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r

   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>92704</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByCareEventsRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="54727d08-4b01-4da2-9ccb-d6cef898ebdd" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>?</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByCareEventsRequest"/></con:call><con:call id="eb9d40cb-3b27-4ee5-9b39-8843d6ee347f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>?</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByCareEventsRequest"/></con:call><con:call id="12e761e3-f745-44f7-9dce-d9fd414f5c5e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>?</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByCareEventsRequest"/></con:call><con:call id="e14b0b73-d89b-4c9f-94b6-9cfa0021e5c6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>?</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByCareEventsRequest"/></con:call><con:call id="1129799a-e8e1-46e3-8c0a-6cd901a17ed3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>?</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByCareEventsRequest"/></con:call></con:operation><con:operation id="6fee1632-2552-4d5a-9264-e9ffc68ef463" isOneWay="false" action="startConduct" name="startConduct" bindingOperationName="startConduct" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="01f0e470-a801-442c-bccc-8b04e8b9932e" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>
      <task:StartConductRequest>\r
         <task:taskId>47174</task:taskId>\r
         <task:careEventId>654321</task:careEventId>\r
         <task:availableResourceId>18674372110</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/startConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="6b06d3f3-0f60-4bdf-9d23-2926aaad64d7" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:careEventId>?</task:careEventId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/startConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="4622ce74-c3f5-46ca-b542-855f2a8e5f61" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:careEventId>?</task:careEventId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/startConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="eee34c2a-ba9c-40bf-94ea-3d8254350664" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:careEventId>?</task:careEventId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/startConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="4c7e6336-d7c3-46c0-857f-e2f592cfdefc" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:careEventId>?</task:careEventId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/startConductRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="8662c8c0-6add-41dc-858a-a898b5ab2f14" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>?</task:taskId>\r
         <task:careEventId>?</task:careEventId>\r
         <task:availableResourceId>?</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/startConductRequest"/></con:call></con:operation><con:operation id="2e83d60e-1a8c-46bc-9ec1-87444b72233f" isOneWay="false" action="viewResult" name="viewResult" bindingOperationName="viewResult" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e973f129-d277-4853-ba7f-5ec61c43d851" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:ViewResultRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:ViewResultRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/viewResultRequest"/><con:wsrmConfig version="1.2"/></con:call><con:call id="721f1c8b-c91b-4132-8c22-bf41f267e7ef" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:ViewResultRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:ViewResultRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/viewResultRequest"/></con:call><con:call id="149f098d-b39f-4c6e-bf88-4da59c667e33" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:ViewResultRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:ViewResultRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/viewResultRequest"/></con:call><con:call id="0f3bcadd-2eb7-48de-99dd-da6dc1a1fc8e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:ViewResultRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:ViewResultRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/viewResultRequest"/></con:call><con:call id="b8c1b025-7b9d-4db3-b9a9-83c48821b4f7" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:ViewResultRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:ViewResultRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/viewResultRequest"/></con:call><con:call id="2341f9f2-3187-4ef2-a98d-f26f67a16c42" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:ViewResultRequest>\r
         <task:taskId>?</task:taskId>\r
      </task:ViewResultRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/viewResultRequest"/></con:call></con:operation><con:operation id="75428eaa-a6b9-480a-a9fc-b90da10d094c" isOneWay="false" action="getTasksByReferralId" name="getTasksByReferralId" bindingOperationName="getTasksByReferralId" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="af72265e-3d2e-4467-8ef0-7a011332dbb5" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.emias.dzm.lanit.ru/consultations/application/api/TaskService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByReferralIdRequest>\r
         <task:suppReferralId>?</task:suppReferralId>\r
         <task:type>?</task:type>\r
         <!--1 or more repetitions:-->\r
         <task:statuses>?</task:statuses>\r
      </task:GetTasksByReferralIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/task/soap/TaskServicePortType/getTasksByReferralIdRequest"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="d02a11de-71c2-44af-9e6f-3b48b9ee9538" wsaVersion="NONE" name="AppointmentServiceV1Binding" type="wsdl" bindingName="{http://emias2.gov.ru/appointment/v1/}AppointmentServiceV1Binding" soapVersion="1_2" anonymous="optional" definition="http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService?wsdl"><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService?wsdl</con:url><con:content><![CDATA[<wsdl:definitions name="AppointmentServiceV1" targetNamespace="http://emias2.gov.ru/appointment/v1/" xmlns="http://emias2.gov.ru/appointment/v1/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:wsp="http://www.w3.org/ns/ws-policy/" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <wsdl:documentation>version="1.0"</wsdl:documentation>
  <wsdl:types>
    <xsd:schema targetNamespace="http://emias2.gov.ru/appointment/v1/">
      <xsd:include id="types" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService?xsd=AAAADHAjUCM4P2cuZURELjOXdW4mbtvSHt9xFDZFbblbYHx4ehW.2ANSDryg1rn4w.fkuUmhapcLc_djdX6uNayLSjCWl7Shc6IaOSoBrSICFt0DprNoDtZPxNn_3O6.z1E5M3sst_NKBFJyb2ON2bR0RbL1SQQsuWX9nVMpS0bG_pIBpND."/>
    </xsd:schema>
  </wsdl:types>
  <wsdl:message name="getAppointmentShiftByLpuInput">
    <wsdl:part element="getAppointmentShiftByLpu" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getCountSlotsForAppointmentInput">
    <wsdl:part element="getCountSlotsForAppointment" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="createReferralOutput">
    <wsdl:part element="createReferralResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getLdpTypesOutput">
    <wsdl:part element="getLdpTypesResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getCancelReasonsInput">
    <wsdl:part element="getCancelReasons" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMedicalSpecialitiesInput">
    <wsdl:part element="getMedicalSpecialities" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getWorkCalendarInput">
    <wsdl:part element="getWorkCalendar" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="searchPatientsByTicketOutput">
    <wsdl:part element="searchPatientsByTicketResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getCountSlotsForAppointmentOutput">
    <wsdl:part element="getCountSlotsForAppointmentResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getCancelReasonsOutput">
    <wsdl:part element="getCancelReasonsResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByUserOutput">
    <wsdl:part element="getDoctorsByUserResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateAppointmentWithReceptionFactInput">
    <wsdl:part element="updateAppointmentWithReceptionFact" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReferralsByIDsInput">
    <wsdl:part element="getReferralsByIDs" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentPlanByLpuInput">
    <wsdl:part element="getAppointmentPlanByLpu" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientOutput">
    <wsdl:part element="getDoctorsByPatientResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="createUrgentAppointmentInput">
    <wsdl:part element="createUrgentAppointment" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMedicalSpecialitiesOutput">
    <wsdl:part element="getMedicalSpecialitiesResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="AppointmentCodeErrorException">
    <wsdl:documentation>Error</wsdl:documentation>
    <wsdl:part element="Detail" name="fault"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getARScheduleOutput">
    <wsdl:part element="getARScheduleResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getQuotaTypesInput">
    <wsdl:part element="getQuotaTypes" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateSystemParameterInput">
    <wsdl:part element="updateSystemParameter" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMedicalEmployeesOutput">
    <wsdl:part element="getMedicalEmployeesResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="createUrgentAppointmentOutput">
    <wsdl:part element="createUrgentAppointmentResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForLIInput">
    <wsdl:part element="getDoctorsByPatientForLI" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateSystemParameterOutput">
    <wsdl:part element="updateSystemParameterResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForPackageOutput">
    <wsdl:part element="getDoctorsByPatientForPackageResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="cancelReferralInput">
    <wsdl:part element="cancelReferral" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentsByPatientInput">
    <wsdl:part element="getAppointmentsByPatient" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getLpuTypesOutput">
    <wsdl:part element="getLpuTypesResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForPackageByRouteInput">
    <wsdl:part element="getDoctorsByPatientForPackageByRoute" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentPlanByLpuOutput">
    <wsdl:part element="getAppointmentPlanByLpuResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForPackageByRouteOutput">
    <wsdl:part element="getDoctorsByPatientForPackageByRouteResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="UserContextInfo">
    <wsdl:documentation>Контекст пользователя</wsdl:documentation>
    <wsdl:part element="UserContextInfo" name="UserContextInfo"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReferralHistoryInput">
    <wsdl:part element="getReferralHistory" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateAppointmentWithReceptionFactOutput">
    <wsdl:part element="updateAppointmentWithReceptionFactResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentsByIDsInput">
    <wsdl:part element="getAppointmentsByIDs" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByReferralInput">
    <wsdl:part element="getDoctorsByReferral" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByRouteInput">
    <wsdl:part element="getDoctorsByRoute" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMODutyDoctorAppRefParametersOutput">
    <wsdl:part element="getMODutyDoctorAppRefParametersResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="cancelAppointmentOutput">
    <wsdl:part element="cancelAppointmentResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="cancelAppointmentInput">
    <wsdl:part element="cancelAppointment" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getSystemParametersOutput">
    <wsdl:part element="getSystemParametersResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getWorkCalendarOutput">
    <wsdl:part element="getWorkCalendarResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByRegistryInput">
    <wsdl:part element="getDoctorsByRegistry" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getSamplingTypeInput">
    <wsdl:part element="getSamplingType" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentPlanDailyInput">
    <wsdl:part element="getAppointmentPlanDaily" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateMODutyDoctorAppRefParametersInput">
    <wsdl:part element="updateMODutyDoctorAppRefParameters" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentShiftByLpuOutput">
    <wsdl:part element="getAppointmentShiftByLpuResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForSpecialityOutput">
    <wsdl:part element="getDoctorsByPatientForSpecialityResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentHistoryOutput">
    <wsdl:part element="getAppointmentHistoryResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForPackageInput">
    <wsdl:part element="getDoctorsByPatientForPackage" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentsByPatientOutput">
    <wsdl:part element="getAppointmentsByPatientResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReceptionTypesOutput">
    <wsdl:part element="getReceptionTypesResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getLpuTypesInput">
    <wsdl:part element="getLpuTypes" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMODutyDoctorAppRefParametersInput">
    <wsdl:part element="getMODutyDoctorAppRefParameters" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateMODutyDoctorAppRefParametersOutput">
    <wsdl:part element="updateMODutyDoctorAppRefParametersResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getSamplingTypeOutput">
    <wsdl:part element="getSamplingTypeResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getARScheduleInput">
    <wsdl:part element="getARSchedule" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentShiftDailyInput">
    <wsdl:part element="getAppointmentShiftDaily" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDiagnosesMKB10Output">
    <wsdl:part element="getDiagnosesMKB10Response" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReferralsByIDsOutput">
    <wsdl:part element="getReferralsByIDsResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="searchPatientsByReferralOutput">
    <wsdl:part element="searchPatientsByReferralResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="cancelReferralOutput">
    <wsdl:part element="cancelReferralResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getLdpTypesInput">
    <wsdl:part element="getLdpTypes" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getLpuListOutput">
    <wsdl:part element="getLpuListResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReceptionTypesInput">
    <wsdl:part element="getReceptionTypes" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentsByResourceInput">
    <wsdl:part element="getAppointmentsByResource" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByReferralOutput">
    <wsdl:part element="getDoctorsByReferralResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getQuotaTypesOutput">
    <wsdl:part element="getQuotaTypesResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateReferralOutput">
    <wsdl:part element="updateReferralResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentHistoryInput">
    <wsdl:part element="getAppointmentHistory" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByUserInput">
    <wsdl:part element="getDoctorsByUser" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateReferralInput">
    <wsdl:part element="updateReferral" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getSystemParametersInput">
    <wsdl:part element="getSystemParameters" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientInput">
    <wsdl:part element="getDoctorsByPatient" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getLpuListInput">
    <wsdl:part element="getLpuList" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDistrictsInput">
    <wsdl:part element="getDistricts" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDistrictsOutput">
    <wsdl:part element="getDistrictsResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForSpecialityInput">
    <wsdl:part element="getDoctorsByPatientForSpeciality" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentPlanDailyOutput">
    <wsdl:part element="getAppointmentPlanDailyResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateAppointmentInput">
    <wsdl:part element="updateAppointment" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="searchPatientsByTicketInput">
    <wsdl:part element="searchPatientsByTicket" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReferralsByPatientInput">
    <wsdl:part element="getReferralsByPatient" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="searchPatientsByReferralInput">
    <wsdl:part element="searchPatientsByReferral" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getMedicalEmployeesInput">
    <wsdl:part element="getMedicalEmployees" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="createReferralInput">
    <wsdl:part element="createReferral" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReferralsByPatientOutput">
    <wsdl:part element="getReferralsByPatientResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="createAppointmentOutput">
    <wsdl:part element="createAppointmentResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDiagnosesMKB10Input">
    <wsdl:part element="getDiagnosesMKB10" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentsByIDsOutput">
    <wsdl:part element="getAppointmentsByIDsResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentsByResourceOutput">
    <wsdl:part element="getAppointmentsByResourceResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByRegistryOutput">
    <wsdl:part element="getDoctorsByRegistryResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="updateAppointmentOutput">
    <wsdl:part element="updateAppointmentResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getReferralHistoryOutput">
    <wsdl:part element="getReferralHistoryResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="createAppointmentInput">
    <wsdl:part element="createAppointment" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByPatientForLIOutput">
    <wsdl:part element="getDoctorsByPatientForLIResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getDoctorsByRouteOutput">
    <wsdl:part element="getDoctorsByRouteResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:message name="getAppointmentShiftDailyOutput">
    <wsdl:part element="getAppointmentShiftDailyResponse" name="body"></wsdl:part>
  </wsdl:message>
  <wsdl:portType name="AppointmentServiceV1PT">
    <wsdl:operation name="getReferralsByPatient">
      <wsdl:input message="getReferralsByPatientInput" name="getReferralsByPatient"></wsdl:input>
      <wsdl:output message="getReferralsByPatientOutput" name="getReferralsByPatientResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getReferralsByIDs">
      <wsdl:input message="getReferralsByIDsInput" name="getReferralsByIDs"></wsdl:input>
      <wsdl:output message="getReferralsByIDsOutput" name="getReferralsByIDsResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentsByPatient">
      <wsdl:input message="getAppointmentsByPatientInput" name="getAppointmentsByPatient"></wsdl:input>
      <wsdl:output message="getAppointmentsByPatientOutput" name="getAppointmentsByPatientResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentsByIDs">
      <wsdl:input message="getAppointmentsByIDsInput" name="getAppointmentsByIDs"></wsdl:input>
      <wsdl:output message="getAppointmentsByIDsOutput" name="getAppointmentsByIDsResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentsByResource">
      <wsdl:input message="getAppointmentsByResourceInput" name="getAppointmentsByResource"></wsdl:input>
      <wsdl:output message="getAppointmentsByResourceOutput" name="getAppointmentsByResourceResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByUser">
      <wsdl:input message="getDoctorsByUserInput" name="getDoctorsByUser"></wsdl:input>
      <wsdl:output message="getDoctorsByUserOutput" name="getDoctorsByUserResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByRegistry">
      <wsdl:input message="getDoctorsByRegistryInput" name="getDoctorsByRegistry"></wsdl:input>
      <wsdl:output message="getDoctorsByRegistryOutput" name="getDoctorsByRegistryResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByRoute">
      <wsdl:input message="getDoctorsByRouteInput" name="getDoctorsByRoute"></wsdl:input>
      <wsdl:output message="getDoctorsByRouteOutput" name="getDoctorsByRouteResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatient">
      <wsdl:input message="getDoctorsByPatientInput" name="getDoctorsByPatient"></wsdl:input>
      <wsdl:output message="getDoctorsByPatientOutput" name="getDoctorsByPatientResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByReferral">
      <wsdl:input message="getDoctorsByReferralInput" name="getDoctorsByReferral"></wsdl:input>
      <wsdl:output message="getDoctorsByReferralOutput" name="getDoctorsByReferralResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getARSchedule">
      <wsdl:input message="getARScheduleInput" name="getARSchedule"></wsdl:input>
      <wsdl:output message="getARScheduleOutput" name="getARScheduleResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="createAppointment">
      <wsdl:input message="createAppointmentInput" name="createAppointment"></wsdl:input>
      <wsdl:output message="createAppointmentOutput" name="createAppointmentResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="cancelAppointment">
      <wsdl:input message="cancelAppointmentInput" name="cancelAppointment"></wsdl:input>
      <wsdl:output message="cancelAppointmentOutput" name="cancelAppointmentResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Отмена активной записи на прием</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="updateAppointment">
      <wsdl:input message="updateAppointmentInput" name="updateAppointment"></wsdl:input>
      <wsdl:output message="updateAppointmentOutput" name="updateAppointmentResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Изменение параметров активной записи на прием, без изменения цели приема</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="createReferral">
      <wsdl:input message="createReferralInput" name="createReferral"></wsdl:input>
      <wsdl:output message="createReferralOutput" name="createReferralResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Создание направления на прием</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="cancelReferral">
      <wsdl:input message="cancelReferralInput" name="cancelReferral"></wsdl:input>
      <wsdl:output message="cancelReferralOutput" name="cancelReferralResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Отмена направления на прием</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="updateReferral">
      <wsdl:input message="updateReferralInput" name="updateReferral"></wsdl:input>
      <wsdl:output message="updateReferralOutput" name="updateReferralResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Изменение параметров направления</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentHistory">
      <wsdl:input message="getAppointmentHistoryInput" name="getAppointmentHistory"></wsdl:input>
      <wsdl:output message="getAppointmentHistoryOutput" name="getAppointmentHistoryResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getReferralHistory">
      <wsdl:input message="getReferralHistoryInput" name="getReferralHistory"></wsdl:input>
      <wsdl:output message="getReferralHistoryOutput" name="getReferralHistoryResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateAppointmentWithReceptionFact">
      <wsdl:input message="updateAppointmentWithReceptionFactInput" name="updateAppointmentWithReceptionFact"></wsdl:input>
      <wsdl:output message="updateAppointmentWithReceptionFactOutput" name="updateAppointmentWithReceptionFactResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Добавление факта приема и/или клинического события к записи на прием</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="createUrgentAppointment">
      <wsdl:input message="createUrgentAppointmentInput" name="createUrgentAppointment"></wsdl:input>
      <wsdl:output message="createUrgentAppointmentOutput" name="createUrgentAppointmentResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMODutyDoctorAppRefParameters">
      <wsdl:input message="getMODutyDoctorAppRefParametersInput" name="getMODutyDoctorAppRefParameters"></wsdl:input>
      <wsdl:output message="getMODutyDoctorAppRefParametersOutput" name="getMODutyDoctorAppRefParametersResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateMODutyDoctorAppRefParameters">
      <wsdl:input message="updateMODutyDoctorAppRefParametersInput" name="updateMODutyDoctorAppRefParameters"></wsdl:input>
      <wsdl:output message="updateMODutyDoctorAppRefParametersOutput" name="updateMODutyDoctorAppRefParametersResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateSystemParameter">
      <wsdl:input message="updateSystemParameterInput" name="updateSystemParameter"></wsdl:input>
      <wsdl:output message="updateSystemParameterOutput" name="updateSystemParameterResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="searchPatientsByTicket">
      <wsdl:input message="searchPatientsByTicketInput" name="searchPatientsByTicket"></wsdl:input>
      <wsdl:output message="searchPatientsByTicketOutput" name="searchPatientsByTicketResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="searchPatientsByReferral">
      <wsdl:input message="searchPatientsByReferralInput" name="searchPatientsByReferral"></wsdl:input>
      <wsdl:output message="searchPatientsByReferralOutput" name="searchPatientsByReferralResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getCountSlotsForAppointment">
      <wsdl:input message="getCountSlotsForAppointmentInput" name="getCountSlotsForAppointment"></wsdl:input>
      <wsdl:output message="getCountSlotsForAppointmentOutput" name="getCountSlotsForAppointmentResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getCancelReasons">
      <wsdl:input message="getCancelReasonsInput" name="getCancelReasons"></wsdl:input>
      <wsdl:output message="getCancelReasonsOutput" name="getCancelReasonsResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDiagnosesMKB10">
      <wsdl:input message="getDiagnosesMKB10Input" name="getDiagnosesMKB10"></wsdl:input>
      <wsdl:output message="getDiagnosesMKB10Output" name="getDiagnosesMKB10Response"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getQuotaTypes">
      <wsdl:input message="getQuotaTypesInput" name="getQuotaTypes"></wsdl:input>
      <wsdl:output message="getQuotaTypesOutput" name="getQuotaTypesResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getLdpTypes">
      <wsdl:input message="getLdpTypesInput" name="getLdpTypes"></wsdl:input>
      <wsdl:output message="getLdpTypesOutput" name="getLdpTypesResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getReceptionTypes">
      <wsdl:input message="getReceptionTypesInput" name="getReceptionTypes"></wsdl:input>
      <wsdl:output message="getReceptionTypesOutput" name="getReceptionTypesResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMedicalSpecialities">
      <wsdl:input message="getMedicalSpecialitiesInput" name="getMedicalSpecialities"></wsdl:input>
      <wsdl:output message="getMedicalSpecialitiesOutput" name="getMedicalSpecialitiesResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getLpuTypes">
      <wsdl:input message="getLpuTypesInput" name="getLpuTypes"></wsdl:input>
      <wsdl:output message="getLpuTypesOutput" name="getLpuTypesResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDistricts">
      <wsdl:input message="getDistrictsInput" name="getDistricts"></wsdl:input>
      <wsdl:output message="getDistrictsOutput" name="getDistrictsResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getLpuList">
      <wsdl:input message="getLpuListInput" name="getLpuList"></wsdl:input>
      <wsdl:output message="getLpuListOutput" name="getLpuListResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMedicalEmployees">
      <wsdl:input message="getMedicalEmployeesInput" name="getMedicalEmployees"></wsdl:input>
      <wsdl:output message="getMedicalEmployeesOutput" name="getMedicalEmployeesResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getSystemParameters">
      <wsdl:input message="getSystemParametersInput" name="getSystemParameters"></wsdl:input>
      <wsdl:output message="getSystemParametersOutput" name="getSystemParametersResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getWorkCalendar">
      <wsdl:input message="getWorkCalendarInput" name="getWorkCalendar"></wsdl:input>
      <wsdl:output message="getWorkCalendarOutput" name="getWorkCalendarResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getSamplingType">
      <wsdl:input message="getSamplingTypeInput" name="getSamplingType"></wsdl:input>
      <wsdl:output message="getSamplingTypeOutput" name="getSamplingTypeResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
      <xsd:documentation>Предоставления справочника "Профиль взятия"</xsd:documentation>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForLI">
      <wsdl:input message="getDoctorsByPatientForLIInput" name="getDoctorsByPatientForLI"></wsdl:input>
      <wsdl:output message="getDoctorsByPatientForLIOutput" name="getDoctorsByPatientForLIResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForSpeciality">
      <wsdl:input message="getDoctorsByPatientForSpecialityInput" name="getDoctorsByPatientForSpeciality"></wsdl:input>
      <wsdl:output message="getDoctorsByPatientForSpecialityOutput" name="getDoctorsByPatientForSpecialityResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentPlanDaily">
      <wsdl:input message="getAppointmentPlanDailyInput" name="getAppointmentPlanDaily"></wsdl:input>
      <wsdl:output message="getAppointmentPlanDailyOutput" name="getAppointmentPlanDailyResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentPlanByLpu">
      <wsdl:input message="getAppointmentPlanByLpuInput" name="getAppointmentPlanByLpu"></wsdl:input>
      <wsdl:output message="getAppointmentPlanByLpuOutput" name="getAppointmentPlanByLpuResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentShiftByLpu">
      <wsdl:input message="getAppointmentShiftByLpuInput" name="getAppointmentShiftByLpu"></wsdl:input>
      <wsdl:output message="getAppointmentShiftByLpuOutput" name="getAppointmentShiftByLpuResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentShiftDaily">
      <wsdl:input message="getAppointmentShiftDailyInput" name="getAppointmentShiftDaily"></wsdl:input>
      <wsdl:output message="getAppointmentShiftDailyOutput" name="getAppointmentShiftDailyResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForPackage">
      <wsdl:input message="getDoctorsByPatientForPackageInput" name="getDoctorsByPatientForPackage"></wsdl:input>
      <wsdl:output message="getDoctorsByPatientForPackageOutput" name="getDoctorsByPatientForPackageResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForPackageByRoute">
      <wsdl:input message="getDoctorsByPatientForPackageByRouteInput" name="getDoctorsByPatientForPackageByRoute"></wsdl:input>
      <wsdl:output message="getDoctorsByPatientForPackageByRouteOutput" name="getDoctorsByPatientForPackageByRouteResponse"></wsdl:output>
      <wsdl:fault message="AppointmentCodeErrorException" name="appointmentCodeError"></wsdl:fault>
    </wsdl:operation>
  </wsdl:portType>
  <wsdl:binding name="AppointmentServiceV1Binding" type="AppointmentServiceV1PT">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsp:Policy>
      <sp:SupportingTokens>
        <wsp:Policy>
          <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
            <wsp:Policy>
              <sp:NoPassword/>
            </wsp:Policy>
          </sp:UsernameToken>
        </wsp:Policy>
      </sp:SupportingTokens>
    </wsp:Policy>
    <wsdl:operation name="getReferralsByPatient">
      <soap12:operation soapAction="getReferralsByPatient"/>
      <wsdl:input name="getReferralsByPatient">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getReferralsByPatientResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getReferralsByIDs">
      <soap12:operation soapAction="getReferralsByIDs"/>
      <wsdl:input name="getReferralsByIDs">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getReferralsByIDsResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentsByPatient">
      <soap12:operation soapAction="getAppointmentsByPatient"/>
      <wsdl:input name="getAppointmentsByPatient">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentsByPatientResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentsByIDs">
      <soap12:operation soapAction="getAppointmentsByIDs"/>
      <wsdl:input name="getAppointmentsByIDs">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentsByIDsResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentsByResource">
      <soap12:operation soapAction="getAppointmentsByResource"/>
      <wsdl:input name="getAppointmentsByResource">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentsByResourceResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByUser">
      <soap12:operation soapAction="getDoctorsByUser"/>
      <wsdl:input name="getDoctorsByUser">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByUserResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByRegistry">
      <soap12:operation soapAction="getDoctorsByRegistry"/>
      <wsdl:input name="getDoctorsByRegistry">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByRegistryResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByRoute">
      <soap12:operation soapAction="getDoctorsByRoute"/>
      <wsdl:input name="getDoctorsByRoute">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByRouteResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatient">
      <soap12:operation soapAction="getDoctorsByPatient"/>
      <wsdl:input name="getDoctorsByPatient">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByPatientResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForSpeciality">
      <soap12:operation soapAction="getDoctorsByPatientForSpeciality"/>
      <wsdl:input name="getDoctorsByPatientForSpeciality">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByPatientForSpecialityResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByReferral">
      <soap12:operation soapAction="getDoctorsByReferral"/>
      <wsdl:input name="getDoctorsByReferral">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByReferralResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getARSchedule">
      <soap12:operation soapAction="getARSchedule"/>
      <wsdl:input name="getARSchedule">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getARScheduleResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="createAppointment">
      <soap12:operation soapAction="createAppointment"/>
      <wsdl:input name="createAppointment">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="createAppointmentResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="cancelAppointment">
      <soap12:operation soapAction="cancelAppointment"/>
      <wsdl:input name="cancelAppointment">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="cancelAppointmentResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateAppointment">
      <soap12:operation soapAction="updateAppointment"/>
      <wsdl:input name="updateAppointment">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="updateAppointmentResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="createReferral">
      <soap12:operation soapAction="createReferral"/>
      <wsdl:input name="createReferral">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="createReferralResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="cancelReferral">
      <soap12:operation soapAction="cancelReferral"/>
      <wsdl:input name="cancelReferral">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="cancelReferralResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateReferral">
      <soap12:operation soapAction="updateReferral"/>
      <wsdl:input name="updateReferral">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="updateReferralResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentHistory">
      <soap12:operation soapAction="getAppointmentHistory"/>
      <wsdl:input name="getAppointmentHistory">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentHistoryResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getReferralHistory">
      <soap12:operation soapAction="getReferralHistory"/>
      <wsdl:input name="getReferralHistory">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getReferralHistoryResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateAppointmentWithReceptionFact">
      <soap12:operation soapAction="updateAppointmentWithReceptionFact"/>
      <wsdl:input name="updateAppointmentWithReceptionFact">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="updateAppointmentWithReceptionFactResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="createUrgentAppointment">
      <soap12:operation soapAction="createUrgentAppointment"/>
      <wsdl:input name="createUrgentAppointment">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="createUrgentAppointmentResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMODutyDoctorAppRefParameters">
      <soap12:operation soapAction="getMODutyDoctorAppRefParameters"/>
      <wsdl:input name="getMODutyDoctorAppRefParameters">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getMODutyDoctorAppRefParametersResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateMODutyDoctorAppRefParameters">
      <soap12:operation soapAction="updateMODutyDoctorAppRefParameters"/>
      <wsdl:input name="updateMODutyDoctorAppRefParameters">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="updateMODutyDoctorAppRefParametersResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="updateSystemParameter">
      <soap12:operation soapAction="updateSystemParameter"/>
      <wsdl:input name="updateSystemParameter">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="updateSystemParameterResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="searchPatientsByTicket">
      <soap12:operation soapAction="searchPatientsByTicket"/>
      <wsdl:input name="searchPatientsByTicket">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="searchPatientsByTicketResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="searchPatientsByReferral">
      <soap12:operation soapAction="searchPatientsByReferral"/>
      <wsdl:input name="searchPatientsByReferral">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="searchPatientsByReferralResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getCountSlotsForAppointment">
      <soap12:operation soapAction="getCountSlotsForAppointment"/>
      <wsdl:input name="getCountSlotsForAppointment">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getCountSlotsForAppointmentResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getCancelReasons">
      <soap12:operation soapAction="getCancelReasons"/>
      <wsdl:input name="getCancelReasons">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getCancelReasonsResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDiagnosesMKB10">
      <soap12:operation soapAction="getDiagnosesMKB10"/>
      <wsdl:input name="getDiagnosesMKB10">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getDiagnosesMKB10Response">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getQuotaTypes">
      <soap12:operation soapAction="getQuotaTypes"/>
      <wsdl:input name="getQuotaTypes">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getQuotaTypesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getLdpTypes">
      <soap12:operation soapAction="getLdpTypes"/>
      <wsdl:input name="getLdpTypes">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getLdpTypesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getReceptionTypes">
      <soap12:operation soapAction="getReceptionTypes"/>
      <wsdl:input name="getReceptionTypes">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getReceptionTypesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMedicalSpecialities">
      <soap12:operation soapAction="getMedicalSpecialities"/>
      <wsdl:input name="getMedicalSpecialities">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getMedicalSpecialitiesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getLpuTypes">
      <soap12:operation soapAction="getLpuTypes"/>
      <wsdl:input name="getLpuTypes">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getLpuTypesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDistricts">
      <soap12:operation soapAction="getDistricts"/>
      <wsdl:input name="getDistricts">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getDistrictsResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getLpuList">
      <soap12:operation soapAction="getLpuList"/>
      <wsdl:input name="getLpuList">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getLpuListResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getMedicalEmployees">
      <soap12:operation soapAction="getMedicalEmployees"/>
      <wsdl:input name="getMedicalEmployees">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getMedicalEmployeesResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getSystemParameters">
      <soap12:operation soapAction="getSystemParameters"/>
      <wsdl:input name="getSystemParameters">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getSystemParametersResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getWorkCalendar">
      <soap12:operation soapAction="getWorkCalendar"/>
      <wsdl:input name="getWorkCalendar">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getWorkCalendarResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getSamplingType">
      <soap12:operation soapAction="getSamplingType"/>
      <wsdl:input name="getSamplingType">
        <soap12:body use="literal"/>
      </wsdl:input>
      <wsdl:output name="getSamplingTypeResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForLI">
      <soap12:operation soapAction="getDoctorsByPatientForLI"/>
      <wsdl:input name="getDoctorsByPatientForLI">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByPatientForLIResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentPlanDaily">
      <soap12:operation soapAction="getAppointmentPlanDaily"/>
      <wsdl:input name="getAppointmentPlanDaily">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentPlanDailyResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentPlanByLpu">
      <soap12:operation soapAction="getAppointmentPlanByLpu"/>
      <wsdl:input name="getAppointmentPlanByLpu">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentPlanByLpuResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentShiftByLpu">
      <soap12:operation soapAction="getAppointmentShiftByLpu"/>
      <wsdl:input name="getAppointmentShiftByLpu">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentShiftByLpuResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getAppointmentShiftDaily">
      <soap12:operation soapAction="getAppointmentShiftDaily"/>
      <wsdl:input name="getAppointmentShiftDaily">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getAppointmentShiftDailyResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForPackage">
      <soap12:operation soapAction="getDoctorsByPatientForPackage"/>
      <wsdl:input name="getDoctorsByPatientForPackage">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByPatientForPackageResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
    <wsdl:operation name="getDoctorsByPatientForPackageByRoute">
      <soap12:operation soapAction="getDoctorsByPatientForPackageByRoute"/>
      <wsdl:input name="getDoctorsByPatientForPackageByRoute">
        <soap12:body use="literal"/>
        <soap12:header message="UserContextInfo" part="UserContextInfo" use="literal"></soap12:header>
      </wsdl:input>
      <wsdl:output name="getDoctorsByPatientForPackageByRouteResponse">
        <soap12:body use="literal"/>
      </wsdl:output>
      <wsdl:fault name="appointmentCodeError">
        <soap12:fault name="appointmentCodeError"/>
      </wsdl:fault>
    </wsdl:operation>
  </wsdl:binding>
  <wsdl:service name="AppointmentServiceV1">
    <wsdl:port binding="AppointmentServiceV1Binding" name="AppointmentServiceV1PTB">
      <soap12:address location="http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService"/>
    </wsdl:port>
  </wsdl:service>
</wsdl:definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService?xsd=AAAADHAjUCM4P2cuZURELjOXdW4mbtvSHt9xFDZFbblbYHx4ehW.2ANSDryg1rn4w.fkuUmhapcLc_djdX6uNayLSjCWl7Shc6IaOSoBrSICFt0DprNoDtZPxNn_3O6.z1E5M3sst_NKBFJyb2ON2bR0RbL1SQQsuWX9nVMpS0bG_pIBpND.</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias2.gov.ru/appointment/v1/" version="1.0" xmlns:tns="http://emias2.gov.ru/appointment/v1/" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <!--==============================ELEMENTS==============================-->
  <!--Контекст пользователя-->
  <xsd:element name="UserContextInfo">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Контекст пользователя для аутентификации</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Текущий ЛПУ пользователя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="jobId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Исполнение должности сотрудника</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="userRoleId" type="xsd:int">
          <xsd:annotation>
            <xsd:documentation>Текущая роль пользователя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="userRights" type="tns:UserRights">
          <xsd:annotation>
            <xsd:documentation>Набор привилегий пользователя для авторизации</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ДР, под которым работает сотрудник</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentHistory">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentHistory</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="appointmentId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentHistoryResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getAppointmentHistory Response</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="historyRec" type="tns:AppointmentHistoryRec">
          <xsd:annotation>
            <xsd:documentation>Действие над записью (одна строка из истории). Строки выводятся в порядке
							возрастания actionTime</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="versionMismatched" nillable="true" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Признак «Несоответствия версии количеству строк в истории изменений»</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReferralHistory">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="referralId" type="xsd:long"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReferralHistoryResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="historyRec" type="tns:ReferralHistoryRec"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="searchPatientsByTicket">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение searchPatientsByTicket</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="ticketNumber" type="tns:NonEmptyString">
          <xsd:annotation>
            <xsd:documentation>Номер талона (записи)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="searchPatientsByTicketResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение searchPatientsByTicket Response</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="response">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="ticketNumber" type="xsd:string">
                <xsd:annotation>
                  <xsd:documentation>Номер талона (записи) из запроса</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:choice>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="patientId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>Идентификатор пациента</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element minOccurs="0" name="message" type="tns:Message">
                  <xsd:annotation>
                    <xsd:documentation>Ошибка поиска данных</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:choice>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="searchPatientsByReferral">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение searchPatientsByReferral</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="referralNumber" type="tns:NonEmptyString">
          <xsd:annotation>
            <xsd:documentation>Номер направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="searchPatientsByReferralResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение searchPatientsByReferralResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="response">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="referralNumber" type="xsd:string">
                <xsd:annotation>
                  <xsd:documentation>Номер направления из запроса</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:choice>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="patientId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>Идентификатор пациента</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element minOccurs="0" name="message" type="tns:Message">
                  <xsd:annotation>
                    <xsd:documentation>Ошибка поиска данных</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:choice>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReferralsByPatient">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getReferralsByPatient</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="5" name="request" type="tns:ReferralByPatient">
          <xsd:annotation>
            <xsd:documentation>Запрос на поиск данных</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="referralType" type="tns:ReferralType">
          <xsd:annotation>
            <xsd:documentation>Признак «Типы направления»</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="returnPatient" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Вернуть пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReferralsByPatientResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="response" type="tns:ReferralByPatientContainer">
          <xsd:annotation>
            <xsd:documentation>Исходящее сообщение getReferralsByPatient Response</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentsByResource">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentsByResource</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="request">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="resourceId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор ДР</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element maxOccurs="unbounded" name="startDate" type="tns:DatePeriod">
                <xsd:annotation>
                  <xsd:documentation>Дата начала приёма</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
        <xsd:element name="signActive" type="tns:ActiveSign">
          <xsd:annotation>
            <xsd:documentation>Признак «Активные и завершенные записи»</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="returnPatient" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Вернуть пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="skipCalculatedDates" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Не заполнять даты отмены, создания, последнего редактирования</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="skipReferrals" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Не заполнять направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element default="1" minOccurs="0" name="appVersion" type="tns:AppVersion">
          <xsd:annotation>
            <xsd:documentation>Выдавать записи 1 - в полном формате 2 - в сокращённом формате</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentsByResourceResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getAppointmentsByResourceResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="response">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="resourceId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор ДР</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:choice>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="appointment" type="tns:Appointment">
                  <xsd:annotation>
                    <xsd:documentation>Записи к ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="appointment2" type="tns:Appointment2">
                  <xsd:annotation>
                    <xsd:documentation>Записи к ДР (в сокращённом виде)</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element minOccurs="0" name="message" type="tns:Message">
                  <xsd:annotation>
                    <xsd:documentation>Ошибка поиска данных</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:choice>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentsByPatient">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentsByPatient</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="5" name="request">
          <xsd:complexType>
            <xsd:annotation>
              <xsd:documentation>Запрос на поиск данных</xsd:documentation>
            </xsd:annotation>
            <xsd:sequence>
              <xsd:element name="patientId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор пациента</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element maxOccurs="unbounded" minOccurs="0" name="referralId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор направления</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element minOccurs="0" name="startDate" type="tns:DatePeriod">
                <xsd:annotation>
                  <xsd:documentation>Период начала приёма</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element minOccurs="0" name="createDate" type="tns:DatePeriod">
                <xsd:annotation>
                  <xsd:documentation>Период даты создания записи</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
        <xsd:element name="signActive" type="tns:ActiveSign">
          <xsd:annotation>
            <xsd:documentation>Признак «Активные и завершенные записи»</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="returnPatient" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Вернуть пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element default="1" minOccurs="0" name="appVersion" type="tns:AppVersion">
          <xsd:annotation>
            <xsd:documentation>Выдавать записи 1 - в полном формате 2 - в сокращённом формате</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentsByPatientResponse">
    <xsd:annotation>
      <xsd:documentation/>
    </xsd:annotation>
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="5" name="response">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="patientId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор пациента из запроса</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:choice>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="appointment" type="tns:Appointment">
                  <xsd:annotation>
                    <xsd:documentation>Записи пациента</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="appointment2" type="tns:Appointment2">
                  <xsd:annotation>
                    <xsd:documentation>Записи пациента в сокращённом виде</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:choice>
              <xsd:element maxOccurs="unbounded" minOccurs="0" name="message" type="tns:Message">
                <xsd:annotation>
                  <xsd:documentation>Ошибка поиска данных(уведомления)</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentsByIDs">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="appointmentId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="returnPatient" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Вернуть пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element default="1" minOccurs="0" name="appVersion" type="tns:AppVersion">
          <xsd:annotation>
            <xsd:documentation>Выдавать записи 1 - в полном формате 2 - в сокращённом формате</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentsByIDsResponse">
    <xsd:complexType>
      <xsd:sequence maxOccurs="unbounded" minOccurs="0">
        <xsd:element name="response" type="tns:AppointmentsByIDsResponse"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="AppointmentsByIDsResponse">
    <xsd:choice maxOccurs="unbounded">
      <xsd:sequence>
        <xsd:element name="appointment" type="tns:Appointment"/>
      </xsd:sequence>
      <xsd:sequence>
        <xsd:element name="appointment2" type="tns:Appointment2"/>
      </xsd:sequence>
      <xsd:sequence>
        <xsd:element name="appointmentId" type="xsd:long"/>
        <xsd:element name="message" type="tns:Message"/>
      </xsd:sequence>
    </xsd:choice>
  </xsd:complexType>
  <xsd:element name="getReferralsByIDs">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" name="referralId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="returnPatient" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Вернуть пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReferralsByIDsResponse">
    <xsd:complexType>
      <xsd:sequence maxOccurs="unbounded" minOccurs="0">
        <xsd:element name="response" type="tns:ReferralsByIDsResponse"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByUser">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByUser</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="arTypeId">
          <xsd:simpleType>
            <xsd:restriction base="xsd:long">
              <xsd:enumeration value="10"/>
              <xsd:enumeration value="20"/>
              <xsd:enumeration value="30"/>
            </xsd:restriction>
          </xsd:simpleType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByUserResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByUserResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatient">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByPatient</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="patientId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByPatientResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByRegistry">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByRegistry</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="arTypeId">
          <xsd:simpleType>
            <xsd:restriction base="xsd:long">
              <xsd:enumeration value="10"/>
              <xsd:enumeration value="20"/>
            </xsd:restriction>
          </xsd:simpleType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByRegistryResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByRegistry Response</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByRoute">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByRoute</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="arTypeId">
          <xsd:simpleType>
            <xsd:restriction base="xsd:long">
              <xsd:enumeration value="10"/>
              <xsd:enumeration value="20"/>
            </xsd:restriction>
          </xsd:simpleType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByRouteResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByRouteResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getSystemParameters">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getSystemParameters</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getSystemParametersResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getSystemParametersResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="systemParameter" type="tns:SystemParameter">
          <xsd:annotation>
            <xsd:documentation>Общесистемный параметр</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateSystemParameter">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение updateSystemParameter</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="changeSystemParameter">
          <xsd:complexType>
            <xsd:annotation>
              <xsd:documentation>Параметр, который необходимо изменить</xsd:documentation>
            </xsd:annotation>
            <xsd:sequence>
              <xsd:element name="paramTypeId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор типа параметра</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element name="paramValue" type="tns:NonEmptyString">
                <xsd:annotation>
                  <xsd:documentation>Значение параметра</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element minOccurs="0" name="paramUnit" type="tns:NonEmptyString">
                <xsd:annotation>
                  <xsd:documentation>Единицы измерения</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateSystemParameterResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение updateSystemParameterResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="systemParameter" type="tns:SystemParameter">
          <xsd:annotation>
            <xsd:documentation>Измененный общесистемный параметр</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForPackage">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByPatient ForPackage</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="patientId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:sequence>
          <xsd:element name="packageParams">
            <xsd:annotation>
              <xsd:documentation>Пареметры поиска из пакета назначений</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="specialityId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД специальности</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="ldpId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД вида ЛДП</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:sequence>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForPackageResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByPatient ForPackage</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:sequence maxOccurs="unbounded" minOccurs="0">
          <xsd:element name="availableResourceBySpeciality">
            <xsd:annotation>
              <xsd:documentation>Список ДР для специальности</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="specialityId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД Специальности</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="isAvailable" type="xsd:boolean">
                  <xsd:annotation>
                    <xsd:documentation>Признак наличия ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
                  <xsd:annotation>
                    <xsd:documentation>ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:sequence>
        <xsd:sequence maxOccurs="unbounded" minOccurs="0">
          <xsd:element name="availableResourceByLdp">
            <xsd:annotation>
              <xsd:documentation>Список ДР для ЛДП</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="ldpId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД вида ЛДП</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="isAvailable" type="xsd:boolean">
                  <xsd:annotation>
                    <xsd:documentation>Признак наличия ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
                  <xsd:annotation>
                    <xsd:documentation>ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:sequence>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForPackageByRoute">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByPatient ForPackageByRoute</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="patientId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:sequence>
          <xsd:element name="packageParams">
            <xsd:annotation>
              <xsd:documentation>Пареметры поиска из пакета назначений</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="specialityId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД специальности</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="ldpId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД вида ЛДП</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:sequence>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForPackageByRouteResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByPatient ForPackageByRoute</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:sequence maxOccurs="unbounded" minOccurs="0">
          <xsd:element name="availableResourceBySpeciality">
            <xsd:annotation>
              <xsd:documentation>Список ДР для специальности</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="specialityId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД Специальности</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="isAvailable" type="xsd:boolean">
                  <xsd:annotation>
                    <xsd:documentation>Признак наличия ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
                  <xsd:annotation>
                    <xsd:documentation>ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:sequence>
        <xsd:sequence maxOccurs="unbounded" minOccurs="0">
          <xsd:element name="availableResourceByLdp">
            <xsd:annotation>
              <xsd:documentation>Список ДР для ЛДП</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="ldpId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>ИД вида ЛДП</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="isAvailable" type="xsd:boolean">
                  <xsd:annotation>
                    <xsd:documentation>Признак наличия ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
                  <xsd:annotation>
                    <xsd:documentation>ДР</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:sequence>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getMODutyDoctorAppRefParameters">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getMODutyDoctorAppRefParameters</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор филиала МО</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getMODutyDoctorAppRefParametersResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getMODutyDoctorAppRefParametersResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="2" minOccurs="0" name="lpuParameter" type="tns:LpuParameter">
          <xsd:annotation>
            <xsd:documentation>Параметр ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="2" minOccurs="0" name="systemParameter" type="tns:SystemParameter">
          <xsd:annotation>
            <xsd:documentation>Общесистемный параметр</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateMODutyDoctorAppRefParameters">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение updateMODutyDoctorAppRefParameters</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор филиала МО</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="2" name="changeLpuParameter">
          <xsd:annotation>
            <xsd:documentation>Параметр, который необходимо изменить</xsd:documentation>
          </xsd:annotation>
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="paramTypeId" type="xsd:long">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор типа параметра</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element name="paramValue" type="tns:NonEmptyString">
                <xsd:annotation>
                  <xsd:documentation>Значение параметра</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element minOccurs="0" name="paramUnit" type="tns:NonEmptyString">
                <xsd:annotation>
                  <xsd:documentation>Единицы измерения</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateMODutyDoctorAppRefParametersResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>ИсходящеесообщениеupdateMODutyDoctorAppRefParametersResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="2" minOccurs="0" name="lpuParameter" type="tns:LpuParameter">
          <xsd:annotation>
            <xsd:documentation>Результат</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getWorkCalendar">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getWorkCalendar</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="year" type="xsd:int">
          <xsd:annotation>
            <xsd:documentation>Год</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getWorkCalendarResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getWorkCalendarResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="calendar" type="tns:Calendar">
          <xsd:annotation>
            <xsd:documentation>Дни производственного календаря</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getCountSlotsForAppointment">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getCountSlotsForAppointment</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор доступного ресурса</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="dateFrom" type="xsd:date">
          <xsd:annotation>
            <xsd:documentation>Дата начала периода</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getCountSlotsForAppointmentResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящеесообщение getCountSlotsForAppointmentResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="dailySlotsKit" type="tns:DailyARSlotsKit">
          <xsd:annotation>
            <xsd:documentation>Количество слотов в разбивке по дням (на каждый день диапазона выборки своя
							строка)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByReferral">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByReferral</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="referralId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="appointmentId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи (в сценарии переноса записи)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByReferralResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByReferralResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getLdpTypes">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getLdpTypes</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getLdpTypesResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getLdpTypesResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="ldpType" type="tns:LdpType">
          <xsd:annotation>
            <xsd:documentation>Вид ЛДП</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getARSchedule">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getARSchedule</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:choice minOccurs="0">
          <xsd:element name="patientId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор пациента</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="referralId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор направления</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="appointmentId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:choice>
        <xsd:element minOccurs="0" name="forceBusySlots" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Игнорировать занятость слота</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="period" type="tns:DatePeriod">
          <xsd:annotation>
            <xsd:documentation>Период предоставления расписания</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getARScheduleResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getARScheduleResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="spamSpec" type="tns:SpamError">
          <xsd:annotation>
            <xsd:documentation>Ошибка антиспам-проверки №1</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="spamLpu" type="tns:SpamError">
          <xsd:annotation>
            <xsd:documentation>Ошибка антиспам-проверки №2</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="spamBM" type="tns:SpamError">
          <xsd:annotation>
            <xsd:documentation>Ошибка антиспама записи на ЛИ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="slots" type="tns:AppointmentSlot">
          <xsd:annotation>
            <xsd:documentation>Слоты расписания</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="1" minOccurs="0" name="horizon" type="xsd:date">
          <xsd:annotation>
            <xsd:documentation>Последний день горизонта записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="createAppointment">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение createAppointment</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="patientId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="complexResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор кабинета с оборудованием</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="appointmentTime" type="tns:TimeInterval">
          <xsd:annotation>
            <xsd:documentation>Дата и время записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:choice>
          <xsd:element name="referralId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>ИД направления</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="receptionId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор вида приема</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="ldpId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор вида ЛДП</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="samplingTypeId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор профиля взятия БМ</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:choice>
        <xsd:element minOccurs="0" name="comment" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Комментарий</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="forceBusySlots" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Признак игнорирования занятости слота</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="createAppointmentResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение createAppointmentResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:choice>
        <xsd:sequence>
          <xsd:element name="id" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="number" type="xsd:string">
            <xsd:annotation>
              <xsd:documentation>Номер записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
        <xsd:sequence>
          <xsd:element maxOccurs="4" name="message" type="tns:Message">
            <xsd:annotation>
              <xsd:documentation>Уведомления о недоступности записи на указанный период</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element maxOccurs="unbounded" minOccurs="0" name="blockingAppointment" type="tns:Appointment">
            <xsd:annotation>
              <xsd:documentation>Блокирующие записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:choice>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="cancelAppointment">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение cancelAppointment</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="appointmentId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="cancelReasonId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор причины отмены</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="cancelAppointmentResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение cancelAppointmentResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="result" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Успешность выполнения метода</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateAppointment">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение updateAppointment</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="appointmentId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="complexResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор кабинета с оборудованием</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="appointmentTime" type="tns:TimeInterval">
          <xsd:annotation>
            <xsd:documentation>Дата и времязаписи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="receptionId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор вида приема</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="updateReasonId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор причины изменения</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="comment" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Комментарий</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="forceBusySlots" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Признак игнорирования занятости слота</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateAppointmentResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение updateAppointmentResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:choice>
        <xsd:sequence>
          <xsd:element minOccurs="0" name="id" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element minOccurs="0" name="number" type="xsd:string">
            <xsd:annotation>
              <xsd:documentation>Номер записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
        <xsd:sequence>
          <xsd:element maxOccurs="4" name="message" type="tns:Message">
            <xsd:annotation>
              <xsd:documentation>Уведомления о недоступности записи на указанный период</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element maxOccurs="unbounded" minOccurs="0" name="blockingAppointment" type="tns:Appointment">
            <xsd:annotation>
              <xsd:documentation>Блокирующие записи</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:choice>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="createReferral">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение createReferral</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:choice>
          <xsd:element name="toDoctor">
            <xsd:annotation>
              <xsd:documentation>Направление к специалисту</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="specialityId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>Идентификатор специальности</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="receptionId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>Идентификатор вида приема</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
          <xsd:element name="toLdp">
            <xsd:annotation>
              <xsd:documentation>Направление на ЛДП</xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:sequence>
                <xsd:element name="ldpId" type="xsd:long">
                  <xsd:annotation>
                    <xsd:documentation>Идентификатор вида ЛДП</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="proceduresNumber" type="tns:Count9999NotNullable">
                  <xsd:annotation>
                    <xsd:documentation>Количество процедур</xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:sequence>
            </xsd:complexType>
          </xsd:element>
        </xsd:choice>
        <xsd:element name="patientId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="diagnosisMKB10Id" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор диагноза по МКБ10</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="receiveLpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор принимающего ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="validityPeriod" type="tns:DatePeriod">
          <xsd:annotation>
            <xsd:documentation>Период действия направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="assignmentId" type="tns:NonEmptyString">
          <xsd:annotation>
            <xsd:documentation>ИД Назначения. Может отсутствовать, если заполняется с бумажного носителя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="protocolId" type="tns:NonEmptyString">
          <xsd:annotation>
            <xsd:documentation>ИД Протокола. Может отсутствовать, если заполняется с бумажного носителя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="instrumental" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Признак инструментальной диагностики</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="comment" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Комментарий (обоснование)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="receptionFactId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД факта приема, в рамках которого создается направление</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="careEventId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД Клинического события</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="paperReferralDesc" type="tns:PaperReferralDesc">
          <xsd:annotation>
            <xsd:documentation>Информация из бумажного направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="createReferralResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение createReferralResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="id" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="number" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Номер направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="cancelReferral">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение cancelReferral</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="referralId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="cancelReasonId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор причины отмены</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="cancelReferralResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение cancelReferralResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="result" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Успешность выполнения метода</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateReferral">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение updateReferral</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="referralId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:choice minOccurs="0">
          <xsd:element name="proceduresNumber">
            <xsd:annotation>
              <xsd:documentation>Количество процедур</xsd:documentation>
            </xsd:annotation>
            <xsd:simpleType>
              <xsd:restriction base="xsd:int">
                <xsd:minInclusive value="1"/>
              </xsd:restriction>
            </xsd:simpleType>
          </xsd:element>
          <xsd:element name="receptionId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор вида приема</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:choice>
        <xsd:element minOccurs="0" name="diagnosisMKB10Id" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор диагноза по МКБ10</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="receiveLpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор принимающего ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="validityPeriod" type="tns:DatePeriod">
          <xsd:annotation>
            <xsd:documentation>Период действия направления</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="comment" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Комментарий (обоснование)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateReferralResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение updateReferralResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="result" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Успешность выполнения метода</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateAppointmentWithReceptionFact">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение updateAppointmentWithReceptionFact</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="appointmentId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:choice minOccurs="0">
          <xsd:element name="receptionFactId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор факта приема</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="careEventId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор Клинического события</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:choice>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="updateAppointmentWithReceptionFactResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение updateAppointmentWithReceptionFactResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="result" type="xsd:boolean">
          <xsd:annotation>
            <xsd:documentation>Успешность выполнения метода</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="createUrgentAppointment">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение createUrgentAppointment</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="patientId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="availableResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор ДР</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="complexResourceId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор кабинета с оборудованием</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:choice>
          <xsd:element name="receptionTypeId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор вида приема</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="ldpId" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Идентификатор вида ЛДП</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:choice>
        <xsd:element minOccurs="0" name="comment" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Комментарий</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="createUrgentAppointmentResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение createUrgentAppointmentResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="id" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>Идентификатор записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="number" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Номер записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getCancelReasons">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getCancelReasons</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getCancelReasonsResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getCancelReasonsResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="cancelReason" type="tns:CancelReason">
          <xsd:annotation>
            <xsd:documentation>Причина отмены записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDiagnosesMKB10">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDiagnosesMKB10</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDiagnosesMKB10Response">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDiagnosesMKB10Response</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="diagnosisMKB10" type="tns:DiagnosisMKB10">
          <xsd:annotation>
            <xsd:documentation>Диагноз по МКБ-10</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getQuotaTypes">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getQuotaTypes</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getQuotaTypesResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getQuotaTypesResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="quotaType" type="tns:QuotaType">
          <xsd:annotation>
            <xsd:documentation>Вид квоты</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReceptionTypes">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getReceptionTypes</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getReceptionTypesResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getReceptionTypesResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="receptionType" type="tns:ReceptionType">
          <xsd:annotation>
            <xsd:documentation>Вид приема</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getMedicalSpecialities">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getMedicalSpecialities</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getMedicalSpecialitiesResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getMedicalSpecialitiesResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="medicalSpeciality" type="tns:MedicalSpeciality">
          <xsd:annotation>
            <xsd:documentation>Специальность</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getLpuTypes">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getLpuTypes</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence></xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getLpuTypesResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getLpuTypesResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="lpuType" type="tns:LpuType">
          <xsd:annotation>
            <xsd:documentation>Вид ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDistricts">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDistricts</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence></xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDistrictsResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDistrictsResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="district" type="tns:District">
          <xsd:annotation>
            <xsd:documentation>Административный округ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getLpuList">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getLpuList</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence></xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getLpuListResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getLpuListResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="lpu" type="tns:Lpu">
          <xsd:annotation>
            <xsd:documentation>ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getMedicalEmployees">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getMedicalEmployees</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:choice>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" name="lpuId" type="xsd:long">
              <xsd:annotation>
                <xsd:documentation>ИД ЛПУ</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="fio" type="tns:NonEmptyString">
              <xsd:annotation>
                <xsd:documentation>Фамилия или Имя или Отчество (поиск по вхождению)</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
          <xsd:sequence>
            <xsd:element maxOccurs="unbounded" name="mejiId" type="xsd:long">
              <xsd:annotation>
                <xsd:documentation>ИД Исполнения должности</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:choice>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getMedicalEmployeesResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getMedicalEmployeesResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="medicalEmployee" type="tns:MedicalEmployee">
          <xsd:annotation>
            <xsd:documentation>Медицинский работник</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <!--==============================SIMPLE TYPES==============================-->
  <xsd:simpleType name="ReferralState">
    <xsd:restriction base="xsd:long">
      <xsd:enumeration value="0"/>
      <xsd:enumeration value="1"/>
      <xsd:enumeration value="2"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="ReferralType">
    <xsd:restriction base="xsd:int">
      <xsd:minInclusive value="1"/>
      <xsd:maxInclusive value="15"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="ActiveSign">
    <xsd:restriction base="xsd:int">
      <xsd:minInclusive value="1"/>
      <xsd:maxInclusive value="15"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="AppVersion">
    <xsd:restriction base="xsd:int">
      <xsd:minInclusive value="1"/>
      <xsd:maxInclusive value="2"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="Sex">
    <xsd:annotation>
      <xsd:documentation>Пол</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="male"/>
      <xsd:enumeration value="female"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType final="restriction" name="AppointmentTypeEnum">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="RECEPTION"/>
      <xsd:enumeration value="LDP"/>
      <xsd:enumeration value="BM"/>
      <xsd:enumeration value="IR"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType final="restriction" name="ReferralTypeEnum">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="REF_TO_DOCTOR"/>
      <xsd:enumeration value="REF_TO_LDP"/>
      <xsd:enumeration value="REF_TO_BM"/>
      <xsd:enumeration value="REF_TO_IR"/>
    </xsd:restriction>
  </xsd:simpleType>
  <!--==============================COMPLEX TYPES==============================-->
  <xsd:simpleType name="NonEmptyString">
    <xsd:restriction base="xsd:string">
      <xsd:minLength value="1"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="Appointment">
    <xsd:complexContent>
      <xsd:extension base="tns:AppointmentDesc">
        <xsd:sequence>
          <xsd:element minOccurs="0" name="referral" type="tns:Referral">
            <xsd:annotation>
              <xsd:documentation>Описание направления на основании которого была создана запись</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="AppointmentDesc">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patient" type="tns:Patient">
        <xsd:annotation>
          <xsd:documentation>Описание пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="number" nillable="true" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Номер записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentTime" type="tns:TimeInterval">
        <xsd:annotation>
          <xsd:documentation>Дата и время приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:AppointmentTypeEnum">
        <xsd:annotation>
          <xsd:documentation>RECEPTON - запись на приём к специалисту LDP - запись на процедуру BM - запись на
						лабораторное исследование</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actual" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "активная"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="completed" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "завершённая"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="overdue" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "просроченная"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="canceled" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "отменённая"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="comments" type="tns:String2000">
        <xsd:annotation>
          <xsd:documentation>Комментарий</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:AppointmentStatus">
        <xsd:annotation>
          <xsd:documentation>Статус записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="cancelInfo" type="tns:CancelInfo">
        <xsd:annotation>
          <xsd:documentation>Информация об отмене записи. Заполняется только если статус записи 20
						(отменена)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="availableResource" type="tns:AvailableResourceDesc">
        <xsd:annotation>
          <xsd:documentation>Описание доступного ресурса, к которому оформлена запись</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="complexResource" type="tns:ComplexResourceDesc">
        <xsd:annotation>
          <xsd:documentation>Описание комплексного ресурса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="receptionFact" type="tns:ReceptionFact">
        <xsd:annotation>
          <xsd:documentation>Информация о факте приёма по данной записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="careEventId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор клинического события, который был создан по данной записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="queueTicket" type="tns:QueueTicketDesc">
        <xsd:annotation>
          <xsd:documentation>Описание талона в живую очередь</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="appointmentToDoctor" type="tns:ToDoctor">
        <xsd:annotation>
          <xsd:documentation>Описание записи к специальности (заполняется, если тип записи RECEPTION)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="appointmentToLDP" type="tns:ToLDP">
        <xsd:annotation>
          <xsd:documentation>Описание записи на ЛДП (заполняется, если тип записи LDP)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="appointmentToBM" type="tns:SamplingType">
        <xsd:annotation>
          <xsd:documentation>Описание записи на ЛИ (заполняется для типа записи BM)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="appointmentType" type="tns:AppointmentType">
        <xsd:annotation>
          <xsd:documentation>Тип записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentAuthorInfo" nillable="true" type="tns:EventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события по созданию записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="createTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата создания записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentLastChangeInfo" nillable="true" type="tns:EventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события последнего изменения записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="lastChangeTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата последнего изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="shiftCount" type="tns:NonNegativeInt">
        <xsd:annotation>
          <xsd:documentation>Количество осуществленных переносов записи, выполненных медработником</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="shiftAvailable" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Возможность переноса записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Appointment2">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patient" type="tns:Patient">
        <xsd:annotation>
          <xsd:documentation>Описание пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="number" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Номер записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentTime" type="tns:TimeInterval">
        <xsd:annotation>
          <xsd:documentation>Дата и время приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:AppointmentTypeEnum">
        <xsd:annotation>
          <xsd:documentation>RECEPTON - запись на приём к специалисту LDP - запись на процедуру BM - запись на
						лабораторное исследование</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="complexResourceRoomNumber" type="tns:String10">
        <xsd:annotation>
          <xsd:documentation>Номер кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="complexResourceLpuShortName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Краткое наименование ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="receptionFactId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД факта приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="careEventId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД клинического события</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="receptionType" type="tns:ReceptionType">
        <xsd:annotation>
          <xsd:documentation>Вид приёма (заполняется, если Вид записи = RECEPTION)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="referralDiagnosis" type="tns:DiagnosisMKB10">
        <xsd:annotation>
          <xsd:documentation>Направительный диагноз</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentType" type="tns:AppointmentType">
        <xsd:annotation>
          <xsd:documentation>Тип записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Referral">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификаторнаправления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patient" type="tns:Patient">
        <xsd:annotation>
          <xsd:documentation>Описание пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="number" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Номер направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="validityPeriod" type="tns:DatePeriod">
        <xsd:annotation>
          <xsd:documentation>Период действия направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="comment" type="tns:String2000">
        <xsd:annotation>
          <xsd:documentation>Комментарий</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:ReferralTypeEnum">
        <xsd:annotation>
          <xsd:documentation>REF_TO_DOCTOR - направление на приём к специалисту, REF_TO_LDP - направление на
						процедуру</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="cancelInfo" type="tns:CancelInfo">
        <xsd:annotation>
          <xsd:documentation>Информация об отмене записи. Заполняется только если IS_INVALID = TRUE</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpu" type="tns:Lpu">
        <xsd:annotation>
          <xsd:documentation>Описание ЛПУ в которое направлен пациент</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="availableResource" type="tns:AvailableResourceDesc">
        <xsd:annotation>
          <xsd:documentation>Описание доступного ресурса, к которому оформлено направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="diagnosis" type="tns:DiagnosisMKB10">
        <xsd:annotation>
          <xsd:documentation>Диагноз (направительный)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="issuedLpu" type="tns:Lpu">
        <xsd:annotation>
          <xsd:documentation>Описание ЛПУ в котором было создано направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="issuedAvailableResource" type="tns:AvailableResourceDesc">
        <xsd:annotation>
          <xsd:documentation>Описание доступного ресурса, который оформил направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="issuedDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата выдачи направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="senderMedicalEmployee" type="tns:MedicalEmployee">
        <xsd:annotation>
          <xsd:documentation>Медработник выдавший направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="referralToDoctor" type="tns:ToDoctor">
        <xsd:annotation>
          <xsd:documentation>Описание направления к специальности (заполняется, если тип направления REF_TO
						_DOCTOR)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="referralToLdp" type="tns:ToLDP">
        <xsd:annotation>
          <xsd:documentation>Описание направления на ЛДП (заполняется, если тип направления REF_TO_LDP)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="assignmentId" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="receptionFactId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор факта приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="careEventId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор клинического события</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="referralAuthorInfo" type="tns:EventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события создания направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="createTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата создания направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="referralLastChangeInfo" type="tns:EventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события последнего изменения направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="lastChangeTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата последнего изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="isActive" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак «Активные направления»</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="isCompleted" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак «Реализованные направления»</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="isFinished" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак «Завершенные направления»</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="isOverdue" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак «Просроченные направления»</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="isCanceled" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак «Отмененные направления»</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="invalidStructure" type="tns:InvalidStructure">
        <xsd:annotation>
          <xsd:documentation>Информация о невалидной структуре направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MedicalEmployee">
    <xsd:sequence>
      <xsd:element name="mejiId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор исполнения должности сотрудника</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="employeeId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор сотрудника</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lastName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Фамилия</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="firstName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Имя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="secondName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Отчество</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="speciality" type="tns:MedicalSpeciality">
        <xsd:annotation>
          <xsd:documentation>Специальность сотрудника</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpu" type="tns:Lpu">
        <xsd:annotation>
          <xsd:documentation>Филиала МО, к которому относится исполнение должности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="department" type="tns:Department">
        <xsd:annotation>
          <xsd:documentation>Подразделение филиала МО, к которому относится исполнение должности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="isRelevance" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность исполнения должности сотрудника</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Department">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:DepartmentType">
        <xsd:annotation>
          <xsd:documentation>Вид</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpuId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор филиала МО, к которому относится подразделение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="DepartmentType">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentType">
    <xsd:sequence>
      <xsd:element name="code" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Код типа записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String225">
        <xsd:annotation>
          <xsd:documentation>Наименование типа записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AvailableResourceDesc">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String300">
        <xsd:annotation>
          <xsd:documentation>Название ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="mainDoctor" type="tns:MedicalEmployee">
        <xsd:annotation>
          <xsd:documentation>Основной медработник в ДР только для ДР типа 10 (Специалист)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="archived" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак архивности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ComplexResourceDesc">
    <xsd:annotation>
      <xsd:documentation>Описывает кабинет с оборудованием</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор кабинета с оборудованием</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String300">
        <xsd:annotation>
          <xsd:documentation>Название кабинета с оборудованием</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="room" nillable="true" type="tns:Room">
        <xsd:annotation>
          <xsd:documentation>Описание кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="archived" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак архивности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Lpu">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="shortName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Краткое название ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpuTypeId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Вид ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="district" type="tns:District">
        <xsd:annotation>
          <xsd:documentation>Административный округ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="address" type="tns:Address">
        <xsd:annotation>
          <xsd:documentation>Адрес</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="CancelReason">
    <xsd:sequence>
      <xsd:element name="code" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Кодпричины отмены</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название причины отмены</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="parentId" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Идентификатор "родителя"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="LdpType">
    <xsd:sequence>
      <xsd:element name="code" nillable="true" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Идентификатор вида ЛДП</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="ldpCode">
        <xsd:annotation>
          <xsd:documentation>Код ЛДП</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="6"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="name" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="valueMR" nillable="true" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation>Условная единица трудоемкости медсестры</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="valueVR" nillable="true" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation>Условная единица трудоемкости врача</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="li" nillable="true" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак ЛИ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="procedure" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак процедуры</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="examination" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="requestCriticalResearch" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак ДИ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="withoutReferral" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "Разрешено без направления"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" nillable="true" type="xsd:boolean"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ToLDP">
    <xsd:sequence>
      <xsd:element name="ldpType" type="tns:LdpType">
        <xsd:annotation>
          <xsd:documentation>Описание вида ЛДП</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="countProcedures" type="tns:Count9999NotNullable">
        <xsd:annotation>
          <xsd:documentation>Количество назначенных Процедур (Только для направления)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="countActualAppointments" type="tns:Count9999Nullable">
        <xsd:annotation>
          <xsd:documentation>Количество активных записей по направлению</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="countClosedAppointments" type="tns:Count9999Nullable">
        <xsd:annotation>
          <xsd:documentation>Количество закрытых записей по направлению</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ToDoctor">
    <xsd:sequence>
      <xsd:element name="speciality" nillable="true" type="tns:MedicalSpeciality">
        <xsd:annotation>
          <xsd:documentation>Описание специальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="receptionType" nillable="true" type="tns:ReceptionType">
        <xsd:annotation>
          <xsd:documentation>Описание вида приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MedicalSpeciality">
    <xsd:annotation>
      <xsd:documentation>Специальность</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="code" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор специальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="alias" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Алиас</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="male" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Мужская</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="female" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Женская</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="primary" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Специальность первичного звена</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" nillable="true" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="isChanged" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак измененной специализации только для Специализации ДР типа 10 (Специалист)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReceptionType">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор вида приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Наименование вида приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="categoryCode" nillable="true">
        <xsd:annotation>
          <xsd:documentation>Код краткого наименования вида приема</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="4"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="categoryName" nillable="true" type="tns:String225">
        <xsd:annotation>
          <xsd:documentation>Краткое наименование вида приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="valueMS" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation>Условная единица трудоемкости медсестры</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="valueVR" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation>Условная единица трудоемкости врача</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="home" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Амбулаторный</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="primary" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Первичный</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="repeat" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Повторный</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="specialityCode" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Код специальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReceptionFact">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор приема осмотра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patientId" nillable="true" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="startTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Время началаприема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="endTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Время окончания приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="deferringTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время последнего откладывания</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="resumeTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время последнего возобновления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="greatestDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время последнего редактирования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="duration" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Продолжительность приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:ReceptionFactStatus">
        <xsd:annotation>
          <xsd:documentation>Статус приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="canceledFact" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак отмены приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="availableResourceId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Принимающий врач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="complexResource" nillable="true" type="tns:ComplexResourceDesc">
        <xsd:annotation>
          <xsd:documentation>Описание места приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="receptionId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД вида приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="ldpId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД вида ЛДП</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="protocol" type="tns:Protocol">
        <xsd:annotation>
          <xsd:documentation>Описание протокола</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Protocol">
    <xsd:sequence>
      <xsd:element name="id" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="statusCode" nillable="true">
        <xsd:annotation>
          <xsd:documentation>Код статуса</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="4"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="statusName" nillable="true" type="tns:String225">
        <xsd:annotation>
          <xsd:documentation>Наименование статуса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="diagnosis" nillable="true" type="tns:DiagnosisMKB10">
        <xsd:annotation>
          <xsd:documentation>Диагноз (фактический)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="DiagnosisMKB10">
    <xsd:annotation>
      <xsd:documentation>Диагноз МКБ-10</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="code" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Идентификатор диагноза</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="diseaseCode">
        <xsd:annotation>
          <xsd:documentation>Код диагноза</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="12"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="name">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="1000"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element minOccurs="0" name="sex" type="tns:Sex">
        <xsd:annotation>
          <xsd:documentation>FEMALE, MALE</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="mkbClass" type="tns:String2">
        <xsd:annotation>
          <xsd:documentation>Класс</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="mkbSubClass" type="tns:String2">
        <xsd:annotation>
          <xsd:documentation>Подкласс</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="mkbGroup" type="tns:String3">
        <xsd:annotation>
          <xsd:documentation>Группа</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="parentId" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Идентификатор "родителя"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReceptionFactStatus">
    <xsd:sequence>
      <xsd:element name="code" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Идентификатор статуса приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String225">
        <xsd:annotation>
          <xsd:documentation>Наименование статуса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="priority" type="tns:String3">
        <xsd:annotation>
          <xsd:documentation>Приоритет статуса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Patient">
    <xsd:sequence>
      <xsd:element name="id" nillable="true" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="lastName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Фамилия</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="firstName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Имя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="secondName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Отчество</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="birthDay" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>Дата рождения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="sex" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Пол (true - мужчина)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="omsNumber">
        <xsd:annotation>
          <xsd:documentation>Номер полиса ОМС</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="255"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element minOccurs="0" name="errorInfo" type="tns:Message">
        <xsd:annotation>
          <xsd:documentation>Информация об ошибке, связанной с заполнением полей данного пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentStatus">
    <xsd:sequence>
      <xsd:element name="code" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Идентификатор статуса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Наименование статуса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentHistoryContainer">
    <xsd:sequence>
      <xsd:element name="appointmentId" type="xsd:long"/>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="appointmentHistoryLog" type="tns:AppointmentHistoryRec"/>
      <xsd:element minOccurs="0" name="dataFault" type="tns:DataFaultTextInfo"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentHistoryRec">
    <xsd:annotation>
      <xsd:documentation>Журнал истории изменений записи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="appointmentId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="rejectedAppointmentId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор предыдущей записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actionTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата события</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actionType" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Вид события: CREATION – создание, CANCEL – отмена, CHANGE – изменение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="eventInitiator" type="tns:EventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="changeParameters" type="tns:ChangeParameter">
        <xsd:annotation>
          <xsd:documentation>Основные параметры сущности, заполняемые при создании / изменении / отмене</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReferralHistoryRec">
    <xsd:annotation>
      <xsd:documentation>Журнал истории изменений записи</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="referralId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actionTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата события</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actionType" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Вид события: CREATION – создание, CANCEL – отмена, CHANGE – изменение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="eventInitiator" type="tns:EventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="changeParameters" type="tns:ChangeParameter">
        <xsd:annotation>
          <xsd:documentation>Основныe параметры сущности, заполняемые при создании/изменении/отмене</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="EventInitiator">
    <xsd:choice>
      <xsd:element name="employeeEventInitiator" type="tns:EmployeeEventInitiator">
        <xsd:annotation>
          <xsd:documentation>Инициатор события врач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:sequence>
        <xsd:element name="patientEventInitiator" type="tns:PatientEventInitiator">
          <xsd:annotation>
            <xsd:documentation>Инициатор события пациент</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="externalSystem">
          <xsd:annotation>
            <xsd:documentation>Информация о внешней системе (только если инициатор события пациент)</xsd:documentation>
          </xsd:annotation>
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="code" nillable="true" type="tns:NonNegativeInt">
                <xsd:annotation>
                  <xsd:documentation>Код внешней системы пользователя</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element name="desc" type="tns:String50">
                <xsd:annotation>
                  <xsd:documentation>Обозначение системы пользователя</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
              <xsd:element name="type" nillable="true" type="tns:NonNegativeInt">
                <xsd:annotation>
                  <xsd:documentation>Идентификатор типа инициатора события</xsd:documentation>
                </xsd:annotation>
              </xsd:element>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:choice>
  </xsd:complexType>
  <xsd:complexType name="EmployeeEventInitiator">
    <xsd:sequence>
      <xsd:element name="accountId" nillable="true" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД учетной записи пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="userName" nillable="true" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Идентификатор системы и логин пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="userRoleId" nillable="true">
        <xsd:annotation>
          <xsd:documentation>Идентификатор роли, под которой работает пользователь</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:int">
            <xsd:minInclusive value="0"/>
            <xsd:maxInclusive value="9999"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element minOccurs="0" name="lastName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Фамилия пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="firstName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Имя пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="secondName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Отчество пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="mejiId" nillable="true" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД исполнения должности пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="specialityName" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Наименование специальности пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpuId" nillable="true" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД учреждения пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpuName" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Наименование учреждения пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="PatientEventInitiator">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="lastName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Фамилия</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="firstName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Имя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="secondName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Отчество</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="omsSeries">
        <xsd:annotation>
          <xsd:documentation>Серия полиса ОМС</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="6"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="omsNumber" nillable="true">
        <xsd:annotation>
          <xsd:documentation>Номер полиса ОМС</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="255"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="omsType" nillable="true" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Тип полиса ОМС</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ChangeParameter">
    <xsd:sequence>
      <xsd:element name="paramName" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Наименование параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="oldValue" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Старое значение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="newValue" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Новое значение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReferralByPatient">
    <xsd:sequence>
      <xsd:element name="patientId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="createDate" type="tns:DatePeriod">
        <xsd:annotation>
          <xsd:documentation>Период создания направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReferralByPatientContainer">
    <xsd:sequence>
      <xsd:element name="patientId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента из запроса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:choice>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="referral" type="tns:Referral">
          <xsd:annotation>
            <xsd:documentation>Направления пациента</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="message" type="tns:Message">
          <xsd:annotation>
            <xsd:documentation>Ошибка поиска данных</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:choice>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="DataFaultTextInfo">
    <xsd:sequence>
      <xsd:element name="code" type="xsd:string"/>
      <xsd:element name="message" type="xsd:string"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentsByIDsRequest">
    <xsd:sequence>
      <xsd:element name="appointmentId" type="xsd:long"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ReferralsByIDsResponse">
    <xsd:choice maxOccurs="unbounded">
      <xsd:sequence>
        <xsd:element name="referral" type="tns:Referral"/>
        <xsd:element minOccurs="0" name="activeAppointments" type="tns:ActiveAppointmentsContainer"/>
        <xsd:element minOccurs="0" name="closedAppointments" type="tns:ClosedAppointmentsContainer"/>
        <xsd:element minOccurs="0" name="message" type="tns:Message"/>
      </xsd:sequence>
      <xsd:sequence>
        <xsd:element name="referralId" type="xsd:long"/>
        <xsd:element name="message" type="tns:Message"/>
      </xsd:sequence>
    </xsd:choice>
  </xsd:complexType>
  <!--Введены разные типы во избежание формирование списка JAXBElement в ReferralsByIDsResponse.java-->
  <xsd:complexType name="ActiveAppointmentsContainer">
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" name="appointment" type="tns:AppointmentDesc"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ClosedAppointmentsContainer">
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" name="appointment" type="tns:AppointmentDesc"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AvailableResource">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String300">
        <xsd:annotation>
          <xsd:documentation>Название ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="typeId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор типа ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="typeName" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название типа ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="dutyDoctor" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Дежурный врач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="selfAppointment" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Разрешена самозапись</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="mainDoctor" type="tns:MedicalEmployee">
        <xsd:annotation>
          <xsd:documentation>Основной медработник в ДР только для ДР типа 10 (Специалист)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="specialization" type="tns:MedicalSpeciality">
        <xsd:annotation>
          <xsd:documentation>Специализация ДР только для ДР типа 10 (Специалист)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="ldpId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛДП</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="receptionId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Описание видов приема</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="samplingType" type="tns:SamplingType">
        <xsd:annotation>
          <xsd:documentation>Профиль взятия БМ, заполняется только для ДР типа 30</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="complexResource" type="tns:ComplexResourceDesc">
        <xsd:annotation>
          <xsd:documentation>Кабинет с оборудованием в ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="available">
        <xsd:annotation>
          <xsd:documentation>Доступность ресурса в зависимости от алгоритма, которым он получен</xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element minOccurs="0" name="byAttachment" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен по прикреплению к специальности</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="bySelfAppointment" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен пациенту по самозаписи К_УЗН_5_ОП шаг №4</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="main" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен пациенту по самозаписи. Участковый основной К_УЗН_5_ОП шаг
									№4 А_УЗН_30</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="replacement" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен пациенту по самозаписи. Участковый замеща-ющий К_УЗН_5_ОП
									шаг №4 А_УЗН_30</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="byEmployee" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен медработнику филиала</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="byReferral" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен по направлению</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="byRegistry" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен в рамках единой регистратуры</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="byRoute" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен по маршруту</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="byAddress" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Доступен по адресному объекту</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element minOccurs="0" name="hasWorkingDay" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак «Наличие хотябы одного рабочего дня в пределах диапазона запроса»</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="unavailable">
        <xsd:annotation>
          <xsd:documentation>Количество активных записей ДР</xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="countActiveAppointments" type="tns:Count9999Nullable">
              <xsd:annotation>
                <xsd:documentation>Дата для которой есть нерабочая квота</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="date" type="xsd:date">
              <xsd:annotation>
                <xsd:documentation>Дата для которой есть нерабочая квота</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="isHoliday" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>В отпуске</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="isHospital" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>На больничном</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="isOnDuty" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Принимает по ЭО</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="isStudy" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Наобучении</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="notWork" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Врач не работает</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="isDecree" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>В декретном отпуске</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="LpuParameter">
    <xsd:annotation>
      <xsd:documentation>Параметр ЛПУ (таблица LPU_PARAMETER)</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpuId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="typeId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор типа параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="value" type="tns:String250">
        <xsd:annotation>
          <xsd:documentation>Значение параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="unit" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Единицы измерения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="version" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Версия изменения параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Calendar">
    <xsd:annotation>
      <xsd:documentation>Рабочий календарь</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="dayType">
        <xsd:annotation>
          <xsd:documentation>Дата дня в календаре</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:enumeration value="WORKDAY"/>
            <xsd:enumeration value="HOLIDAY"/>
            <xsd:enumeration value="SUNDAY"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="day" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>Тип дня в календаре. Может принимать значения: WORKDAY – рабочий день HOLIDAY –
						выходной день SUNDAY - воскресенье</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="SystemParameter">
    <xsd:annotation>
      <xsd:documentation>Общесистемный параметр (таблица SYSTEM_PARAMETER)</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="paramType" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Код типа параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="value" type="tns:String250">
        <xsd:annotation>
          <xsd:documentation>Значение параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="unit" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Единицы измерения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="version" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Версия изменения параметра</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="settingType" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Тип настройки</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="DailyARSlotsKit">
    <xsd:annotation>
      <xsd:documentation>День со слотами</xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="date" type="xsd:date"/>
    <xsd:attribute name="count" type="tns:NonNegativeInt"/>
  </xsd:complexType>
  <xsd:complexType name="SpamError">
    <xsd:sequence>
      <xsd:element name="message" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Сообщение об ошибке</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" name="lock" type="tns:Appointment">
        <xsd:annotation>
          <xsd:documentation>Блокирующие записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentSlot">
    <xsd:sequence>
      <xsd:element name="appointmentTime" type="tns:TimeInterval">
        <xsd:annotation>
          <xsd:documentation>Дата и время записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" name="quotaTypeId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор вида квоты</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="complexResourceId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор кабинета с оборудованием, где работает ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="slotRestriction">
        <xsd:annotation>
          <xsd:documentation>Ограничения слота</xsd:documentation>
        </xsd:annotation>
        <xsd:complexType>
          <xsd:sequence>
            <xsd:element name="quotaRuleIntervalId" type="xsd:long">
              <xsd:annotation>
                <xsd:documentation>Идентификатор интервала, в рамках которого получен слот</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="onWholeInterval" type="xsd:boolean">
              <xsd:annotation>
                <xsd:documentation>Запись на весь интервал</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element minOccurs="0" name="appointmentCount">
              <xsd:annotation>
                <xsd:documentation>Ограничение - Количество записей</xsd:documentation>
              </xsd:annotation>
              <xsd:simpleType>
                <xsd:restriction base="xsd:int">
                  <xsd:minInclusive value="1"/>
                </xsd:restriction>
              </xsd:simpleType>
            </xsd:element>
            <xsd:element minOccurs="0" name="maxPercentTime">
              <xsd:annotation>
                <xsd:documentation>Ограничение - Доля времени, доступная для записи</xsd:documentation>
              </xsd:annotation>
              <xsd:simpleType>
                <xsd:restriction base="xsd:int">
                  <xsd:minInclusive value="0"/>
                  <xsd:maxInclusive value="100"/>
                </xsd:restriction>
              </xsd:simpleType>
            </xsd:element>
          </xsd:sequence>
        </xsd:complexType>
      </xsd:element>
      <xsd:element name="isAvailable" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Доступен для записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="availableByQuotaToRole" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Доступен по квотам с учетом роли пользователя</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="availableRedTicket" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Доступен для записи с красным талоном</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="availableByRoute" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Доступен по маршруту</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="slotIsBusy" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Слот занят</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="PaperReferralDesc">
    <xsd:sequence>
      <xsd:element name="issuedLpu" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛПУ, в котором было создано направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="issuedByMedicalEmployee" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор исполнения должности сотрудника, выдавшего направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="issuedDate" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>Дата выдачи направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="OperationWarning">
    <xsd:annotation>
      <xsd:documentation>Предупреждение при выполнении операции</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="code" type="xsd:string"/>
      <xsd:element name="messageText" type="xsd:string"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="QuotaType">
    <xsd:annotation>
      <xsd:documentation>Вид квоты</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор виды квоты</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="shortName" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Краткое название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="fullName" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Полное название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="allowBranches" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Разрешает запись из других ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="wholeInterval" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Запись возможна только на весь интервал</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="color">
        <xsd:annotation>
          <xsd:documentation>Цвет</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="6"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="quotaTypeMode" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Work – рабочее время, Rejected – запрещающее время, Entry – установки квот</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="LpuType">
    <xsd:annotation>
      <xsd:documentation>Тип МУ</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор вида ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="District">
    <xsd:annotation>
      <xsd:documentation>Административный округ</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Идентификатор административного округа</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" nillable="true" type="tns:String250">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="shortName" type="tns:String10">
        <xsd:annotation>
          <xsd:documentation>Краткое название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actuality" nillable="true" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Актуальность</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="QueueTicketDesc">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор талона</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="number" type="tns:String50">
        <xsd:annotation>
          <xsd:documentation>Номер талона</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Address">
    <xsd:annotation>
      <xsd:documentation>Адрес</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="fullAddress">
        <xsd:annotation>
          <xsd:documentation>Сформированный адрес: [улица], д. [номер дома, если есть], к. [номер корпуса,
						если есть], стр. [номер строения, если есть]</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:restriction base="xsd:string">
            <xsd:maxLength value="317"/>
          </xsd:restriction>
        </xsd:simpleType>
      </xsd:element>
      <xsd:element name="addressPointId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор адресного объекта (только для КР, для пациента не заполняется)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="city" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Город</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="street" nillable="true" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Улица</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="house" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Дом</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="building" type="tns:String10">
        <xsd:annotation>
          <xsd:documentation>Корпус</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="construction" type="tns:String10">
        <xsd:annotation>
          <xsd:documentation>Строение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentAuthorInfo">
    <xsd:sequence>
      <xsd:element name="medicalEmployeeId" type="xsd:long"/>
      <xsd:element name="lastName" type="xsd:string"/>
      <xsd:element name="firstName" type="xsd:string"/>
      <xsd:element name="secondName" type="xsd:string"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="getSamplingType">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getSamplingTypes</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence/>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getSamplingTypeResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getSamplingTypes Response</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="samplingType" type="tns:SamplingType">
          <xsd:annotation>
            <xsd:documentation>ПрофильвзятияБМ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForLI">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByPatient ForLI</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="assignment" type="tns:Assignment">
          <xsd:annotation>
            <xsd:documentation>Назначение</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForLIResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByPatient ForLI</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>Доступный ресурс</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForSpeciality">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getDoctorsByPatient ForSpeciality</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="assignment" type="tns:Assignment">
          <xsd:annotation>
            <xsd:documentation>Назначение</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getDoctorsByPatientForSpecialityResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getDoctorsByPatient ForSpeciality</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="availableResource" type="tns:AvailableResource">
          <xsd:annotation>
            <xsd:documentation>Доступный ресурс</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="SamplingType">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор профиля взятия</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String370">
        <xsd:annotation>
          <xsd:documentation>Наименования профиля взятия</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="getAppointmentPlanDaily">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentPlanDaily</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="dateFrom" type="xsd:date">
          <xsd:annotation>
            <xsd:documentation>Дата начала выборки</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentPlanDailyResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящеесообщение getAppointmentPlanDailyResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" ref="tns:result">
          <xsd:annotation>
            <xsd:documentation>Результатпоиска записей</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentPlanByLpu">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentPlanByLpu</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="startPeriod" type="tns:TimeInterval">
          <xsd:annotation>
            <xsd:documentation>Интервал времени начала приёма</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentPlanByLpuResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящеесообщение getAppointmentPlanByLpuResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" ref="tns:result">
          <xsd:annotation>
            <xsd:documentation>Результатпоиска записей</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentShiftByLpu">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentShiftByLpu</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="changePeriod" type="tns:TimeInterval">
          <xsd:annotation>
            <xsd:documentation>Интервал времени изменения записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="endPeriod" type="tns:TimeInterval">
          <xsd:annotation>
            <xsd:documentation>Интервал времени окончания записи</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentShiftByLpuResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getAppointmentShiftByLpuResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" ref="tns:result">
          <xsd:annotation>
            <xsd:documentation>Результатпоиска записей</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentShiftDaily">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Входящее сообщение getAppointmentShiftDaily</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="dateFrom" type="xsd:date">
          <xsd:annotation>
            <xsd:documentation>Дата</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="getAppointmentShiftDailyResponse">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Исходящее сообщение getAppointmentShiftDailyResponse</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element maxOccurs="unbounded" minOccurs="0" ref="tns:result">
          <xsd:annotation>
            <xsd:documentation>Результатпоиска записей</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="result">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="lpuId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД ЛПУ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="unbounded" name="appToAR">
          <xsd:complexType>
            <xsd:sequence>
              <xsd:element name="availableResource" type="tns:AvailableResourceShort"/>
              <xsd:element maxOccurs="unbounded" name="appointment" type="tns:AppointmentShort"/>
            </xsd:sequence>
          </xsd:complexType>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="AvailableResourceShort">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String300">
        <xsd:annotation>
          <xsd:documentation>Название ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="typeId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор типа ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="typeName" type="tns:String255">
        <xsd:annotation>
          <xsd:documentation>Название типа ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="dutyDoctor" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Дежурный врач</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="mainDoctor" type="tns:MedicalEmployee">
        <xsd:annotation>
          <xsd:documentation>Основной медработник в ДР. Заполняется только для ДР типа 10 (Специалист)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="specialization" type="tns:MedicalSpeciality">
        <xsd:annotation>
          <xsd:documentation>Специализация ДР Заполняется только для ДР типа 10 (Специалист)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AppointmentShort">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patientId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="number" nillable="true" type="tns:String20">
        <xsd:annotation>
          <xsd:documentation>Номер записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentTime" type="tns:TimeInterval">
        <xsd:annotation>
          <xsd:documentation>Дата и время приёма</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:AppointmentTypeEnum">
        <xsd:annotation>
          <xsd:documentation>RECEPTON запись на приём к специальности LDP запись на процедуру</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="actual" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "активная"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="completed" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "завершённая"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="overdue" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "просроченная"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="canceled" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак "отменённая"</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="status" type="tns:AppointmentStatus">
        <xsd:annotation>
          <xsd:documentation>Статус записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="cancelInfo" type="tns:CancelInfo">
        <xsd:annotation>
          <xsd:documentation>Информация об отмене записи. Заполняется только если статус записи 20
						(отменена)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="availableResourceId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД доступного ресурса к которому оформлена запись</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="complexResource" type="tns:ComplexResourceShort">
        <xsd:annotation>
          <xsd:documentation>Описание комплекс-ного ресурса к которому оформлена запись</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="receptionFact" type="tns:ReceptionFact">
        <xsd:annotation>
          <xsd:documentation>Информация о факте приёма по данной записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="careEventId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор клинического события, который был создан по данной записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="queueTicket" type="tns:QueueTicketDesc">
        <xsd:annotation>
          <xsd:documentation>Описание талона в живую очередь</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="appointmentType" type="tns:AppointmentType">
        <xsd:annotation>
          <xsd:documentation>Тип записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="lastChangeTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата последнего изменения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="RoomShort">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String10">
        <xsd:annotation>
          <xsd:documentation>Название кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Room">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String10">
        <xsd:annotation>
          <xsd:documentation>Название кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="lpu" type="tns:Lpu">
        <xsd:annotation>
          <xsd:documentation>Описание ЛПУ, в котором находится кабинет</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ComplexResourceShort">
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор кабинета с оборудованием</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="tns:String300">
        <xsd:annotation>
          <xsd:documentation>Название кабинета с оборудованием</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="room" nillable="true" type="tns:RoomShort">
        <xsd:annotation>
          <xsd:documentation>Описание кабинета</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="DatePeriod">
    <xsd:sequence>
      <xsd:element name="start" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>Дата начала периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="end" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>Дата окончания периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TimeInterval">
    <xsd:sequence>
      <xsd:element name="start" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время начала интервала</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="end" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время окончания интервала</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Assignment">
    <xsd:sequence>
      <xsd:element name="patientId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="moId" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>ИД МО принимающее (головное ЛПУ куста)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:choice>
        <xsd:element name="samplingTypeId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД профиля взятия БМ</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="unbounded" name="specialityId" type="xsd:long">
          <xsd:annotation>
            <xsd:documentation>ИД специальности</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:choice>
      <xsd:element name="period" type="tns:DatePeriod">
        <xsd:annotation>
          <xsd:documentation>Период действия назначения (период предоставления ДР)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="Detail">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="faultType" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Тип ошибки: ERROR – внутренняя ошибка, не выводится пользователю. USERERROR –
							пользовательская ошибка, транслируется пользователю(только для BUSINESS ошибок)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="faultInfo" type="tns:Message">
          <xsd:annotation>
            <xsd:documentation>Информация об ошибке</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="reasonInfo" type="tns:Message">
          <xsd:annotation>
            <xsd:documentation>Информация о причине ошибки (необязательная информация, заполняется в
							сценариях требующих учтонения, например причина некорректной структуры направления)</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="uuid" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Информация об идентификаторе ошибочного запроса</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="method" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Информация о методе сервиса, приведшего к ошибке</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="Message">
    <xsd:sequence>
      <xsd:element name="code" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Код сообщения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="messageText" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Текст сообщения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="UserRights">
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" name="userRightId" type="xsd:long"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="InvalidStructure">
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="referralBaseError" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Причина ошибки основания направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="referralARError" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Причина несоответствия направления и ДР</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="CancelInfo">
    <xsd:sequence>
      <xsd:element minOccurs="0" name="cancelReason" type="tns:CancelReason">
        <xsd:annotation>
          <xsd:documentation>Описание причины отмены записи</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="canceledTime" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата и время отмены</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="Count9999NotNullable">
    <xsd:restriction base="xsd:int">
      <xsd:minInclusive value="1"/>
      <xsd:maxInclusive value="9999"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="Count9999Nullable">
    <xsd:restriction base="xsd:int">
      <xsd:minInclusive value="0"/>
      <xsd:maxInclusive value="9999"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="NonNegativeInt">
    <xsd:restriction base="xsd:int">
      <xsd:minInclusive value="0"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String2">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="2"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String3">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="3"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String10">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="10"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String20">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="20"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String50">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="50"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String225">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="225"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String250">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="250"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String255">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="255"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String300">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="300"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String370">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="370"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="String2000">
    <xsd:restriction base="xsd:string">
      <xsd:maxLength value="2000"/>
    </xsd:restriction>
  </xsd:simpleType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint></con:endpoints><con:operation id="f43942d6-3df2-4f8b-8838-4acfc89ad49a" isOneWay="false" action="cancelAppointment" name="cancelAppointment" bindingOperationName="cancelAppointment" type="Request-Response" outputName="cancelAppointmentResponse" inputName="cancelAppointment" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="4bcfdc56-8cc7-4f7e-9e43-e4589948dd05" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:cancelAppointment>\r
         <v1:appointmentId>?</v1:appointmentId>\r
         <v1:cancelReasonId>?</v1:cancelReasonId>\r
      </v1:cancelAppointment>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/cancelAppointment"/></con:call></con:operation><con:operation id="775097bd-0ba1-425b-b387-3a08ceef8053" isOneWay="false" action="cancelReferral" name="cancelReferral" bindingOperationName="cancelReferral" type="Request-Response" outputName="cancelReferralResponse" inputName="cancelReferral" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e67fc429-a3c0-4bef-812b-8acec0316fcc" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:cancelReferral>\r
         <v1:referralId>?</v1:referralId>\r
         <v1:cancelReasonId>?</v1:cancelReasonId>\r
      </v1:cancelReferral>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/cancelReferral"/></con:call></con:operation><con:operation id="f1e938dc-efbe-4a36-afcd-7222103837f9" isOneWay="false" action="createAppointment" name="createAppointment" bindingOperationName="createAppointment" type="Request-Response" outputName="createAppointmentResponse" inputName="createAppointment" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="9333189f-bf9b-4289-be28-06153dd8ba6c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:createAppointment>\r
         <v1:patientId>?</v1:patientId>\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <v1:complexResourceId>?</v1:complexResourceId>\r
         <v1:appointmentTime>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:appointmentTime>\r
         <!--You have a CHOICE of the next 4 items at this level-->\r
         <v1:referralId>?</v1:referralId>\r
         <v1:receptionId>?</v1:receptionId>\r
         <v1:ldpId>?</v1:ldpId>\r
         <v1:samplingTypeId>?</v1:samplingTypeId>\r
         <!--Optional:-->\r
         <v1:comment>?</v1:comment>\r
         <!--Optional:-->\r
         <v1:forceBusySlots>?</v1:forceBusySlots>\r
      </v1:createAppointment>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/createAppointment"/></con:call></con:operation><con:operation id="866e455a-a9cd-43d4-ae11-7bcafd6fcd19" isOneWay="false" action="createReferral" name="createReferral" bindingOperationName="createReferral" type="Request-Response" outputName="createReferralResponse" inputName="createReferral" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="b0e254f7-e30f-4235-95bd-a8bf77a10888" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:createReferral>\r
         <!--You have a CHOICE of the next 2 items at this level-->\r
         <v1:toDoctor>\r
            <v1:specialityId>?</v1:specialityId>\r
            <v1:receptionId>?</v1:receptionId>\r
         </v1:toDoctor>\r
         <v1:toLdp>\r
            <v1:ldpId>?</v1:ldpId>\r
            <v1:proceduresNumber>?</v1:proceduresNumber>\r
         </v1:toLdp>\r
         <v1:patientId>?</v1:patientId>\r
         <v1:diagnosisMKB10Id>?</v1:diagnosisMKB10Id>\r
         <v1:receiveLpuId>?</v1:receiveLpuId>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <v1:validityPeriod>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:validityPeriod>\r
         <!--Optional:-->\r
         <v1:assignmentId>?</v1:assignmentId>\r
         <!--Optional:-->\r
         <v1:protocolId>?</v1:protocolId>\r
         <!--Optional:-->\r
         <v1:instrumental>?</v1:instrumental>\r
         <!--Optional:-->\r
         <v1:comment>?</v1:comment>\r
         <!--Optional:-->\r
         <v1:receptionFactId>?</v1:receptionFactId>\r
         <!--Optional:-->\r
         <v1:careEventId>?</v1:careEventId>\r
         <!--Optional:-->\r
         <v1:paperReferralDesc>\r
            <v1:issuedLpu>?</v1:issuedLpu>\r
            <v1:issuedByMedicalEmployee>?</v1:issuedByMedicalEmployee>\r
            <v1:issuedDate>?</v1:issuedDate>\r
         </v1:paperReferralDesc>\r
      </v1:createReferral>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/createReferral"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="39ac44c6-b8e2-43d5-b85e-ea3a3ae20c39" isOneWay="false" action="createUrgentAppointment" name="createUrgentAppointment" bindingOperationName="createUrgentAppointment" type="Request-Response" outputName="createUrgentAppointmentResponse" inputName="createUrgentAppointment" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2d8218ba-2ba7-4a4a-9127-8b396b775760" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:createUrgentAppointment>\r
         <v1:patientId>?</v1:patientId>\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <v1:complexResourceId>?</v1:complexResourceId>\r
         <!--You have a CHOICE of the next 2 items at this level-->\r
         <v1:receptionTypeId>?</v1:receptionTypeId>\r
         <v1:ldpId>?</v1:ldpId>\r
         <!--Optional:-->\r
         <v1:comment>?</v1:comment>\r
      </v1:createUrgentAppointment>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/createUrgentAppointment"/></con:call></con:operation><con:operation id="4482f3e2-533f-485a-8291-efc7c032f656" isOneWay="false" action="getAppointmentHistory" name="getAppointmentHistory" bindingOperationName="getAppointmentHistory" type="Request-Response" outputName="getAppointmentHistoryResponse" inputName="getAppointmentHistory" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="6b87c32f-b471-4abb-8d77-e662ee23b31d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentHistory>\r
         <v1:appointmentId>?</v1:appointmentId>\r
      </v1:getAppointmentHistory>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentHistory"/></con:call></con:operation><con:operation id="0f827d93-bebc-41f0-b440-423c576413a7" isOneWay="false" action="getAppointmentPlanByLpu" name="getAppointmentPlanByLpu" bindingOperationName="getAppointmentPlanByLpu" type="Request-Response" outputName="getAppointmentPlanByLpuResponse" inputName="getAppointmentPlanByLpu" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="011b3fc3-4167-4205-9c39-c22f36fd19c4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentPlanByLpu>\r
         <!--Zero or more repetitions:-->\r
         <v1:lpuId>?</v1:lpuId>\r
         <!--Optional:-->\r
         <v1:startPeriod>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:startPeriod>\r
      </v1:getAppointmentPlanByLpu>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentPlanByLpu"/></con:call></con:operation><con:operation id="fa6cf3d1-f10c-475d-923c-5640ac255f2f" isOneWay="false" action="getAppointmentPlanDaily" name="getAppointmentPlanDaily" bindingOperationName="getAppointmentPlanDaily" type="Request-Response" outputName="getAppointmentPlanDailyResponse" inputName="getAppointmentPlanDaily" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e3f97655-fdb9-4480-9265-d264a252bbe6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentPlanDaily>\r
         <!--Zero or more repetitions:-->\r
         <v1:lpuId>?</v1:lpuId>\r
         <!--Optional:-->\r
         <v1:dateFrom>?</v1:dateFrom>\r
      </v1:getAppointmentPlanDaily>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentPlanDaily"/></con:call></con:operation><con:operation id="a94bd031-1b11-42e0-88f4-12534abcb1b0" isOneWay="false" action="getAppointmentsByIDs" name="getAppointmentsByIDs" bindingOperationName="getAppointmentsByIDs" type="Request-Response" outputName="getAppointmentsByIDsResponse" inputName="getAppointmentsByIDs" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="fa24918f-ddb7-4a26-8e5e-d6ba9e6d2dce" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:appointmentId>?</v1:appointmentId>\r
         <!--Optional:-->\r
         <v1:returnPatient>?</v1:returnPatient>\r
         <!--Optional:-->\r
         <v1:appVersion>1</v1:appVersion>\r
      </v1:getAppointmentsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentsByIDs"/></con:call></con:operation><con:operation id="efd880b1-02f9-4f75-a674-168ad5f7998e" isOneWay="false" action="getAppointmentsByPatient" name="getAppointmentsByPatient" bindingOperationName="getAppointmentsByPatient" type="Request-Response" outputName="getAppointmentsByPatientResponse" inputName="getAppointmentsByPatient" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5342b59c-5d73-4ea6-8335-80f78615b03b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentsByPatient>\r
         <!--1 to 5 repetitions:-->\r
         <v1:request>\r
            <v1:patientId>?</v1:patientId>\r
            <!--Zero or more repetitions:-->\r
            <v1:referralId>?</v1:referralId>\r
            <!--Optional:-->\r
            <v1:startDate>\r
               <v1:start>?</v1:start>\r
               <v1:end>?</v1:end>\r
            </v1:startDate>\r
            <!--Optional:-->\r
            <v1:createDate>\r
               <v1:start>?</v1:start>\r
               <v1:end>?</v1:end>\r
            </v1:createDate>\r
         </v1:request>\r
         <v1:signActive>?</v1:signActive>\r
         <!--Optional:-->\r
         <v1:returnPatient>?</v1:returnPatient>\r
         <!--Optional:-->\r
         <v1:appVersion>1</v1:appVersion>\r
      </v1:getAppointmentsByPatient>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentsByPatient"/></con:call></con:operation><con:operation id="d6d1574a-bcd7-48fc-b053-c638d8b6cc9c" isOneWay="false" action="getAppointmentsByResource" name="getAppointmentsByResource" bindingOperationName="getAppointmentsByResource" type="Request-Response" outputName="getAppointmentsByResourceResponse" inputName="getAppointmentsByResource" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="16822156-94ad-4d71-9ad4-1e7df6c4982d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentsByResource>\r
         <!--1 or more repetitions:-->\r
         <v1:request>\r
            <v1:resourceId>?</v1:resourceId>\r
            <!--1 or more repetitions:-->\r
            <v1:startDate>\r
               <v1:start>?</v1:start>\r
               <v1:end>?</v1:end>\r
            </v1:startDate>\r
         </v1:request>\r
         <v1:signActive>?</v1:signActive>\r
         <!--Optional:-->\r
         <v1:returnPatient>?</v1:returnPatient>\r
         <!--Optional:-->\r
         <v1:skipCalculatedDates>?</v1:skipCalculatedDates>\r
         <!--Optional:-->\r
         <v1:skipReferrals>?</v1:skipReferrals>\r
         <!--Optional:-->\r
         <v1:appVersion>1</v1:appVersion>\r
      </v1:getAppointmentsByResource>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentsByResource"/></con:call></con:operation><con:operation id="5e5d07c7-c00a-4dce-9a01-53ca2e4ae981" isOneWay="false" action="getAppointmentShiftByLpu" name="getAppointmentShiftByLpu" bindingOperationName="getAppointmentShiftByLpu" type="Request-Response" outputName="getAppointmentShiftByLpuResponse" inputName="getAppointmentShiftByLpu" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="954d8a9e-a7fb-44c6-a411-a8eea76f291e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentShiftByLpu>\r
         <!--Zero or more repetitions:-->\r
         <v1:lpuId>?</v1:lpuId>\r
         <!--Optional:-->\r
         <v1:changePeriod>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:changePeriod>\r
         <!--Optional:-->\r
         <v1:endPeriod>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:endPeriod>\r
      </v1:getAppointmentShiftByLpu>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentShiftByLpu"/></con:call></con:operation><con:operation id="f2dd3f34-66a5-48fb-818d-cb5dc3fb5a45" isOneWay="false" action="getAppointmentShiftDaily" name="getAppointmentShiftDaily" bindingOperationName="getAppointmentShiftDaily" type="Request-Response" outputName="getAppointmentShiftDailyResponse" inputName="getAppointmentShiftDaily" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="121cdb10-bab4-44b9-bc2a-abd1c5182ce5" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getAppointmentShiftDaily>\r
         <!--Zero or more repetitions:-->\r
         <v1:lpuId>?</v1:lpuId>\r
         <!--Optional:-->\r
         <v1:dateFrom>?</v1:dateFrom>\r
      </v1:getAppointmentShiftDaily>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getAppointmentShiftDaily"/></con:call></con:operation><con:operation id="8ed65f33-30f3-4b4f-ac7f-bb22ee81cf01" isOneWay="false" action="getARSchedule" name="getARSchedule" bindingOperationName="getARSchedule" type="Request-Response" outputName="getARScheduleResponse" inputName="getARSchedule" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2bb39523-fb4e-4fc2-8cc7-a0544d6cd80b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getARSchedule>\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <!--You have a CHOICE of the next 3 items at this level-->\r
         <v1:patientId>?</v1:patientId>\r
         <v1:referralId>?</v1:referralId>\r
         <v1:appointmentId>?</v1:appointmentId>\r
         <!--Optional:-->\r
         <v1:forceBusySlots>?</v1:forceBusySlots>\r
         <v1:period>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:period>\r
      </v1:getARSchedule>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getARSchedule"/></con:call></con:operation><con:operation id="0df8e6f7-a6d5-464a-919f-c8e437fe9737" isOneWay="false" action="getCancelReasons" name="getCancelReasons" bindingOperationName="getCancelReasons" type="Request-Response" outputName="getCancelReasonsResponse" inputName="getCancelReasons" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="b81bd9e6-444c-44b5-8874-c843d851e6ac" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getCancelReasons/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getCancelReasons"/></con:call></con:operation><con:operation id="6be131e9-e8a4-42d7-99f8-3c2ede5fb374" isOneWay="false" action="getCountSlotsForAppointment" name="getCountSlotsForAppointment" bindingOperationName="getCountSlotsForAppointment" type="Request-Response" outputName="getCountSlotsForAppointmentResponse" inputName="getCountSlotsForAppointment" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="c07a5938-c846-4794-bd56-2a50483d931d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getCountSlotsForAppointment>\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <v1:dateFrom>?</v1:dateFrom>\r
      </v1:getCountSlotsForAppointment>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getCountSlotsForAppointment"/></con:call></con:operation><con:operation id="b5ca8c3c-93ab-4cc6-b7d0-c3a51d7cdc0f" isOneWay="false" action="getDiagnosesMKB10" name="getDiagnosesMKB10" bindingOperationName="getDiagnosesMKB10" type="Request-Response" outputName="getDiagnosesMKB10Response" inputName="getDiagnosesMKB10" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="0d86fe9e-67fa-42c9-afda-e6079c65fc26" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getDiagnosesMKB10/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDiagnosesMKB10"/></con:call></con:operation><con:operation id="52fe12bf-c05a-41a6-bf7a-56d01d7e336b" isOneWay="false" action="getDistricts" name="getDistricts" bindingOperationName="getDistricts" type="Request-Response" outputName="getDistrictsResponse" inputName="getDistricts" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="f799efcf-560c-4e28-b59d-4efdb1aeb416" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getDistricts/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDistricts"/></con:call></con:operation><con:operation id="8afca3c6-b9b5-458a-9af5-35a85f129f3f" isOneWay="false" action="getDoctorsByPatient" name="getDoctorsByPatient" bindingOperationName="getDoctorsByPatient" type="Request-Response" outputName="getDoctorsByPatientResponse" inputName="getDoctorsByPatient" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="83b44464-83f8-4590-b139-add5b373e0c6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByPatient>\r
         <v1:patientId>?</v1:patientId>\r
      </v1:getDoctorsByPatient>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByPatient"/></con:call></con:operation><con:operation id="ee461b9f-5c4a-4a20-8b67-f20464105a12" isOneWay="false" action="getDoctorsByPatientForLI" name="getDoctorsByPatientForLI" bindingOperationName="getDoctorsByPatientForLI" type="Request-Response" outputName="getDoctorsByPatientForLIResponse" inputName="getDoctorsByPatientForLI" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="f3f05d37-6024-45ad-a3b7-ba54fdaf7118" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByPatientForLI>\r
         <v1:assignment>\r
            <v1:patientId>?</v1:patientId>\r
            <v1:moId>?</v1:moId>\r
            <!--You have a CHOICE of the next 2 items at this level-->\r
            <v1:samplingTypeId>?</v1:samplingTypeId>\r
            <!--1 or more repetitions:-->\r
            <v1:specialityId>?</v1:specialityId>\r
            <v1:period>\r
               <v1:start>?</v1:start>\r
               <v1:end>?</v1:end>\r
            </v1:period>\r
         </v1:assignment>\r
      </v1:getDoctorsByPatientForLI>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByPatientForLI"/></con:call></con:operation><con:operation id="90d8b149-ddbc-45d3-bf61-afde7b7cef73" isOneWay="false" action="getDoctorsByPatientForPackage" name="getDoctorsByPatientForPackage" bindingOperationName="getDoctorsByPatientForPackage" type="Request-Response" outputName="getDoctorsByPatientForPackageResponse" inputName="getDoctorsByPatientForPackage" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="19b9b84c-b456-4a6e-aaa0-37ae0b1f6104" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByPatientForPackage>\r
         <v1:patientId>?</v1:patientId>\r
         <v1:packageParams>\r
            <!--Zero or more repetitions:-->\r
            <v1:specialityId>?</v1:specialityId>\r
            <!--Zero or more repetitions:-->\r
            <v1:ldpId>?</v1:ldpId>\r
         </v1:packageParams>\r
      </v1:getDoctorsByPatientForPackage>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByPatientForPackage"/></con:call></con:operation><con:operation id="00fbe0f4-bed4-4667-a813-e1a0aebe3839" isOneWay="false" action="getDoctorsByPatientForPackageByRoute" name="getDoctorsByPatientForPackageByRoute" bindingOperationName="getDoctorsByPatientForPackageByRoute" type="Request-Response" outputName="getDoctorsByPatientForPackageByRouteResponse" inputName="getDoctorsByPatientForPackageByRoute" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="0837e70f-9286-4bd4-996e-5425752f2ace" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByPatientForPackageByRoute>\r
         <v1:patientId>?</v1:patientId>\r
         <v1:packageParams>\r
            <!--Zero or more repetitions:-->\r
            <v1:specialityId>?</v1:specialityId>\r
            <!--Zero or more repetitions:-->\r
            <v1:ldpId>?</v1:ldpId>\r
         </v1:packageParams>\r
      </v1:getDoctorsByPatientForPackageByRoute>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByPatientForPackageByRoute"/></con:call></con:operation><con:operation id="acfdd152-3e8a-43bb-9765-12e50551a41c" isOneWay="false" action="getDoctorsByPatientForSpeciality" name="getDoctorsByPatientForSpeciality" bindingOperationName="getDoctorsByPatientForSpeciality" type="Request-Response" outputName="getDoctorsByPatientForSpecialityResponse" inputName="getDoctorsByPatientForSpeciality" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="1260b25a-1d0b-46bc-8e0a-6338cc56664e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByPatientForSpeciality>\r
         <v1:assignment>\r
            <v1:patientId>?</v1:patientId>\r
            <v1:moId>?</v1:moId>\r
            <!--You have a CHOICE of the next 2 items at this level-->\r
            <v1:samplingTypeId>?</v1:samplingTypeId>\r
            <!--1 or more repetitions:-->\r
            <v1:specialityId>?</v1:specialityId>\r
            <v1:period>\r
               <v1:start>?</v1:start>\r
               <v1:end>?</v1:end>\r
            </v1:period>\r
         </v1:assignment>\r
      </v1:getDoctorsByPatientForSpeciality>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByPatientForSpeciality"/></con:call></con:operation><con:operation id="fcfd7942-c500-43a9-a21c-7980206d3b15" isOneWay="false" action="getDoctorsByReferral" name="getDoctorsByReferral" bindingOperationName="getDoctorsByReferral" type="Request-Response" outputName="getDoctorsByReferralResponse" inputName="getDoctorsByReferral" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5d498a13-912d-47cb-838e-22001f17441e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByReferral>\r
         <v1:referralId>?</v1:referralId>\r
         <!--Optional:-->\r
         <v1:appointmentId>?</v1:appointmentId>\r
      </v1:getDoctorsByReferral>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByReferral"/></con:call></con:operation><con:operation id="8b349e8f-8fa5-4212-a7c0-e763a269c683" isOneWay="false" action="getDoctorsByRegistry" name="getDoctorsByRegistry" bindingOperationName="getDoctorsByRegistry" type="Request-Response" outputName="getDoctorsByRegistryResponse" inputName="getDoctorsByRegistry" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e434864c-e0af-4427-886d-01f78ed96e71" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByRegistry>\r
         <!--Zero or more repetitions:-->\r
         <v1:arTypeId>?</v1:arTypeId>\r
      </v1:getDoctorsByRegistry>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByRegistry"/></con:call></con:operation><con:operation id="39576fd7-1f1a-4a66-a182-909a87212408" isOneWay="false" action="getDoctorsByRoute" name="getDoctorsByRoute" bindingOperationName="getDoctorsByRoute" type="Request-Response" outputName="getDoctorsByRouteResponse" inputName="getDoctorsByRoute" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="95353a37-b8d2-4221-b292-e09ef94f808c" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
 <soap:Header>
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>INSTRUMENTAL/MDuishaeva</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">${#TestSuite#systemName}/${#TestSuite#Username}</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>204</v1:lpuId>\r
         <v1:jobId>12018042375</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
             </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByRoute>\r
         <!--Zero or more repetitions:-->\r
         <v1:arTypeId>10</v1:arTypeId>\r
      </v1:getDoctorsByRoute>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByRoute"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="f6039e93-6a9d-4a45-b587-b7203daa6f63" isOneWay="false" action="getDoctorsByUser" name="getDoctorsByUser" bindingOperationName="getDoctorsByUser" type="Request-Response" outputName="getDoctorsByUserResponse" inputName="getDoctorsByUser" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="f708bc39-7a86-463d-88a4-4abb5a5a03e9" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>206</v1:lpuId>\r
         <v1:jobId>10626539202</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
          </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getDoctorsByUser>\r
         <!--Zero or more repetitions:-->\r
         <v1:arTypeId>10</v1:arTypeId>\r
      </v1:getDoctorsByUser>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getDoctorsByUser"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="42dbde3c-9885-4b1c-8f94-ce5aa3d2b83b" isOneWay="false" action="getLdpTypes" name="getLdpTypes" bindingOperationName="getLdpTypes" type="Request-Response" outputName="getLdpTypesResponse" inputName="getLdpTypes" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="c4a60aa3-a019-4f6b-b7be-94156bfbf2a8" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getLdpTypes/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getLdpTypes"/></con:call></con:operation><con:operation id="5a948f6d-4a51-4c3f-ac30-c792c3e43f94" isOneWay="false" action="getLpuList" name="getLpuList" bindingOperationName="getLpuList" type="Request-Response" outputName="getLpuListResponse" inputName="getLpuList" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2390a1e3-f196-4dbf-b516-1031cbe8dd4f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getLpuList/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getLpuList"/></con:call></con:operation><con:operation id="9d41e53b-93b7-4b6f-8e70-1227868e734e" isOneWay="false" action="getLpuTypes" name="getLpuTypes" bindingOperationName="getLpuTypes" type="Request-Response" outputName="getLpuTypesResponse" inputName="getLpuTypes" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="82fd7219-aa7a-425e-a018-477f842c098a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getLpuTypes/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getLpuTypes"/></con:call></con:operation><con:operation id="8f48969d-2858-46c6-9c7f-d7b978382922" isOneWay="false" action="getMedicalEmployees" name="getMedicalEmployees" bindingOperationName="getMedicalEmployees" type="Request-Response" outputName="getMedicalEmployeesResponse" inputName="getMedicalEmployees" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="fe768f39-7137-4314-8731-4a5763fd4ead" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getMedicalEmployees>\r
         <!--You have a CHOICE of the next 2 items at this level-->\r
         <!--1 or more repetitions:-->\r
         <v1:lpuId>?</v1:lpuId>\r
         <!--Optional:-->\r
         <v1:fio>?</v1:fio>\r
         <!--1 or more repetitions:-->\r
         <v1:mejiId>?</v1:mejiId>\r
      </v1:getMedicalEmployees>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getMedicalEmployees"/></con:call></con:operation><con:operation id="d31aca67-9ff5-4551-b65c-2d8e1dbbce74" isOneWay="false" action="getMedicalSpecialities" name="getMedicalSpecialities" bindingOperationName="getMedicalSpecialities" type="Request-Response" outputName="getMedicalSpecialitiesResponse" inputName="getMedicalSpecialities" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="b541f12e-030d-474f-8ceb-6dafffaaf8d9" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getMedicalSpecialities/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getMedicalSpecialities"/></con:call></con:operation><con:operation id="ff037283-9d90-40ae-8b49-8e4eeb9d360c" isOneWay="false" action="getMODutyDoctorAppRefParameters" name="getMODutyDoctorAppRefParameters" bindingOperationName="getMODutyDoctorAppRefParameters" type="Request-Response" outputName="getMODutyDoctorAppRefParametersResponse" inputName="getMODutyDoctorAppRefParameters" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="a292da6c-83c1-403f-9668-a75679e65d70" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getMODutyDoctorAppRefParameters>\r
         <v1:lpuId>?</v1:lpuId>\r
      </v1:getMODutyDoctorAppRefParameters>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getMODutyDoctorAppRefParameters"/></con:call></con:operation><con:operation id="4b66b7a4-a822-4c45-bbc4-39813806ac7a" isOneWay="false" action="getQuotaTypes" name="getQuotaTypes" bindingOperationName="getQuotaTypes" type="Request-Response" outputName="getQuotaTypesResponse" inputName="getQuotaTypes" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e047b26c-1b92-4275-955a-69094f9d76d2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getQuotaTypes/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getQuotaTypes"/></con:call></con:operation><con:operation id="030b8105-4192-4a0d-8715-45e47fc9ef3e" isOneWay="false" action="getReceptionTypes" name="getReceptionTypes" bindingOperationName="getReceptionTypes" type="Request-Response" outputName="getReceptionTypesResponse" inputName="getReceptionTypes" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="59a6ba0c-580c-4a3a-8eb5-47992069bb87" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getReceptionTypes/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getReceptionTypes"/></con:call></con:operation><con:operation id="4d51678e-dd6a-4b2d-864b-39a01e00aaf8" isOneWay="false" action="getReferralHistory" name="getReferralHistory" bindingOperationName="getReferralHistory" type="Request-Response" outputName="getReferralHistoryResponse" inputName="getReferralHistory" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="bcb77ba1-147e-430e-a9b6-311d7496ba37" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralHistory>\r
         <v1:referralId>?</v1:referralId>\r
      </v1:getReferralHistory>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getReferralHistory"/></con:call></con:operation><con:operation id="638e244d-0c52-49e0-bf57-06170a6a881e" isOneWay="false" action="getReferralsByIDs" name="getReferralsByIDs" bindingOperationName="getReferralsByIDs" type="Request-Response" outputName="getReferralsByIDsResponse" inputName="getReferralsByIDs" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="40437630-530c-45d6-83c2-fa0dacf1d35e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>?</v1:referralId>\r
         <!--Optional:-->\r
         <v1:returnPatient>?</v1:returnPatient>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getReferralsByIDs"/></con:call></con:operation><con:operation id="62cf0dc5-9868-4ed1-a18c-008ff79eed85" isOneWay="false" action="getReferralsByPatient" name="getReferralsByPatient" bindingOperationName="getReferralsByPatient" type="Request-Response" outputName="getReferralsByPatientResponse" inputName="getReferralsByPatient" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5caeddee-753b-47df-9de6-a8dde6dec558" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByPatient>\r
         <!--1 to 5 repetitions:-->\r
         <v1:request>\r
            <v1:patientId>?</v1:patientId>\r
            <!--Zero or more repetitions:-->\r
            <v1:createDate>\r
               <v1:start>?</v1:start>\r
               <v1:end>?</v1:end>\r
            </v1:createDate>\r
         </v1:request>\r
         <v1:referralType>?</v1:referralType>\r
         <!--Optional:-->\r
         <v1:returnPatient>?</v1:returnPatient>\r
      </v1:getReferralsByPatient>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getReferralsByPatient"/></con:call></con:operation><con:operation id="0407e98e-79c7-463d-b345-2b7d7b52c067" isOneWay="false" action="getSamplingType" name="getSamplingType" bindingOperationName="getSamplingType" type="Request-Response" outputName="getSamplingTypeResponse" inputName="getSamplingType" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="cb9a0530-db8b-4278-bf06-bfaf2e5cbcb0" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getSamplingType/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getSamplingType"/></con:call></con:operation><con:operation id="840cbc87-2059-4a2c-948d-aabe671b827c" isOneWay="false" action="getSystemParameters" name="getSystemParameters" bindingOperationName="getSystemParameters" type="Request-Response" outputName="getSystemParametersResponse" inputName="getSystemParameters" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="1b4565e1-04f2-4888-924c-3697fcbd3bc3" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getSystemParameters/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getSystemParameters"/></con:call></con:operation><con:operation id="3982ddb7-b50e-4c77-bc55-fac60de7c291" isOneWay="false" action="getWorkCalendar" name="getWorkCalendar" bindingOperationName="getWorkCalendar" type="Request-Response" outputName="getWorkCalendarResponse" inputName="getWorkCalendar" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="46d653a2-7e0f-4fd3-a7ff-320c1def352f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header/>\r
   <soap:Body>\r
      <v1:getWorkCalendar>\r
         <v1:year>?</v1:year>\r
      </v1:getWorkCalendar>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/getWorkCalendar"/></con:call></con:operation><con:operation id="0faa4bb6-37e6-4cad-a6d8-5302b3a5447c" isOneWay="false" action="searchPatientsByReferral" name="searchPatientsByReferral" bindingOperationName="searchPatientsByReferral" type="Request-Response" outputName="searchPatientsByReferralResponse" inputName="searchPatientsByReferral" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="8411f536-7170-42bb-b068-49d64b9b4981" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:searchPatientsByReferral>\r
         <!--1 or more repetitions:-->\r
         <v1:referralNumber>?</v1:referralNumber>\r
      </v1:searchPatientsByReferral>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/searchPatientsByReferral"/></con:call></con:operation><con:operation id="908ee30e-1d3b-450d-9227-848c4d53e8f6" isOneWay="false" action="searchPatientsByTicket" name="searchPatientsByTicket" bindingOperationName="searchPatientsByTicket" type="Request-Response" outputName="searchPatientsByTicketResponse" inputName="searchPatientsByTicket" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="7a0097cd-8283-44fd-944e-33afcb118ed2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:searchPatientsByTicket>\r
         <!--1 or more repetitions:-->\r
         <v1:ticketNumber>?</v1:ticketNumber>\r
      </v1:searchPatientsByTicket>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/searchPatientsByTicket"/></con:call></con:operation><con:operation id="0cd06776-31a9-49f9-aadc-5c4089e16481" isOneWay="false" action="updateAppointment" name="updateAppointment" bindingOperationName="updateAppointment" type="Request-Response" outputName="updateAppointmentResponse" inputName="updateAppointment" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="79e323f4-a125-4853-9176-e27fec77d12b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:updateAppointment>\r
         <v1:appointmentId>?</v1:appointmentId>\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <v1:complexResourceId>?</v1:complexResourceId>\r
         <v1:appointmentTime>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:appointmentTime>\r
         <!--Optional:-->\r
         <v1:receptionId>?</v1:receptionId>\r
         <v1:updateReasonId>?</v1:updateReasonId>\r
         <!--Optional:-->\r
         <v1:comment>?</v1:comment>\r
         <!--Optional:-->\r
         <v1:forceBusySlots>?</v1:forceBusySlots>\r
      </v1:updateAppointment>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/updateAppointment"/></con:call></con:operation><con:operation id="91f7ad17-a200-444f-8844-ec217e1e11ec" isOneWay="false" action="updateAppointmentWithReceptionFact" name="updateAppointmentWithReceptionFact" bindingOperationName="updateAppointmentWithReceptionFact" type="Request-Response" outputName="updateAppointmentWithReceptionFactResponse" inputName="updateAppointmentWithReceptionFact" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="101901cf-5c4e-4c1c-a757-c26c5e2209bc" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:updateAppointmentWithReceptionFact>\r
         <v1:appointmentId>?</v1:appointmentId>\r
         <!--You have a CHOICE of the next 2 items at this level-->\r
         <v1:receptionFactId>?</v1:receptionFactId>\r
         <v1:careEventId>?</v1:careEventId>\r
      </v1:updateAppointmentWithReceptionFact>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/updateAppointmentWithReceptionFact"/></con:call></con:operation><con:operation id="7c378382-9d07-4960-bbb2-6d5a65c25a6d" isOneWay="false" action="updateMODutyDoctorAppRefParameters" name="updateMODutyDoctorAppRefParameters" bindingOperationName="updateMODutyDoctorAppRefParameters" type="Request-Response" outputName="updateMODutyDoctorAppRefParametersResponse" inputName="updateMODutyDoctorAppRefParameters" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="0b82dd6c-50e1-4782-adeb-5d2b88dcc579" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:updateMODutyDoctorAppRefParameters>\r
         <v1:lpuId>?</v1:lpuId>\r
         <!--1 to 2 repetitions:-->\r
         <v1:changeLpuParameter>\r
            <v1:paramTypeId>?</v1:paramTypeId>\r
            <v1:paramValue>?</v1:paramValue>\r
            <!--Optional:-->\r
            <v1:paramUnit>?</v1:paramUnit>\r
         </v1:changeLpuParameter>\r
      </v1:updateMODutyDoctorAppRefParameters>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/updateMODutyDoctorAppRefParameters"/></con:call></con:operation><con:operation id="62c28c3b-880e-47b8-aac5-33ef0a4a7e28" isOneWay="false" action="updateReferral" name="updateReferral" bindingOperationName="updateReferral" type="Request-Response" outputName="updateReferralResponse" inputName="updateReferral" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="cdb9e1f4-0025-468d-b706-eab6932dc843" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:updateReferral>\r
         <v1:referralId>?</v1:referralId>\r
         <!--You have a CHOICE of the next 2 items at this level-->\r
         <v1:proceduresNumber>?</v1:proceduresNumber>\r
         <v1:receptionId>?</v1:receptionId>\r
         <!--Optional:-->\r
         <v1:diagnosisMKB10Id>?</v1:diagnosisMKB10Id>\r
         <v1:receiveLpuId>?</v1:receiveLpuId>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
         <v1:validityPeriod>\r
            <v1:start>?</v1:start>\r
            <v1:end>?</v1:end>\r
         </v1:validityPeriod>\r
         <!--Optional:-->\r
         <v1:comment>?</v1:comment>\r
      </v1:updateReferral>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/updateReferral"/></con:call></con:operation><con:operation id="604aa1b1-3fd4-4936-94a4-3823a2f0924a" isOneWay="false" action="updateSystemParameter" name="updateSystemParameter" bindingOperationName="updateSystemParameter" type="Request-Response" outputName="updateSystemParameterResponse" inputName="updateSystemParameter" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="4db85a30-2bd4-46dc-af54-e46a902d3ed1" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
      <v1:UserContextInfo>\r
         <v1:lpuId>?</v1:lpuId>\r
         <v1:jobId>?</v1:jobId>\r
         <v1:userRoleId>?</v1:userRoleId>\r
         <!--Optional:-->\r
         <v1:userRights>\r
            <!--1 or more repetitions:-->\r
            <v1:userRightId>?</v1:userRightId>\r
         </v1:userRights>\r
         <!--Optional:-->\r
         <v1:availableResourceId>?</v1:availableResourceId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:updateSystemParameter>\r
         <v1:changeSystemParameter>\r
            <v1:paramTypeId>?</v1:paramTypeId>\r
            <v1:paramValue>?</v1:paramValue>\r
            <!--Optional:-->\r
            <v1:paramUnit>?</v1:paramUnit>\r
         </v1:changeSystemParameter>\r
      </v1:updateSystemParameter>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias2.gov.ru/appointment/v1/AppointmentServiceV1PT/updateSystemParameter"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="16a503f7-1dfc-460f-9841-ee9091f2b3d2" wsaVersion="NONE" name="SimiServiceV4PortBinding" type="wsdl" bindingName="{http://emias.mos.ru/simi/v4/simiService}SimiServiceV4PortBinding" soapVersion="1_1" anonymous="optional" definition="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl"><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--Generated by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.3.1 (UNKNOWN_BRANCH-false; 2015-01-15T16:53:43+0100) JAXWS-RI/2.2.10 JAXWS-API/2.2.11 JAXB-RI/2.2.10-b140802.1033 JAXB-API/2.2.12-b140109.1041 svn-revision#unknown.-->
<definitions name="SimiServiceV4" targetNamespace="http://emias.mos.ru/simi/v4/simiService" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:cet="http://emias.mos.ru/simi/v4/simiService/types" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://emias.mos.ru/simi/v4/simiService" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsp1_2="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <types>
    <xsd:schema>
      <xsd:import namespace="http://emias.mos.ru/simi/v4/simiService/types" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS77iTe7tp8jeGl6y3b6DYm4o-"/>
    </xsd:schema>
  </types>
  <message name="simiFaultException">
    <part element="cet:simiFaultException" name="fault"/>
  </message>
  <message name="deprecateDocument">
    <part element="cet:deprecateDocument" name="parameters"/>
  </message>
  <message name="deprecateDocumentResponse">
    <part element="cet:deprecateDocumentResponse" name="parameters"/>
  </message>
  <message name="getCareEventDocuments">
    <part element="cet:getCareEventDocuments" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsResponse">
    <part element="cet:getCareEventDocumentsResponse" name="parameters"/>
  </message>
  <message name="saveDocument">
    <part element="cet:saveDocument" name="parameters"/>
  </message>
  <message name="saveDocumentResponse">
    <part element="cet:saveDocumentResponse" name="parameters"/>
  </message>
  <message name="archiveDocument">
    <part element="cet:archiveDocument" name="parameters"/>
  </message>
  <message name="archiveDocumentResponse">
    <part element="cet:archiveDocumentResponse" name="parameters"/>
  </message>
  <message name="searchDocuments">
    <part element="cet:searchDocuments" name="parameters"/>
  </message>
  <message name="searchDocumentsResponse">
    <part element="cet:searchDocumentsResponse" name="parameters"/>
  </message>
  <message name="getDocument">
    <part element="cet:getDocument" name="parameters"/>
  </message>
  <message name="getDocumentResponse">
    <part element="cet:getDocumentResponse" name="parameters"/>
  </message>
  <message name="getAuditRecords">
    <part element="cet:getAuditRecords" name="parameters"/>
  </message>
  <message name="getAuditRecordsResponse">
    <part element="cet:getAuditRecordsResponse" name="parameters"/>
  </message>
  <message name="createDocument">
    <part element="cet:createDocument" name="parameters"/>
  </message>
  <message name="createDocumentResponse">
    <part element="cet:createDocumentResponse" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsForSign">
    <part element="cet:getCareEventDocumentsForSign" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsForSignResponse">
    <part element="cet:getCareEventDocumentsForSignResponse" name="parameters"/>
  </message>
  <message name="getDocumentsByPatientForSign">
    <part element="cet:getDocumentsByPatientForSign" name="parameters"/>
  </message>
  <message name="getDocumentsByPatientForSignResponse">
    <part element="cet:getDocumentsByPatientForSignResponse" name="parameters"/>
  </message>
  <message name="getDocumentsForSign">
    <part element="cet:getDocumentsForSign" name="parameters"/>
  </message>
  <message name="getDocumentsForSignResponse">
    <part element="cet:getDocumentsForSignResponse" name="parameters"/>
  </message>
  <portType name="ISimiService">
    <operation name="deprecateDocument">
      <input message="tns:deprecateDocument" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/deprecateDocument"/>
      <output message="tns:deprecateDocumentResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/deprecateDocumentResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/deprecateDocument/Fault/SimiFaultException"/>
    </operation>
    <operation name="getCareEventDocuments">
      <input message="tns:getCareEventDocuments" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocuments"/>
      <output message="tns:getCareEventDocumentsResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocumentsResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocuments/Fault/SimiFaultException"/>
    </operation>
    <operation name="saveDocument">
      <input message="tns:saveDocument" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/saveDocument"/>
      <output message="tns:saveDocumentResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/saveDocumentResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/saveDocument/Fault/SimiFaultException"/>
    </operation>
    <operation name="archiveDocument">
      <input message="tns:archiveDocument" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/archiveDocument"/>
      <output message="tns:archiveDocumentResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/archiveDocumentResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/archiveDocument/Fault/SimiFaultException"/>
    </operation>
    <operation name="searchDocuments">
      <input message="tns:searchDocuments" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/searchDocuments"/>
      <output message="tns:searchDocumentsResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/searchDocumentsResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/searchDocuments/Fault/SimiFaultException"/>
    </operation>
    <operation name="getDocument">
      <input message="tns:getDocument" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocument"/>
      <output message="tns:getDocumentResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocument/Fault/SimiFaultException"/>
    </operation>
    <operation name="getAuditRecords">
      <input message="tns:getAuditRecords" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getAuditRecords"/>
      <output message="tns:getAuditRecordsResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getAuditRecordsResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getAuditRecords/Fault/SimiFaultException"/>
    </operation>
    <operation name="createDocument">
      <input message="tns:createDocument" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/createDocument"/>
      <output message="tns:createDocumentResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/createDocumentResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/createDocument/Fault/SimiFaultException"/>
    </operation>
    <operation name="getCareEventDocumentsForSign">
      <input message="tns:getCareEventDocumentsForSign" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocumentsForSign"/>
      <output message="tns:getCareEventDocumentsForSignResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocumentsForSignResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocumentsForSign/Fault/SimiFaultException"/>
    </operation>
    <operation name="getDocumentsByPatientForSign">
      <input message="tns:getDocumentsByPatientForSign" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsByPatientForSign"/>
      <output message="tns:getDocumentsByPatientForSignResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsByPatientForSignResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsByPatientForSign/Fault/SimiFaultException"/>
    </operation>
    <operation name="getDocumentsForSign">
      <input message="tns:getDocumentsForSign" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsForSign"/>
      <output message="tns:getDocumentsForSignResponse" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsForSignResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsForSign/Fault/SimiFaultException"/>
    </operation>
  </portType>
  <binding name="SimiServiceV4PortBinding" type="tns:ISimiService">
    <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsp:PolicyReference URI="#UP_policy"/>
    <operation name="deprecateDocument">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getCareEventDocuments">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="saveDocument">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="archiveDocument">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="searchDocuments">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getDocument">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getAuditRecords">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="createDocument">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getCareEventDocumentsForSign">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getDocumentsByPatientForSign">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getDocumentsForSign">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
  </binding>
  <service name="SimiServiceV4">
    <wsp:PolicyReference URI="#UP_policy"/>
    <port binding="tns:SimiServiceV4PortBinding" name="SimiServiceV4Port">
      <soap:address location="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService"/>
    </port>
  </service>
  <wsp:Policy wsu:Id="UP_policy">
    <sp:SupportingTokens xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy>
        <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
          <wsp:Policy>
            <sp:WssUsernameToken11/>
          </wsp:Policy>
        </sp:UsernameToken>
      </wsp:Policy>
    </sp:SupportingTokens>
  </wsp:Policy>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS77iTe7tp8jeGl6y3b6DYm4o-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/v4/simiService/types" version="1.0" xmlns:ns1="http://emias.mos.ru/simi/core" xmlns:ns2="http://emias.mos.ru/simi/cct" xmlns:ns3="http://emias.mos.ru/simi/document" xmlns:tns="http://emias.mos.ru/simi/v4/simiService/types" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS6EDzwccaJRteXLHTFcwI4Ao-"/>
  <xs:import namespace="http://emias.mos.ru/simi/cct" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS66.lWJ3w7WcmLguHISsY1Dw-"/>
  <xs:import namespace="http://emias.mos.ru/simi/document" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS6aQ.SQ68Ys92ctgfBm748.c-"/>
  <!--query documents-->
  <xs:complexType name="DocumentsResultPage">
    <xs:annotation>
      <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="ns1:PagingResults">
        <xs:sequence>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="item" type="ns3:Metadata">
            <xs:annotation>
              <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="DocumentsQueryData">
    <xs:annotation>
      <xs:documentation>Параметры отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="conditions">
        <xs:annotation>
          <xs:documentation>Условия отбора результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Условия отбора результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="condition" type="tns:DocumentsFilterCondition">
              <xs:annotation>
                <xs:documentation>Условие отбора Документов СИМИ</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element form="qualified" minOccurs="0" name="orderClauses">
        <xs:annotation>
          <xs:documentation>Способы сортировки результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Способы сортировки результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="orderClause" type="tns:DocumentsOrderClause">
              <xs:annotation>
                <xs:documentation>Способ сортировки результатов</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DocumentsFilterCondition">
    <xs:annotation>
      <xs:documentation>Условие отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="leftOperand" type="tns:DocumentsSearchAttribute">
        <xs:annotation>
          <xs:documentation>Левый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="rightOperand" type="xs:string">
        <xs:annotation>
          <xs:documentation>Правый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="operator" type="ns1:ComparisonType" use="required">
      <xs:annotation>
        <xs:documentation>Способ сравнения операндов</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="DocumentsOrderClause">
    <xs:annotation>
      <xs:documentation>Способ сортировки результатов отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="attributeName" type="tns:DocumentsSearchAttribute">
        <xs:annotation>
          <xs:documentation>Атрибут отбора Документов СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="ascending" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Направление сортировки (ascending/descending)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="DocumentsSearchAttribute">
    <xs:annotation>
      <xs:documentation>Атрибуты отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="PATIENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="STATUS">
        <xs:annotation>
          <xs:documentation>Статус документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIMI_VERSION">
        <xs:annotation>
          <xs:documentation>Версия объектной модели Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LINKS_PARENT">
        <xs:annotation>
          <xs:documentation>Восходящая зависимость</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LINKS_DESCENDANT">
        <xs:annotation>
          <xs:documentation>Нисходящая зависимость</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_SUBMISSION_SET">
        <xs:annotation>
          <xs:documentation>Идентификатор набора документов, которому принадлежит Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_CREATED">
        <xs:annotation>
          <xs:documentation>Дата/время создания Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VALID">
        <xs:annotation>
          <xs:documentation>Бизнес признак валидности контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGNEE_LOGIN">
        <xs:annotation>
          <xs:documentation>Логин пользователя, подписавшего электронной подписью документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CCT_CODE">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CARE_EVENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CARE_EVENT_STARTED">
        <xs:annotation>
          <xs:documentation>Дата/время начала Клинического события</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CARE_EVENT_FINISHED">
        <xs:annotation>
          <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="AUTHOR_LOGIN">
        <xs:annotation>
          <xs:documentation>Логин пользователя-автора Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_SCHEMA">
        <xs:annotation>
          <xs:documentation>Идентификатор терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_CODE">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_DESCRIPTION">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--query audit user actions-->
  <xs:complexType name="AuditResultPage">
    <xs:annotation>
      <xs:documentation>Результаты отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="ns1:PagingResults">
        <xs:sequence>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="item" type="tns:AuditRecord">
            <xs:annotation>
              <xs:documentation>Результат отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="AuditQueryData">
    <xs:annotation>
      <xs:documentation>Параметры отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="conditions">
        <xs:annotation>
          <xs:documentation>Условия отбора результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Условия отбора результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" name="condition" type="tns:AuditFilterCondition">
              <xs:annotation>
                <xs:documentation>Условие отбора результатов</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element form="qualified" minOccurs="0" name="orderClauses">
        <xs:annotation>
          <xs:documentation>Способы сортировки результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Способы сортировки результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="orderClause" type="tns:AuditOrderClause">
              <xs:annotation>
                <xs:documentation>Способ сортировки результатов</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="AuditFilterCondition">
    <xs:annotation>
      <xs:documentation>Условие отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="leftOperand" type="tns:AuditSearchAttribute">
        <xs:annotation>
          <xs:documentation>Левый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="rightOperand" type="xs:string">
        <xs:annotation>
          <xs:documentation>Правый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="operator" type="ns1:ComparisonType" use="required">
      <xs:annotation>
        <xs:documentation>Способ сравнения операндов</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="AuditOrderClause">
    <xs:annotation>
      <xs:documentation>Способ сортировки результатов отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="attributeName" type="tns:AuditSearchAttribute">
        <xs:annotation>
          <xs:documentation>Поле журнала аудита действий пользователей</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="ascending" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Направление сортировки (ascending/descending)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="AuditRecord">
    <xs:annotation>
      <xs:documentation>Запись Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="ns3:documentId"/>
    </xs:sequence>
    <xs:attribute name="eventTime" type="xs:dateTime" use="required">
      <xs:annotation>
        <xs:documentation>Дата и время совершения операции пользователем</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="action" type="tns:UserActionType" use="required">
      <xs:annotation>
        <xs:documentation>Тип операции, совершенной пользователем</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="errorCode" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Код ошибки выполнения операции, совершенной пользователем</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="userLogin" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Логин пользователя, совершившего данную операцию</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="AuditSearchAttribute">
    <xs:annotation>
      <xs:documentation>Поля Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="EVENT_TIME">
        <xs:annotation>
          <xs:documentation>Дата и время совершения операции пользователем</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ACTION">
        <xs:annotation>
          <xs:documentation>Тип операции, совершенной пользователем</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ERROR_CODE">
        <xs:annotation>
          <xs:documentation>Код ошибки выполнения операции, совершенной пользователем</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="USER_LOGIN">
        <xs:annotation>
          <xs:documentation>Логин пользователя, совершившего данную операцию</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="UserActionType">
    <xs:annotation>
      <xs:documentation>Типы операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="CREATE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Создание Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CHANGE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Изменение черновика Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGN_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Подписание Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Аннулирование Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ARCHIVE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Архивирование Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNKNOWN_ACTION">
        <xs:annotation>
          <xs:documentation>Неизвестное действие</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="GET_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Получение документа</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--requests & responses-->
  <xs:element name="simiFaultException" nillable="true" type="ns1:SimiFaultInfo">
    <xs:annotation>
      <xs:documentation>Ошибка</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="archiveDocument">
    <xs:annotation>
      <xs:documentation>Входные параметры метода archiveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода archiveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns3:documentId"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="archiveDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода archiveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода archiveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence/>
    </xs:complexType>
  </xs:element>
  <xs:element name="createDocument">
    <xs:annotation>
      <xs:documentation>Входные параметры метода createDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода createDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns2:cctCode"/>
        <xs:element ref="ns1:patientId"/>
        <xs:element ref="ns1:careEventId"/>
        <xs:element ref="ns1:careEventStarted"/>
        <xs:element minOccurs="0" ref="ns1:careEventFinished"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="createDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода createDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода createDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns3:document"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="deprecateDocument">
    <xs:annotation>
      <xs:documentation>Входные параметры метода deprecateDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода deprecateDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns3:documentId"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="deprecateDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода deprecateDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода deprecateDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence/>
    </xs:complexType>
  </xs:element>
  <xs:element name="getAuditRecords">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getAuditRecords</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getAuditRecords</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="params" type="tns:AuditQueryData">
          <xs:annotation>
            <xs:documentation>Параметры отбора сведений об операциях, совершенных пользователями</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element minOccurs="0" ref="ns1:pagingOptions"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getAuditRecordsResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getAuditRecords</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getAuditRecords</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:AuditResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocuments">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getCareEventDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns1:careEventId"/>
        <xs:element minOccurs="0" ref="ns2:cctCode"/>
        <xs:element minOccurs="0" ref="ns1:pagingOptions"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getCareEventDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocument">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns3:documentId"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns3:document"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="saveDocument">
    <xs:annotation>
      <xs:documentation>Входные параметры метода saveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода saveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns3:document"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="saveDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода saveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода saveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element minOccurs="0" ref="ns3:document"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="searchDocuments">
    <xs:annotation>
      <xs:documentation>Входные параметры метода searchDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода searchDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element minOccurs="0" name="queryName" type="xs:string">
          <xs:annotation>
            <xs:documentation>Имя подготовленного (хранимого) запроса</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element name="params" type="tns:DocumentsQueryData">
          <xs:annotation>
            <xs:documentation>Параметры отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element minOccurs="0" ref="ns1:pagingOptions"/>
        <xs:element minOccurs="0" ref="ns1:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="searchDocumentsResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода searchDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода searchDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsForSign">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns1:careEventId"/>
        <xs:element minOccurs="0" ref="ns1:pagingOptions"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsForSignResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsByPatientForSign">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getDocumentsByPatientForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="ns1:patientId"/>
        <xs:element minOccurs="0" ref="ns1:pagingOptions"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsByPatientForSignResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getDocumentsByPatientForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsForSign">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" minOccurs="0" ref="ns3:documentId"/>
        <xs:element minOccurs="0" ref="ns1:pagingOptions"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsForSignResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS6EDzwccaJRteXLHTFcwI4Ao-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/core" version="1.0" xmlns:tns="http://emias.mos.ru/simi/core" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <!--business entities which don't belong to SIMI services-->
  <xs:element name="patientId" type="xs:long">
    <xs:annotation>
      <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventId" type="xs:long">
    <xs:annotation>
      <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventStarted" type="xs:dateTime">
    <xs:annotation>
      <xs:documentation>Дата/время начала Клинического события</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventFinished" type="xs:dateTime">
    <xs:annotation>
      <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--calling methods' options-->
  <xs:element name="options" type="tns:Options">
    <xs:annotation>
      <xs:documentation>Параметры вызова метода</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="Options">
    <xs:annotation>
      <xs:documentation>Набор именованных значений</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="entry" type="tns:KeyValuePair">
        <xs:annotation>
          <xs:documentation>Именованное значение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <!--error description-->
  <xs:complexType name="SimiFaultInfo">
    <xs:annotation>
      <xs:documentation>Описание ошибки вызова метода</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="contextEntries">
        <xs:annotation>
          <xs:documentation>Параметры контекста возникновения ошибки</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Параметры контекста возникновения ошибки</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="entry">
              <xs:annotation>
                <xs:documentation>Параметр контекста возникновения ошибки</xs:documentation>
              </xs:annotation>
              <xs:complexType>
                <xs:annotation>
                  <xs:documentation>Параметр контекста возникновения ошибки</xs:documentation>
                </xs:annotation>
                <xs:sequence>
                  <xs:element minOccurs="0" name="key" type="xs:anyType">
                    <xs:annotation>
                      <xs:documentation>Название параметра контекста возникновения ошибки</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                  <xs:element minOccurs="0" name="value" type="xs:anyType">
                    <xs:annotation>
                      <xs:documentation>Значение параметра контекста возникновения ошибк</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element minOccurs="0" name="stackTrace" type="xs:string">
        <xs:annotation>
          <xs:documentation>Стек-трейс</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="message" type="xs:string">
        <xs:annotation>
          <xs:documentation>Сообщение об ошибке</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="errorCode" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Код ошибки</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--pagination-->
  <xs:element name="pagingOptions" type="tns:PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType abstract="true" name="PagingResults">
    <xs:annotation>
      <xs:documentation>Список с пагинацией</xs:documentation>
    </xs:annotation>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageTotal" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Общее количество страниц</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="morePagesAvailable" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Флаг доступности других страниц с результатами для "постраничного листания" (true - если доступны еще страницы; false - иначе)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--base types-->
  <xs:complexType name="Tag">
    <xs:annotation>
      <xs:documentation>Представляет "Тэг"</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CodedValue">
        <xs:attribute name="definedByCct" type="xs:boolean" use="required">
          <xs:annotation>
            <xs:documentation>Признак принадлежности Тэга к взятым из CCT терминологии Тэгам</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="TagCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию "Тэгов"</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="tag" type="tns:Tag">
        <xs:annotation>
          <xs:documentation>Представляет "Тэг"</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="KeyValuePair">
    <xs:annotation>
      <xs:documentation>Представляет базовый тип "ключ/значение"</xs:documentation>
    </xs:annotation>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="key" type="xs:string" use="required">
          <xs:annotation>
            <xs:documentation>Ключ</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="CodedValue">
    <xs:annotation>
      <xs:documentation>Представляет базовый тип элемента терминологии</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="schema" type="xs:string">
        <xs:annotation>
          <xs:documentation>Идентификатор терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="description" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="ComparisonType">
    <xs:annotation>
      <xs:documentation>Представляет перечисление типов сравнения значений</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="GT">
        <xs:annotation>
          <xs:documentation>Сравнение "больше чем"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="GE">
        <xs:annotation>
          <xs:documentation>Сравнение "больше или равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="EQ">
        <xs:annotation>
          <xs:documentation>Сравнение "в точности равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LT">
        <xs:annotation>
          <xs:documentation>Сравнение "меньше чем"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LE">
        <xs:annotation>
          <xs:documentation>Сравнение "меньше или равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LIKE">
        <xs:annotation>
          <xs:documentation>Сравнение по подстроке</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="NE">
        <xs:annotation>
          <xs:documentation>Сравнение "не равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS66.lWJ3w7WcmLguHISsY1Dw-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/cct" version="1.0" xmlns:ns1="http://emias.mos.ru/simi/core" xmlns:tns="http://emias.mos.ru/simi/cct" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS6EDzwccaJRteXLHTFcwI4Ao-"/>
  <!--reusable elements-->
  <xs:element name="cctCode" nillable="false" type="xs:unsignedInt">
    <xs:annotation>
      <xs:documentation>Код элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctItem" type="tns:CctItem">
    <xs:annotation>
      <xs:documentation>Представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctFolder" type="tns:CctFolder">
    <xs:annotation>
      <xs:documentation>Представление группирующего элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctItemCollection" type="tns:CctItemCollection">
    <xs:annotation>
      <xs:documentation>Набор элементов и группирующих элементов терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctParameters" type="ns1:Options">
    <xs:annotation>
      <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:attribute name="lifecycleState" type="tns:LifecycleState">
    <xs:annotation>
      <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <!--description of cct type-->
  <xs:complexType name="CctItemCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию элементов и группирующих элементов терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="cctFolder" type="tns:CctFolder">
        <xs:annotation>
          <xs:documentation>Набор группирующих элементов терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="cctItem" type="tns:CctItem">
        <xs:annotation>
          <xs:documentation>Набор элементов терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="CctItem">
    <xs:annotation>
      <xs:documentation>Представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CctBase">
        <xs:sequence>
          <xs:element ref="tns:contentTypeInfo">
            <xs:annotation>
              <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element ref="tns:cctParameters">
            <xs:annotation>
              <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="canDeprecateAfterSign" type="xs:boolean" use="optional">
          <xs:annotation>
            <xs:documentation>Признак возможности анулирования Документа СИМИ после его подписания ЭП (если не задан - true)</xs:documentation>
          </xs:annotation>
        </xs:attribute>
        <xs:attribute ref="tns:lifecycleState">
          <xs:annotation>
            <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="CctFolder">
    <xs:annotation>
      <xs:documentation>Представление группирующего элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CctBase"/>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="CctBase">
    <xs:annotation>
      <xs:documentation>Базовое представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="tns:cctCode">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="cctDescription" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="tags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, наследуемых Документом СИМИ, вследствие его принадлежности к Классу документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="confidentialityTags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, определяющих уровень конфиденциальности Документа СИМИ, наследуемых Документом СИМИ, вследствие его принадлежности к Классу документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="parentCode" type="xs:unsignedInt" use="required">
      <xs:annotation>
        <xs:documentation>Код родительского элемента терминологиии CCT</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--content type description-->
  <xs:element name="contentTypeInfo" type="tns:ContentTypeInfo">
    <xs:annotation>
      <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="ContentTypeInfo">
    <xs:annotation>
      <xs:documentation>Описывает сведения о типе контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="mimeType" type="xs:string">
        <xs:annotation>
          <xs:documentation>Коллекция MIME-типов, разрешенных для Класса документов СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="mimeClass" type="tns:MimeClass" use="required">
      <xs:annotation>
        <xs:documentation>MIME-класс, определенный для Класса документов СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="MimeClass">
    <xs:annotation>
      <xs:documentation>Представляет перечисление типов контента Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="APPLICATION">
        <xs:annotation>
          <xs:documentation>Любые двоичные данные</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="AUDIO">
        <xs:annotation>
          <xs:documentation>Аудио</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="IMAGE">
        <xs:annotation>
          <xs:documentation>Изображение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TEXT">
        <xs:annotation>
          <xs:documentation>Текст</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VIDEO">
        <xs:annotation>
          <xs:documentation>Видео</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VND">
        <xs:annotation>
          <xs:documentation>Вендор-зависимый класс контента</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="X">
        <xs:annotation>
          <xs:documentation>Нестандартный подтип, не зарегистрирован в «Центре присвоенных номеров Интернета» (IANA)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--visualization description-->
  <xs:element name="visualizationId" nillable="false" type="xs:string">
    <xs:annotation>
      <xs:documentation>Представляет идентификатор XSLT представления контента Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="visualizations" type="tns:VisualizationCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="VisualizationCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="visualization" type="tns:Visualization">
        <xs:annotation>
          <xs:documentation>Представляет сведения о XSLT преобразовании, которое может быть использовано для визуализации контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Visualization">
    <xs:annotation>
      <xs:documentation>Описывает сведения о XSLT преобразовании, которое может быть использовано для визуализации контента Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="tns:visualizationId">
        <xs:annotation>
          <xs:documentation>Представляет идентификатор XSLT представления контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:cctCode">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="visualizationInfo" type="tns:VisualizationInfo">
        <xs:annotation>
          <xs:documentation>Базовые сведения о XSLT преобразовании</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="visualizationData" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>Данные XSLT преобразования в формате base64</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="VisualizationInfo">
    <xs:annotation>
      <xs:documentation>Описывает базовые сведения о XSLT преобразовании</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="tags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Тэги XSLT преобразования</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="name" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Наименование XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="description" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Описание XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="xsltVersion" type="tns:XsltVersion" use="required">
      <xs:annotation>
        <xs:documentation>Версия спецификации XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signature" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Признак (true/false) возможности использования данного XSLT преобразования для визуализации контента Документа СИМИ при его подписании (истинное значение должен иметь только один элемент списка)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="XsltVersion">
    <xs:annotation>
      <xs:documentation>Представляет перечисление версий спецификаций XSLT преобразований</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="XSLT_1_0">
        <xs:annotation>
          <xs:documentation>Версия 1.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_1_1">
        <xs:annotation>
          <xs:documentation>Версия 1.1</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_2_0">
        <xs:annotation>
          <xs:documentation>Версия 2.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_3_0">
        <xs:annotation>
          <xs:documentation>Версия 3.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="LifecycleState">
    <xs:annotation>
      <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ALPHA">
        <xs:annotation>
          <xs:documentation>Доступ на АРМ врача возможен только у модельеров</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BETA">
        <xs:annotation>
          <xs:documentation>Предоставляется тестовый доступ врачам</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ACTIVE">
        <xs:annotation>
          <xs:documentation>Свободное (промышленное) использование</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATED">
        <xs:annotation>
          <xs:documentation>Элемент терминологии является "архивным" (более не используется)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS6aQ.SQ68Ys92ctgfBm748.c-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/document" version="1.0" xmlns:ns1="http://emias.mos.ru/simi/core" xmlns:ns2="http://emias.mos.ru/simi/cct" xmlns:ns3="http://www.w3.org/2000/09/xmldsig#" xmlns:tns="http://emias.mos.ru/simi/document" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS6EDzwccaJRteXLHTFcwI4Ao-"/>
  <xs:import namespace="http://emias.mos.ru/simi/cct" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS66.lWJ3w7WcmLguHISsY1Dw-"/>
  <xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS7lxe83LPteOuucV7fAIoiGc-"/>
  <!--reusable elements-->
  <xs:element name="document" nillable="false" type="tns:Document">
    <xs:annotation>
      <xs:documentation>Документ СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="documentId" nillable="false" type="xs:string">
    <xs:annotation>
      <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="data" type="xs:base64Binary">
    <xs:annotation>
      <xs:documentation>Контент Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--document entity and its main sections-->
  <xs:complexType name="Document">
    <xs:annotation>
      <xs:documentation>Представляет Документ СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="metadata" type="tns:Metadata">
        <xs:annotation>
          <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="content" type="tns:Content">
        <xs:annotation>
          <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="signature" type="tns:Signature">
        <xs:annotation>
          <xs:documentation>Описывает сведения об электронной подписи Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Metadata">
    <xs:annotation>
      <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:documentId">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="documentInfo" type="tns:DocumentInfo">
        <xs:annotation>
          <xs:documentation>Базовые сведения о Документе СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="ns2:visualizations">
        <xs:annotation>
          <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="confidentialityTags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, определяющих уровень конфеденциальности Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="links" type="tns:Links">
        <xs:annotation>
          <xs:documentation>Сведения о междокументарных связях Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="status" type="tns:Status" use="required">
      <xs:annotation>
        <xs:documentation>Статус документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="authorLogin" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Логин пользователя-автора Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signeeLogin" type="xs:string">
      <xs:annotation>
        <xs:documentation>Логин пользователя, подписавшего электронной подписью документ СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Content">
    <xs:annotation>
      <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="visualization" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>XSLT преобразование, использованное при подписании контента Документа СИМИ электронной подписью</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:data">
        <xs:annotation>
          <xs:documentation>Контент Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="mimeClass" type="ns2:MimeClass" use="required">
      <xs:annotation>
        <xs:documentation>MIME-класс, которому принадлежит контент Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="mimeType" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>MIME-тип, которому принадлежит контент Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="valid" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Бизнес признак валидности контента Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Signature">
    <xs:annotation>
      <xs:documentation>Описывает сведения об электронной подписи Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="ns3:Signature">
        <xs:annotation>
          <xs:documentation>Цифровая подпись по стандарту XMLDSig</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="technicalSignature" type="xs:boolean" use="optional">
      <xs:annotation>
        <xs:documentation>Признак (true/false) использования технической подписи для подписания Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signeeLogin" type="xs:string">
      <xs:annotation>
        <xs:documentation>Логин пользователя, подписавшего документ электронной подписью (указывается только при использовании технической подписи, то есть если атрибут technicalSignature=true)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="deprecated" type="xs:dateTime">
      <xs:annotation>
        <xs:documentation>Дата/время аннулирования подписанного документа (указывается только если Документ СИМИ аннулирован то есть его статус установлен в DEPRECATED)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--documents' metadata description elements-->
  <xs:complexType name="CctInfo">
    <xs:annotation>
      <xs:documentation>Сведения о Классе документов СИМИ (определенный терминологией CCT), которому принадлежит данный Документ СИМИ</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="ns1:CodedValue">
        <xs:sequence>
          <xs:element ref="ns2:cctParameters">
            <xs:annotation>
              <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element ref="ns2:contentTypeInfo">
            <xs:annotation>
              <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="DocumentInfo">
    <xs:annotation>
      <xs:documentation>Описывает базовые сведения о Документе СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="ns1:patientId">
        <xs:annotation>
          <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="ns1:careEventId">
        <xs:annotation>
          <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="ns1:careEventStarted">
        <xs:annotation>
          <xs:documentation>Дата/время начала Клинического события</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" ref="ns1:careEventFinished">
        <xs:annotation>
          <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="cctInfo" type="tns:CctInfo">
        <xs:annotation>
          <xs:documentation>Сведения о Классе документов СИМИ (определенный терминологией CCT), которому принадлежит данный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="tags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Тэги Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="documentCreated" type="xs:dateTime" use="required">
      <xs:annotation>
        <xs:documentation>Дата/время создания Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="documentSubmissionSetId" type="xs:string">
      <xs:annotation>
        <xs:documentation>Идентификатор набора документов, которому принадлежит Документ СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="simiVersion" type="xs:unsignedShort" use="required">
      <xs:annotation>
        <xs:documentation>Версия объектной модели Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--enumerations-->
  <xs:simpleType name="Status">
    <xs:annotation>
      <xs:documentation>Представляет перечисление статусов Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="CREATED">
        <xs:annotation>
          <xs:documentation>Созданный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DRAFT">
        <xs:annotation>
          <xs:documentation>Черновик Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGNED">
        <xs:annotation>
          <xs:documentation>Подписанный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATED">
        <xs:annotation>
          <xs:documentation>Аннулированный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ARCHIVED">
        <xs:annotation>
          <xs:documentation>Архивированный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:complexType name="LinkedDocument">
    <xs:annotation>
      <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:documentId">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Links">
    <xs:annotation>
      <xs:documentation>Сведения о междокументарных связях Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="parent" type="tns:LinkedDocument">
        <xs:annotation>
          <xs:documentation>Документ-родитель</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="descendants" type="tns:LinkedDocument">
        <xs:annotation>
          <xs:documentation>Документы-потомки</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELkpnxA2OmeJdFr5KSTYO_Wbv8BkLZmQ6Gh1yaSUR6glVs32MR5qwJs.fv0U3dXOAVXrfrel_oV5FXN1zy.fS7lxe83LPteOuucV7fAIoiGc-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://www.w3.org/2000/09/xmldsig#" version="1.0" xmlns:tns="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="CanonicalizationMethod" type="tns:CanonicalizationMethodType"/>
  <xs:element name="DSAKeyValue" type="tns:DSAKeyValueType"/>
  <xs:element name="DigestMethod" type="tns:DigestMethodType"/>
  <xs:element name="DigestValue" type="tns:DigestValueType"/>
  <xs:element name="HMACOutputLength" type="tns:HMACOutputLengthType"/>
  <xs:element name="KeyInfo" type="tns:KeyInfoType"/>
  <xs:element name="KeyName" type="xs:string"/>
  <xs:element name="KeyValue" type="tns:KeyValueType"/>
  <xs:element name="Manifest" type="tns:ManifestType"/>
  <xs:element name="MgmtData" type="xs:string"/>
  <xs:element name="Object" type="tns:ObjectType"/>
  <xs:element name="PGPData" type="tns:PGPDataType"/>
  <xs:element name="PGPKeyID" type="xs:base64Binary"/>
  <xs:element name="PGPKeyPacket" type="xs:base64Binary"/>
  <xs:element name="RSAKeyValue" type="tns:RSAKeyValueType"/>
  <xs:element name="Reference" type="tns:ReferenceType"/>
  <xs:element name="RetrievalMethod" type="tns:RetrievalMethodType"/>
  <xs:element name="SPKIData" type="tns:SPKIDataType"/>
  <xs:element name="SPKISexp" type="xs:base64Binary"/>
  <xs:element name="Signature" type="tns:SignatureType"/>
  <xs:element name="SignatureMethod" type="tns:SignatureMethodType"/>
  <xs:element name="SignatureProperties" type="tns:SignaturePropertiesType"/>
  <xs:element name="SignatureProperty" type="tns:SignaturePropertyType"/>
  <xs:element name="SignatureValue" type="tns:SignatureValueType"/>
  <xs:element name="SignedInfo" type="tns:SignedInfoType"/>
  <xs:element name="Transform" type="tns:TransformType"/>
  <xs:element name="Transforms" type="tns:TransformsType"/>
  <xs:element name="X509CRL" type="xs:base64Binary"/>
  <xs:element name="X509Certificate" type="xs:base64Binary"/>
  <xs:element name="X509Data" type="tns:X509DataType"/>
  <xs:element name="X509IssuerSerial" type="tns:X509IssuerSerialType"/>
  <xs:element name="X509SKI" type="xs:base64Binary"/>
  <xs:element name="X509SubjectName" type="xs:string"/>
  <xs:element name="XPath" type="xs:string"/>
  <xs:complexType mixed="true" name="ObjectType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
    <xs:attribute name="MimeType" type="xs:string"/>
    <xs:attribute name="Encoding" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="ManifestType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="Reference" type="tns:ReferenceType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="ReferenceType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="Transforms" type="tns:TransformsType"/>
      <xs:element form="qualified" name="DigestMethod" type="tns:DigestMethodType"/>
      <xs:element form="qualified" name="DigestValue" type="xs:base64Binary"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
    <xs:attribute name="URI" type="xs:anyURI"/>
    <xs:attribute name="Type" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="TransformsType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="Transform" type="tns:TransformType"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="TransformType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:XPath"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="DigestMethodType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType name="X509DataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:X509Certificate"/>
        <xs:element ref="tns:X509SubjectName"/>
        <xs:element ref="tns:X509CRL"/>
        <xs:element ref="tns:X509IssuerSerial"/>
        <xs:element ref="tns:X509SKI"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="SignedInfoType">
    <xs:sequence>
      <xs:element form="qualified" name="CanonicalizationMethod" type="tns:CanonicalizationMethodType"/>
      <xs:element form="qualified" name="SignatureMethod" type="tns:SignatureMethodType"/>
      <xs:element form="qualified" maxOccurs="unbounded" name="Reference" type="tns:ReferenceType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="CanonicalizationMethodType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="SignatureMethodType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:HMACOutputLength"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType name="PGPDataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:PGPKeyID"/>
        <xs:element ref="tns:PGPKeyPacket"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="KeyInfoType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:X509Data"/>
        <xs:element ref="tns:KeyValue"/>
        <xs:element ref="tns:RetrievalMethod"/>
        <xs:element ref="tns:KeyName"/>
        <xs:element ref="tns:MgmtData"/>
        <xs:element ref="tns:PGPData"/>
        <xs:element ref="tns:SPKIData"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="SignatureType">
    <xs:sequence>
      <xs:element form="qualified" name="SignedInfo" type="tns:SignedInfoType"/>
      <xs:element form="qualified" name="SignatureValue" type="tns:SignatureValueType"/>
      <xs:element form="qualified" minOccurs="0" name="KeyInfo" type="tns:KeyInfoType"/>
      <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="Object" type="tns:ObjectType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="SignatureValueType">
    <xs:simpleContent>
      <xs:extension base="xs:base64Binary">
        <xs:attribute name="Id" type="xs:ID"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="SPKIDataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:SPKISexp"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="KeyValueType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:DSAKeyValue"/>
        <xs:element ref="tns:RSAKeyValue"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="HMACOutputLengthType">
    <xs:restriction base="xs:integer"/>
  </xs:simpleType>
  <xs:complexType name="X509IssuerSerialType">
    <xs:sequence>
      <xs:element form="qualified" name="X509IssuerName" type="xs:string"/>
      <xs:element form="qualified" name="X509SerialNumber" type="xs:integer"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DSAKeyValueType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="P" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="Q" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="G" type="xs:base64Binary"/>
      <xs:element form="qualified" name="Y" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="J" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="Seed" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="PgenCounter" type="xs:base64Binary"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="RetrievalMethodType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="Transforms" type="tns:TransformsType"/>
    </xs:sequence>
    <xs:attribute name="URI" type="xs:anyURI"/>
    <xs:attribute name="Type" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="SignaturePropertiesType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="SignatureProperty" type="tns:SignaturePropertyType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="SignaturePropertyType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Target" type="xs:anyURI" use="required"/>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="RSAKeyValueType">
    <xs:sequence>
      <xs:element form="qualified" name="Modulus" type="xs:base64Binary"/>
      <xs:element form="qualified" name="Exponent" type="xs:base64Binary"/>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="DigestValueType">
    <xs:restriction base="xs:base64Binary"/>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint></con:endpoints><con:operation id="fb9669c8-fea1-4b6d-9283-f782e2213415" isOneWay="false" action="" name="archiveDocument" bindingOperationName="archiveDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="a33a463b-aece-434f-95e9-d60218d248da" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:archiveDocument>\r
         <doc:documentId>?</doc:documentId>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:archiveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/archiveDocument"/></con:call></con:operation><con:operation id="f433cb56-34c9-4bcf-9d96-68418c49f239" isOneWay="false" action="" name="createDocument" bindingOperationName="createDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="6202742e-59bd-4a6b-a7e7-a7e39222e25c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>?</cct:cctCode>\r
         <core:patientId>?</core:patientId>\r
         <core:careEventId>?</core:careEventId>\r
         <core:careEventStarted>?</core:careEventStarted>\r
         <!--Optional:-->\r
         <core:careEventFinished>?</core:careEventFinished>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/createDocument"/></con:call></con:operation><con:operation id="ac22857f-bd5b-47e1-84e2-aeede773094a" isOneWay="false" action="" name="deprecateDocument" bindingOperationName="deprecateDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="9493d16a-e4b4-4ecc-a8cc-d1411c36c6e6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:deprecateDocument>\r
         <doc:documentId>?</doc:documentId>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:deprecateDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/deprecateDocument"/></con:call></con:operation><con:operation id="83a3c569-0779-49bc-ba6e-e9be0f73c1be" isOneWay="false" action="" name="getAuditRecords" bindingOperationName="getAuditRecords" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3bbd406f-9a37-45e6-bb52-58546f66109a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getAuditRecords>\r
         <params>\r
            <typ:conditions>\r
               <!--1 or more repetitions:-->\r
               <typ:condition operator="?">\r
                  <typ:leftOperand>?</typ:leftOperand>\r
                  <typ:rightOperand>?</typ:rightOperand>\r
               </typ:condition>\r
            </typ:conditions>\r
            <!--Optional:-->\r
            <typ:orderClauses>\r
               <!--Zero or more repetitions:-->\r
               <typ:orderClause ascending="?">\r
                  <typ:attributeName>?</typ:attributeName>\r
               </typ:orderClause>\r
            </typ:orderClauses>\r
         </params>\r
         <!--Optional:-->\r
         <core:pagingOptions pageNumber="?" pageSize="?"/>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:getAuditRecords>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getAuditRecords"/></con:call></con:operation><con:operation id="367d6dc3-700d-4723-a826-b1c54ee35e9c" isOneWay="false" action="" name="getCareEventDocuments" bindingOperationName="getCareEventDocuments" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="c229d659-37d8-41c6-97f4-a2a6a314f79d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getCareEventDocuments>\r
         <core:careEventId>?</core:careEventId>\r
         <!--Optional:-->\r
         <cct:cctCode>?</cct:cctCode>\r
         <!--Optional:-->\r
         <core:pagingOptions pageNumber="?" pageSize="?"/>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:getCareEventDocuments>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocuments"/></con:call></con:operation><con:operation id="2e541830-72dc-4859-a446-787b882c09fc" isOneWay="false" action="" name="getCareEventDocumentsForSign" bindingOperationName="getCareEventDocumentsForSign" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="936751bf-348e-40ff-a877-7a7284f3b1a6" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getCareEventDocumentsForSign>\r
         <core:careEventId>?</core:careEventId>\r
         <!--Optional:-->\r
         <core:pagingOptions pageNumber="?" pageSize="?"/>\r
      </typ:getCareEventDocumentsForSign>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getCareEventDocumentsForSign"/></con:call></con:operation><con:operation id="20f64fee-7c2a-4c15-afbc-9da446609602" isOneWay="false" action="" name="getDocument" bindingOperationName="getDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="c00bb062-0679-45ae-9709-c1b635c345fe" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>?</doc:documentId>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocument"/></con:call></con:operation><con:operation id="8bf0dcd8-9b89-46dc-ad7c-9af87da02a1d" isOneWay="false" action="" name="getDocumentsByPatientForSign" bindingOperationName="getDocumentsByPatientForSign" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="61af7ab3-e465-44d3-bfbf-0cb792930fb1" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getDocumentsByPatientForSign>\r
         <core:patientId>?</core:patientId>\r
         <!--Optional:-->\r
         <core:pagingOptions pageNumber="?" pageSize="?"/>\r
      </typ:getDocumentsByPatientForSign>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsByPatientForSign"/></con:call></con:operation><con:operation id="ff50281b-422c-4643-bcb3-50e40e692692" isOneWay="false" action="" name="getDocumentsForSign" bindingOperationName="getDocumentsForSign" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="377ebac0-d00c-43ea-8c20-30bb8cf07905" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getDocumentsForSign>\r
         <!--Zero or more repetitions:-->\r
         <doc:documentId>?</doc:documentId>\r
         <!--Optional:-->\r
         <core:pagingOptions pageNumber="?" pageSize="?"/>\r
      </typ:getDocumentsForSign>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/getDocumentsForSign"/></con:call></con:operation><con:operation id="cd93c95e-c7e3-4f1d-a8c9-26ae9ea80e14" isOneWay="false" action="" name="saveDocument" bindingOperationName="saveDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2e2c2c1d-e35d-4087-af15-fa1305fe1dd2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:xd="http://www.w3.org/2000/09/xmldsig#">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="?" authorLogin="?" signeeLogin="?">\r
               <doc:documentId>?</doc:documentId>\r
               <doc:documentInfo documentCreated="?" documentSubmissionSetId="?" simiVersion="?">\r
                  <core:patientId>?</core:patientId>\r
                  <core:careEventId>?</core:careEventId>\r
                  <core:careEventStarted>?</core:careEventStarted>\r
                  <!--Optional:-->\r
                  <core:careEventFinished>?</core:careEventFinished>\r
                  <doc:cctInfo>\r
                     <schema>?</schema>\r
                     <code>?</code>\r
                     <description>?</description>\r
                     <cct:cctParameters>\r
                        <!--Zero or more repetitions:-->\r
                        <entry key="?">?</entry>\r
                     </cct:cctParameters>\r
                     <cct:contentTypeInfo mimeClass="?">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>?</mimeType>\r
                     </cct:contentTypeInfo>\r
                  </doc:cctInfo>\r
                  <tags>\r
                     <!--Zero or more repetitions:-->\r
                     <tag definedByCct="?">\r
                        <schema>?</schema>\r
                        <code>?</code>\r
                        <description>?</description>\r
                     </tag>\r
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>\r
                  <!--Zero or more repetitions:-->\r
                  <visualization>\r
                     <!--Optional:-->\r
                     <cct:visualizationId>?</cct:visualizationId>\r
                     <cct:cctCode>?</cct:cctCode>\r
                     <visualizationInfo name="?" description="?" xsltVersion="?" signature="?">\r
                        <cct:tags>\r
                           <!--Zero or more repetitions:-->\r
                           <tag definedByCct="?">\r
                              <schema>?</schema>\r
                              <code>?</code>\r
                              <description>?</description>\r
                           </tag>\r
                        </cct:tags>\r
                     </visualizationInfo>\r
                     <!--Optional:-->\r
                     <visualizationData>cid:1259691633550</visualizationData>\r
                  </visualization>\r
               </cct:visualizations>\r
               <confidentialityTags>\r
                  <!--Zero or more repetitions:-->\r
                  <tag definedByCct="?">\r
                     <schema>?</schema>\r
                     <code>?</code>\r
                     <description>?</description>\r
                  </tag>\r
               </confidentialityTags>\r
               <links>\r
                  <!--Optional:-->\r
                  <parent>\r
                     <doc:documentId>?</doc:documentId>\r
                  </parent>\r
                  <!--Zero or more repetitions:-->\r
                  <descendants>\r
                     <doc:documentId>?</doc:documentId>\r
                  </descendants>\r
               </links>\r
            </metadata>\r
            <doc:content mimeClass="?" mimeType="?" valid="?">\r
               <!--Optional:-->\r
               <doc:visualization>cid:991413906471</doc:visualization>\r
               <doc:data>cid:739092548871</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="?" signeeLogin="?" deprecated="?">\r
               <!--Optional:-->\r
               <xd:Signature Id="?">\r
                  <xd:SignedInfo Id="?">\r
                     <xd:CanonicalizationMethod Algorithm="?">\r
                        e\r
                        <!--You may enter ANY elements at this point-->\r
                        gero\r
                     </xd:CanonicalizationMethod>\r
                     <xd:SignatureMethod Algorithm="?">\r
                        cum\r
                        <!--You have a CHOICE of the next 2 items at this level-->\r
                        <xd:HMACOutputLength>?</xd:HMACOutputLength>\r
                        <!--You may enter ANY elements at this point-->\r
                        sonoras\r
                     </xd:SignatureMethod>\r
                     <!--1 or more repetitions:-->\r
                     <xd:Reference Id="?" URI="?" Type="?">\r
                        <!--Optional:-->\r
                        <xd:Transforms>\r
                           <!--1 or more repetitions:-->\r
                           <xd:Transform Algorithm="?">\r
                              aeoliam\r
                              <!--You have a CHOICE of the next 2 items at this level-->\r
                              <xd:XPath>?</xd:XPath>\r
                              <!--You may enter ANY elements at this point-->\r
                              quae\r
                           </xd:Transform>\r
                        </xd:Transforms>\r
                        <xd:DigestMethod Algorithm="?">\r
                           ventos\r
                           <!--You may enter ANY elements at this point-->\r
                           verrantque\r
                        </xd:DigestMethod>\r
                        <xd:DigestValue>cid:161777535695</xd:DigestValue>\r
                     </xd:Reference>\r
                  </xd:SignedInfo>\r
                  <xd:SignatureValue Id="?">cid:548566613950</xd:SignatureValue>\r
                  <!--Optional:-->\r
                  <xd:KeyInfo Id="?">\r
                     temperat\r
                     <!--You have a CHOICE of the next 8 items at this level-->\r
                     <xd:X509Data>\r
                        <!--You have a CHOICE of the next 6 items at this level-->\r
                        <xd:X509Certificate>cid:396101101215</xd:X509Certificate>\r
                        <xd:X509SubjectName>?</xd:X509SubjectName>\r
                        <xd:X509CRL>cid:1568977188643</xd:X509CRL>\r
                        <xd:X509IssuerSerial>\r
                           <xd:X509IssuerName>?</xd:X509IssuerName>\r
                           <xd:X509SerialNumber>?</xd:X509SerialNumber>\r
                        </xd:X509IssuerSerial>\r
                        <xd:X509SKI>cid:1357125697382</xd:X509SKI>\r
                        <!--You may enter ANY elements at this point-->\r
                     </xd:X509Data>\r
                     <xd:KeyValue>\r
                        per\r
                        <!--You have a CHOICE of the next 3 items at this level-->\r
                        <xd:DSAKeyValue>\r
                           <!--Optional:-->\r
                           <xd:P>cid:1412298240454</xd:P>\r
                           <!--Optional:-->\r
                           <xd:Q>cid:362246450028</xd:Q>\r
                           <!--Optional:-->\r
                           <xd:G>cid:1602327139882</xd:G>\r
                           <xd:Y>cid:1514063995132</xd:Y>\r
                           <!--Optional:-->\r
                           <xd:J>cid:1376190309608</xd:J>\r
                           <!--Optional:-->\r
                           <xd:Seed>cid:1451074153829</xd:Seed>\r
                           <!--Optional:-->\r
                           <xd:PgenCounter>cid:376804569625</xd:PgenCounter>\r
                        </xd:DSAKeyValue>\r
                        <xd:RSAKeyValue>\r
                           <xd:Modulus>cid:572653399059</xd:Modulus>\r
                           <xd:Exponent>cid:247822582692</xd:Exponent>\r
                        </xd:RSAKeyValue>\r
                        <!--You may enter ANY elements at this point-->\r
                        turbine\r
                     </xd:KeyValue>\r
                     <xd:RetrievalMethod URI="?" Type="?">\r
                        <!--Optional:-->\r
                        <xd:Transforms>\r
                           <!--1 or more repetitions:-->\r
                           <xd:Transform Algorithm="?">\r
                              circum\r
                              <!--You have a CHOICE of the next 2 items at this level-->\r
                              <xd:XPath>?</xd:XPath>\r
                              <!--You may enter ANY elements at this point-->\r
                              regemque\r
                           </xd:Transform>\r
                        </xd:Transforms>\r
                     </xd:RetrievalMethod>\r
                     <xd:KeyName>?</xd:KeyName>\r
                     <xd:MgmtData>?</xd:MgmtData>\r
                     <xd:PGPData>\r
                        <!--You have a CHOICE of the next 3 items at this level-->\r
                        <xd:PGPKeyID>cid:834671874091</xd:PGPKeyID>\r
                        <xd:PGPKeyPacket>cid:388572863429</xd:PGPKeyPacket>\r
                        <!--You may enter ANY elements at this point-->\r
                     </xd:PGPData>\r
                     <xd:SPKIData>\r
                        <!--You have a CHOICE of the next 2 items at this level-->\r
                        <xd:SPKISexp>cid:750091384544</xd:SPKISexp>\r
                        <!--You may enter ANY elements at this point-->\r
                     </xd:SPKIData>\r
                     <!--You may enter ANY elements at this point-->\r
                     nimborum\r
                  </xd:KeyInfo>\r
                  <!--Zero or more repetitions:-->\r
                  <xd:Object Id="?" MimeType="?" Encoding="?">\r
                     fremunt\r
                     <!--You may enter ANY elements at this point-->\r
                     foedere\r
                  </xd:Object>\r
               </xd:Signature>\r
            </doc:signature>\r
         </doc:document>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/saveDocument"/></con:call></con:operation><con:operation id="89652c83-413e-45d8-ab3f-43c950c0ab6a" isOneWay="false" action="" name="searchDocuments" bindingOperationName="searchDocuments" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="094ae114-998b-4412-aed4-3432744e598c" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:searchDocuments>\r
         <!--Optional:-->\r
         <queryName>?</queryName>\r
         <params>\r
            <!--Optional:-->\r
            <typ:conditions>\r
               <!--Zero or more repetitions:-->\r
               <typ:condition operator="?">\r
                  <typ:leftOperand>?</typ:leftOperand>\r
                  <typ:rightOperand>?</typ:rightOperand>\r
               </typ:condition>\r
            </typ:conditions>\r
            <!--Optional:-->\r
            <typ:orderClauses>\r
               <!--Zero or more repetitions:-->\r
               <typ:orderClause ascending="?">\r
                  <typ:attributeName>?</typ:attributeName>\r
               </typ:orderClause>\r
            </typ:orderClauses>\r
         </params>\r
         <!--Optional:-->\r
         <core:pagingOptions pageNumber="?" pageSize="?"/>\r
         <!--Optional:-->\r
         <core:options>\r
            <!--Zero or more repetitions:-->\r
            <entry key="?">?</entry>\r
         </core:options>\r
      </typ:searchDocuments>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/v4/simiService/ISimiService/searchDocuments"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="942d1a2e-a24f-4f97-bc66-f9c9a27c51b1" wsaVersion="NONE" name="OpenEhrServiceV4PortBinding" type="wsdl" bindingName="{http://emias.mos.ru/simi/v4/openEhrService}OpenEhrServiceV4PortBinding" soapVersion="1_1" anonymous="optional" definition="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl"><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--Generated by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.3.1 (UNKNOWN_BRANCH-false; 2015-01-15T16:53:43+0100) JAXWS-RI/2.2.10 JAXWS-API/2.2.11 JAXB-RI/2.2.10-b140802.1033 JAXB-API/2.2.12-b140109.1041 svn-revision#unknown.-->
<definitions name="OpenEhrServiceV4" targetNamespace="http://emias.mos.ru/simi/v4/openEhrService" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:cet="http://emias.mos.ru/simi/v4/openEhrService/types" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://emias.mos.ru/simi/v4/openEhrService" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsp1_2="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <types>
    <xsd:schema>
      <xsd:import namespace="http://emias.mos.ru/simi/v4/openEhrService/types" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxuSkaM09Tnwic4yz7WJaMB7k-"/>
    </xsd:schema>
  </types>
  <message name="simiFaultException">
    <part element="cet:simiFaultException" name="fault"/>
  </message>
  <message name="convertBase64TddToJson">
    <part element="cet:convertBase64TddToJson" name="parameters"/>
  </message>
  <message name="convertBase64TddToJsonResponse">
    <part element="cet:convertBase64TddToJsonResponse" name="parameters"/>
  </message>
  <message name="convertJsonToBase64Tdd">
    <part element="cet:convertJsonToBase64Tdd" name="parameters"/>
  </message>
  <message name="convertJsonToBase64TddResponse">
    <part element="cet:convertJsonToBase64TddResponse" name="parameters"/>
  </message>
  <message name="getTDS">
    <part element="cet:getTDS" name="parameters"/>
  </message>
  <message name="getTDSResponse">
    <part element="cet:getTDSResponse" name="parameters"/>
  </message>
  <message name="getExampleTDD">
    <part element="cet:getExampleTDD" name="parameters"/>
  </message>
  <message name="getExampleTDDResponse">
    <part element="cet:getExampleTDDResponse" name="parameters"/>
  </message>
  <message name="getTemplateList">
    <part element="cet:getTemplateList" name="parameters"/>
  </message>
  <message name="getTemplateListResponse">
    <part element="cet:getTemplateListResponse" name="parameters"/>
  </message>
  <message name="getWebTemplate">
    <part element="cet:getWebTemplate" name="parameters"/>
  </message>
  <message name="getWebTemplateResponse">
    <part element="cet:getWebTemplateResponse" name="parameters"/>
  </message>
  <message name="convertJsonToTdd">
    <part element="cet:convertJsonToTdd" name="parameters"/>
  </message>
  <message name="convertJsonToTddResponse">
    <part element="cet:convertJsonToTddResponse" name="parameters"/>
  </message>
  <message name="convertTddToJson">
    <part element="cet:convertTddToJson" name="parameters"/>
  </message>
  <message name="convertTddToJsonResponse">
    <part element="cet:convertTddToJsonResponse" name="parameters"/>
  </message>
  <portType name="IOpenEhrService">
    <operation name="convertBase64TddToJson">
      <input message="tns:convertBase64TddToJson" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertBase64TddToJson"/>
      <output message="tns:convertBase64TddToJsonResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertBase64TddToJsonResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertBase64TddToJson/Fault/SimiFaultException"/>
    </operation>
    <operation name="convertJsonToBase64Tdd">
      <input message="tns:convertJsonToBase64Tdd" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToBase64Tdd"/>
      <output message="tns:convertJsonToBase64TddResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToBase64TddResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToBase64Tdd/Fault/SimiFaultException"/>
    </operation>
    <operation name="getTDS">
      <input message="tns:getTDS" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTDS"/>
      <output message="tns:getTDSResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTDSResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTDS/Fault/SimiFaultException"/>
    </operation>
    <operation name="getExampleTDD">
      <input message="tns:getExampleTDD" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getExampleTDD"/>
      <output message="tns:getExampleTDDResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getExampleTDDResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getExampleTDD/Fault/SimiFaultException"/>
    </operation>
    <operation name="getTemplateList">
      <input message="tns:getTemplateList" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTemplateList"/>
      <output message="tns:getTemplateListResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTemplateListResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTemplateList/Fault/SimiFaultException"/>
    </operation>
    <operation name="getWebTemplate">
      <input message="tns:getWebTemplate" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getWebTemplate"/>
      <output message="tns:getWebTemplateResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getWebTemplateResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getWebTemplate/Fault/SimiFaultException"/>
    </operation>
    <operation name="convertJsonToTdd">
      <input message="tns:convertJsonToTdd" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToTdd"/>
      <output message="tns:convertJsonToTddResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToTddResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToTdd/Fault/SimiFaultException"/>
    </operation>
    <operation name="convertTddToJson">
      <input message="tns:convertTddToJson" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertTddToJson"/>
      <output message="tns:convertTddToJsonResponse" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertTddToJsonResponse"/>
      <fault message="tns:simiFaultException" name="SimiFaultException" wsam:Action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertTddToJson/Fault/SimiFaultException"/>
    </operation>
  </portType>
  <binding name="OpenEhrServiceV4PortBinding" type="tns:IOpenEhrService">
    <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsp:PolicyReference URI="#UP_policy"/>
    <operation name="convertBase64TddToJson">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="convertJsonToBase64Tdd">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getTDS">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getExampleTDD">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getTemplateList">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="getWebTemplate">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="convertJsonToTdd">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
    <operation name="convertTddToJson">
      <soap:operation soapAction=""/>
      <input>
        <soap:body use="literal"/>
      </input>
      <output>
        <soap:body use="literal"/>
      </output>
      <fault name="SimiFaultException">
        <soap:fault name="SimiFaultException" use="literal"/>
      </fault>
    </operation>
  </binding>
  <service name="OpenEhrServiceV4">
    <wsp:PolicyReference URI="#UP_policy"/>
    <port binding="tns:OpenEhrServiceV4PortBinding" name="OpenEhrServiceV4Port">
      <soap:address location="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService"/>
    </port>
  </service>
  <wsp:Policy wsu:Id="UP_policy">
    <sp:SupportingTokens xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy>
        <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
          <wsp:Policy>
            <sp:WssUsernameToken11/>
          </wsp:Policy>
        </sp:UsernameToken>
      </wsp:Policy>
    </sp:SupportingTokens>
  </wsp:Policy>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxuSkaM09Tnwic4yz7WJaMB7k-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/v4/openEhrService/types" version="1.0" xmlns:ns1="http://emias.mos.ru/simi/core" xmlns:ns3="http://emias.mos.ru/simi/document" xmlns:ns4="http://emias.mos.ru/simi/cct" xmlns:tns="http://emias.mos.ru/simi/v4/openEhrService/types" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvvaYV5uP64lwm0_4tGhn72g-"/>
  <xs:import namespace="http://emias.mos.ru/simi/cct" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvQx0tT_1AmQXw3VP02jYiqM-"/>
  <xs:import namespace="http://emias.mos.ru/simi/document" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvx7D9gemTNJSU1mVlpfyzC4-"/>
  <xs:element name="templateId" type="xs:string">
    <xs:annotation>
      <xs:documentation>Идентификатор шаблона (Template)</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="structuredJson" type="xs:string">
    <xs:annotation>
      <xs:documentation>Структурированный Документ (Composition) в Json представлении</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="webTemplate" type="xs:string">
    <xs:annotation>
      <xs:documentation>Шаблон (Template) в представлении адаптированном для Web</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="compositionTdd" type="xs:string">
    <xs:annotation>
      <xs:documentation>Структурированный Документ (Composition) в TDD представлении</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="base64CompositionTdd" type="xs:base64Binary">
    <xs:annotation>
      <xs:documentation>Base64 структурированного Документа (Composition) в TDD представлении</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="compositionData" type="tns:CompositionData">
    <xs:annotation>
      <xs:documentation>Данные о структурированном Документе(Composition)</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="CompositionData">
    <xs:annotation>
      <xs:documentation>Данные о структурированном Документе(Composition)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:templateId"/>
      <xs:element ref="tns:structuredJson"/>
      <xs:element ref="tns:webTemplate"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="TemplateInfoCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию структур базовой информации о шаблоне (Template)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="templateInfo" type="tns:TemplateInfo">
        <xs:annotation>
          <xs:documentation>Описание структуры базовой информации о шаблоне (Template)</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="TemplateInfo">
    <xs:annotation>
      <xs:documentation>Описание структуры базовой информации о шаблоне (Template)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="concept" type="xs:string">
        <xs:annotation>
          <xs:documentation>Название шаблона</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:templateId"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="SchemaFile">
    <xs:annotation>
      <xs:documentation>Описание файла схемы</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="content" type="xs:string">
        <xs:annotation>
          <xs:documentation>Содержимое файла</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="filename" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Название файла</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--requests & responses-->
  <xs:element name="simiFaultException" nillable="true" type="ns1:SimiFaultInfo">
    <xs:annotation>
      <xs:documentation>Ошибка</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="convertBase64TddToJson">
    <xs:annotation>
      <xs:documentation>Входные параметры метода convertBase64TddToJson</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода convertBase64TddToJson</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:base64CompositionTdd"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertBase64TddToJsonResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода convertBase64TddToJson</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода convertBase64TddToJson</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:compositionData"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertJsonToBase64Tdd">
    <xs:annotation>
      <xs:documentation>Входные параметры метода convertJsonToBase64Tdd</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода convertJsonToBase64Tdd</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:templateId"/>
        <xs:element ref="tns:structuredJson"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertJsonToBase64TddResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода convertJsonToBase64Tdd</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода convertJsonToBase64Tdd</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:base64CompositionTdd"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertJsonToTdd">
    <xs:annotation>
      <xs:documentation>Входные параметры метода convertJsonToTdd</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода convertJsonToTdd</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:templateId"/>
        <xs:element ref="tns:structuredJson"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertJsonToTddResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода convertJsonToTdd</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода convertJsonToTdd</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:compositionTdd"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertTddToJson">
    <xs:annotation>
      <xs:documentation>Входные параметры метода convertTddToJson</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода convertTddToJson</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:compositionTdd"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="convertTddToJsonResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода convertTddToJson</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода convertTddToJson</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:compositionData"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getExampleTDD">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getExampleTDD</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getExampleTDD</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:templateId"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getExampleTDDResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getExampleTDD</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getExampleTDD</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element form="qualified" name="content" type="ns3:Content">
          <xs:annotation>
            <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getTDS">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getTDS</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getTDS</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:templateId"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getTDSResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getTDS</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getTDS</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" name="schemaFile" type="tns:SchemaFile">
          <xs:annotation>
            <xs:documentation>Описание файла схемы</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getTemplateList">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getTemplateList</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getTemplateList</xs:documentation>
      </xs:annotation>
      <xs:sequence/>
    </xs:complexType>
  </xs:element>
  <xs:element name="getTemplateListResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getTemplateList</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getTemplateList</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:TemplateInfoCollection">
          <xs:annotation>
            <xs:documentation>Представляет коллекцию структур базовой информации о шаблоне (Template)</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getWebTemplate">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getWebTemplate</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getWebTemplate</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:templateId"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getWebTemplateResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getWebTemplate</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getWebTemplate</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="tns:webTemplate"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvvaYV5uP64lwm0_4tGhn72g-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/core" version="1.0" xmlns:tns="http://emias.mos.ru/simi/core" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <!--business entities which don't belong to SIMI services-->
  <xs:element name="patientId" type="xs:long">
    <xs:annotation>
      <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventId" type="xs:long">
    <xs:annotation>
      <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventStarted" type="xs:dateTime">
    <xs:annotation>
      <xs:documentation>Дата/время начала Клинического события</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventFinished" type="xs:dateTime">
    <xs:annotation>
      <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--calling methods' options-->
  <xs:element name="options" type="tns:Options">
    <xs:annotation>
      <xs:documentation>Параметры вызова метода</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="Options">
    <xs:annotation>
      <xs:documentation>Набор именованных значений</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="entry" type="tns:KeyValuePair">
        <xs:annotation>
          <xs:documentation>Именованное значение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <!--error description-->
  <xs:complexType name="SimiFaultInfo">
    <xs:annotation>
      <xs:documentation>Описание ошибки вызова метода</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="contextEntries">
        <xs:annotation>
          <xs:documentation>Параметры контекста возникновения ошибки</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Параметры контекста возникновения ошибки</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="entry">
              <xs:annotation>
                <xs:documentation>Параметр контекста возникновения ошибки</xs:documentation>
              </xs:annotation>
              <xs:complexType>
                <xs:annotation>
                  <xs:documentation>Параметр контекста возникновения ошибки</xs:documentation>
                </xs:annotation>
                <xs:sequence>
                  <xs:element minOccurs="0" name="key" type="xs:anyType">
                    <xs:annotation>
                      <xs:documentation>Название параметра контекста возникновения ошибки</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                  <xs:element minOccurs="0" name="value" type="xs:anyType">
                    <xs:annotation>
                      <xs:documentation>Значение параметра контекста возникновения ошибк</xs:documentation>
                    </xs:annotation>
                  </xs:element>
                </xs:sequence>
              </xs:complexType>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element minOccurs="0" name="stackTrace" type="xs:string">
        <xs:annotation>
          <xs:documentation>Стек-трейс</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="message" type="xs:string">
        <xs:annotation>
          <xs:documentation>Сообщение об ошибке</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="errorCode" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Код ошибки</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--pagination-->
  <xs:element name="pagingOptions" type="tns:PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType abstract="true" name="PagingResults">
    <xs:annotation>
      <xs:documentation>Список с пагинацией</xs:documentation>
    </xs:annotation>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageTotal" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Общее количество страниц</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="morePagesAvailable" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Флаг доступности других страниц с результатами для "постраничного листания" (true - если доступны еще страницы; false - иначе)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--base types-->
  <xs:complexType name="Tag">
    <xs:annotation>
      <xs:documentation>Представляет "Тэг"</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CodedValue">
        <xs:attribute name="definedByCct" type="xs:boolean" use="required">
          <xs:annotation>
            <xs:documentation>Признак принадлежности Тэга к взятым из CCT терминологии Тэгам</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="TagCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию "Тэгов"</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="tag" type="tns:Tag">
        <xs:annotation>
          <xs:documentation>Представляет "Тэг"</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="KeyValuePair">
    <xs:annotation>
      <xs:documentation>Представляет базовый тип "ключ/значение"</xs:documentation>
    </xs:annotation>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="key" type="xs:string" use="required">
          <xs:annotation>
            <xs:documentation>Ключ</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="CodedValue">
    <xs:annotation>
      <xs:documentation>Представляет базовый тип элемента терминологии</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="schema" type="xs:string">
        <xs:annotation>
          <xs:documentation>Идентификатор терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="description" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="ComparisonType">
    <xs:annotation>
      <xs:documentation>Представляет перечисление типов сравнения значений</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="GT">
        <xs:annotation>
          <xs:documentation>Сравнение "больше чем"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="GE">
        <xs:annotation>
          <xs:documentation>Сравнение "больше или равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="EQ">
        <xs:annotation>
          <xs:documentation>Сравнение "в точности равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LT">
        <xs:annotation>
          <xs:documentation>Сравнение "меньше чем"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LE">
        <xs:annotation>
          <xs:documentation>Сравнение "меньше или равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LIKE">
        <xs:annotation>
          <xs:documentation>Сравнение по подстроке</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="NE">
        <xs:annotation>
          <xs:documentation>Сравнение "не равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvQx0tT_1AmQXw3VP02jYiqM-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/cct" version="1.0" xmlns:ns1="http://emias.mos.ru/simi/core" xmlns:tns="http://emias.mos.ru/simi/cct" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvvaYV5uP64lwm0_4tGhn72g-"/>
  <!--reusable elements-->
  <xs:element name="cctCode" nillable="false" type="xs:unsignedInt">
    <xs:annotation>
      <xs:documentation>Код элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctItem" type="tns:CctItem">
    <xs:annotation>
      <xs:documentation>Представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctFolder" type="tns:CctFolder">
    <xs:annotation>
      <xs:documentation>Представление группирующего элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctItemCollection" type="tns:CctItemCollection">
    <xs:annotation>
      <xs:documentation>Набор элементов и группирующих элементов терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctParameters" type="ns1:Options">
    <xs:annotation>
      <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:attribute name="lifecycleState" type="tns:LifecycleState">
    <xs:annotation>
      <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <!--description of cct type-->
  <xs:complexType name="CctItemCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию элементов и группирующих элементов терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="cctFolder" type="tns:CctFolder">
        <xs:annotation>
          <xs:documentation>Набор группирующих элементов терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="cctItem" type="tns:CctItem">
        <xs:annotation>
          <xs:documentation>Набор элементов терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="CctItem">
    <xs:annotation>
      <xs:documentation>Представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CctBase">
        <xs:sequence>
          <xs:element ref="tns:contentTypeInfo">
            <xs:annotation>
              <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element ref="tns:cctParameters">
            <xs:annotation>
              <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="canDeprecateAfterSign" type="xs:boolean" use="optional">
          <xs:annotation>
            <xs:documentation>Признак возможности анулирования Документа СИМИ после его подписания ЭП (если не задан - true)</xs:documentation>
          </xs:annotation>
        </xs:attribute>
        <xs:attribute ref="tns:lifecycleState">
          <xs:annotation>
            <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="CctFolder">
    <xs:annotation>
      <xs:documentation>Представление группирующего элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CctBase"/>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="CctBase">
    <xs:annotation>
      <xs:documentation>Базовое представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="tns:cctCode">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="cctDescription" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="tags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, наследуемых Документом СИМИ, вследствие его принадлежности к Классу документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="confidentialityTags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, определяющих уровень конфиденциальности Документа СИМИ, наследуемых Документом СИМИ, вследствие его принадлежности к Классу документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="parentCode" type="xs:unsignedInt" use="required">
      <xs:annotation>
        <xs:documentation>Код родительского элемента терминологиии CCT</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--content type description-->
  <xs:element name="contentTypeInfo" type="tns:ContentTypeInfo">
    <xs:annotation>
      <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="ContentTypeInfo">
    <xs:annotation>
      <xs:documentation>Описывает сведения о типе контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="mimeType" type="xs:string">
        <xs:annotation>
          <xs:documentation>Коллекция MIME-типов, разрешенных для Класса документов СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="mimeClass" type="tns:MimeClass" use="required">
      <xs:annotation>
        <xs:documentation>MIME-класс, определенный для Класса документов СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="MimeClass">
    <xs:annotation>
      <xs:documentation>Представляет перечисление типов контента Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="APPLICATION">
        <xs:annotation>
          <xs:documentation>Любые двоичные данные</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="AUDIO">
        <xs:annotation>
          <xs:documentation>Аудио</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="IMAGE">
        <xs:annotation>
          <xs:documentation>Изображение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TEXT">
        <xs:annotation>
          <xs:documentation>Текст</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VIDEO">
        <xs:annotation>
          <xs:documentation>Видео</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VND">
        <xs:annotation>
          <xs:documentation>Вендор-зависимый класс контента</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="X">
        <xs:annotation>
          <xs:documentation>Нестандартный подтип, не зарегистрирован в «Центре присвоенных номеров Интернета» (IANA)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--visualization description-->
  <xs:element name="visualizationId" nillable="false" type="xs:string">
    <xs:annotation>
      <xs:documentation>Представляет идентификатор XSLT представления контента Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="visualizations" type="tns:VisualizationCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="VisualizationCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="visualization" type="tns:Visualization">
        <xs:annotation>
          <xs:documentation>Представляет сведения о XSLT преобразовании, которое может быть использовано для визуализации контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Visualization">
    <xs:annotation>
      <xs:documentation>Описывает сведения о XSLT преобразовании, которое может быть использовано для визуализации контента Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="tns:visualizationId">
        <xs:annotation>
          <xs:documentation>Представляет идентификатор XSLT представления контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:cctCode">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="visualizationInfo" type="tns:VisualizationInfo">
        <xs:annotation>
          <xs:documentation>Базовые сведения о XSLT преобразовании</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="visualizationData" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>Данные XSLT преобразования в формате base64</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="VisualizationInfo">
    <xs:annotation>
      <xs:documentation>Описывает базовые сведения о XSLT преобразовании</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="tags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Тэги XSLT преобразования</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="name" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Наименование XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="description" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Описание XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="xsltVersion" type="tns:XsltVersion" use="required">
      <xs:annotation>
        <xs:documentation>Версия спецификации XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signature" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Признак (true/false) возможности использования данного XSLT преобразования для визуализации контента Документа СИМИ при его подписании (истинное значение должен иметь только один элемент списка)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="XsltVersion">
    <xs:annotation>
      <xs:documentation>Представляет перечисление версий спецификаций XSLT преобразований</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="XSLT_1_0">
        <xs:annotation>
          <xs:documentation>Версия 1.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_1_1">
        <xs:annotation>
          <xs:documentation>Версия 1.1</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_2_0">
        <xs:annotation>
          <xs:documentation>Версия 2.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_3_0">
        <xs:annotation>
          <xs:documentation>Версия 3.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="LifecycleState">
    <xs:annotation>
      <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ALPHA">
        <xs:annotation>
          <xs:documentation>Доступ на АРМ врача возможен только у модельеров</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BETA">
        <xs:annotation>
          <xs:documentation>Предоставляется тестовый доступ врачам</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ACTIVE">
        <xs:annotation>
          <xs:documentation>Свободное (промышленное) использование</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATED">
        <xs:annotation>
          <xs:documentation>Элемент терминологии является "архивным" (более не используется)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvx7D9gemTNJSU1mVlpfyzC4-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/document" version="1.0" xmlns:ns1="http://emias.mos.ru/simi/core" xmlns:ns2="http://emias.mos.ru/simi/cct" xmlns:ns3="http://www.w3.org/2000/09/xmldsig#" xmlns:tns="http://emias.mos.ru/simi/document" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvvaYV5uP64lwm0_4tGhn72g-"/>
  <xs:import namespace="http://emias.mos.ru/simi/cct" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxvQx0tT_1AmQXw3VP02jYiqM-"/>
  <xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxuMFBktN6OFO.KzqWemkZJP8-"/>
  <!--reusable elements-->
  <xs:element name="document" nillable="false" type="tns:Document">
    <xs:annotation>
      <xs:documentation>Документ СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="documentId" nillable="false" type="xs:string">
    <xs:annotation>
      <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="data" type="xs:base64Binary">
    <xs:annotation>
      <xs:documentation>Контент Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--document entity and its main sections-->
  <xs:complexType name="Document">
    <xs:annotation>
      <xs:documentation>Представляет Документ СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="metadata" type="tns:Metadata">
        <xs:annotation>
          <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="content" type="tns:Content">
        <xs:annotation>
          <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="signature" type="tns:Signature">
        <xs:annotation>
          <xs:documentation>Описывает сведения об электронной подписи Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Metadata">
    <xs:annotation>
      <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:documentId">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="documentInfo" type="tns:DocumentInfo">
        <xs:annotation>
          <xs:documentation>Базовые сведения о Документе СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="ns2:visualizations">
        <xs:annotation>
          <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="confidentialityTags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, определяющих уровень конфеденциальности Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="links" type="tns:Links">
        <xs:annotation>
          <xs:documentation>Сведения о междокументарных связях Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="status" type="tns:Status" use="required">
      <xs:annotation>
        <xs:documentation>Статус документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="authorLogin" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Логин пользователя-автора Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signeeLogin" type="xs:string">
      <xs:annotation>
        <xs:documentation>Логин пользователя, подписавшего электронной подписью документ СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Content">
    <xs:annotation>
      <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="visualization" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>XSLT преобразование, использованное при подписании контента Документа СИМИ электронной подписью</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:data">
        <xs:annotation>
          <xs:documentation>Контент Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="mimeClass" type="ns2:MimeClass" use="required">
      <xs:annotation>
        <xs:documentation>MIME-класс, которому принадлежит контент Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="mimeType" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>MIME-тип, которому принадлежит контент Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="valid" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Бизнес признак валидности контента Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Signature">
    <xs:annotation>
      <xs:documentation>Описывает сведения об электронной подписи Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="ns3:Signature">
        <xs:annotation>
          <xs:documentation>Цифровая подпись по стандарту XMLDSig</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="technicalSignature" type="xs:boolean" use="optional">
      <xs:annotation>
        <xs:documentation>Признак (true/false) использования технической подписи для подписания Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signeeLogin" type="xs:string">
      <xs:annotation>
        <xs:documentation>Логин пользователя, подписавшего документ электронной подписью (указывается только при использовании технической подписи, то есть если атрибут technicalSignature=true)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="deprecated" type="xs:dateTime">
      <xs:annotation>
        <xs:documentation>Дата/время аннулирования подписанного документа (указывается только если Документ СИМИ аннулирован то есть его статус установлен в DEPRECATED)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--documents' metadata description elements-->
  <xs:complexType name="CctInfo">
    <xs:annotation>
      <xs:documentation>Сведения о Классе документов СИМИ (определенный терминологией CCT), которому принадлежит данный Документ СИМИ</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="ns1:CodedValue">
        <xs:sequence>
          <xs:element ref="ns2:cctParameters">
            <xs:annotation>
              <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element ref="ns2:contentTypeInfo">
            <xs:annotation>
              <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="DocumentInfo">
    <xs:annotation>
      <xs:documentation>Описывает базовые сведения о Документе СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="ns1:patientId">
        <xs:annotation>
          <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="ns1:careEventId">
        <xs:annotation>
          <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="ns1:careEventStarted">
        <xs:annotation>
          <xs:documentation>Дата/время начала Клинического события</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" ref="ns1:careEventFinished">
        <xs:annotation>
          <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="cctInfo" type="tns:CctInfo">
        <xs:annotation>
          <xs:documentation>Сведения о Классе документов СИМИ (определенный терминологией CCT), которому принадлежит данный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="tags" type="ns1:TagCollection">
        <xs:annotation>
          <xs:documentation>Тэги Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="documentCreated" type="xs:dateTime" use="required">
      <xs:annotation>
        <xs:documentation>Дата/время создания Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="documentSubmissionSetId" type="xs:string">
      <xs:annotation>
        <xs:documentation>Идентификатор набора документов, которому принадлежит Документ СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="simiVersion" type="xs:unsignedShort" use="required">
      <xs:annotation>
        <xs:documentation>Версия объектной модели Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--enumerations-->
  <xs:simpleType name="Status">
    <xs:annotation>
      <xs:documentation>Представляет перечисление статусов Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="CREATED">
        <xs:annotation>
          <xs:documentation>Созданный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DRAFT">
        <xs:annotation>
          <xs:documentation>Черновик Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGNED">
        <xs:annotation>
          <xs:documentation>Подписанный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATED">
        <xs:annotation>
          <xs:documentation>Аннулированный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ARCHIVED">
        <xs:annotation>
          <xs:documentation>Архивированный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:complexType name="LinkedDocument">
    <xs:annotation>
      <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:documentId">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Links">
    <xs:annotation>
      <xs:documentation>Сведения о междокументарных связях Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="parent" type="tns:LinkedDocument">
        <xs:annotation>
          <xs:documentation>Документ-родитель</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="descendants" type="tns:LinkedDocument">
        <xs:annotation>
          <xs:documentation>Документы-потомки</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELqrAkdknijHaTEmXa074mZgvdqWJ6_UBdhQwxNVYjXNYWr3ewwwfVx6d4bylf6CwaY5FDnci15MSLDNtNPGIyVXxuMFBktN6OFO.KzqWemkZJP8-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://www.w3.org/2000/09/xmldsig#" version="1.0" xmlns:tns="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="CanonicalizationMethod" type="tns:CanonicalizationMethodType"/>
  <xs:element name="DSAKeyValue" type="tns:DSAKeyValueType"/>
  <xs:element name="DigestMethod" type="tns:DigestMethodType"/>
  <xs:element name="DigestValue" type="tns:DigestValueType"/>
  <xs:element name="HMACOutputLength" type="tns:HMACOutputLengthType"/>
  <xs:element name="KeyInfo" type="tns:KeyInfoType"/>
  <xs:element name="KeyName" type="xs:string"/>
  <xs:element name="KeyValue" type="tns:KeyValueType"/>
  <xs:element name="Manifest" type="tns:ManifestType"/>
  <xs:element name="MgmtData" type="xs:string"/>
  <xs:element name="Object" type="tns:ObjectType"/>
  <xs:element name="PGPData" type="tns:PGPDataType"/>
  <xs:element name="PGPKeyID" type="xs:base64Binary"/>
  <xs:element name="PGPKeyPacket" type="xs:base64Binary"/>
  <xs:element name="RSAKeyValue" type="tns:RSAKeyValueType"/>
  <xs:element name="Reference" type="tns:ReferenceType"/>
  <xs:element name="RetrievalMethod" type="tns:RetrievalMethodType"/>
  <xs:element name="SPKIData" type="tns:SPKIDataType"/>
  <xs:element name="SPKISexp" type="xs:base64Binary"/>
  <xs:element name="Signature" type="tns:SignatureType"/>
  <xs:element name="SignatureMethod" type="tns:SignatureMethodType"/>
  <xs:element name="SignatureProperties" type="tns:SignaturePropertiesType"/>
  <xs:element name="SignatureProperty" type="tns:SignaturePropertyType"/>
  <xs:element name="SignatureValue" type="tns:SignatureValueType"/>
  <xs:element name="SignedInfo" type="tns:SignedInfoType"/>
  <xs:element name="Transform" type="tns:TransformType"/>
  <xs:element name="Transforms" type="tns:TransformsType"/>
  <xs:element name="X509CRL" type="xs:base64Binary"/>
  <xs:element name="X509Certificate" type="xs:base64Binary"/>
  <xs:element name="X509Data" type="tns:X509DataType"/>
  <xs:element name="X509IssuerSerial" type="tns:X509IssuerSerialType"/>
  <xs:element name="X509SKI" type="xs:base64Binary"/>
  <xs:element name="X509SubjectName" type="xs:string"/>
  <xs:element name="XPath" type="xs:string"/>
  <xs:complexType mixed="true" name="ObjectType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
    <xs:attribute name="MimeType" type="xs:string"/>
    <xs:attribute name="Encoding" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="ManifestType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="Reference" type="tns:ReferenceType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="ReferenceType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="Transforms" type="tns:TransformsType"/>
      <xs:element form="qualified" name="DigestMethod" type="tns:DigestMethodType"/>
      <xs:element form="qualified" name="DigestValue" type="xs:base64Binary"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
    <xs:attribute name="URI" type="xs:anyURI"/>
    <xs:attribute name="Type" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="TransformsType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="Transform" type="tns:TransformType"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="TransformType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:XPath"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="DigestMethodType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType name="X509DataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:X509Certificate"/>
        <xs:element ref="tns:X509SubjectName"/>
        <xs:element ref="tns:X509CRL"/>
        <xs:element ref="tns:X509IssuerSerial"/>
        <xs:element ref="tns:X509SKI"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="SignedInfoType">
    <xs:sequence>
      <xs:element form="qualified" name="CanonicalizationMethod" type="tns:CanonicalizationMethodType"/>
      <xs:element form="qualified" name="SignatureMethod" type="tns:SignatureMethodType"/>
      <xs:element form="qualified" maxOccurs="unbounded" name="Reference" type="tns:ReferenceType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="CanonicalizationMethodType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="SignatureMethodType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:HMACOutputLength"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType name="PGPDataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:PGPKeyID"/>
        <xs:element ref="tns:PGPKeyPacket"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="KeyInfoType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:X509Data"/>
        <xs:element ref="tns:KeyValue"/>
        <xs:element ref="tns:RetrievalMethod"/>
        <xs:element ref="tns:KeyName"/>
        <xs:element ref="tns:MgmtData"/>
        <xs:element ref="tns:PGPData"/>
        <xs:element ref="tns:SPKIData"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="SignatureType">
    <xs:sequence>
      <xs:element form="qualified" name="SignedInfo" type="tns:SignedInfoType"/>
      <xs:element form="qualified" name="SignatureValue" type="tns:SignatureValueType"/>
      <xs:element form="qualified" minOccurs="0" name="KeyInfo" type="tns:KeyInfoType"/>
      <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="Object" type="tns:ObjectType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="SignatureValueType">
    <xs:simpleContent>
      <xs:extension base="xs:base64Binary">
        <xs:attribute name="Id" type="xs:ID"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="SPKIDataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:SPKISexp"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="KeyValueType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:DSAKeyValue"/>
        <xs:element ref="tns:RSAKeyValue"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="HMACOutputLengthType">
    <xs:restriction base="xs:integer"/>
  </xs:simpleType>
  <xs:complexType name="X509IssuerSerialType">
    <xs:sequence>
      <xs:element form="qualified" name="X509IssuerName" type="xs:string"/>
      <xs:element form="qualified" name="X509SerialNumber" type="xs:integer"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DSAKeyValueType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="P" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="Q" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="G" type="xs:base64Binary"/>
      <xs:element form="qualified" name="Y" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="J" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="Seed" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="PgenCounter" type="xs:base64Binary"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="RetrievalMethodType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="Transforms" type="tns:TransformsType"/>
    </xs:sequence>
    <xs:attribute name="URI" type="xs:anyURI"/>
    <xs:attribute name="Type" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="SignaturePropertiesType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="SignatureProperty" type="tns:SignaturePropertyType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="SignaturePropertyType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Target" type="xs:anyURI" use="required"/>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="RSAKeyValueType">
    <xs:sequence>
      <xs:element form="qualified" name="Modulus" type="xs:base64Binary"/>
      <xs:element form="qualified" name="Exponent" type="xs:base64Binary"/>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="DigestValueType">
    <xs:restriction base="xs:base64Binary"/>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint></con:endpoints><con:operation id="1c7ac29f-818e-4dea-bb7c-c2c02c408244" isOneWay="false" action="" name="convertBase64TddToJson" bindingOperationName="convertBase64TddToJson" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="bd147578-0fb2-46eb-9d75-96c974889d3b" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>cid:1038973755161</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertBase64TddToJson"/></con:call></con:operation><con:operation id="91a38e36-8b33-4ce6-a77e-aa1517e5468c" isOneWay="false" action="" name="convertJsonToBase64Tdd" bindingOperationName="convertJsonToBase64Tdd" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3f170c79-f015-4bb4-804a-5fb05eb29fe8" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>?</typ:templateId>\r
         <typ:structuredJson>?</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToBase64Tdd"/></con:call></con:operation><con:operation id="4bb61388-ad23-4ac7-a5ff-4d7032f08ebb" isOneWay="false" action="" name="convertJsonToTdd" bindingOperationName="convertJsonToTdd" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="fc38a746-fcc1-4c76-9b85-23b118676aec" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:convertJsonToTdd>\r
         <typ:templateId>?</typ:templateId>\r
         <typ:structuredJson>?</typ:structuredJson>\r
      </typ:convertJsonToTdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertJsonToTdd"/></con:call></con:operation><con:operation id="465112fe-35da-4a08-868c-51357cc2338e" isOneWay="false" action="" name="convertTddToJson" bindingOperationName="convertTddToJson" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="be8299f0-cf57-4aca-8b99-f212016500e0" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:convertTddToJson>\r
         <typ:compositionTdd>?</typ:compositionTdd>\r
      </typ:convertTddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/convertTddToJson"/></con:call></con:operation><con:operation id="2c465564-9218-4ab1-89ef-9794b23f0eec" isOneWay="false" action="" name="getExampleTDD" bindingOperationName="getExampleTDD" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="45dcd954-cca0-4fdc-ae21-ffeebeb3a54e" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getExampleTDD>\r
         <typ:templateId>?</typ:templateId>\r
      </typ:getExampleTDD>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getExampleTDD"/></con:call></con:operation><con:operation id="4fe1e743-ccaf-42bb-ab5d-03fba30e114c" isOneWay="false" action="" name="getTDS" bindingOperationName="getTDS" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="23357876-6f4f-4fd1-8c69-909e152a8ccd" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getTDS>\r
         <typ:templateId>?</typ:templateId>\r
      </typ:getTDS>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTDS"/></con:call></con:operation><con:operation id="f59b8c8b-0fce-4c7f-94b3-12e496b037e0" isOneWay="false" action="" name="getTemplateList" bindingOperationName="getTemplateList" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3b75dea2-dfd5-4e9d-bd4b-39e8400ef0c8" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getTemplateList/>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getTemplateList"/></con:call></con:operation><con:operation id="e55d82f8-4faf-42e3-be18-2e94fd5ff569" isOneWay="false" action="" name="getWebTemplate" bindingOperationName="getWebTemplate" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="b5ea3be0-2a1d-430e-8d8b-a245b1275ec4" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header/>\r
   <soapenv:Body>\r
      <typ:getWebTemplate>\r
         <typ:templateId>?</typ:templateId>\r
      </typ:getWebTemplate>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.ru/simi/v4/openEhrService/IOpenEhrService/getWebTemplate"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="37995c04-52a2-4c99-b694-864ff0685cbf" wsaVersion="NONE" name="ReferralServicePortTypeBinding" type="wsdl" bindingName="{http://emias.mos.ru/consultations/v1/referral/soap/}ReferralServicePortTypeBinding" soapVersion="1_2" anonymous="optional" definition="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?wsdl"><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?wsdl</con:url><con:content><![CDATA[<definitions name="referral" targetNamespace="http://emias.mos.ru/consultations/v1/referral/soap/" xmlns:wsp="http://www.w3.org/ns/ws-policy/" xmlns:tns="http://emias.mos.ru/consultations/v1/referral/soap/" xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:referral="http://emias.mos.ru/consultations/v1/referral/" xmlns="http://schemas.xmlsoap.org/wsdl/">
  <import location="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?wsdl=referral.wsdl" namespace="http://emias.mos.ru/consultations/v1/referral/"></import>
  <types></types>
  <binding name="ReferralServicePortTypeBinding" type="referral:ReferralServicePortType">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsp:Policy>
      <sp:SupportingTokens>
        <wsp:Policy>
          <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
            <wsp:Policy>
              <sp:NoPassword/>
            </wsp:Policy>
          </sp:UsernameToken>
        </wsp:Policy>
      </sp:SupportingTokens>
    </wsp:Policy>
    <operation name="getReferral">
      <soap12:operation soapAction="getReferral"/>
      <input>
        <soap12:header message="referral:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getReferralByDocumentId">
      <soap12:operation soapAction="getReferralByDocumentId"/>
      <input>
        <soap12:header message="referral:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getReferralByAssignmentId">
      <soap12:operation soapAction="getReferralByAssignmentId"/>
      <input>
        <soap12:header message="referral:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getReferralsByPatient">
      <soap12:operation soapAction="getReferralsByPatient"/>
      <input>
        <soap12:header message="referral:ConsultationsUserContextMessage" part="header" use="literal"></soap12:header>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
  </binding>
  <service name="ReferralService">
    <port binding="tns:ReferralServicePortTypeBinding" name="ReferralService">
      <soap12:address location="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService"/>
    </port>
  </service>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?wsdl=referral.wsdl</con:url><con:content><![CDATA[<definitions name="referral" targetNamespace="http://emias.mos.ru/consultations/v1/referral/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/referral/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/" xmlns:cmn="http://emias.mos.ru/consultations/v1/common/types/" xmlns="http://schemas.xmlsoap.org/wsdl/">
  <documentation>version="1.0"</documentation>
  <types>
    <xsd:schema>
      <xsd:import namespace="http://emias.mos.ru/system/v1/faults/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.faults.xsd"/>
      <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=common-types.xsd"/>
      <xsd:import namespace="http://emias.mos.ru/consultations/v1/referral/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=referral-wsdl-types.xsd"/>
    </xsd:schema>
  </types>
  <message name="GetReferralByAssignmentIdInput">
    <part element="tns:GetReferralByAssignmentIdRequest" name="body"></part>
  </message>
  <message name="GetReferralsByPatientOutput">
    <part element="tns:GetReferralsByPatientResponse" name="body"></part>
  </message>
  <message name="GetReferralByDocumentIdInput">
    <part element="tns:GetReferralByDocumentIdRequest" name="body"></part>
  </message>
  <message name="GetReferralByAssignmentIdOutput">
    <part element="tns:GetReferralByAssignmentIdResponse" name="body"></part>
  </message>
  <message name="fault">
    <documentation>Ошибка</documentation>
    <part element="nsf:fault" name="body"></part>
  </message>
  <message name="GetReferralsByPatientInput">
    <part element="tns:GetReferralsByPatientRequest" name="body"></part>
  </message>
  <message name="ConsultationsUserContextMessage">
    <part element="cmn:ConsultationsUserContext" name="header"></part>
  </message>
  <message name="GetReferralInput">
    <part element="tns:GetReferralRequest" name="body"></part>
  </message>
  <message name="GetReferralByDocumentIdOutput">
    <part element="tns:GetReferralByDocumentIdResponse" name="body"></part>
  </message>
  <message name="GetReferralOutput">
    <part element="tns:GetReferralResponse" name="body"></part>
  </message>
  <portType name="ReferralServicePortType">
    <operation name="getReferral">
      <documentation>Метод получения Направления по идентификатору Направления
 @param referralId
 @return
 @throws BusinessException</documentation>
      <input message="tns:GetReferralInput"></input>
      <output message="tns:GetReferralOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getReferralByDocumentId">
      <documentation>Метод получения Направления по идентификатору документа СИМИ Направления
 @param documentId
 @return</documentation>
      <input message="tns:GetReferralByDocumentIdInput"></input>
      <output message="tns:GetReferralByDocumentIdOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getReferralByAssignmentId">
      <documentation>Метод получения Направления по идентификатору Назначения
 @param assignmentId
 @return</documentation>
      <input message="tns:GetReferralByAssignmentIdInput"></input>
      <output message="tns:GetReferralByAssignmentIdOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
    <operation name="getReferralsByPatient">
      <documentation></documentation>
      <input message="tns:GetReferralsByPatientInput"></input>
      <output message="tns:GetReferralsByPatientOutput"></output>
      <fault message="tns:fault" name="fault"></fault>
    </operation>
  </portType>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.faults.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/faults/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:uctx="http://emias.mos.ru/system/v1/userContext/" xmlns="http://emias.mos.ru/system/v1/faults/">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.xsd"/>
  <xs:import namespace="http://emias.mos.ru/system/v1/userContext/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.userContext.xsd"/>
  <!--faults-->
  <xs:element name="fault" type="BaseFault">
    <xs:annotation>
      <xs:documentation>Базовый тип ошибки</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="SecurityFault">
    <xs:annotation>
      <xs:documentation>Ошибка безопасности</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element ref="uctx:userContext"/>
          <xs:choice>
            <xs:element name="unauthorizedRequestSecurityException" type="UnauthorizedRequestSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="otherSecurityException" type="OtherSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:choice>
        </xs:sequence>
        <xs:attribute fixed="SECURITY" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="BusinessFault">
    <xs:annotation>
      <xs:documentation>Бизнес ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Коллекция Сообщений об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="hasErrors" type="xs:boolean">
            <xs:annotation>
              <xs:documentation>Признак наличия ошибок в списке сообщений</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="BUSINESS" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="UnexpectedFault">
    <xs:annotation>
      <xs:documentation>Непредвиденная ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="version" type="xs:string">
            <xs:annotation>
              <xs:documentation>Версия продукта-сервиса</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="stackTrace">
            <xs:annotation>
              <xs:documentation>Стек вызова (последние 10  записей)</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="10" name="stackTraceRecord">
                  <xs:annotation>
                    <xs:documentation>Запись StackTrace</xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="declaringClass" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование класса, содержащего метод</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="methodName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование метода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="fileName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование файла</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="lineNumber" type="xs:int">
                        <xs:annotation>
                          <xs:documentation>Номер строки кода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="UNEXPECTED" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="BaseFault">
    <xs:annotation>
      <xs:documentation>Описание базового типа описания ошибки</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--security exceptions-->
  <xs:complexType name="UnauthorizedRequestSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="requiredRights">
        <xs:annotation>
          <xs:documentation>Перечень идентификаторов недостающих Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>Идентификатор Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="UNAUTHORIZED_REQUEST_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="OtherSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="message" type="Message">
        <xs:annotation>
          <xs:documentation>Сообщение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="OTHER_SECURITY_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="SecurityExceptionTypes">
    <xs:annotation>
      <xs:documentation>Типы исключений безопасности</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="UNAUTHORIZED_REQUEST_EXCEPTION"/>
      <xs:enumeration value="OTHER_SECURITY_EXCEPTION"/>
    </xs:restriction>
  </xs:simpleType>
  <!--components-->
  <xs:simpleType name="FaultTypes">
    <xs:annotation>
      <xs:documentation>Тип ошибки</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="SECURITY">
        <xs:annotation>
          <xs:documentation>Непредвиденная ошибка приложения</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BUSINESS">
        <xs:annotation>
          <xs:documentation>Бизнес ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNEXPECTED">
        <xs:annotation>
          <xs:documentation>Ошибка безопасности</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.userContext.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/userContext/" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:core="http://emias.mos.ru/system/v1/" xmlns="http://emias.mos.ru/system/v1/userContext/">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.xsd"/>
  <xs:element name="userContext" type="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="systemName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Шифр системы-потребителя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя пользователя (логин)</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRoleId" type="ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Роли пользователя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="isUserRoleSystemWide" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак "Общесистемная Роль пользователя"</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRights">
        <xs:annotation>
          <xs:documentation>Коллекция Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>ИД Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="jobExecutionId" type="ID"/>
      <xs:element minOccurs="0" name="hostIp" type="xs:string">
        <xs:annotation>
          <xs:documentation>IP адрес хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hostName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <!--error message description-->
  <xs:complexType name="ErrorMessageCollection">
    <xs:annotation>
      <xs:documentation>Коллекция сообщений об ошибках</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="message" type="ErrorMessage">
        <xs:annotation>
          <xs:documentation>Сообщение об ошибке</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="ErrorMessage">
    <xs:annotation>
      <xs:documentation>Сообщение об ошибке</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="Message">
        <xs:sequence>
          <xs:element minOccurs="0" name="parameters">
            <xs:annotation>
              <xs:documentation>Коллекция параметров сообщения</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="unbounded" name="parameter" type="KeyValuePair">
                  <xs:annotation>
                    <xs:documentation>Параметр сообщения</xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Сопутствующие сообщения об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="type" type="ErrorMessageTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип сообщения</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:simpleType name="ErrorMessageTypes">
    <xs:annotation>
      <xs:documentation>Тип сообщения об ошибке</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ERROR">
        <xs:annotation>
          <xs:documentation>Ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="WARNING">
        <xs:annotation>
          <xs:documentation>Предупреждение (не блокирующая ошибка)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="INFO">
        <xs:annotation>
          <xs:documentation>Информационное сообщение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:long"/>
  </xs:simpleType>
  <xs:complexType name="KeyValuePair">
    <xs:annotation>
      <xs:documentation>Представляет тип "ключ/значение"</xs:documentation>
    </xs:annotation>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="key" type="xs:string" use="required">
          <xs:annotation>
            <xs:documentation>Ключ</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="Message">
    <xs:annotation>
      <xs:documentation>Сообщение</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="message" type="xs:string">
        <xs:annotation>
          <xs:documentation>Текст сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=common-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/common/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/common/types/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/">
  <xsd:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.core.v1.xsd"/>
  <xsd:complexType name="RequestPageInfo">
    <xsd:sequence>
      <xsd:element default="0" minOccurs="1" name="page" type="xsd:int">
        <xsd:annotation>
          <xsd:documentation>Номер страницы</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element default="0" minOccurs="1" name="pageSize" type="xsd:int">
        <xsd:annotation>
          <xsd:documentation>Размер страницы</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ResponsePageInfo">
    <xsd:complexContent>
      <xsd:extension base="tns:RequestPageInfo">
        <xsd:sequence>
          <xsd:element default="0" minOccurs="1" name="total" type="xsd:long">
            <xsd:annotation>
              <xsd:documentation>Всего записей</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="ConsultationsUserContext">
    <xsd:complexType>
      <xsd:annotation>
        <xsd:documentation>Контекст пользователя</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element minOccurs="0" name="employeeJobId" type="tns:EmployeeJobKey">
          <xsd:annotation>
            <xsd:documentation>Идентификатор исполнения должности</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="fullName" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>ФИО пользователя</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element minOccurs="0" name="position" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation>Должность медработника</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:complexType name="Priority">
    <xsd:annotation>
      <xsd:documentation>Справочник "Степень срочности"</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Название</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="cito" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак срочности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="longTerm" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Долгосрочное назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fromPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты начала проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="toPeriod" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Параметр для расчета желаемой даты окончания проведения исследования</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="offset" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Количество дней, начиная от текущей даты</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="active" type="xsd:boolean">
        <xsd:annotation>
          <xsd:documentation>Признак актуальности</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="AppointmentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор записи</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="CareEventKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор клинического события</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="PatientKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор пациента</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="AssignmentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор назначения</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:simpleType name="ReferralKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор направления</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:simpleType name="NsiKey">
    <xsd:restriction base="xsd:normalizedString"/>
  </xsd:simpleType>
  <!--<xsd:simpleType name="SpecialityKey">-->
  <!--<xsd:annotation>-->
  <!--<xsd:documentation>Идентификатор специальности</xsd:documentation>-->
  <!--</xsd:annotation>-->
  <!--<xsd:restriction base="tns:NsiKey"/>-->
  <!--</xsd:simpleType>-->
  <xsd:simpleType name="SpecializationKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор специализации</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="tns:NsiKey"/>
  </xsd:simpleType>
  <xsd:simpleType name="AvailableResourceKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор доступного ресурса</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="LpuKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="EmployeeJobKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор врача</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="CctCode">
    <xsd:annotation>
      <xsd:documentation>Идентификатор класс-кода документа</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:long"/>
  </xsd:simpleType>
  <xsd:simpleType name="DocumentKey">
    <xsd:annotation>
      <xsd:documentation>Идентификатор документа</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string"/>
  </xsd:simpleType>
  <xsd:complexType name="Lpu">
    <xsd:annotation>
      <xsd:documentation>ЛПУ</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="id" type="xsd:long">
        <xsd:annotation>
          <xsd:documentation>Идентификатор ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Наименование ЛПУ</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Period">
    <xsd:annotation>
      <xsd:documentation>Период</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="1" minOccurs="1" name="start" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Начало периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element maxOccurs="1" minOccurs="1" name="end" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Конец периода</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.core.v1.xsd</con:url><con:content><![CDATA[<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=emias.system.v1.xsd"/>
  <!--references-->
  <xs:element name="medicalOrganizationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинской организации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="medicalFacilityId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинского учреждения</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--async operation status-->
  <xs:element name="operationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор операции</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="OperationExecutionStatus">
    <xs:annotation>
      <xs:documentation>Статус выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="isCompleted" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак окончания выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="completenessProgress" type="OperationCompletenessBase">
        <xs:annotation>
          <xs:documentation>Сведения о текущем статусе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hasSucceded" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак успешности выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
        <xs:annotation>
          <xs:documentation>Коллекция сообщений, порожденных в ходе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="id" type="ID" use="required">
      <xs:annotation>
        <xs:documentation>Идентификатор операции</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessPercentage">
    <xs:annotation>
      <xs:documentation>Описание текущего статуса выполнения операции в процентах (0%-100%)</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="OperationCompletenessBase">
        <xs:sequence>
          <xs:element name="completenessStatus">
            <xs:annotation>
              <xs:documentation>Статус (0%-100%)</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="xs:unsignedByte">
                <xs:minInclusive value="0"/>
                <xs:maxInclusive value="100"/>
              </xs:restriction>
            </xs:simpleType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessBase">
    <xs:annotation>
      <xs:documentation>Базовый абстрактный тип для описания текущего статуса выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--calling methods' options-->
  <xs:element name="options" type="Options">
    <xs:annotation>
      <xs:documentation>Параметры вызова метода</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="Options">
    <xs:annotation>
      <xs:documentation>Набор именованных значений</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="entry" type="KeyValuePair">
        <xs:annotation>
          <xs:documentation>Именованное значение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <!--pagination-->
  <xs:element name="pagingOptions" type="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType abstract="true" name="PagingResults">
    <xs:annotation>
      <xs:documentation>Список с пагинацией</xs:documentation>
    </xs:annotation>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageTotal" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Общее количество страниц</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="morePagesAvailable" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Флаг доступности других страниц с результатами для "постраничного листания" (true - если доступны еще страницы; false - иначе)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--base types-->
  <xs:complexType name="TimeInterval">
    <xs:annotation>
      <xs:documentation>Временной период (время)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время начала интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время окончания интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DatePeriod">
    <xs:annotation>
      <xs:documentation>Временной период (дата)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата начала периода</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата окончания периода</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=referral-wsdl-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/referral/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/referral/" xmlns:referral="http://emias.mos.ru/consultations/v1/referral/types/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/referral/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=referral-types.xsd"/>
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=common-types.xsd"/>
  <xsd:element name="GetReferralRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="referralId" type="common:ReferralKey"/>
        <xsd:element minOccurs="0" name="patientId" type="common:PatientKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="referral:Referral"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralByDocumentIdRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="documentId" type="common:DocumentKey"/>
        <xsd:element minOccurs="0" name="patientId" type="common:PatientKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralByDocumentIdResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="referral:Referral"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralByAssignmentIdRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="assignmentId" type="common:AssignmentKey"/>
        <xsd:element minOccurs="0" name="patientId" type="common:PatientKey"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralByAssignmentIdResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="referral:Referral"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralsByPatientRequest">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="patientId" type="common:PatientKey"/>
        <xsd:element maxOccurs="unbounded" minOccurs="0" name="referralStatuses" type="referral:ReferralStatus"/>
        <xsd:element minOccurs="0" name="paging" type="common:RequestPageInfo"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
  <xsd:element name="GetReferralsByPatientResponse">
    <xsd:complexType>
      <xsd:sequence>
        <xsd:element name="result" type="referral:ReferralPage"/>
      </xsd:sequence>
    </xsd:complexType>
  </xsd:element>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=referral-types.xsd</con:url><con:content><![CDATA[<xsd:schema elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/consultations/v1/referral/types/" version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emias.mos.ru/consultations/v1/referral/types/" xmlns:common="http://emias.mos.ru/consultations/v1/common/types/">
  <xsd:import namespace="http://emias.mos.ru/consultations/v1/common/types/" schemaLocation="http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService?xsd=common-types.xsd"/>
  <xsd:complexType name="ReferralPage">
    <xsd:annotation>
      <xsd:documentation>Пострнаничный вывод списка назначений</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element maxOccurs="unbounded" minOccurs="0" name="results" type="tns:Referral">
        <xsd:annotation>
          <xsd:documentation>Список направлений</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="paging" type="common:ResponsePageInfo">
        <xsd:annotation>
          <xsd:documentation>Пагинация</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Referral">
    <xsd:annotation>
      <xsd:documentation>Направление</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="referralId" type="common:ReferralKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="assignmentId" type="common:AssignmentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="documentId" type="common:DocumentKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="referralStatus" type="tns:ReferralStatus">
        <xsd:annotation>
          <xsd:documentation>Статус назначения</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="patientId" type="common:PatientKey">
        <xsd:annotation>
          <xsd:documentation>Идентификатор пациента</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="lpu" type="common:Lpu">
        <xsd:annotation>
          <xsd:documentation>Описание филиала медицинской организации, в который сознао направление</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="brunchLpu" type="common:Lpu">
        <xsd:annotation>
          <xsd:documentation>Филиал медицинской организации, в который направлен пациент</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="startDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата начала действия направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="endDate" type="xsd:dateTime">
        <xsd:annotation>
          <xsd:documentation>Дата окончания действия направления</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="employeeJobId" type="common:EmployeeJobKey">
        <xsd:annotation>
          <xsd:documentation>ИД исполнения должности пользователя создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="fio" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>ФИО пользователя создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="position" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Должность медицинского работника создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="login" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Логин пользователя создавшего назначение</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="availableResourceId" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation>Идентификатор доступного ресурса</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="ReferralStatus">
    <xsd:annotation>
      <xsd:documentation>Статус направления, определенный в архетипе Action</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="ReferralCreated">
        <xsd:annotation>
          <xsd:documentation>Направление создано</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="ReferralApproved">
        <xsd:annotation>
          <xsd:documentation>Направление утверждено</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Cancelled">
        <xsd:annotation>
          <xsd:documentation>Направление отменено</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
</xsd:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService</con:endpoint></con:endpoints><con:operation id="ef68bd59-c9f0-47ac-b3d9-6b8cfd2c7bb0" isOneWay="false" action="getReferral" name="getReferral" bindingOperationName="getReferral" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5ec953ed-48fc-428a-8080-848ff19c33a2" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralRequest>\r
         <ref:referralId>?</ref:referralId>\r
         <!--Optional:-->\r
         <ref:patientId>?</ref:patientId>\r
      </ref:GetReferralRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/referral/soap/ReferralServicePortType/getReferralRequest"/></con:call></con:operation><con:operation id="9a7f45d8-b147-49f7-98f9-b9ff50e379cc" isOneWay="false" action="getReferralByAssignmentId" name="getReferralByAssignmentId" bindingOperationName="getReferralByAssignmentId" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="e6c1a249-8b82-46e2-901e-18825611a862" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByAssignmentIdRequest>\r
         <ref:assignmentId>?</ref:assignmentId>\r
         <!--Optional:-->\r
         <ref:patientId>?</ref:patientId>\r
      </ref:GetReferralByAssignmentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/referral/soap/ReferralServicePortType/getReferralByAssignmentIdRequest"/></con:call></con:operation><con:operation id="0569c3ef-2f32-4fb1-b226-e82e85bada8c" isOneWay="false" action="getReferralByDocumentId" name="getReferralByDocumentId" bindingOperationName="getReferralByDocumentId" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="2b96bf30-5900-47ba-9168-95e3a3135078" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByDocumentIdRequest>\r
         <ref:documentId>?</ref:documentId>\r
         <!--Optional:-->\r
         <ref:patientId>?</ref:patientId>\r
      </ref:GetReferralByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/referral/soap/ReferralServicePortType/getReferralByDocumentIdRequest"/></con:call></con:operation><con:operation id="6a507875-97f9-41ca-a622-e2525d117edc" isOneWay="false" action="getReferralsByPatient" name="getReferralsByPatient" bindingOperationName="getReferralsByPatient" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="7955a1cd-3d46-4bee-a6b1-539bb12d28e0" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext>\r
         <!--Optional:-->\r
         <typ:employeeJobId>?</typ:employeeJobId>\r
         <!--Optional:-->\r
         <typ:fullName>?</typ:fullName>\r
         <!--Optional:-->\r
         <typ:position>?</typ:position>\r
      </typ:ConsultationsUserContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralsByPatientRequest>\r
         <ref:patientId>?</ref:patientId>\r
         <!--Zero or more repetitions:-->\r
         <ref:referralStatuses>?</ref:referralStatuses>\r
         <!--Optional:-->\r
         <ref:paging>\r
            <typ:page>0</typ:page>\r
            <typ:pageSize>0</typ:pageSize>\r
         </ref:paging>\r
      </ref:GetReferralsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/consultations/v1/referral/soap/ReferralServicePortType/getReferralsByPatientRequest"/><con:wsrmConfig version="1.2"/></con:call></con:operation></con:interface><con:interface xsi:type="con:WsdlInterface" id="516fa280-8390-45a5-854b-d0bdb591812a" wsaVersion="NONE" name="simiServiceBinding" type="wsdl" bindingName="{http://emias.mos.ru/simi/simiService/v5/}simiServiceBinding" soapVersion="1_2" anonymous="optional" definition="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl"><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--Generated by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.3.1 (UNKNOWN_BRANCH-false; 2015-01-15T16:53:43+0100) JAXWS-RI/2.2.10 JAXWS-API/2.2.11 JAXB-RI/2.2.10-b140802.1033 JAXB-API/2.2.12-b140109.1041 svn-revision#unknown.-->
<definitions name="simiService" targetNamespace="http://emias.mos.ru/simi/simiService/v5/" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:cet="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:nsf="http://emias.mos.ru/system/v1/faults/" xmlns:soap12="http://schemas.xmlsoap.org/wsdl/soap12/" xmlns:tns="http://emias.mos.ru/simi/simiService/v5/" xmlns:uctx="http://emias.mos.ru/system/v1/userContext/" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <documentation>Сервис SimiService с объектной моделью Document v5</documentation>
  <types>
    <xsd:schema>
      <xsd:import namespace="http://emias.mos.ru/system/v1/userContext/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wSPe7rI6EH1EGGOBEEq2OF.g-"/>
      <xsd:import namespace="http://emias.mos.ru/system/v1/faults/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wSQbg4gjq.Y9UZnNlFAIM5dk-"/>
      <xsd:import namespace="http://emias.mos.ru/simi/faults/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wQ6SMCzdAAsFjb8wvLCEekDY-"/>
      <xsd:import namespace="http://emias.mos.ru/simi/simiService/v5/types/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wShAlHpHNw6RfsO82_pitXUTj"/>
    </xsd:schema>
  </types>
  <message name="userContext">
    <documentation>Контекст пользователя</documentation>
    <part element="uctx:userContext" name="userContext"/>
  </message>
  <message name="fault">
    <documentation>Ошибка</documentation>
    <part element="nsf:fault" name="fault"/>
  </message>
  <message name="deprecateDocumentInput">
    <part element="cet:deprecateDocumentRequest" name="parameters"/>
  </message>
  <message name="deprecateDocumentOutput">
    <part element="cet:deprecateDocumentResponse" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsInput">
    <part element="cet:getCareEventDocumentsRequest" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsOutput">
    <part element="cet:getCareEventDocumentsResponse" name="parameters"/>
  </message>
  <message name="saveDocumentInput">
    <part element="cet:saveDocumentRequest" name="parameters"/>
  </message>
  <message name="saveDocumentOutput">
    <part element="cet:saveDocumentResponse" name="parameters"/>
  </message>
  <message name="archiveDocumentInput">
    <part element="cet:archiveDocumentRequest" name="parameters"/>
  </message>
  <message name="archiveDocumentOutput">
    <part element="cet:archiveDocumentResponse" name="parameters"/>
  </message>
  <message name="searchDocumentsInput">
    <part element="cet:searchDocumentsRequest" name="parameters"/>
  </message>
  <message name="searchDocumentsOutput">
    <part element="cet:searchDocumentsResponse" name="parameters"/>
  </message>
  <message name="getDocumentInput">
    <part element="cet:getDocumentRequest" name="parameters"/>
  </message>
  <message name="getDocumentOutput">
    <part element="cet:getDocumentResponse" name="parameters"/>
  </message>
  <message name="getAuditRecordsInput">
    <part element="cet:getAuditRecordsRequest" name="parameters"/>
  </message>
  <message name="getAuditRecordsOutput">
    <part element="cet:getAuditRecordsResponse" name="parameters"/>
  </message>
  <message name="createDocumentInput">
    <part element="cet:createDocumentRequest" name="parameters"/>
  </message>
  <message name="createDocumentOutput">
    <part element="cet:createDocumentResponse" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsForSignInput">
    <part element="cet:getCareEventDocumentsForSignRequest" name="parameters"/>
  </message>
  <message name="getCareEventDocumentsForSignOutput">
    <part element="cet:getCareEventDocumentsForSignResponse" name="parameters"/>
  </message>
  <message name="getDocumentsByPatientForSignInput">
    <part element="cet:getDocumentsByPatientForSignRequest" name="parameters"/>
  </message>
  <message name="getDocumentsByPatientForSignOutput">
    <part element="cet:getDocumentsByPatientForSignResponse" name="parameters"/>
  </message>
  <message name="getDocumentsForSignInput">
    <part element="cet:getDocumentsForSignRequest" name="parameters"/>
  </message>
  <message name="getDocumentsForSignOutput">
    <part element="cet:getDocumentsForSignResponse" name="parameters"/>
  </message>
  <portType name="simiServicePortType">
    <operation name="deprecateDocument">
      <documentation>Аннулирование документов</documentation>
      <input message="tns:deprecateDocumentInput" name="deprecateDocumentInput"/>
      <output message="tns:deprecateDocumentOutput" name="deprecateDocumentOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="getCareEventDocuments">
      <documentation>Получение документов по событию</documentation>
      <input message="tns:getCareEventDocumentsInput" name="getCareEventDocumentsInput"/>
      <output message="tns:getCareEventDocumentsOutput" name="getCareEventDocumentsOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="saveDocument">
      <documentation>Сохранение документа</documentation>
      <input message="tns:saveDocumentInput" name="saveDocumentInput"/>
      <output message="tns:saveDocumentOutput" name="saveDocumentOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="archiveDocument">
      <documentation>Архивирование документов</documentation>
      <input message="tns:archiveDocumentInput" name="archiveDocumentInput"/>
      <output message="tns:archiveDocumentOutput" name="archiveDocumentOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="searchDocuments">
      <documentation>Выборка документов</documentation>
      <input message="tns:searchDocumentsInput" name="searchDocumentsInput"/>
      <output message="tns:searchDocumentsOutput" name="searchDocumentsOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="getDocument">
      <documentation>Получение документа</documentation>
      <input message="tns:getDocumentInput" name="getDocumentInput"/>
      <output message="tns:getDocumentOutput" name="getDocumentOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="getAuditRecords">
      <documentation>Получение записей об аудите</documentation>
      <input message="tns:getAuditRecordsInput" name="getAuditRecordsInput"/>
      <output message="tns:getAuditRecordsOutput" name="getAuditRecordsOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="createDocument">
      <documentation>Создание документа</documentation>
      <input message="tns:createDocumentInput" name="createDocumentInput"/>
      <output message="tns:createDocumentOutput" name="createDocumentOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="getCareEventDocumentsForSign">
      <documentation>Получение документов для подписания по клиническому событию</documentation>
      <input message="tns:getCareEventDocumentsForSignInput" name="getCareEventDocumentsForSignInput"/>
      <output message="tns:getCareEventDocumentsForSignOutput" name="getCareEventDocumentsForSignOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="getDocumentsByPatientForSign">
      <documentation>Получение документов для подписания по пациенту</documentation>
      <input message="tns:getDocumentsByPatientForSignInput" name="getDocumentsByPatientForSignInput"/>
      <output message="tns:getDocumentsByPatientForSignOutput" name="getDocumentsByPatientForSignOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
    <operation name="getDocumentsForSign">
      <documentation>Получение документов для подписания по идентификаторам</documentation>
      <input message="tns:getDocumentsForSignInput" name="getDocumentsForSignInput"/>
      <output message="tns:getDocumentsForSignOutput" name="getDocumentsForSignOutput"/>
      <fault message="tns:fault" name="fault"/>
    </operation>
  </portType>
  <binding name="simiServiceBinding" type="tns:simiServicePortType">
    <soap12:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <operation name="deprecateDocument">
      <soap12:operation soapAction="deprecateDocument"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getCareEventDocuments">
      <soap12:operation soapAction="getCareEventDocuments"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="saveDocument">
      <soap12:operation soapAction="saveDocument"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="archiveDocument">
      <soap12:operation soapAction="archiveDocument"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="searchDocuments">
      <soap12:operation soapAction="searchDocuments"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getDocument">
      <soap12:operation soapAction="getDocument"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getAuditRecords">
      <soap12:operation soapAction="getAuditRecords"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="createDocument">
      <soap12:operation soapAction="createDocument"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getCareEventDocumentsForSign">
      <soap12:operation soapAction="getCareEventDocumentsForSign"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getDocumentsByPatientForSign">
      <soap12:operation soapAction="getDocumentsByPatientForSign"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
    <operation name="getDocumentsForSign">
      <soap12:operation soapAction="getDocumentsForSign"/>
      <input>
        <soap12:header message="tns:userContext" part="userContext" use="literal"/>
        <soap12:body use="literal"/>
      </input>
      <output>
        <soap12:body use="literal"/>
      </output>
      <fault name="fault">
        <soap12:fault name="fault" use="literal"/>
      </fault>
    </operation>
  </binding>
  <service name="simiService" xmlns:wsp="http://www.w3.org/ns/ws-policy">
    <port binding="tns:simiServiceBinding" name="simiServicePort">
      <soap12:address location="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService"/>
      <wsp:PolicyReference URI="#authPolicy"/>
    </port>
  </service>
  <wsp:Policy wsu:Id="authPolicy" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
    <sp:SupportingTokens xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702">
      <wsp:Policy>
        <sp:UsernameToken sp:IncludeToken="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/IncludeToken/AlwaysToRecipient">
          <wsp:Policy>
            <sp:NoPassword/>
          </wsp:Policy>
        </sp:UsernameToken>
      </wsp:Policy>
    </sp:SupportingTokens>
  </wsp:Policy>
</definitions>]]></con:content><con:type>http://schemas.xmlsoap.org/wsdl/</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wSPe7rI6EH1EGGOBEEq2OF.g-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--edited with XMLSpy v2011 rel. 2 (http://www.altova.com) by DIT (DIT)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/userContext/" xmlns="http://emias.mos.ru/system/v1/userContext/" xmlns:core="http://emias.mos.ru/system/v1/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wT2c7RR2Mr0q5YRmjA.MCyXw-"/>
  <xs:element name="userContext" type="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="UserContext">
    <xs:annotation>
      <xs:documentation>Контекст пользователя</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="systemName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Шифр системы-потребителя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя пользователя (логин)</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRoleId" type="ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Роли пользователя</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="isUserRoleSystemWide" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак "Общесистемная Роль пользователя"</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="userRights">
        <xs:annotation>
          <xs:documentation>Коллекция Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>ИД Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element name="jobExecutionId" type="ID"/>
      <xs:element minOccurs="0" name="hostIp" type="xs:string">
        <xs:annotation>
          <xs:documentation>IP адрес хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hostName" type="xs:string">
        <xs:annotation>
          <xs:documentation>Имя хоста</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wT2c7RR2Mr0q5YRmjA.MCyXw-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <!--error message description-->
  <xs:complexType name="ErrorMessageCollection">
    <xs:annotation>
      <xs:documentation>Коллекция сообщений об ошибках</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="message" type="ErrorMessage">
        <xs:annotation>
          <xs:documentation>Сообщение об ошибке</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="ErrorMessage">
    <xs:annotation>
      <xs:documentation>Сообщение об ошибке</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="Message">
        <xs:sequence>
          <xs:element minOccurs="0" name="parameters">
            <xs:annotation>
              <xs:documentation>Коллекция параметров сообщения</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="unbounded" name="parameter" type="KeyValuePair">
                  <xs:annotation>
                    <xs:documentation>Параметр сообщения</xs:documentation>
                  </xs:annotation>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Сопутствующие сообщения об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="type" type="ErrorMessageTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип сообщения</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:simpleType name="ErrorMessageTypes">
    <xs:annotation>
      <xs:documentation>Тип сообщения об ошибке</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ERROR">
        <xs:annotation>
          <xs:documentation>Ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="WARNING">
        <xs:annotation>
          <xs:documentation>Предупреждение (не блокирующая ошибка)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="INFO">
        <xs:annotation>
          <xs:documentation>Информационное сообщение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:long"/>
  </xs:simpleType>
  <xs:complexType name="KeyValuePair">
    <xs:annotation>
      <xs:documentation>Представляет тип "ключ/значение"</xs:documentation>
    </xs:annotation>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="key" type="xs:string" use="required">
          <xs:annotation>
            <xs:documentation>Ключ</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="Message">
    <xs:annotation>
      <xs:documentation>Сообщение</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="message" type="xs:string">
        <xs:annotation>
          <xs:documentation>Текст сообщения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wSQbg4gjq.Y9UZnNlFAIM5dk-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" targetNamespace="http://emias.mos.ru/system/v1/faults/" xmlns="http://emias.mos.ru/system/v1/faults/" xmlns:uctx="http://emias.mos.ru/system/v1/userContext/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wT2c7RR2Mr0q5YRmjA.MCyXw-"/>
  <xs:import namespace="http://emias.mos.ru/system/v1/userContext/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wSPe7rI6EH1EGGOBEEq2OF.g-"/>
  <!--faults-->
  <xs:element name="fault" type="BaseFault">
    <xs:annotation>
      <xs:documentation>Базовый тип ошибки</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="SecurityFault">
    <xs:annotation>
      <xs:documentation>Ошибка безопасности</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element ref="uctx:userContext"/>
          <xs:choice>
            <xs:element name="unauthorizedRequestSecurityException" type="UnauthorizedRequestSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
            <xs:element name="otherSecurityException" type="OtherSecurityException">
              <xs:annotation>
                <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:choice>
        </xs:sequence>
        <xs:attribute fixed="SECURITY" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="BusinessFault">
    <xs:annotation>
      <xs:documentation>Бизнес ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="messages" type="ErrorMessageCollection">
            <xs:annotation>
              <xs:documentation>Коллекция Сообщений об ошибках</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="hasErrors" type="xs:boolean">
            <xs:annotation>
              <xs:documentation>Признак наличия ошибок в списке сообщений</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="BUSINESS" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="UnexpectedFault">
    <xs:annotation>
      <xs:documentation>Непредвиденная ошибка</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="BaseFault">
        <xs:sequence>
          <xs:element name="version" type="xs:string">
            <xs:annotation>
              <xs:documentation>Версия продукта-сервиса</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element name="stackTrace">
            <xs:annotation>
              <xs:documentation>Стек вызова (последние 10  записей)</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:sequence>
                <xs:element maxOccurs="10" name="stackTraceRecord">
                  <xs:annotation>
                    <xs:documentation>Запись StackTrace</xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:sequence>
                      <xs:element name="declaringClass" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование класса, содержащего метод</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="methodName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование метода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="fileName" type="xs:string">
                        <xs:annotation>
                          <xs:documentation>Наименование файла</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="lineNumber" type="xs:int">
                        <xs:annotation>
                          <xs:documentation>Номер строки кода</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
        </xs:sequence>
        <xs:attribute fixed="UNEXPECTED" name="type" type="FaultTypes" use="required">
          <xs:annotation>
            <xs:documentation>Тип ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="BaseFault">
    <xs:annotation>
      <xs:documentation>Описание базового типа описания ошибки</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--security exceptions-->
  <xs:complexType name="UnauthorizedRequestSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа UNAUTHORIZED_REQUEST_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="requiredRights">
        <xs:annotation>
          <xs:documentation>Перечень идентификаторов недостающих Полномочий пользователя</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:sequence>
            <xs:element maxOccurs="unbounded" name="userRightId" type="ID">
              <xs:annotation>
                <xs:documentation>Идентификатор Полномочия пользователя</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="UNAUTHORIZED_REQUEST_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="OtherSecurityException">
    <xs:annotation>
      <xs:documentation>Исключение безопасности типа OTHER_SECURITY_EXCEPTION</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="message" type="Message">
        <xs:annotation>
          <xs:documentation>Сообщение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute fixed="OTHER_SECURITY_EXCEPTION" name="type" type="SecurityExceptionTypes" use="required">
      <xs:annotation>
        <xs:documentation>Тип исключения безопасности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="SecurityExceptionTypes">
    <xs:annotation>
      <xs:documentation>Типы исключений безопасности</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="UNAUTHORIZED_REQUEST_EXCEPTION"/>
      <xs:enumeration value="OTHER_SECURITY_EXCEPTION"/>
    </xs:restriction>
  </xs:simpleType>
  <!--components-->
  <xs:simpleType name="FaultTypes">
    <xs:annotation>
      <xs:documentation>Тип ошибки</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="SECURITY">
        <xs:annotation>
          <xs:documentation>Непредвиденная ошибка приложения</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BUSINESS">
        <xs:annotation>
          <xs:documentation>Бизнес ошибка</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNEXPECTED">
        <xs:annotation>
          <xs:documentation>Ошибка безопасности</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wQ6SMCzdAAsFjb8wvLCEekDY-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/faults/v5/" version="1.0" xmlns:nsf="http://emias.mos.ru/system/v1/faults/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/system/v1/faults/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wSQbg4gjq.Y9UZnNlFAIM5dk-"/>
  <!--base types-->
  <xs:complexType name="SimiFault">
    <xs:annotation>
      <xs:documentation>Ошибка обработки запроса</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="nsf:BaseFault">
        <xs:sequence>
          <xs:element name="contextEntries">
            <xs:annotation>
              <xs:documentation>Параметры контекста возникновения ошибки</xs:documentation>
            </xs:annotation>
            <xs:complexType>
              <xs:annotation>
                <xs:documentation>Параметры контекста возникновения ошибки</xs:documentation>
              </xs:annotation>
              <xs:sequence>
                <xs:element maxOccurs="unbounded" minOccurs="0" name="entry">
                  <xs:annotation>
                    <xs:documentation>Параметр контекста возникновения ошибки</xs:documentation>
                  </xs:annotation>
                  <xs:complexType>
                    <xs:annotation>
                      <xs:documentation>Параметр контекста возникновения ошибки</xs:documentation>
                    </xs:annotation>
                    <xs:sequence>
                      <xs:element minOccurs="0" name="key" type="xs:anyType">
                        <xs:annotation>
                          <xs:documentation>Название параметра контекста возникновения ошибки</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                      <xs:element minOccurs="0" name="value" type="xs:anyType">
                        <xs:annotation>
                          <xs:documentation>Значение параметра контекста возникновения ошибк</xs:documentation>
                        </xs:annotation>
                      </xs:element>
                    </xs:sequence>
                  </xs:complexType>
                </xs:element>
              </xs:sequence>
            </xs:complexType>
          </xs:element>
          <xs:element minOccurs="0" name="stackTrace" type="xs:string">
            <xs:annotation>
              <xs:documentation>Стек-трейс</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element minOccurs="0" name="message" type="xs:string">
            <xs:annotation>
              <xs:documentation>Сообщение об ошибке</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="errorCode" type="xs:int" use="required">
          <xs:annotation>
            <xs:documentation>Код ошибки</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wShAlHpHNw6RfsO82_pitXUTj</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/simiService/v5/types/" version="1.0" xmlns:cct="http://emias.mos.ru/simi/cct/v5/" xmlns:doc="http://emias.mos.ru/simi/document/v5/" xmlns:simicore="http://emias.mos.ru/simi/core/v5/" xmlns:tns="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/document/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wQlXXRbEu5B8xEV8OKo6cYgc-"/>
  <xs:import namespace="http://emias.mos.ru/simi/core/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTUeN2BFRYvYdnD_hDrwHLR8-"/>
  <xs:import namespace="http://emias.mos.ru/simi/cct/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTpZgC5viSZTrH4qCBUyAO00-"/>
  <!--query documents-->
  <xs:complexType name="DocumentsResultPage">
    <xs:annotation>
      <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="simicore:PagingResults">
        <xs:sequence>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="item" type="doc:Metadata">
            <xs:annotation>
              <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="DocumentsQueryData">
    <xs:annotation>
      <xs:documentation>Параметры отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="conditions">
        <xs:annotation>
          <xs:documentation>Условия отбора результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Условия отбора результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="condition" type="tns:DocumentsFilterCondition">
              <xs:annotation>
                <xs:documentation>Условие отбора Документов СИМИ</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element form="qualified" minOccurs="0" name="orderClauses">
        <xs:annotation>
          <xs:documentation>Способы сортировки результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Способы сортировки результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="orderClause" type="tns:DocumentsOrderClause">
              <xs:annotation>
                <xs:documentation>Способ сортировки результатов</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DocumentsFilterCondition">
    <xs:annotation>
      <xs:documentation>Условие отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="leftOperand" type="tns:DocumentsSearchAttribute">
        <xs:annotation>
          <xs:documentation>Левый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="rightOperand" type="xs:string">
        <xs:annotation>
          <xs:documentation>Правый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="operator" type="simicore:ComparisonType" use="required">
      <xs:annotation>
        <xs:documentation>Способ сравнения операндов</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="DocumentsOrderClause">
    <xs:annotation>
      <xs:documentation>Способ сортировки результатов отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="attributeName" type="tns:DocumentsSearchAttribute">
        <xs:annotation>
          <xs:documentation>Атрибут отбора Документов СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="ascending" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Направление сортировки (ascending/descending)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="DocumentsSearchAttribute">
    <xs:annotation>
      <xs:documentation>Атрибуты отбора Документов СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="PATIENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="STATUS">
        <xs:annotation>
          <xs:documentation>Статус документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIMI_VERSION">
        <xs:annotation>
          <xs:documentation>Версия объектной модели Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LINKS_PARENT">
        <xs:annotation>
          <xs:documentation>Восходящая зависимость</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LINKS_DESCENDANT">
        <xs:annotation>
          <xs:documentation>Нисходящая зависимость</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_SUBMISSION_SET">
        <xs:annotation>
          <xs:documentation>Идентификатор набора документов, которому принадлежит Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_CREATED">
        <xs:annotation>
          <xs:documentation>Дата/время создания Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VALID">
        <xs:annotation>
          <xs:documentation>Бизнес признак валидности контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGNEE_LOGIN">
        <xs:annotation>
          <xs:documentation>Логин пользователя, подписавшего электронной подписью документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CCT_CODE">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CARE_EVENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CARE_EVENT_STARTED">
        <xs:annotation>
          <xs:documentation>Дата/время начала Клинического события</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CARE_EVENT_FINISHED">
        <xs:annotation>
          <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="AUTHOR_LOGIN">
        <xs:annotation>
          <xs:documentation>Логин пользователя-автора Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_SCHEMA">
        <xs:annotation>
          <xs:documentation>Идентификатор терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_CODE">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_VALUE">
        <xs:annotation>
          <xs:documentation>Значение элемента терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TAG_ROLE">
        <xs:annotation>
          <xs:documentation>Роль элемента терминологии "Тэга"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_TARGET_DOCUMENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор целевого Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_TARGET_ROLE">
        <xs:annotation>
          <xs:documentation>Роль целевого Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_SOURCE_ROLE">
        <xs:annotation>
          <xs:documentation>Роль текущего Документа СИМИ по отношению к целевому Документу СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_TYPE_SCHEMA">
        <xs:annotation>
          <xs:documentation>Идентификатор типа междокументарной связи</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_TYPE_CODE">
        <xs:annotation>
          <xs:documentation>Код типа междокументарной связи</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_TYPE_VALUE">
        <xs:annotation>
          <xs:documentation>Значение типа междокументарной связи</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ASSOCIATION_TARGET_CCT_CODE">
        <xs:annotation>
          <xs:documentation>Код класса документов СИМИ, которому принадлежит целевой Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--query audit user actions-->
  <xs:complexType name="AuditResultPage">
    <xs:annotation>
      <xs:documentation>Результаты отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="simicore:PagingResults">
        <xs:sequence>
          <xs:element maxOccurs="unbounded" minOccurs="0" name="item" type="tns:AuditRecord">
            <xs:annotation>
              <xs:documentation>Результат отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="AuditQueryData">
    <xs:annotation>
      <xs:documentation>Параметры отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="conditions">
        <xs:annotation>
          <xs:documentation>Условия отбора результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Условия отбора результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" name="condition" type="tns:AuditFilterCondition">
              <xs:annotation>
                <xs:documentation>Условие отбора результатов</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
      <xs:element form="qualified" minOccurs="0" name="orderClauses">
        <xs:annotation>
          <xs:documentation>Способы сортировки результатов</xs:documentation>
        </xs:annotation>
        <xs:complexType>
          <xs:annotation>
            <xs:documentation>Способы сортировки результатов</xs:documentation>
          </xs:annotation>
          <xs:sequence>
            <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="orderClause" type="tns:AuditOrderClause">
              <xs:annotation>
                <xs:documentation>Способ сортировки результатов</xs:documentation>
              </xs:annotation>
            </xs:element>
          </xs:sequence>
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="AuditFilterCondition">
    <xs:annotation>
      <xs:documentation>Условие отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="leftOperand" type="tns:AuditSearchAttribute">
        <xs:annotation>
          <xs:documentation>Левый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="rightOperand" type="xs:string">
        <xs:annotation>
          <xs:documentation>Правый операнд в условии сравнения</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="operator" type="simicore:ComparisonType" use="required">
      <xs:annotation>
        <xs:documentation>Способ сравнения операндов</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="AuditOrderClause">
    <xs:annotation>
      <xs:documentation>Способ сортировки результатов отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="attributeName" type="tns:AuditSearchAttribute">
        <xs:annotation>
          <xs:documentation>Поле журнала аудита действий пользователей</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="ascending" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Направление сортировки (ascending/descending)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="AuditRecord">
    <xs:annotation>
      <xs:documentation>Запись Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="doc:documentId"/>
    </xs:sequence>
    <xs:attribute name="eventTime" type="xs:dateTime" use="required">
      <xs:annotation>
        <xs:documentation>Дата и время совершения операции пользователем</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="action" type="tns:UserActionType" use="required">
      <xs:annotation>
        <xs:documentation>Тип операции, совершенной пользователем</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="errorCode" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Код ошибки выполнения операции, совершенной пользователем</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="userLogin" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Логин пользователя, совершившего данную операцию</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="AuditSearchAttribute">
    <xs:annotation>
      <xs:documentation>Поля Журнала аудита операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="EVENT_TIME">
        <xs:annotation>
          <xs:documentation>Дата и время совершения операции пользователем</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ACTION">
        <xs:annotation>
          <xs:documentation>Тип операции, совершенной пользователем</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DOCUMENT_ID">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ERROR_CODE">
        <xs:annotation>
          <xs:documentation>Код ошибки выполнения операции, совершенной пользователем</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="USER_LOGIN">
        <xs:annotation>
          <xs:documentation>Логин пользователя, совершившего данную операцию</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="UserActionType">
    <xs:annotation>
      <xs:documentation>Типы операций, совершаемых пользователями</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="CREATE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Создание Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CHANGE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Изменение черновика Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGN_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Подписание Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Аннулирование Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ARCHIVE_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Архивирование Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNKNOWN_ACTION">
        <xs:annotation>
          <xs:documentation>Неизвестное действие</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="GET_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Получение документа</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SAVE_EXTERNAL_DOCUMENT">
        <xs:annotation>
          <xs:documentation>Сохранен подписанный документ за один шаг</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="UNKNOWN_SAVE">
        <xs:annotation>
          <xs:documentation>Неопределенное изменение при сохранении</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="CHANGE_METADATA">
        <xs:annotation>
          <xs:documentation>Изменены метаданные у документа, который находится в статусе SIGNING</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--requests & responses-->
  <xs:element name="archiveDocumentRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода archiveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода archiveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="doc:documentId"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="archiveDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода archiveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода archiveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence/>
    </xs:complexType>
  </xs:element>
  <xs:element name="createDocumentRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода createDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода createDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="cct:cctCode"/>
        <xs:element ref="simicore:patientId"/>
        <xs:element ref="simicore:careEventId"/>
        <xs:element ref="simicore:careEventStarted"/>
        <xs:element minOccurs="0" ref="simicore:careEventFinished"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="createDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода createDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода createDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="doc:document"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="deprecateDocumentRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода deprecateDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода deprecateDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="doc:documentId"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="deprecateDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода deprecateDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода deprecateDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence/>
    </xs:complexType>
  </xs:element>
  <xs:element name="getAuditRecordsRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getAuditRecords</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getAuditRecords</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="params" type="tns:AuditQueryData">
          <xs:annotation>
            <xs:documentation>Параметры отбора сведений об операциях, совершенных пользователями</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element minOccurs="0" ref="simicore:pagingOptions"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getAuditRecordsResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getAuditRecords</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getAuditRecords</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:AuditResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора сведений из Журнала аудита операций, совершаемых пользователями</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getCareEventDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="simicore:careEventId"/>
        <xs:element minOccurs="0" ref="cct:cctCode"/>
        <xs:element minOccurs="0" ref="simicore:pagingOptions"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getCareEventDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="doc:documentId"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="doc:document"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="saveDocumentRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода saveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода saveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="doc:document"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="saveDocumentResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода saveDocument</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода saveDocument</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element minOccurs="0" ref="doc:document"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="searchDocumentsRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода searchDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода searchDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element minOccurs="0" name="queryName" type="xs:string">
          <xs:annotation>
            <xs:documentation>Имя подготовленного (хранимого) запроса</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element name="params" type="tns:DocumentsQueryData">
          <xs:annotation>
            <xs:documentation>Параметры отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
        <xs:element minOccurs="0" ref="simicore:pagingOptions"/>
        <xs:element minOccurs="0" ref="simicore:options"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="searchDocumentsResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода searchDocuments</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода searchDocuments</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsForSignRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="simicore:careEventId"/>
        <xs:element minOccurs="0" ref="simicore:pagingOptions"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getCareEventDocumentsForSignResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsByPatientForSignRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getDocumentsByPatientForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element ref="simicore:patientId"/>
        <xs:element minOccurs="0" ref="simicore:pagingOptions"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsByPatientForSignResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getDocumentsByPatientForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsForSignRequest">
    <xs:annotation>
      <xs:documentation>Входные параметры метода getDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Входные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" minOccurs="0" ref="doc:documentId"/>
        <xs:element minOccurs="0" ref="simicore:pagingOptions"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="getDocumentsForSignResponse">
    <xs:annotation>
      <xs:documentation>Выходные параметры метода getDocumentsForSign</xs:documentation>
    </xs:annotation>
    <xs:complexType>
      <xs:annotation>
        <xs:documentation>Выходные параметры метода getCareEventDocumentsForSign</xs:documentation>
      </xs:annotation>
      <xs:sequence>
        <xs:element name="return" type="tns:DocumentsResultPage">
          <xs:annotation>
            <xs:documentation>Результаты отбора Документов СИМИ</xs:documentation>
          </xs:annotation>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wQlXXRbEu5B8xEV8OKo6cYgc-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/document/v5/" version="1.0" xmlns:cct="http://emias.mos.ru/simi/cct/v5/" xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:simicore="http://emias.mos.ru/simi/core/v5/" xmlns:tns="http://emias.mos.ru/simi/document/v5/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTUeN2BFRYvYdnD_hDrwHLR8-"/>
  <xs:import namespace="http://emias.mos.ru/simi/cct/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTpZgC5viSZTrH4qCBUyAO00-"/>
  <xs:import namespace="http://www.w3.org/2000/09/xmldsig#" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTLbWlpc_hChP4qzACBOF3y4-"/>
  <!--reusable elements-->
  <xs:element name="document" nillable="false" type="tns:Document">
    <xs:annotation>
      <xs:documentation>Документ СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="documentId" nillable="false" type="xs:string">
    <xs:annotation>
      <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="data" type="xs:base64Binary">
    <xs:annotation>
      <xs:documentation>Контент Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--document entity and its main sections-->
  <xs:complexType name="DocumentTag">
    <xs:annotation>
      <xs:documentation>Представляет "Тэг" Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="simicore:Tag">
        <xs:attribute name="definedByCct" type="xs:boolean" use="required">
          <xs:annotation>
            <xs:documentation>Признак принадлежности "Тэга" к взятым из CCT терминологии "Тэгам"</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="DocumentTagCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию "Тэгов" Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="tag" type="tns:DocumentTag">
        <xs:annotation>
          <xs:documentation>Представляет "Тэг" Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Document">
    <xs:annotation>
      <xs:documentation>Представляет Документ СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="metadata" type="tns:Metadata">
        <xs:annotation>
          <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="content" type="tns:Content">
        <xs:annotation>
          <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="signature" type="tns:Signature">
        <xs:annotation>
          <xs:documentation>Описывает сведения об электронной подписи Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Metadata">
    <xs:annotation>
      <xs:documentation>Представляет метаданные Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:documentId">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="documentInfo" type="tns:DocumentInfo">
        <xs:annotation>
          <xs:documentation>Базовые сведения о Документе СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="cct:visualizations">
        <xs:annotation>
          <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="confidentialityTags" type="tns:DocumentTagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, определяющих уровень конфеденциальности Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="links" type="tns:Links">
        <xs:annotation>
          <xs:documentation>Сведения о междокументарных связях Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="associations" type="tns:Associations">
        <xs:annotation>
          <xs:documentation>Сведения об ассоциациях между Документами СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="status" type="tns:Status" use="required">
      <xs:annotation>
        <xs:documentation>Статус документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="authorLogin" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Логин пользователя-автора Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signeeLogin" type="xs:string">
      <xs:annotation>
        <xs:documentation>Логин пользователя, подписавшего электронной подписью документ СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Content">
    <xs:annotation>
      <xs:documentation>Описывает контент Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="visualization" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>XSLT преобразование, использованное при подписании контента Документа СИМИ
                        электронной подписью</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:data">
        <xs:annotation>
          <xs:documentation>Контент Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="mimeClass" type="cct:MimeClass" use="required">
      <xs:annotation>
        <xs:documentation>MIME-класс, которому принадлежит контент Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="mimeType" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>MIME-тип, которому принадлежит контент Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="valid" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Бизнес признак валидности контента Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Signature">
    <xs:annotation>
      <xs:documentation>Описывает сведения об электронной подписи Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="ds:Signature">
        <xs:annotation>
          <xs:documentation>Цифровая подпись по стандарту XMLDSig</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="signatureCAdES" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>Цифровая подпись по стандарту CAdES</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="technicalSignature" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Признак (true/false) использования технической подписи для подписания Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="userFIO" type="xs:string">
      <xs:annotation>
        <xs:documentation>ФИО подписанта</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="dateSign" type="xs:dateTime" use="required">
      <xs:annotation>
        <xs:documentation>Дата подписания</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="jobExecutionId" type="xs:long">
      <xs:annotation>
        <xs:documentation>Идентификатор исполняемой должности</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signMO" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Признак (true/false) подписи медицинской организации</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signeeLogin" type="xs:string">
      <xs:annotation>
        <xs:documentation>Логин пользователя, подписавшего документ электронной подписью (указывается только при
                    использовании технической подписи, то есть если атрибут technicalSignature=true)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="deprecated" type="xs:dateTime">
      <xs:annotation>
        <xs:documentation>Дата/время аннулирования подписанного документа (указывается только если Документ СИМИ
                    аннулирован то есть его статус установлен в DEPRECATED)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--documents' metadata description elements-->
  <xs:complexType name="CctInfo">
    <xs:annotation>
      <xs:documentation>Сведения о Классе документов СИМИ (определенный терминологией CCT), которому принадлежит
                данный Документ СИМИ</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="simicore:Tag">
        <xs:sequence>
          <xs:element ref="cct:cctParameters">
            <xs:annotation>
              <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ,
                                определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element ref="cct:contentTypeInfo">
            <xs:annotation>
              <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося
                                представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="DocumentInfo">
    <xs:annotation>
      <xs:documentation>Описывает базовые сведения о Документе СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="simicore:patientId">
        <xs:annotation>
          <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="simicore:careEventId">
        <xs:annotation>
          <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="simicore:careEventStarted">
        <xs:annotation>
          <xs:documentation>Дата/время начала Клинического события</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" ref="simicore:careEventFinished">
        <xs:annotation>
          <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element form="qualified" name="cctInfo" type="tns:CctInfo">
        <xs:annotation>
          <xs:documentation>Сведения о Классе документов СИМИ (определенный терминологией CCT), которому
                        принадлежит данный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="tags" type="tns:DocumentTagCollection">
        <xs:annotation>
          <xs:documentation>Тэги Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="documentCreated" type="xs:dateTime" use="required">
      <xs:annotation>
        <xs:documentation>Дата/время создания Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="documentSubmissionSetId" type="xs:string">
      <xs:annotation>
        <xs:documentation>Идентификатор набора документов, которому принадлежит Документ СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="simiVersion" type="xs:unsignedShort" use="required">
      <xs:annotation>
        <xs:documentation>Версия объектной модели Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--enumerations-->
  <xs:simpleType name="Status">
    <xs:annotation>
      <xs:documentation>Представляет перечисление статусов Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="CREATED">
        <xs:annotation>
          <xs:documentation>Созданный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DRAFT">
        <xs:annotation>
          <xs:documentation>Черновик Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGNED">
        <xs:annotation>
          <xs:documentation>Подписанный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="SIGNING">
        <xs:annotation>
          <xs:documentation>Подписывающийся Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATED">
        <xs:annotation>
          <xs:documentation>Аннулированный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ARCHIVED">
        <xs:annotation>
          <xs:documentation>Архивированный Документ СИМИ</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:complexType name="LinkedDocument">
    <xs:annotation>
      <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element ref="tns:documentId">
        <xs:annotation>
          <xs:documentation>Идентификатор Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Links">
    <xs:annotation>
      <xs:documentation>Сведения о междокументарных связях Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="parent" type="tns:LinkedDocument">
        <xs:annotation>
          <xs:documentation>Документ-родитель</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="descendants" type="tns:LinkedDocument">
        <xs:annotation>
          <xs:documentation>Документы-потомки</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="AssociationType">
    <xs:annotation>
      <xs:documentation>Тип ассоциации между Документами СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="schema" type="xs:string">
        <xs:annotation>
          <xs:documentation>Идентификатор терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="value" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Association">
    <xs:annotation>
      <xs:documentation>Ассоциация между Документами СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="myRole" type="xs:string">
        <xs:annotation>
          <xs:documentation>Роль текущего Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="otherRole" type="xs:string">
        <xs:annotation>
          <xs:documentation>Роль другого Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="type" type="tns:AssociationType">
        <xs:annotation>
          <xs:documentation>Тип ассоциации</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="otherId" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Идентификатор другого Документа СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="Associations">
    <xs:annotation>
      <xs:documentation>Сведения об ассоциациях между Документами СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="association" type="tns:Association">
        <xs:annotation>
          <xs:documentation>Ассоциация между Документами СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTUeN2BFRYvYdnD_hDrwHLR8-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/core/v5/" version="1.0" xmlns:tns="http://emias.mos.ru/simi/core/v5/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wStcNMYJZ0u2i5cYGH_KL84s-"/>
  <!--business entities which don't belong to SIMI services-->
  <xs:element name="patientId" type="xs:long">
    <xs:annotation>
      <xs:documentation>Идентификатор Пациента в ЕМИАС</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventId" type="xs:long">
    <xs:annotation>
      <xs:documentation>Идентификатор Клинического события в операционном сервисе ЕМИАС.СУПП.События</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventStarted" type="xs:dateTime">
    <xs:annotation>
      <xs:documentation>Дата/время начала Клинического события</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="careEventFinished" type="xs:dateTime">
    <xs:annotation>
      <xs:documentation>Дата/время окончания Клинического события</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--base types-->
  <xs:complexType name="Tag">
    <xs:annotation>
      <xs:documentation>Представляет "Тэг"</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="schema" type="xs:string">
        <xs:annotation>
          <xs:documentation>Идентификатор терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="code" type="xs:string">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="value" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="role" type="xs:string">
      <xs:annotation>
        <xs:documentation>Назначение/роль "Тэга"</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="TagCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию "Тэгов"</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="tag" type="tns:Tag">
        <xs:annotation>
          <xs:documentation>Представляет "Тэг"</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="ComparisonType">
    <xs:annotation>
      <xs:documentation>Представляет перечисление типов сравнения значений</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="GT">
        <xs:annotation>
          <xs:documentation>Сравнение "больше чем"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="GE">
        <xs:annotation>
          <xs:documentation>Сравнение "больше или равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="EQ">
        <xs:annotation>
          <xs:documentation>Сравнение "в точности равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LT">
        <xs:annotation>
          <xs:documentation>Сравнение "меньше чем"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LE">
        <xs:annotation>
          <xs:documentation>Сравнение "меньше или равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="LIKE">
        <xs:annotation>
          <xs:documentation>Сравнение по подстроке</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="NE">
        <xs:annotation>
          <xs:documentation>Сравнение "не равно"</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wStcNMYJZ0u2i5cYGH_KL84s-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<!--edited with XMLSpy v2017 rel. 3 sp1 (x64) (http://www.altova.com) by Vladimir Makarov (Private)-->
<xs:schema attributeFormDefault="unqualified" elementFormDefault="qualified" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:include schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wT2c7RR2Mr0q5YRmjA.MCyXw-"/>
  <!--references-->
  <xs:element name="medicalOrganizationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинской организации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="medicalFacilityId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор Медицинского учреждения</xs:documentation>
    </xs:annotation>
  </xs:element>
  <!--async operation status-->
  <xs:element name="operationId" type="ID">
    <xs:annotation>
      <xs:documentation>Идентификатор операции</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="OperationExecutionStatus">
    <xs:annotation>
      <xs:documentation>Статус выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="isCompleted" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак окончания выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="completenessProgress" type="OperationCompletenessBase">
        <xs:annotation>
          <xs:documentation>Сведения о текущем статусе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="hasSucceded" type="xs:boolean">
        <xs:annotation>
          <xs:documentation>Признак успешности выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="messages" type="ErrorMessageCollection">
        <xs:annotation>
          <xs:documentation>Коллекция сообщений, порожденных в ходе выполнения операции</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="id" type="ID" use="required">
      <xs:annotation>
        <xs:documentation>Идентификатор операции</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType abstract="false" name="OperationCompletenessPercentage">
    <xs:annotation>
      <xs:documentation>Описание текущего статуса выполнения операции в процентах (0%-100%)</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="OperationCompletenessBase">
        <xs:sequence>
          <xs:element name="completenessStatus">
            <xs:annotation>
              <xs:documentation>Статус (0%-100%)</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
              <xs:restriction base="xs:unsignedByte">
                <xs:minInclusive value="0"/>
                <xs:maxInclusive value="100"/>
              </xs:restriction>
            </xs:simpleType>
          </xs:element>
        </xs:sequence>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="OperationCompletenessBase">
    <xs:annotation>
      <xs:documentation>Базовый абстрактный тип для описания текущего статуса выполнения операции</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
  </xs:complexType>
  <!--calling methods' options-->
  <xs:element name="options" type="Options">
    <xs:annotation>
      <xs:documentation>Параметры вызова метода</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="Options">
    <xs:annotation>
      <xs:documentation>Набор именованных значений</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="entry" type="KeyValuePair">
        <xs:annotation>
          <xs:documentation>Именованное значение</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <!--pagination-->
  <xs:element name="pagingOptions" type="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType abstract="true" name="PagingResults">
    <xs:annotation>
      <xs:documentation>Список с пагинацией</xs:documentation>
    </xs:annotation>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageTotal" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Общее количество страниц</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="morePagesAvailable" type="xs:boolean" use="required">
      <xs:annotation>
        <xs:documentation>Флаг доступности других страниц с результатами для "постраничного листания" (true - если доступны еще страницы; false - иначе)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:complexType name="PagingOptions">
    <xs:annotation>
      <xs:documentation>Параметры пагинации</xs:documentation>
    </xs:annotation>
    <xs:sequence/>
    <xs:attribute name="pageNumber" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Номер страницы (zero-based)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="pageSize" type="xs:int" use="required">
      <xs:annotation>
        <xs:documentation>Размер страницы</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--base types-->
  <xs:complexType name="TimeInterval">
    <xs:annotation>
      <xs:documentation>Временной период (время)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время начала интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:time">
        <xs:annotation>
          <xs:documentation>Время окончания интервала</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DatePeriod">
    <xs:annotation>
      <xs:documentation>Временной период (дата)</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" name="start" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата начала периода</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="end" type="xs:date">
        <xs:annotation>
          <xs:documentation>Дата окончания периода</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTpZgC5viSZTrH4qCBUyAO00-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://emias.mos.ru/simi/cct/v5/" version="1.0" xmlns:simicore="http://emias.mos.ru/simi/core/v5/" xmlns:tns="http://emias.mos.ru/simi/cct/v5/" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:import namespace="http://emias.mos.ru/simi/core/v5/" schemaLocation="http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTUeN2BFRYvYdnD_hDrwHLR8-"/>
  <!--reusable elements-->
  <xs:element name="cctCode" nillable="false" type="xs:unsignedInt">
    <xs:annotation>
      <xs:documentation>Код элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctItem" type="tns:CctItem">
    <xs:annotation>
      <xs:documentation>Представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctFolder" type="tns:CctFolder">
    <xs:annotation>
      <xs:documentation>Представление группирующего элемента терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctItemCollection" type="tns:CctItemCollection">
    <xs:annotation>
      <xs:documentation>Набор элементов и группирующих элементов терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="cctParameters" type="simicore:TagCollection">
    <xs:annotation>
      <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:attribute name="lifecycleState" type="tns:LifecycleState">
    <xs:annotation>
      <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
    </xs:annotation>
  </xs:attribute>
  <!--description of cct type-->
  <xs:complexType name="CctItemCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию элементов и группирующих элементов терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="cctFolder" type="tns:CctFolder">
        <xs:annotation>
          <xs:documentation>Набор группирующих элементов терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="cctItem" type="tns:CctItem">
        <xs:annotation>
          <xs:documentation>Набор элементов терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="CctItem">
    <xs:annotation>
      <xs:documentation>Представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CctBase">
        <xs:sequence>
          <xs:element ref="tns:contentTypeInfo">
            <xs:annotation>
              <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
          <xs:element ref="tns:cctParameters">
            <xs:annotation>
              <xs:documentation>Представляет параметры, специфичные для Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
            </xs:annotation>
          </xs:element>
        </xs:sequence>
        <xs:attribute name="canDeprecateAfterSign" type="xs:boolean" use="optional">
          <xs:annotation>
            <xs:documentation>Признак возможности анулирования Документа СИМИ после его подписания ЭП (если не задан - true)</xs:documentation>
          </xs:annotation>
        </xs:attribute>
        <xs:attribute ref="tns:lifecycleState">
          <xs:annotation>
            <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
          </xs:annotation>
        </xs:attribute>
      </xs:extension>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType name="CctFolder">
    <xs:annotation>
      <xs:documentation>Представление группирующего элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:complexContent>
      <xs:extension base="tns:CctBase"/>
    </xs:complexContent>
  </xs:complexType>
  <xs:complexType abstract="true" name="CctBase">
    <xs:annotation>
      <xs:documentation>Базовое представление элемента терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="tns:cctCode">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="cctDescription" type="xs:string">
        <xs:annotation>
          <xs:documentation>Описание элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="tags" type="simicore:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, наследуемых Документом СИМИ, вследствие его принадлежности к Классу документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="confidentialityTags" type="simicore:TagCollection">
        <xs:annotation>
          <xs:documentation>Коллекция Тэгов, определяющих уровень конфиденциальности Документа СИМИ, наследуемых Документом СИМИ, вследствие его принадлежности к Классу документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="parentCode" type="xs:unsignedInt" use="required">
      <xs:annotation>
        <xs:documentation>Код родительского элемента терминологиии CCT</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <!--content type description-->
  <xs:element name="contentTypeInfo" type="tns:ContentTypeInfo">
    <xs:annotation>
      <xs:documentation>Представляет тип контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="ContentTypeInfo">
    <xs:annotation>
      <xs:documentation>Описывает сведения о типе контента, разрешенного для Документа СИМИ, являющегося представителем Класса документов СИМИ, определенного элементом терминологии CCT</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" name="mimeType" type="xs:string">
        <xs:annotation>
          <xs:documentation>Коллекция MIME-типов, разрешенных для Класса документов СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="mimeClass" type="tns:MimeClass" use="required">
      <xs:annotation>
        <xs:documentation>MIME-класс, определенный для Класса документов СИМИ</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="MimeClass">
    <xs:annotation>
      <xs:documentation>Представляет перечисление типов контента Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="APPLICATION">
        <xs:annotation>
          <xs:documentation>Любые двоичные данные</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="AUDIO">
        <xs:annotation>
          <xs:documentation>Аудио</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="IMAGE">
        <xs:annotation>
          <xs:documentation>Изображение</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="TEXT">
        <xs:annotation>
          <xs:documentation>Текст</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VIDEO">
        <xs:annotation>
          <xs:documentation>Видео</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="VND">
        <xs:annotation>
          <xs:documentation>Вендор-зависимый класс контента</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="X">
        <xs:annotation>
          <xs:documentation>Нестандартный подтип, не зарегистрирован в «Центре присвоенных номеров Интернета» (IANA)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <!--visualization description-->
  <xs:element name="visualizationId" nillable="false" type="xs:string">
    <xs:annotation>
      <xs:documentation>Представляет идентификатор XSLT представления контента Документа СИМИ</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:element name="visualizations" type="tns:VisualizationCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
    </xs:annotation>
  </xs:element>
  <xs:complexType name="VisualizationCollection">
    <xs:annotation>
      <xs:documentation>Представляет коллекцию сведений о XSLT преобразованиях</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element maxOccurs="unbounded" minOccurs="0" name="visualization" type="tns:Visualization">
        <xs:annotation>
          <xs:documentation>Представляет сведения о XSLT преобразовании, которое может быть использовано для визуализации контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="Visualization">
    <xs:annotation>
      <xs:documentation>Описывает сведения о XSLT преобразовании, которое может быть использовано для визуализации контента Документа СИМИ</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element minOccurs="0" ref="tns:visualizationId">
        <xs:annotation>
          <xs:documentation>Представляет идентификатор XSLT представления контента Документа СИМИ</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element ref="tns:cctCode">
        <xs:annotation>
          <xs:documentation>Код элемента терминологии CCT</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element name="visualizationInfo" type="tns:VisualizationInfo">
        <xs:annotation>
          <xs:documentation>Базовые сведения о XSLT преобразовании</xs:documentation>
        </xs:annotation>
      </xs:element>
      <xs:element minOccurs="0" name="visualizationData" type="xs:base64Binary">
        <xs:annotation>
          <xs:documentation>Данные XSLT преобразования в формате base64</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="VisualizationInfo">
    <xs:annotation>
      <xs:documentation>Описывает базовые сведения о XSLT преобразовании</xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element form="qualified" name="tags" type="simicore:TagCollection">
        <xs:annotation>
          <xs:documentation>Тэги XSLT преобразования</xs:documentation>
        </xs:annotation>
      </xs:element>
    </xs:sequence>
    <xs:attribute name="name" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Наименование XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="description" type="xs:string" use="required">
      <xs:annotation>
        <xs:documentation>Описание XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="xsltVersion" type="tns:XsltVersion" use="required">
      <xs:annotation>
        <xs:documentation>Версия спецификации XSLT преобразования</xs:documentation>
      </xs:annotation>
    </xs:attribute>
    <xs:attribute name="signature" type="xs:boolean">
      <xs:annotation>
        <xs:documentation>Признак (true/false) возможности использования данного XSLT преобразования для визуализации контента Документа СИМИ при его подписании (истинное значение должен иметь только один элемент списка)</xs:documentation>
      </xs:annotation>
    </xs:attribute>
  </xs:complexType>
  <xs:simpleType name="XsltVersion">
    <xs:annotation>
      <xs:documentation>Представляет перечисление версий спецификаций XSLT преобразований</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="XSLT_1_0">
        <xs:annotation>
          <xs:documentation>Версия 1.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_1_1">
        <xs:annotation>
          <xs:documentation>Версия 1.1</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_2_0">
        <xs:annotation>
          <xs:documentation>Версия 2.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="XSLT_3_0">
        <xs:annotation>
          <xs:documentation>Версия 3.0</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="LifecycleState">
    <xs:annotation>
      <xs:documentation>Состояние жизненного цикла элемента CCT</xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="ALPHA">
        <xs:annotation>
          <xs:documentation>Доступ на АРМ врача возможен только у модельеров</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="BETA">
        <xs:annotation>
          <xs:documentation>Предоставляется тестовый доступ врачам</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="ACTIVE">
        <xs:annotation>
          <xs:documentation>Свободное (промышленное) использование</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
      <xs:enumeration value="DEPRECATED">
        <xs:annotation>
          <xs:documentation>Элемент терминологии является "архивным" (более не используется)</xs:documentation>
        </xs:annotation>
      </xs:enumeration>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part><con:part><con:url>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService?wsdl=AAAADHAjUCM4P2cuZURELi98RDQPMaHHvg8b8xpVn.MGIEHVggmCXbQ0dhtcMqGCCf5p9E2fX2xHY6a_FzSeMjAmCycg7tWR7G9lxjiCln.4RrsqhanG_w3UiEX.KZtbDKO5Yyms8ZXQkw6wTLbWlpc_hChP4qzACBOF3y4-</con:url><con:content><![CDATA[<!--Published by JAX-WS RI (http://jax-ws.java.net). RI's version is Metro/2.4.3 (RELEASE-2.4.3-ad3323c; 2019-01-21T17:46:06+0000) JAXWS-RI/2.3.2 JAXWS-API/2.3.2 JAXB-RI/2.3.2 JAXB-API/2.3.2 git-revision#unknown.-->
<xs:schema targetNamespace="http://www.w3.org/2000/09/xmldsig#" version="1.0" xmlns:tns="http://www.w3.org/2000/09/xmldsig#" xmlns:xs="http://www.w3.org/2001/XMLSchema">
  <xs:element name="CanonicalizationMethod" type="tns:CanonicalizationMethodType"/>
  <xs:element name="DSAKeyValue" type="tns:DSAKeyValueType"/>
  <xs:element name="DigestMethod" type="tns:DigestMethodType"/>
  <xs:element name="DigestValue" type="tns:DigestValueType"/>
  <xs:element name="HMACOutputLength" type="tns:HMACOutputLengthType"/>
  <xs:element name="KeyInfo" type="tns:KeyInfoType"/>
  <xs:element name="KeyName" type="xs:string"/>
  <xs:element name="KeyValue" type="tns:KeyValueType"/>
  <xs:element name="Manifest" type="tns:ManifestType"/>
  <xs:element name="MgmtData" type="xs:string"/>
  <xs:element name="Object" type="tns:ObjectType"/>
  <xs:element name="PGPData" type="tns:PGPDataType"/>
  <xs:element name="PGPKeyID" type="xs:base64Binary"/>
  <xs:element name="PGPKeyPacket" type="xs:base64Binary"/>
  <xs:element name="RSAKeyValue" type="tns:RSAKeyValueType"/>
  <xs:element name="Reference" type="tns:ReferenceType"/>
  <xs:element name="RetrievalMethod" type="tns:RetrievalMethodType"/>
  <xs:element name="SPKIData" type="tns:SPKIDataType"/>
  <xs:element name="SPKISexp" type="xs:base64Binary"/>
  <xs:element name="Signature" type="tns:SignatureType"/>
  <xs:element name="SignatureMethod" type="tns:SignatureMethodType"/>
  <xs:element name="SignatureProperties" type="tns:SignaturePropertiesType"/>
  <xs:element name="SignatureProperty" type="tns:SignaturePropertyType"/>
  <xs:element name="SignatureValue" type="tns:SignatureValueType"/>
  <xs:element name="SignedInfo" type="tns:SignedInfoType"/>
  <xs:element name="Transform" type="tns:TransformType"/>
  <xs:element name="Transforms" type="tns:TransformsType"/>
  <xs:element name="X509CRL" type="xs:base64Binary"/>
  <xs:element name="X509Certificate" type="xs:base64Binary"/>
  <xs:element name="X509Data" type="tns:X509DataType"/>
  <xs:element name="X509IssuerSerial" type="tns:X509IssuerSerialType"/>
  <xs:element name="X509SKI" type="xs:base64Binary"/>
  <xs:element name="X509SubjectName" type="xs:string"/>
  <xs:element name="XPath" type="xs:string"/>
  <xs:complexType mixed="true" name="ObjectType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
    <xs:attribute name="MimeType" type="xs:string"/>
    <xs:attribute name="Encoding" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="ManifestType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="Reference" type="tns:ReferenceType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="ReferenceType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="Transforms" type="tns:TransformsType"/>
      <xs:element form="qualified" name="DigestMethod" type="tns:DigestMethodType"/>
      <xs:element form="qualified" name="DigestValue" type="xs:base64Binary"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
    <xs:attribute name="URI" type="xs:anyURI"/>
    <xs:attribute name="Type" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="TransformsType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="Transform" type="tns:TransformType"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="TransformType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:XPath"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="DigestMethodType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType name="X509DataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:X509Certificate"/>
        <xs:element ref="tns:X509SubjectName"/>
        <xs:element ref="tns:X509CRL"/>
        <xs:element ref="tns:X509IssuerSerial"/>
        <xs:element ref="tns:X509SKI"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="SignedInfoType">
    <xs:sequence>
      <xs:element form="qualified" name="CanonicalizationMethod" type="tns:CanonicalizationMethodType"/>
      <xs:element form="qualified" name="SignatureMethod" type="tns:SignatureMethodType"/>
      <xs:element form="qualified" maxOccurs="unbounded" name="Reference" type="tns:ReferenceType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="CanonicalizationMethodType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="SignatureMethodType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:HMACOutputLength"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Algorithm" type="xs:anyURI" use="required"/>
  </xs:complexType>
  <xs:complexType name="PGPDataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:PGPKeyID"/>
        <xs:element ref="tns:PGPKeyPacket"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="KeyInfoType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:X509Data"/>
        <xs:element ref="tns:KeyValue"/>
        <xs:element ref="tns:RetrievalMethod"/>
        <xs:element ref="tns:KeyName"/>
        <xs:element ref="tns:MgmtData"/>
        <xs:element ref="tns:PGPData"/>
        <xs:element ref="tns:SPKIData"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="SignatureType">
    <xs:sequence>
      <xs:element form="qualified" name="SignedInfo" type="tns:SignedInfoType"/>
      <xs:element form="qualified" name="SignatureValue" type="tns:SignatureValueType"/>
      <xs:element form="qualified" minOccurs="0" name="KeyInfo" type="tns:KeyInfoType"/>
      <xs:element form="qualified" maxOccurs="unbounded" minOccurs="0" name="Object" type="tns:ObjectType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="SignatureValueType">
    <xs:simpleContent>
      <xs:extension base="xs:base64Binary">
        <xs:attribute name="Id" type="xs:ID"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:complexType name="SPKIDataType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:SPKISexp"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType mixed="true" name="KeyValueType">
    <xs:sequence>
      <xs:choice maxOccurs="unbounded" minOccurs="0">
        <xs:element ref="tns:DSAKeyValue"/>
        <xs:element ref="tns:RSAKeyValue"/>
        <xs:any namespace="##other" processContents="lax"/>
      </xs:choice>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="HMACOutputLengthType">
    <xs:restriction base="xs:integer"/>
  </xs:simpleType>
  <xs:complexType name="X509IssuerSerialType">
    <xs:sequence>
      <xs:element form="qualified" name="X509IssuerName" type="xs:string"/>
      <xs:element form="qualified" name="X509SerialNumber" type="xs:integer"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="DSAKeyValueType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="P" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="Q" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="G" type="xs:base64Binary"/>
      <xs:element form="qualified" name="Y" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="J" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="Seed" type="xs:base64Binary"/>
      <xs:element form="qualified" minOccurs="0" name="PgenCounter" type="xs:base64Binary"/>
    </xs:sequence>
  </xs:complexType>
  <xs:complexType name="RetrievalMethodType">
    <xs:sequence>
      <xs:element form="qualified" minOccurs="0" name="Transforms" type="tns:TransformsType"/>
    </xs:sequence>
    <xs:attribute name="URI" type="xs:anyURI"/>
    <xs:attribute name="Type" type="xs:anyURI"/>
  </xs:complexType>
  <xs:complexType name="SignaturePropertiesType">
    <xs:sequence>
      <xs:element form="qualified" maxOccurs="unbounded" name="SignatureProperty" type="tns:SignaturePropertyType"/>
    </xs:sequence>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType mixed="true" name="SignaturePropertyType">
    <xs:sequence>
      <xs:any maxOccurs="unbounded" minOccurs="0" namespace="##other" processContents="lax"/>
    </xs:sequence>
    <xs:attribute name="Target" type="xs:anyURI" use="required"/>
    <xs:attribute name="Id" type="xs:ID"/>
  </xs:complexType>
  <xs:complexType name="RSAKeyValueType">
    <xs:sequence>
      <xs:element form="qualified" name="Modulus" type="xs:base64Binary"/>
      <xs:element form="qualified" name="Exponent" type="xs:base64Binary"/>
    </xs:sequence>
  </xs:complexType>
  <xs:simpleType name="DigestValueType">
    <xs:restriction base="xs:base64Binary"/>
  </xs:simpleType>
</xs:schema>]]></con:content><con:type>http://www.w3.org/2001/XMLSchema</con:type></con:part></con:definitionCache><con:endpoints><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint></con:endpoints><con:operation id="18334c2a-ff5b-476a-bed3-3bbf2a4b38c2" isOneWay="false" action="archiveDocument" name="archiveDocument" bindingOperationName="archiveDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="fc259ad7-4caf-42de-9b36-f223419c93f7" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:archiveDocumentRequest>\r
         <v5:documentId>?</v5:documentId>\r
         <!--Optional:-->\r
         <v51:options>\r
            <!--Zero or more repetitions:-->\r
            <v51:entry key="?">?</v51:entry>\r
         </v51:options>\r
      </typ:archiveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/archiveDocumentRequest"/></con:call></con:operation><con:operation id="c81f5c7f-f325-47ac-ba73-890fbd1590e5" isOneWay="false" action="createDocument" name="createDocument" bindingOperationName="createDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="ad26cdf2-945d-4bca-9598-be7de0abaa16" name="Request 1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>INSTRUMENTAL/RBeda</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>\r
         <user:systemName>INSTRUMENTAL</user:systemName>\r
         <user:userName>RBeda</user:userName>\r
         <user:userRoleId>5</user:userRoleId>\r
                <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>400001</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>121397062</user:jobExecutionId>\r
             </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:createDocumentRequest>\r
         <v5:cctCode>46081</v5:cctCode>\r
         <v51:patientId>111</v51:patientId>\r
         <v51:careEventId>23334</v51:careEventId>\r
         <v51:careEventStarted>2022-09-28T11:11:11</v51:careEventStarted>\r
            </typ:createDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/createDocumentRequest"/><con:wsrmConfig version="1.2"/></con:call></con:operation><con:operation id="43ab4b9c-e7b1-49c2-abf5-7daa5cdc4a6a" isOneWay="false" action="deprecateDocument" name="deprecateDocument" bindingOperationName="deprecateDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="afadd129-589b-4f25-b114-95deca9b7d16" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>?</v5:documentId>\r
         <!--Optional:-->\r
         <v51:options>\r
            <!--Zero or more repetitions:-->\r
            <v51:entry key="?">?</v51:entry>\r
         </v51:options>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/deprecateDocumentRequest"/></con:call></con:operation><con:operation id="ae6b9f81-fabc-418a-8352-b497bae617fb" isOneWay="false" action="getAuditRecords" name="getAuditRecords" bindingOperationName="getAuditRecords" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="14f618df-f20d-477e-9f70-24a20b41de09" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:getAuditRecordsRequest>\r
         <params>\r
            <typ:conditions>\r
               <!--1 or more repetitions:-->\r
               <typ:condition operator="?">\r
                  <typ:leftOperand>?</typ:leftOperand>\r
                  <typ:rightOperand>?</typ:rightOperand>\r
               </typ:condition>\r
            </typ:conditions>\r
            <!--Optional:-->\r
            <typ:orderClauses>\r
               <!--Zero or more repetitions:-->\r
               <typ:orderClause ascending="?">\r
                  <typ:attributeName>?</typ:attributeName>\r
               </typ:orderClause>\r
            </typ:orderClauses>\r
         </params>\r
         <!--Optional:-->\r
         <v5:pagingOptions pageNumber="?" pageSize="?"/>\r
         <!--Optional:-->\r
         <v5:options>\r
            <!--Zero or more repetitions:-->\r
            <v5:entry key="?">?</v5:entry>\r
         </v5:options>\r
      </typ:getAuditRecordsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/getAuditRecordsRequest"/></con:call></con:operation><con:operation id="ebb09d31-164b-47bf-aeac-24e6ccd00e29" isOneWay="false" action="getCareEventDocuments" name="getCareEventDocuments" bindingOperationName="getCareEventDocuments" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="caad10ba-780d-45eb-9ad9-66674391ea4a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/core/v5/" xmlns:v51="http://emias.mos.ru/simi/cct/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:getCareEventDocumentsRequest>\r
         <v5:careEventId>?</v5:careEventId>\r
         <!--Optional:-->\r
         <v51:cctCode>?</v51:cctCode>\r
         <!--Optional:-->\r
         <v5:pagingOptions pageNumber="?" pageSize="?"/>\r
         <!--Optional:-->\r
         <v5:options>\r
            <!--Zero or more repetitions:-->\r
            <v5:entry key="?">?</v5:entry>\r
         </v5:options>\r
      </typ:getCareEventDocumentsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/getCareEventDocumentsRequest"/></con:call></con:operation><con:operation id="762e8876-1143-49e5-bdde-ccd967c53be6" isOneWay="false" action="getCareEventDocumentsForSign" name="getCareEventDocumentsForSign" bindingOperationName="getCareEventDocumentsForSign" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="97c3aa5a-bca0-48d2-9be5-51de5436783a" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:getCareEventDocumentsForSignRequest>\r
         <v5:careEventId>?</v5:careEventId>\r
         <!--Optional:-->\r
         <v5:pagingOptions pageNumber="?" pageSize="?"/>\r
      </typ:getCareEventDocumentsForSignRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/getCareEventDocumentsForSignRequest"/></con:call></con:operation><con:operation id="09e21ff8-c73d-4534-8df3-5743e4fbbf99" isOneWay="false" action="getDocument" name="getDocument" bindingOperationName="getDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="3ca0f2ec-ee34-4851-a5ba-71b1192a9d83" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>?</v5:documentId>\r
         <!--Optional:-->\r
         <v51:options>\r
            <!--Zero or more repetitions:-->\r
            <v51:entry key="?">?</v51:entry>\r
         </v51:options>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/getDocumentRequest"/></con:call></con:operation><con:operation id="c1a05492-80e8-4591-b957-ce661edb9c91" isOneWay="false" action="getDocumentsByPatientForSign" name="getDocumentsByPatientForSign" bindingOperationName="getDocumentsByPatientForSign" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="59f6f42f-567b-4b0d-a85b-1a07b10d695d" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:getDocumentsByPatientForSignRequest>\r
         <v5:patientId>?</v5:patientId>\r
         <!--Optional:-->\r
         <v5:pagingOptions pageNumber="?" pageSize="?"/>\r
      </typ:getDocumentsByPatientForSignRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/getDocumentsByPatientForSignRequest"/></con:call></con:operation><con:operation id="5e7afba0-7157-4d34-8ae9-6c110ffdf397" isOneWay="false" action="getDocumentsForSign" name="getDocumentsForSign" bindingOperationName="getDocumentsForSign" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="9a713a44-67ac-46f9-a322-6d0b3765ff7f" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:getDocumentsForSignRequest>\r
         <!--Zero or more repetitions:-->\r
         <v5:documentId>?</v5:documentId>\r
         <!--Optional:-->\r
         <v51:pagingOptions pageNumber="?" pageSize="?"/>\r
      </typ:getDocumentsForSignRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/getDocumentsForSignRequest"/></con:call></con:operation><con:operation id="fa9b3be1-88b2-464d-b532-0e269dd56473" isOneWay="false" action="saveDocument" name="saveDocument" bindingOperationName="saveDocument" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="5c9c7960-9ce4-4053-a240-f8433d495c14" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:xd="http://www.w3.org/2000/09/xmldsig#">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="?" authorLogin="?" signeeLogin="?">\r
               <v5:documentId>?</v5:documentId>\r
               <v5:documentInfo documentCreated="?" documentSubmissionSetId="?" simiVersion="?">\r
                  <v51:patientId>?</v51:patientId>\r
                  <v51:careEventId>?</v51:careEventId>\r
                  <v51:careEventStarted>?</v51:careEventStarted>\r
                  <!--Optional:-->\r
                  <v51:careEventFinished>?</v51:careEventFinished>\r
                  <v5:cctInfo role="?">\r
                     <!--Optional:-->\r
                     <schema>?</schema>\r
                     <!--Optional:-->\r
                     <code>?</code>\r
                     <!--Optional:-->\r
                     <value>?</value>\r
                     <v52:cctParameters>\r
                        <!--Zero or more repetitions:-->\r
                        <tag role="?">\r
                           <!--Optional:-->\r
                           <schema>?</schema>\r
                           <!--Optional:-->\r
                           <code>?</code>\r
                           <!--Optional:-->\r
                           <value>?</value>\r
                        </tag>\r
                     </v52:cctParameters>\r
                     <v52:contentTypeInfo mimeClass="?">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>?</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                  <tags>\r
                     <!--Zero or more repetitions:-->\r
                     <tag role="?" definedByCct="?">\r
                        <!--Optional:-->\r
                        <schema>?</schema>\r
                        <!--Optional:-->\r
                        <code>?</code>\r
                        <!--Optional:-->\r
                        <value>?</value>\r
                     </tag>\r
                  </tags>\r
               </v5:documentInfo>\r
               <v52:visualizations>\r
                  <!--Zero or more repetitions:-->\r
                  <visualization>\r
                     <!--Optional:-->\r
                     <v52:visualizationId>?</v52:visualizationId>\r
                     <v52:cctCode>?</v52:cctCode>\r
                     <visualizationInfo name="?" description="?" xsltVersion="?" signature="?">\r
                        <v52:tags>\r
                           <!--Zero or more repetitions:-->\r
                           <tag role="?">\r
                              <!--Optional:-->\r
                              <schema>?</schema>\r
                              <!--Optional:-->\r
                              <code>?</code>\r
                              <!--Optional:-->\r
                              <value>?</value>\r
                           </tag>\r
                        </v52:tags>\r
                     </visualizationInfo>\r
                     <!--Optional:-->\r
                     <visualizationData>cid:893836189792</visualizationData>\r
                  </visualization>\r
               </v52:visualizations>\r
               <confidentialityTags>\r
                  <!--Zero or more repetitions:-->\r
                  <tag role="?" definedByCct="?">\r
                     <!--Optional:-->\r
                     <schema>?</schema>\r
                     <!--Optional:-->\r
                     <code>?</code>\r
                     <!--Optional:-->\r
                     <value>?</value>\r
                  </tag>\r
               </confidentialityTags>\r
               <links>\r
                  <!--Optional:-->\r
                  <parent>\r
                     <v5:documentId>?</v5:documentId>\r
                  </parent>\r
                  <!--Zero or more repetitions:-->\r
                  <descendants>\r
                     <v5:documentId>?</v5:documentId>\r
                  </descendants>\r
               </links>\r
               <associations>\r
                  <!--Zero or more repetitions:-->\r
                  <association otherId="?">\r
                     <!--Optional:-->\r
                     <myRole>?</myRole>\r
                     <!--Optional:-->\r
                     <otherRole>?</otherRole>\r
                     <!--Optional:-->\r
                     <type>\r
                        <!--Optional:-->\r
                        <schema>?</schema>\r
                        <!--Optional:-->\r
                        <code>?</code>\r
                        <!--Optional:-->\r
                        <value>?</value>\r
                     </type>\r
                  </association>\r
               </associations>\r
            </metadata>\r
            <v5:content mimeClass="?" mimeType="?" valid="?">\r
               <!--Optional:-->\r
               <v5:visualization>cid:1576641237605</v5:visualization>\r
               <v5:data>cid:956974483569</v5:data>\r
            </v5:content>\r
            <!--Zero or more repetitions:-->\r
            <v5:signature technicalSignature="?" userFIO="?" dateSign="?" jobExecutionId="?" signMO="?" signeeLogin="?" deprecated="?">\r
               <!--Optional:-->\r
               <xd:Signature Id="?">\r
                  <xd:SignedInfo Id="?">\r
                     <xd:CanonicalizationMethod Algorithm="?">\r
                        e\r
                        <!--You may enter ANY elements at this point-->\r
                        gero\r
                     </xd:CanonicalizationMethod>\r
                     <xd:SignatureMethod Algorithm="?">\r
                        cum\r
                        <!--You have a CHOICE of the next 2 items at this level-->\r
                        <xd:HMACOutputLength>?</xd:HMACOutputLength>\r
                        <!--You may enter ANY elements at this point-->\r
                        sonoras\r
                     </xd:SignatureMethod>\r
                     <!--1 or more repetitions:-->\r
                     <xd:Reference Id="?" URI="?" Type="?">\r
                        <!--Optional:-->\r
                        <xd:Transforms>\r
                           <!--1 or more repetitions:-->\r
                           <xd:Transform Algorithm="?">\r
                              aeoliam\r
                              <!--You have a CHOICE of the next 2 items at this level-->\r
                              <xd:XPath>?</xd:XPath>\r
                              <!--You may enter ANY elements at this point-->\r
                              quae\r
                           </xd:Transform>\r
                        </xd:Transforms>\r
                        <xd:DigestMethod Algorithm="?">\r
                           ventos\r
                           <!--You may enter ANY elements at this point-->\r
                           verrantque\r
                        </xd:DigestMethod>\r
                        <xd:DigestValue>cid:1200040530147</xd:DigestValue>\r
                     </xd:Reference>\r
                  </xd:SignedInfo>\r
                  <xd:SignatureValue Id="?">cid:1030942406605</xd:SignatureValue>\r
                  <!--Optional:-->\r
                  <xd:KeyInfo Id="?">\r
                     temperat\r
                     <!--You have a CHOICE of the next 8 items at this level-->\r
                     <xd:X509Data>\r
                        <!--You have a CHOICE of the next 6 items at this level-->\r
                        <xd:X509Certificate>cid:220613791148</xd:X509Certificate>\r
                        <xd:X509SubjectName>?</xd:X509SubjectName>\r
                        <xd:X509CRL>cid:554521759209</xd:X509CRL>\r
                        <xd:X509IssuerSerial>\r
                           <xd:X509IssuerName>?</xd:X509IssuerName>\r
                           <xd:X509SerialNumber>?</xd:X509SerialNumber>\r
                        </xd:X509IssuerSerial>\r
                        <xd:X509SKI>cid:542786096446</xd:X509SKI>\r
                        <!--You may enter ANY elements at this point-->\r
                     </xd:X509Data>\r
                     <xd:KeyValue>\r
                        per\r
                        <!--You have a CHOICE of the next 3 items at this level-->\r
                        <xd:DSAKeyValue>\r
                           <!--Optional:-->\r
                           <xd:P>cid:1102680982607</xd:P>\r
                           <!--Optional:-->\r
                           <xd:Q>cid:705072057802</xd:Q>\r
                           <!--Optional:-->\r
                           <xd:G>cid:1616913845794</xd:G>\r
                           <xd:Y>cid:192534586869</xd:Y>\r
                           <!--Optional:-->\r
                           <xd:J>cid:1228918404422</xd:J>\r
                           <!--Optional:-->\r
                           <xd:Seed>cid:790558300460</xd:Seed>\r
                           <!--Optional:-->\r
                           <xd:PgenCounter>cid:137477290718</xd:PgenCounter>\r
                        </xd:DSAKeyValue>\r
                        <xd:RSAKeyValue>\r
                           <xd:Modulus>cid:1007052763866</xd:Modulus>\r
                           <xd:Exponent>cid:246097260751</xd:Exponent>\r
                        </xd:RSAKeyValue>\r
                        <!--You may enter ANY elements at this point-->\r
                        turbine\r
                     </xd:KeyValue>\r
                     <xd:RetrievalMethod URI="?" Type="?">\r
                        <!--Optional:-->\r
                        <xd:Transforms>\r
                           <!--1 or more repetitions:-->\r
                           <xd:Transform Algorithm="?">\r
                              circum\r
                              <!--You have a CHOICE of the next 2 items at this level-->\r
                              <xd:XPath>?</xd:XPath>\r
                              <!--You may enter ANY elements at this point-->\r
                              regemque\r
                           </xd:Transform>\r
                        </xd:Transforms>\r
                     </xd:RetrievalMethod>\r
                     <xd:KeyName>?</xd:KeyName>\r
                     <xd:MgmtData>?</xd:MgmtData>\r
                     <xd:PGPData>\r
                        <!--You have a CHOICE of the next 3 items at this level-->\r
                        <xd:PGPKeyID>cid:1340723963131</xd:PGPKeyID>\r
                        <xd:PGPKeyPacket>cid:1330369729139</xd:PGPKeyPacket>\r
                        <!--You may enter ANY elements at this point-->\r
                     </xd:PGPData>\r
                     <xd:SPKIData>\r
                        <!--You have a CHOICE of the next 2 items at this level-->\r
                        <xd:SPKISexp>cid:1529100131987</xd:SPKISexp>\r
                        <!--You may enter ANY elements at this point-->\r
                     </xd:SPKIData>\r
                     <!--You may enter ANY elements at this point-->\r
                     nimborum\r
                  </xd:KeyInfo>\r
                  <!--Zero or more repetitions:-->\r
                  <xd:Object Id="?" MimeType="?" Encoding="?">\r
                     fremunt\r
                     <!--You may enter ANY elements at this point-->\r
                     foedere\r
                  </xd:Object>\r
               </xd:Signature>\r
               <!--Optional:-->\r
               <signatureCAdES>cid:1606432150488</signatureCAdES>\r
            </v5:signature>\r
         </v5:document>\r
         <!--Optional:-->\r
         <v51:options>\r
            <!--Zero or more repetitions:-->\r
            <v51:entry key="?">?</v51:entry>\r
         </v51:options>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/saveDocumentRequest"/></con:call></con:operation><con:operation id="5280bd4c-a904-49b9-8dd5-248dfbd75ea4" isOneWay="false" action="searchDocuments" name="searchDocuments" bindingOperationName="searchDocuments" type="Request-Response" inputName="" receivesAttachments="false" sendsAttachments="false" anonymous="optional"><con:settings/><con:call id="9ee7dc81-ed7b-4887-87b2-89ea1f7133fe" name="Request 1"><con:settings/><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/core/v5/">\r
   <soap:Header>\r
      <user:userContext>\r
         <user:systemName>?</user:systemName>\r
         <user:userName>?</user:userName>\r
         <user:userRoleId>?</user:userRoleId>\r
         <!--Optional:-->\r
         <user:isUserRoleSystemWide>?</user:isUserRoleSystemWide>\r
         <user:userRights>\r
            <!--Zero or more repetitions:-->\r
            <user:userRightId>?</user:userRightId>\r
         </user:userRights>\r
         <user:jobExecutionId>?</user:jobExecutionId>\r
         <!--Optional:-->\r
         <user:hostIp>?</user:hostIp>\r
         <!--Optional:-->\r
         <user:hostName>?</user:hostName>\r
      </user:userContext>\r
   </soap:Header>\r
   <soap:Body>\r
      <typ:searchDocumentsRequest>\r
         <!--Optional:-->\r
         <queryName>?</queryName>\r
         <params>\r
            <!--Optional:-->\r
            <typ:conditions>\r
               <!--Zero or more repetitions:-->\r
               <typ:condition operator="?">\r
                  <typ:leftOperand>?</typ:leftOperand>\r
                  <typ:rightOperand>?</typ:rightOperand>\r
               </typ:condition>\r
            </typ:conditions>\r
            <!--Optional:-->\r
            <typ:orderClauses>\r
               <!--Zero or more repetitions:-->\r
               <typ:orderClause ascending="?">\r
                  <typ:attributeName>?</typ:attributeName>\r
               </typ:orderClause>\r
            </typ:orderClauses>\r
         </params>\r
         <!--Optional:-->\r
         <v5:pagingOptions pageNumber="?" pageSize="?"/>\r
         <!--Optional:-->\r
         <v5:options>\r
            <!--Zero or more repetitions:-->\r
            <v5:entry key="?">?</v5:entry>\r
         </v5:options>\r
      </typ:searchDocumentsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:wsaConfig mustUnderstand="NONE" version="200508" action="http://emias.mos.ru/simi/simiService/v5/simiServicePortType/searchDocumentsRequest"/></con:call></con:operation></con:interface><con:testSuite id="919cb2b3-afbd-43d6-ae65-e6882372b503" name="Assignment"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="503504da-cccc-416c-a7f3-22740d4e27f8" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetAssignment" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="7b0e2050-dedd-4479-a7cf-113301d7a7be"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
     <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="3b79e21d-7046-44b5-812c-1fa6740e1100"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="5b98f764-111f-46dc-acfd-76445479c36c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="1026a5e9-8dbe-4051-8f38-98a4ac46b952"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="84f07cc2-692f-4097-8cc4-7bf370551fca"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="46018d17-bb1d-47ad-9311-c10a6c643754"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="0bd25a23-d7bb-458e-a29c-1161c98f1393"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="e935d24c-546c-446d-b333-9b6cf5536956"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="3f02012b-194d-4a82-b443-20ef011fa522"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="5e178d6a-0e57-4d22-98df-e371c3a41d22"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="a24fd1af-fb66-4bdf-9c73-d2b4be08d19e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="9ec97e9b-1c51-4e21-b50c-e5d601d49656"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="071fa3f2-e0ee-4d0e-9f4d-4459848e9a5d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByCareEventId" id="db8a8c88-afe6-4ead-abdb-44524408bf5b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByCareEventId</con:operation><con:request name="GetAssignmentByCareEventId" id="6e74c7fa-62a8-4b54-af26-dc89bb430de8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</ass:careEventId>\r
         <ass:includeDrafts>false</ass:includeDrafts>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a5cf348-337c-4ff4-bef6-4c4802858682"/><con:assertion type="SOAP Fault Assertion" id="be737471-368f-490f-93bb-05ce5be2aa31"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByPatient" id="afabc1d9-a93a-483e-8147-dcfd9c0d417f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentsByPatient</con:operation><con:request name="GetAssignmentByPatient" id="f285671c-0cb2-456b-8328-79d85a18bebf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>${#TestSuite#patientId}</ass:patientId>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="4949a4d0-8bdb-4fd4-9ea0-d4036364657e"/><con:assertion type="SOAP Fault Assertion" id="d9729411-99a2-45ae-b8a4-a004e566dabf"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="c29b98c0-aac1-469e-9bcb-4250a2aa4412" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentf7d248bc-29e5-4496-90e0-898203a19230</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>bee99a0b-bef9-470a-ba81-336b823b034b::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T15:53:55</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T15:53:55</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="0ed9096a-d4cc-452f-a044-8abfbaa4c553" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetAssignmentByDocumentId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="36ace441-7169-49fb-9e17-c28b38fcc34d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="928ed3ff-b595-45e0-8f56-1f70332661d0"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="df532e6d-487a-4c13-9069-38b2a9eb8d61"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="105340b2-198a-4e06-a62e-556240ca40ee"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="05357ee5-0e80-4ccf-9a2d-196b7a7f11e9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="4f62d02a-1acf-4bea-9f24-000df46c1c11"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="5b94c09f-2d18-40e5-89c8-92e7be131ba5"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="a88b4cfe-44b6-42d6-86c6-69ef50dfb578"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="85e88f6d-c914-4eae-b875-54f3cd879b63"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="071644ce-5892-4df8-a18b-cef2e32507f1"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="af4f1b8e-51c4-4848-a9c3-85ea06f094a5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="3149dd67-e3d3-4c86-af58-55f36015ffb8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="d7b6af84-cb15-4295-9330-f2f54b18bdf6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment387ea8ef-fbb8-4f6f-a7ca-003e3bb7c7b1</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>86b44510-b757-4314-8844-5a8f8a431add::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T13:54:46</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T13:54:46</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="6d467243-2848-4e02-8544-925798490606" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetAssignmentByCareEventId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="236dfeef-23e7-4466-93c5-3ce3a4125d17"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="a44ed948-9451-4838-8e3a-20ffa972915c"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="1fab74d9-8ba0-4d68-ad22-8fe5fb76024b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="57266637-3521-4445-ae82-c84f50d6e905"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="b389c54c-b324-43e6-a063-dd1cfb50f927"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="7fcb1e50-c407-4e47-a4d7-036c12d34f5e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="6da5d33f-5353-4321-bbad-d048ac601db2"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="6613ff4e-3800-4ef5-8616-b167f5457927"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="fa9c1d0b-b803-4457-a890-2b692ccb0285"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="3c351c0f-fb63-4730-bde7-0fb9d4de3b63"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="91d47c52-d6eb-4c0b-b887-f8310afb4df8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="cbeb93a7-cae2-46f5-aa2e-c30399750d18"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="fdd111d9-ac20-4c4d-b443-c9eab9761334"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByCareEventId" id="bef5d098-0512-4f83-8db1-a1b55fbb9f61"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByCareEventId</con:operation><con:request name="GetAssignmentByCareEventId" id="6e74c7fa-62a8-4b54-af26-dc89bb430de8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</ass:careEventId>\r
         <ass:includeDrafts>false</ass:includeDrafts>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a5cf348-337c-4ff4-bef6-4c4802858682"/><con:assertion type="SOAP Fault Assertion" id="be737471-368f-490f-93bb-05ce5be2aa31"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment387ea8ef-fbb8-4f6f-a7ca-003e3bb7c7b1</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>86b44510-b757-4314-8844-5a8f8a431add::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T13:54:46</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T13:54:46</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="d4bd1c6b-7587-4e1d-b502-5299296e20e6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetAssignmentByPatientId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="c6c6a185-dc63-4402-9e43-0f9411447410"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="430158b2-2c1e-4e94-b6a2-0f5c63d8e955"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="e0340425-721a-43f2-9fd9-138b2d94cffd"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="265d83ca-f98e-4f7b-a337-7c2e25a28f1d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="1ca34643-13a2-4f7f-8fa7-373514bcb251"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="8316b531-0d98-4081-ba8a-cf6f935a0d84"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="52fec992-d18c-49cf-955c-aae5efd063a9"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="6af0f3ab-7c13-4f0b-998a-9e8c38c7d1d4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="314aacf0-89c0-4110-bc86-31f132ec2430"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="366dcba9-cfc5-4100-91c9-9436cac9c7fd"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByPatient" id="cd74e660-0e9e-4e50-9d02-a2c8890dd9fb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentsByPatient</con:operation><con:request name="GetAssignmentByPatient" id="f285671c-0cb2-456b-8328-79d85a18bebf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>${#TestSuite#patientId}</ass:patientId>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="4949a4d0-8bdb-4fd4-9ea0-d4036364657e"/><con:assertion type="SOAP Fault Assertion" id="d9729411-99a2-45ae-b8a4-a004e566dabf"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="7de2b9fe-c768-49a0-b224-ca37ea55fe81"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="9c5e3425-f18e-47d4-8576-e65a603b427b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="3cbdd4e3-147f-496a-bd34-4a4fe6acc8ec"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByCareEventId" id="bec991cc-111d-47f3-8a3a-f59b04caca41"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByCareEventId</con:operation><con:request name="GetAssignmentByCareEventId" id="6e74c7fa-62a8-4b54-af26-dc89bb430de8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</ass:careEventId>\r
         <ass:includeDrafts>false</ass:includeDrafts>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a5cf348-337c-4ff4-bef6-4c4802858682"/><con:assertion type="SOAP Fault Assertion" id="be737471-368f-490f-93bb-05ce5be2aa31"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment387ea8ef-fbb8-4f6f-a7ca-003e3bb7c7b1</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>86b44510-b757-4314-8844-5a8f8a431add::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T13:54:46</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T13:54:46</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="cfc954a8-d556-446f-9058-8835b73a724b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Priorities" searchProperties="true"><con:settings/><con:testStep type="request" name="getPriorities" id="0ccc49d1-df82-406a-acae-662d7b7d5c57"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getPriorities</con:operation><con:request name="getPriorities" id="66d283b5-bd3a-4b0f-bd59-104999f9eab4"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">
   <soap:Header>
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetPrioritiesRequest/>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b1b4c6a3-e7d0-400e-9e5d-3eaf7cc8d71a"/><con:assertion type="SOAP Fault Assertion" id="3565831d-95ee-4f7a-8a95-65267ae33bc5"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="123448eb-01af-49c5-b5e5-e0f96b03e9d5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="CancelReasons" searchProperties="true"><con:settings/><con:testStep type="request" name="getCancelReasons" id="a95b59ab-50f0-4928-8395-9c29639260d7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getCancelReasons</con:operation><con:request name="getCancelReasons" id="92a4261d-72f1-450e-ab5a-b004959257ac"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://consultations.test.emias.mos.ru/consultations/application/api/v2/AssignmentService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v2/assignment/">\r
   <soap:Header>
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>\r
      <ass:GetCancelReasonsRequest/>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3c56d891-4658-40a9-8a04-a0bf196cd189"/><con:assertion type="SOAP Fault Assertion" id="7a34a73e-e91b-41f6-9e69-b18d84dd5a81"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties/><con:reportParameters/></con:testCase><con:testCase id="146d3b09-bc38-408a-a047-82d0e7784d29" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="CancelAssignment" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="2d84c7ca-42a6-4c08-ba5f-f00dc4b01860"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="0ca43622-6f8a-487a-8ead-c84831098d55"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="c17a06db-d38a-4287-b94f-ca28a8f40230"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="0555fdfd-3243-43fd-87cc-3d7801e30297"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="ab3a2de8-3520-47b1-90ed-1759ac9e38cc"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="64aad30f-c547-42cd-88b0-f1b0d2dee7e0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="5a4ce4e1-6145-470f-910d-4ca12feb50d6"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="4a60c3f6-a715-4bb7-9a8c-2d0bc26da9e9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="43f49f63-4aeb-467c-9046-3e27353f6766"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="a89bb72e-cadd-439e-a907-8a6838370b7c"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="99701c08-0e33-4525-8456-b5fe15e83f41"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="b5fb3519-6897-4261-b99f-ff6297b215d2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="8a177805-d793-49f5-a83f-26d746859d6f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByCareEventId" id="f88d5181-f611-45d0-8249-d55655ee812c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByCareEventId</con:operation><con:request name="GetAssignmentByCareEventId" id="6e74c7fa-62a8-4b54-af26-dc89bb430de8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</ass:careEventId>\r
         <ass:includeDrafts>false</ass:includeDrafts>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a5cf348-337c-4ff4-bef6-4c4802858682"/><con:assertion type="SOAP Fault Assertion" id="be737471-368f-490f-93bb-05ce5be2aa31"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByPatient" id="1ef78409-eeef-4bfd-b8bf-f67a9c597a45"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentsByPatient</con:operation><con:request name="GetAssignmentByPatient" id="f285671c-0cb2-456b-8328-79d85a18bebf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>${#TestSuite#patientId}</ass:patientId>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="4949a4d0-8bdb-4fd4-9ea0-d4036364657e"/><con:assertion type="SOAP Fault Assertion" id="d9729411-99a2-45ae-b8a4-a004e566dabf"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentCancelAssignment" id="6e7842c3-8db7-4a61-8854-4300a9701d47"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentCancelAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>23970</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelAssignmentContent" id="b0d0e171-0059-4ca3-b9e1-f35ed00a63f8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertCancelAssignmentContent" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_canellation.v1</typ:templateId>\r
         <typ:structuredJson>{
   "отмена_назначения_на_консультацию": {
        "language":[{"|code":"ru"}],
        "territory":[{"|code":"RU"}],
        "composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],   
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"528"}],
                    "careflow_step":[{"|code":"at0009"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"],
                "причина_отмены": [{"|code": "4", "|value": "Пациент проконсультирован вне учреждения" }]
            }]
        }]
   }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentCancelAssignmentDraft" id="5f071c98-16dc-4654-b828-bb8ec561a097"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentCancelAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentCancelAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentCancelAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentCancelAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentCancelAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>23970</code>
                     <!--Optional:-->
                     <value>Отмена назначения на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Отмена назначения на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_canellation.v1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Отм. назн. конс</value>
                        </tag>
                                             <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                                     </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertCancelAssignmentContent#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentCancelAssignmentSigned" id="097434a7-086d-4114-8f49-cc1df63a8eec"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentCancelAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentCancelAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentCancelAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentCancelAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentCancelAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>23970</code>
                     <!--Optional:-->
                     <value>Отмена назначения на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Отмена назначения на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_canellation.v1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Отм. назн. конс</value>
                        </tag>
                                             <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                                     </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertCancelAssignmentContent#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                             <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetCancelledAssignment" id="aa762ea4-972d-4ac0-a990-b1a71e0d2b83"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetCancelledAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="186dca41-52e1-4395-9c30-ad9ba44fead0" name="Статус Cancelled"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns3:assignmentStatus  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >Cancelled&lt;/ns3:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="b0853f40-36b3-426e-9713-f6efb0c99cca" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns3:documentId  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns3:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="5d4c5f45-23bb-4ba6-8228-01799a70cc84" name="Назначение СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
	&lt;ns2:entry key="suppReferralId">${GetAssignment#Response#//ns3:options/ns2:entry/text()}&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="52038626-20d8-4c5c-bb42-bf82b2d9dd46" name="allowChange"><con:configuration><path>//*:allowChange</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="52038626-20d8-4c5c-bb42-bf82b2d9dd46" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="9e02aa4d-d757-4f38-98c3-8d297ab130f6" name="TaskConductCancelled"><con:configuration><token><![CDATA[<ns3:tasks>
                  <ns3:id>${GetAssignment#Response#//ns3:tasks/ns3:id/text()}</ns3:id>
                  <ns3:type>Conduct</ns3:type>
                  <ns3:status>Cancelled</ns3:status>
               </ns3:tasks>]]></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentd7d91e9e-bf56-46d6-b961-ef3c784dc5d8</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>2db84cfc-89b2-477f-b51a-abe3c076837c::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T16:12:49</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T16:12:49</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="c0a64ec5-0dc5-4be0-a871-6a648e204fbf" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="FinishAssignment" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="908fb7ba-da92-4264-9fab-4d6f52fb1002"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="35d5a196-fd6b-4b6a-88ad-6c37f95a5f84"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="ae373896-e2ca-476c-ae19-d900d2a30198"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="b0331b7d-cbca-4cab-ab17-372de16025d3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="c958b329-2f74-49be-b3df-bfcfce9b0972"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="5ccbb31b-f16c-4f92-8c9f-075ef1f5444d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="904ef00c-7ae5-4d2e-a753-a8ce9c492e10"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="f405bc47-0882-4a1c-8bca-477a201baac0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="18ced993-d5b5-40b0-9933-fc8eb99408c7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="7c158008-9ed6-43d1-9dae-6ce58bb9c338"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="c123df5a-6b87-44d0-8b4b-0725482e5ca3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="e775ab3e-c088-46e6-a4a8-a05899415e93"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="557b028c-0549-4a8e-9280-5d238dabb406"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByCareEventId" id="c7cddc77-84ed-4345-bcf1-8d5d6429ccef"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByCareEventId</con:operation><con:request name="GetAssignmentByCareEventId" id="6e74c7fa-62a8-4b54-af26-dc89bb430de8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByCareEventIdRequest>\r
         <ass:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</ass:careEventId>\r
         <ass:includeDrafts>false</ass:includeDrafts>\r
      </ass:GetAssignmentByCareEventIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a5cf348-337c-4ff4-bef6-4c4802858682"/><con:assertion type="SOAP Fault Assertion" id="be737471-368f-490f-93bb-05ce5be2aa31"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByPatient" id="61468456-8906-4eb1-b966-a8d943f3978c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentsByPatient</con:operation><con:request name="GetAssignmentByPatient" id="f285671c-0cb2-456b-8328-79d85a18bebf"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
   <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentsByPatientRequest>\r
         <ass:patientId>${#TestSuite#patientId}</ass:patientId>\r
      </ass:GetAssignmentsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="4949a4d0-8bdb-4fd4-9ea0-d4036364657e"/><con:assertion type="SOAP Fault Assertion" id="d9729411-99a2-45ae-b8a4-a004e566dabf"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="61a9ff29-ec30-4769-9489-48e6b6c7ab8b" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="startConduct" id="37c45de3-1703-496f-aabf-f61947257f64"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>startConduct</con:operation><con:request name="startConduct" id="a642c736-8114-40f3-94bf-54ced3f8293a"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:careEventId>${#TestSuite#test_careEventId}</task:careEventId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="83f8ad1e-bf95-49cf-a5b9-767c188cb63f"/><con:assertion type="SOAP Fault Assertion" id="e262c205-b503-4a9a-8cf9-371bb73c0877"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentTherapist" id="ac6d727c-40e5-4132-8e4d-66ac12bbb592"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentTherapist" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>14951</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertTherapist" id="327a9481-fbaa-4286-b8e2-54b228adb635"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertTherapist" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</typ:templateId>
         <typ:structuredJson>{
    "осмотр_терапевта": {
		"language":[{"|code":"ru"}],
			"territory":[{"|code":"RU"}],
			"context":[{
				"_health_care_facility":[{
					"|id":"1117746711180",
					"|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
					"|id_namespace":"Справочник медицинских организаций",
					"|id_scheme":"undefined"
				}],
				"_participation":[{
					"|function":"Дежурный врач",
					"|id":"012",
					"|name":"Тестовый Петр Сергеевич"
				}],
				"подробности_контекста":[{
					"ид_события":[{
						"|id":"${CreateDocumentTherapist#Response#//*:careEventId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"ид_документа":[{
						"|id":"${CreateDocumentTherapist#Response#//*:documentId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"ид_пациента":[{
						"|id":"${#TestSuite#patientId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"автор_информации":[{
						"идентификатор_исполнения_должности_медработника":[{
							"|id":"${#TestSuite#contractId}",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}],
						"наименование_должности":["Наименование должности 68"],
						"наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
						"наименование_филиала":["Наименование филиала 38"],
						"наименование_юридического_лица":["Наименование юридического лица 26"]
					}],
					"структура_медицинской_организации":[{
						"ид_объекта":[{
							"|id":"${#TestSuite#lpuId}",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}],
						"тип_объекта":[{"|code":"at0019"}],
						"наименование":["Наименование 94"],
						"родительский_ид":[{
							"|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}]
					}],
					"адрес_медицинской_организации":[{
						"субъект_рф":["Субъект РФ 88"],
						"муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
						"поселение":["Поселение 76"],
						"населенный_пункт":["Населенный пункт 40"],
						"элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
						"улица":["Улица 6"],
						"номер_здания_сооружения":[{
							"номер_дома":["Номер дома 60"],
							"номер_строения":["Номер строения 92"],
							"номер_корпуса":["Номер корпуса 93"]
						}],
						"номер_земельного_участка":["Номер земельного участка 28"],
						"дополнительная_информация":["Дополнительная информация 49"]
					}],
					"информация_о_месте_cобытия":[{
						"событие_произошло":[{"|code":"at0071"}],
						"субъект_рф":["Субъект РФ 51"],
						"муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
						"поселение":["Поселение 34"],
						"населенный_пункт":["Населенный пункт 48"],
						"элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
						"улица":["Улица 26"],
						"номер_здания_сооружения":[{
							"номер_дома":["Номер дома 68"],
							"номер_строения":["Номер строения 30"],
							"номер_корпуса":["Номер корпуса 66"]
						}],
						"номер_земельного_участка":["Номер земельного участка 27"],
						"номер_помещения":["Номер помещения 99"],
						"дополнительная_информация":["Дополнительная информация 24"]
					}],
					"дополнительная_информация":[{
						"профиль_медицинской_помощи":[{"|code":"at0087"}],
						"виды_медицинской_помощи":[{"|code":"at0050"}],
						"условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
						"форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
					}]
				}]	
			}],  
			"category": [{
				"|code": "433",
				"|value": "event",
				"|terminology": "openehr"
			}],
			"composer": [{
				"|name": "Кучерова Зоя Викторовна",
				"|id": "02237485436",
				"|id_namespace": "Парус",
				"|id_scheme": "undefined"
			}],
			"жалобы_и_анамнез_заболевания": [{
				"жалобы_и_анамнез_заболевания": [{
					"жалобы": [{
						"на_момент_осмотра_жалобы": [{
							"|code": "at0002",
							"|value": "не предъявляет"
						}],
						"жалобы_пациента": [{
							"жалоба": []
						}]
					}],
					"подробности_истории_болезни": [{
						"считает_себя_больным_с": [],
						"болеет_в_течение": []
					}],
					"анамнез_заболевания": []
				}]
			}],
			"интерпретация_результатов_обследования": [{
				"исследование": [{
					"сведения_об_исследовании": [{
						"сведения_об_исследовании": [{
							"название_исследования": [],
							"дата_обследования": [],
							"результат": [],
							"комментарий": []
						}]
					}],
					"интерпретация_результатов": [{"интерпретация_результатов": []}]
				}]
			}],
			"общий_осмотр": [{
				"общее_состояние": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"подробности": [{
							"общее_состояние": [],
							"уровень_сознания": [],
							"нервно-психический_статус": []
						}]
					}]
				}],
				"рост": [{"рост": [{"|unit": "cm", "|magnitude": null}]}],
				"вес": [{"вес": [{"|unit": "kg", "|magnitude": null}]}],
				"имт": [{"индекс_массы_тела": [{"|unit": "kg/m2", "|magnitude": null}]}],
				"сердечно-сосудистая_система": [{
					"артериальное_давление": [{
						"систолическое": [{"|unit": "mm[Hg]", "|magnitude": null}],
						"диастолическое": [{"|unit": "mm[Hg]", "|magnitude": null}]
					}],
					"чсс": [{"чсс": [{"|unit": "/min", "|magnitude": null}]}],
					"пульс": [{
						"пульс": [{"|unit": "/min","|magnitude": null}],
						"ритм": []
					}],
					"сердце": [{
						"описание": [],
						"осмотр": [{
							"патологий_не_выявлено": [null],
							"клиническое_описание": [],
							"пальпация_сердца": [{"верхушечный_толчок": []}],
							"аускультация_сердца": [{
								"тоны_сердца": [],
								"ритм": [],
								"описание_ритма": [],
								"сердечные_тоны": [{
									"a1-й_тон": [{"a1-й_тон": []}],
									"a2-й_тон": [{"a2-й_тон": []}],
									"локализация": [],
									"комментарий": []
								}],
								"шум": [{"шум": [], "описание_шумов": []}]
							}],
							"комментарий": []
						}]
					}]
				}],
				"температура_тела": [{
					"температура": [{"|unit": "Cel", "|magnitude": null}],
					"комментарий": []
				}],
				"чдд": [{"чдд": [{"|unit": "/min", "|magnitude": null}]}],
				"окружность_талии": [{"окружность_талии": [{"|unit": "cm", "|magnitude": null}]}],
				"функциональный_статус": [{
					"описание": [],
					"осмотр": [{
						"подробности": [{
							"патологий_не_выявлено": [null],
							"ходьба": [],
							"нарушение_походки": []
						}],
						"положение": [],
						"поза_ромберга": [{"поза_ромберга": [{"поза_ромберга": []}]}],
						"конституциональный_тип": []
					}]
				}],
				"кожные_покровы": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"подробности": [{
							"цвет_кожи": [],
							"тип_высыпаний": [],
							"локализация": [],
							"влажность": [],
							"цианоз": [{  
								"наличие": [],
								"характер_распространения": [],
								"локализация": [],
								"описание": []
							}]
						}],
						"клинические_особенности": [{
							"особенность": [],
							"описание": []
						}],
						"комментарий": []
					}]
				}],
				"склеры": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"цвет": []
					}]
				}],
				"лимфатические_узлы": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"подробности": [{
							"локализация_лимфатических_узлов": [],
							"другая_локализация": [],
							"размеры": [{
								"размеры": [],
								"описание_размеров": [],
								"увеличение": [{"увеличение_на": [{"|unit": "cm", "|magnitude": null}]}]
							}],
							"пальпация": [{
								"консистенция": [{"консистенция": []}],
								"болезненность": [{"болезненность_при_пальпации": []}],
								"комментарий": []
							}]
						}]
					}]
				}],
				"молочные_железы": [{
					"описание": [],
					"молочная_железа_справа": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"отделяемое_из_сосков": [{"отделяемое_из_сосков": []}],
						"при_пальпации": [{
							"консистенция": [{
								"консистенция": [],
								"локализация_уплотнений": []
							}]
						}],
						"комментарий": []
					}],
					"молочная_железа_слева": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"отделяемое_из_сосков": [{"отделяемое_из_сосков": [] }],
						"при_пальпации": [{
							"консистенция": [{
								"консистенция": [],
								"локализация_уплотнений": []
							}]
						}],
						"комментарий": []
					}]
				}],
				"отеки": [{
					"описание": [],
					"отеки": [{
						"наличие_отеков": [],
						"локализация": [],
						"степень_выраженности": [],
						"комментарий": []
					}]
				}],
				"опорно-двигательная_система": [{
					"суставы": [{
						"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"локализация": [{
								"локализация": [],
								"специфическая_локализация": [],
								"описание": []
							}],
							"патологий_не_выявлено": [null],
							"подробности": [{
								"суставы": [{"суставы": []}],
								"движения": [{
									"движения": [{ "движения": [{"движения": []}]}],
									"болезненность_при_движении": [{"болезненность_при_движении": []}]
								}],
								"болезненность_в_покое": [{"болезненность_в_покое": [] }]
							}],
							"клиническое_описание": [],
							"комментарий": []
						}]
					}],
					"позвоночник": [{
						"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"патологий_не_выявлено": [null],
							"клиническое_описание": [],
							"пальпация": [{
								"болезненность_при_пальпации": [{
									"болезненность_при_пальпации": [],
									"локализация_на_теле": []
								}]
							}],
							"симптомы_натяжения": [],
							"комментарий": []
						}]
					}]
				}],
				"полость_рта": [{
					"зев_и_миндалины": [{
						"описание": [],
						"осмотр": [{
							"патологий_не_выявлено": [null],
							"обследование_ротовой_полости": [{
								"зев": [{
									"зев": [],
									"цвет": [],
									"описание_зева": []
								}]
							}],
							"миндалины": [{
								"миндалины": [],
								"рыхлость": [],
								"размеры": [],
								"налёт": [{
									"налёт": [],
									"описание_налёта": []
								}]
							}],
							"комментарий": []
						}]
					}],
				"язык": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"налет": [],
						"влажность": []
					}]
				}]
			}],
				"органы_дыхания": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"носовое_дыхание": [],
						"выделение_из_носа": [{
							"выделение_из_носа": [],
							"количество": [],
							"характер": []
						}],
						"комментарий": []
					}]
				}],
				"грудная_клетка": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"грудная_клетка": [{
							"форма": [],
							"описание_формы": [],
							"участие_в_дыхании": [],
							"отставание_в_дыхании": [],
							"пальпация": []
						}],
						"аускультация_легких": [{
							"характер_дыхания": [],
							"крепитация": [],
							"локализация": [],
							"шум_трения_плевры": [],
							"комментарий": [],
							"хрипы": [{
								"наличие_хрипов": [],
								"влажность": [],
								"выслушиваются": [],
								"локализации": [],
								"характеристика_сухих_хрипов": [],
								"характеристика_влажных_хрипов": []
							}]
						}],
						"комментарий": []
					}]
				}],
				"живот": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"подробности": [{
							"подробности": [{
								"участие_в_акте_дыхания": []
							}],
							"пальпация": [{
								"состояние": [{"состояние": []}],
								"болезненность_при_пальпации": [{
									"болезненность_при_пальпации": [],
									"локализация_болезненности": []
								}]
							}],
							"симптомы_раздражения_брюшины": [],
							"комментарий": []
						}]
					}]
				}],
				"печень": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"пальпация": [{
							"поверхность": [{
								"границы": [],
								"увеличение": [{
									"увеличение_на": [{
										"|unit": "cm",
										"|magnitude": null
									}]
								}],
								"поверхность": []
							}],
							"консистенция": [{"консистенция": []}],
							"болезненность": [{"болезненность_при_пальпации": []}]
						}],
						"комментарий": []
					}]
				}],
				"селезенка": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [ null],
						"клиническое_описание": [],
						"пальпация": [{ "орган": []}],
						"комментарий": []
					}]
				}],
				"мочевыделительная_система": [{
					"мочеиспускание": [{
						"мочеиспускание": [],
						"болезненность_при_мочеиспускании": [{ "болезненность_при_мочеиспускании": []}]
					}],
				"почки": [{
					"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"патологий_области_почек_не_выявлено": [null],
							"клиническое_описание": [],
							"подробности": [{
								"симптом_поколачивания": [],
								"комментарий": []
							}]
						}]
					}]
				}],
				"стул": [{
					"клиническое_описание": [],
					"стул": [{
						"частота_испражнений": [{
						"за_период": [],
						"количество_раз_в_среднем": [],
						"количество_раз_интервал": [{"lower": [],"upper": []}]
					}],
						"патологические_примеси": [{
						"название_примеси": [],
						"наличие": [],
						"описание_примеси": []
					}]
					}],
					"цвет": []
				}],
				"комментарий": [{
					"описание": [],
					"комментарий": []
				}]
			}],
			"диагноз": [{
				"основной_диагноз": [{
					"основной_диагноз": [{
						"код_по_мкб_10": [{
							"|code": "A00.0",
							"|value": "A00.0 - Холера, вызванная холерным вибрионом 01, биовар cholerae"
						}],
						"развернутый_клинический_диагноз": [],
						"динамика_состояния": [{
							"динамика_заболевания": []
						}],
						"вид_диагноза": [{
							"диагностический_статус": [],
							"вид_диагноза": [{
								"|code": "at0064",
								"|value": "основной диагноз"
							}]
						}]
					}]
				}],
				"диагноз": [{
					"диагноз": [{
						"вид_диагноза": [{
							"вид_диагноза": [],
							"диагностический_статус": []
						}],
						"код_по_мкб_10": [],
						"развернутый_клинический_диагноз": []
					}]
				}]
			}],
			"рекомендации": [{
				"режим": [{"режим": [{"режим": []}]}],
				"рекомендации_по_питанию": [{"рекомендации_по_питанию": [{"рекомендации_по_питанию": []}]}],
				"прочие_рекомендации": [{"прочие_рекомендации": []}],
				"рекомендации_по_последующему_приему": [{
				"рекомендации_по_последующему_приему": [{
					"предположительная_дата_явки": [],
					"подробности_явки": []
				}]
			}]
			}],
			"сведения_о_выполнении_назначения": [{
				"выполнение": [{
					"_instruction_details": [{
						"|composition_uid":"${#TestCase#composition_uid}",
						"|instruction_uid": "${#TestCase#assignmentId}",
						"|activity_id": "activities[at0001]",
						"|path": "/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
					}],
					"ism_transition": [{
						"current_state": [{"|code": "532"}],
						"careflow_step": [{ "|code": "at0005"}]
					}],
					"специализация": [{"|code": "76","|value": "Терапия"}],
            			"обоснование": ["Обоснование 86"],
            			"причина_отмены": [{"|code": "2", "|value": "Получены новые данные о состоянии пациента" }]
          }]
      }]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentTherapistDraft" id="8153c0fb-9d68-47b6-ae30-116423ee0e63"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentTherapistDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentTherapist#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentTherapist#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentTherapist#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentTherapist#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>14951</code>
                     <!--Optional:-->
                     <value>Осмотр терапевта</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Осмотр терапевта</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Осм. терапевта</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="protocolMedicalSpecialization">
                           <value>Врач-терапевт</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                    <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>documentPurpose</code>
                        <value>Протокол осмотра</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>733F6AD7-762A-45D5-A85F-B571224E6421</v52:visualizationId>
                     <v52:cctCode>14951</v52:cctCode>
                    <visualizationInfo name="Для печати" description="Осмотр терапевта" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertTherapist#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentTherapistSigned" id="ce195808-e1b6-40a8-8d29-a4fdd0a36a9b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentTherapistSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentTherapist#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentTherapist#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentTherapist#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentTherapist#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>14951</code>
                     <!--Optional:-->
                     <value>Осмотр терапевта</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Осмотр терапевта</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Осм. терапевта</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="protocolMedicalSpecialization">
                           <value>Врач-терапевт</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                    <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>documentPurpose</code>
                        <value>Протокол осмотра</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>733F6AD7-762A-45D5-A85F-B571224E6421</v52:visualizationId>
                     <v52:cctCode>14951</v52:cctCode>
                    <visualizationInfo name="Для печати" description="Осмотр терапевта" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertTherapist#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
  <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="ba9886ed-611e-4d4d-acb7-f5b6cdeb4c20"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetFinishedAssignment" id="8e8d237e-cb0e-4687-bef2-86c4127a2f51"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetFinishedAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="1c923e0f-4538-4843-801d-1c9214793369" name="Статус AssignmentFinished"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns3:assignmentStatus  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentFinished&lt;/ns3:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0a0ede91-274c-4c61-8c18-ec2b7b759bc9" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns3:documentId  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns3:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="7fb844d1-0e70-467a-ac76-3a6812089cfb" name="Направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">${GetAssignment#Response#//ns3:options/ns2:entry/text()}&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6a7e6809-f7da-4c20-930b-5905d3a8264b" name="allowChange"><con:configuration><path>//*:allowChange</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6a7e6809-f7da-4c20-930b-5905d3a8264b" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3733def7-5fba-4ed6-a20d-cea131ad72aa" name="TaskConductCompleted"><con:configuration><token><![CDATA[<ns3:tasks>
                  <ns3:id>${GetAssignment#Response#//ns3:tasks/ns3:id/text()}</ns3:id>
                  <ns3:type>Conduct</ns3:type>
                  <ns3:status>Completed</ns3:status>
                  <ns3:documentId>${CreateDocumentTherapist#Response#//*:documentId}</ns3:documentId>
               </ns3:tasks>]]></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment21a1a8ac-3e50-4860-9794-589330c4e3c5</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>e972999f-c05e-42ad-bf8b-ca09977d81e6::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T16:51:04</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T16:51:04</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="f4db7b91-c4c5-4bd6-adb8-24ad8140125a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="CancelAssignment_simi4" searchProperties="true"><con:settings/><con:testStep type="request" name="CreateDocumentAssignment" id="1cd4da9e-8ce1-48c4-b4e2-4282d2f31a3f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46081</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="c9d540f8-7120-43cb-9c2d-f36f8848d392"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="5aa40adb-0178-42b2-899c-a5f7688e0cbf"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>INSTRUMENTAL/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "12",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["666"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "152",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="8fb78c8c-0393-4a2a-b50c-3e3f13dd1020"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>INSTRUMENTAL/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <description>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <description>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="false"/>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="9b9bfc45-e9c4-47a0-a44e-487d2e53579c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>INSTRUMENTAL/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="b7c0f75d-00c9-47e3-b0dc-1520fde905e5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="7364f4c1-35ec-446d-bcb4-fa8612f65c34"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="32eac501-6621-4019-a535-4248f00bc96f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "897",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1863"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="18c4668d-317c-4047-a675-baf465c4dfde"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentSigned#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="2562abb8-2d07-46df-81a2-c352d6019227"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="27378b09-eac7-4da4-af20-4d1a5b6de789"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="b3991f9c-8b61-4aa7-8a87-a5c1c3d986ee"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${GetAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentCancelAssignment" id="45ee6812-31f3-4cd1-9b2b-ae2724d022d7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentCancelAssignment" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>23970</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelAssignmentContent" id="e50b43e0-4603-4a85-8d66-854ec6bbc8f4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertCancelAssignmentContent" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_canellation.v1</typ:templateId>\r
         <typ:structuredJson>{
   "отмена_назначения_на_консультацию": {
        "language":[{"|code":"ru"}],
        "territory":[{"|code":"RU"}],
        "composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],   
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"528"}],
                    "careflow_step":[{"|code":"at0009"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"],
                "причина_отмены": [{"|code": "4", "|value": "Пациент проконсультирован вне учреждения" }]
            }]
        }]
   }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentCancelAssignmentDraft" id="79049d94-c224-485e-829a-84fc53f511b9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentCancelAssignmentDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentCancelAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentCancelAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentCancelAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentCancelAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>\r
                     <schema>ru.emias.simi.terminology.cct</schema>
               	 <code>23970</code>
                     <description>Отмена назначения на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Отмена назначения на консультацию</entry>
                        <entry key="openEhrCommonFormName">Отмена назначения на консультацию</entry>
                        <entry key="openEhrCommonFormVersion">1.1.0.1</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_canellation.v1</entry>
                        <entry key="ShortName">Отм. назн. конс</entry>
                     </cct:cctParameters>\r
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>\r
                  </doc:cctInfo>\r
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertCancelAssignmentContent#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="false"/>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentCancelAssignmentSigned" id="7b32d069-098c-4821-af25-5403c80e520a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentCancelAssignmentSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentCancelAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentCancelAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentCancelAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentCancelAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>\r
                     <schema>ru.emias.simi.terminology.cct</schema>
               	 <code>23970</code>
                     <description>Отмена назначения на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Отмена назначения на консультацию</entry>
                        <entry key="openEhrCommonFormName">Отмена назначения на консультацию</entry>
                        <entry key="openEhrCommonFormVersion">1.1.0.1</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_canellation.v1</entry>
                        <entry key="ShortName">Отм. назн. конс</entry>
                     </cct:cctParameters>\r
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>\r
                  </doc:cctInfo>\r
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertCancelAssignmentContent#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay1" id="a35638e5-c7f8-435f-947f-145034148409"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetCancelledAssignment" id="38b0c33a-1a8d-45ab-b391-865ea4bf0526"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetCancelledAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="186dca41-52e1-4395-9c30-ad9ba44fead0" name="Статус Cancelled"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns3:assignmentStatus  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >Cancelled&lt;/ns3:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="b0853f40-36b3-426e-9713-f6efb0c99cca" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns3:documentId  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns3:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="5d4c5f45-23bb-4ba6-8228-01799a70cc84" name="Назначение СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
	&lt;ns2:entry key="suppReferralId">${GetAssignment#Response#//ns3:options/ns2:entry/text()}&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="52038626-20d8-4c5c-bb42-bf82b2d9dd46" name="allowChange"><con:configuration><path>//*:allowChange</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="52038626-20d8-4c5c-bb42-bf82b2d9dd46" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="9e02aa4d-d757-4f38-98c3-8d297ab130f6" name="TaskConductCancelled"><con:configuration><token><![CDATA[<ns3:tasks>
                  <ns3:id>${GetAssignment#Response#//ns3:tasks/ns3:id/text()}</ns3:id>
                  <ns3:type>Conduct</ns3:type>
                  <ns3:status>Cancelled</ns3:status>
               </ns3:tasks>]]></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment0a7c1473-cf40-4338-8076-0c7408a59e30</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>5f899fc6-4a66-4287-a54b-31da06cf2bfe::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2021-10-28T18:55:23</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2021-11-04T18:55:23</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="5745404a-3560-4676-a731-3a0f19a12572" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="FinishAssignment_simi4" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="77b75e8a-1049-436e-9f20-6b0f22595cd0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46081</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="e42324ef-edaf-4fe5-a1d6-e83297dfb739"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate) 
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="0146df38-09c0-449f-9ab9-d6c4f038cbaa"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
   <soapenv:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
         </wsse:UsernameToken>
      </wsse:Security>
   </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "06bc29cd-baf9-4507-aedb-c01ff37c79bd",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["666"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="618f8661-2404-43ae-b7fe-e0572286423b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>23968</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
  					<entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrCommonFormName">Назначение на консультацию</entry>
                        <entry key="openEhrCommonFormVersion">1.1.0.1</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
            <doc:signature technicalSignature="false"/>
         </doc:document>
      </typ:saveDocument>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="6f290181-9fdb-4e79-89c4-4110d5f52343"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="829793a1-0375-437c-af5c-e9f5c5b3bc26"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertBase64TddToJson>
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="b09748bd-0189-4c8b-b3d6-f3b288b0c19b"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="1b1da293-1cb7-4cb2-9131-674ee7a2f4ea"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
   <soapenv:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
         </wsse:UsernameToken>
      </wsse:Security>
   </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "897",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1863"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="df55f22f-3257-4cb0-8046-736e3aa941cb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>23968</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
  					<entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrCommonFormName">Назначение на консультацию</entry>
                        <entry key="openEhrCommonFormVersion">1.1.0.1</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentSigned#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>
         </doc:document>
      </typ:saveDocument>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="e01ca4ca-9e44-422e-ab20-c2833f89a204"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="9844d9ba-81a7-453c-b40a-84571676db46"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="5370406e-8faa-4fd3-a93d-a5db3006deae" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns3:assignmentStatus  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns3:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="f7e33190-11d5-4e50-af9a-3667e71cc881" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns3:documentId  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns3:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="2db50fd6-a0ca-417b-a7e1-e48d06de7752" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="c36121c6-afae-4804-9213-e9e7f74e713e" name="Task Conduct"><con:configuration><path>declare namespace ns3='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns3:type>{data($x/ns3:type/text())}&lt;/ns3:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns3:type xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns3:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="e3a5e2e5-db22-4b31-9072-30ecf9078764" name="Task Assigned"><con:configuration><path>declare namespace ns3='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns3:status>{data($x/ns3:status/text())}&lt;/ns3:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns3:status xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns3:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="startConduct" id="18a8f5b0-390e-4f0f-844b-570ddde68450"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>startConduct</con:operation><con:request name="startConduct" id="a642c736-8114-40f3-94bf-54ced3f8293a"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:careEventId>${#TestSuite#test_careEventId}</task:careEventId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="83f8ad1e-bf95-49cf-a5b9-767c188cb63f"/><con:assertion type="SOAP Fault Assertion" id="e262c205-b503-4a9a-8cf9-371bb73c0877"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentTherapist" id="c5ac95db-5ab6-4813-805f-a28cd120f531"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentTherapist" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>14951</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertTherapist" id="b9eaeaa7-8bc6-4387-9328-c11083525049"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertTherapist" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</typ:templateId>
         <typ:structuredJson>{
    "осмотр_терапевта": {
		"language":[{"|code":"ru"}],
			"territory":[{"|code":"RU"}],
			"context":[{
				"_health_care_facility":[{
					"|id":"1117746711180",
					"|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
					"|id_namespace":"Справочник медицинских организаций",
					"|id_scheme":"undefined"
				}],
				"_participation":[{
					"|function":"Дежурный врач",
					"|id":"012",
					"|name":"Тестовый Петр Сергеевич"
				}],
				"подробности_контекста":[{
					"ид_события":[{
						"|id":"${CreateDocumentTherapist#Response#//*:careEventId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"ид_документа":[{
						"|id":"${CreateDocumentTherapist#Response#//*:documentId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"ид_пациента":[{
						"|id":"${#TestSuite#patientId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"автор_информации":[{
						"идентификатор_исполнения_должности_медработника":[{
							"|id":"${#TestSuite#contractId}",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}],
						"наименование_должности":["Наименование должности 68"],
						"наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
						"наименование_филиала":["Наименование филиала 38"],
						"наименование_юридического_лица":["Наименование юридического лица 26"]
					}],
					"структура_медицинской_организации":[{
						"ид_объекта":[{
							"|id":"${#TestSuite#lpuId}",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}],
						"тип_объекта":[{"|code":"at0019"}],
						"наименование":["Наименование 94"],
						"родительский_ид":[{
							"|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}]
					}],
					"адрес_медицинской_организации":[{
						"субъект_рф":["Субъект РФ 88"],
						"муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
						"поселение":["Поселение 76"],
						"населенный_пункт":["Населенный пункт 40"],
						"элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
						"улица":["Улица 6"],
						"номер_здания_сооружения":[{
							"номер_дома":["Номер дома 60"],
							"номер_строения":["Номер строения 92"],
							"номер_корпуса":["Номер корпуса 93"]
						}],
						"номер_земельного_участка":["Номер земельного участка 28"],
						"дополнительная_информация":["Дополнительная информация 49"]
					}],
					"информация_о_месте_cобытия":[{
						"событие_произошло":[{"|code":"at0071"}],
						"субъект_рф":["Субъект РФ 51"],
						"муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
						"поселение":["Поселение 34"],
						"населенный_пункт":["Населенный пункт 48"],
						"элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
						"улица":["Улица 26"],
						"номер_здания_сооружения":[{
							"номер_дома":["Номер дома 68"],
							"номер_строения":["Номер строения 30"],
							"номер_корпуса":["Номер корпуса 66"]
						}],
						"номер_земельного_участка":["Номер земельного участка 27"],
						"номер_помещения":["Номер помещения 99"],
						"дополнительная_информация":["Дополнительная информация 24"]
					}],
					"дополнительная_информация":[{
						"профиль_медицинской_помощи":[{"|code":"at0087"}],
						"виды_медицинской_помощи":[{"|code":"at0050"}],
						"условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
						"форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
					}]
				}]	
			}],  
			"category": [{
				"|code": "433",
				"|value": "event",
				"|terminology": "openehr"
			}],
			"composer": [{
				"|name": "Кучерова Зоя Викторовна",
				"|id": "02237485436",
				"|id_namespace": "Парус",
				"|id_scheme": "undefined"
			}],
			"жалобы_и_анамнез_заболевания": [{
				"жалобы_и_анамнез_заболевания": [{
					"жалобы": [{
						"на_момент_осмотра_жалобы": [{
							"|code": "at0002",
							"|value": "не предъявляет"
						}],
						"жалобы_пациента": [{
							"жалоба": []
						}]
					}],
					"подробности_истории_болезни": [{
						"считает_себя_больным_с": [],
						"болеет_в_течение": []
					}],
					"анамнез_заболевания": []
				}]
			}],
			"интерпретация_результатов_обследования": [{
				"исследование": [{
					"сведения_об_исследовании": [{
						"сведения_об_исследовании": [{
							"название_исследования": [],
							"дата_обследования": [],
							"результат": [],
							"комментарий": []
						}]
					}],
					"интерпретация_результатов": [{"интерпретация_результатов": []}]
				}]
			}],
			"общий_осмотр": [{
				"общее_состояние": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"подробности": [{
							"общее_состояние": [],
							"уровень_сознания": [],
							"нервно-психический_статус": []
						}]
					}]
				}],
				"рост": [{"рост": [{"|unit": "cm", "|magnitude": null}]}],
				"вес": [{"вес": [{"|unit": "kg", "|magnitude": null}]}],
				"имт": [{"индекс_массы_тела": [{"|unit": "kg/m2", "|magnitude": null}]}],
				"сердечно-сосудистая_система": [{
					"артериальное_давление": [{
						"систолическое": [{"|unit": "mm[Hg]", "|magnitude": null}],
						"диастолическое": [{"|unit": "mm[Hg]", "|magnitude": null}]
					}],
					"чсс": [{"чсс": [{"|unit": "/min", "|magnitude": null}]}],
					"пульс": [{
						"пульс": [{"|unit": "/min","|magnitude": null}],
						"ритм": []
					}],
					"сердце": [{
						"описание": [],
						"осмотр": [{
							"патологий_не_выявлено": [null],
							"клиническое_описание": [],
							"пальпация_сердца": [{"верхушечный_толчок": []}],
							"аускультация_сердца": [{
								"тоны_сердца": [],
								"ритм": [],
								"описание_ритма": [],
								"сердечные_тоны": [{
									"a1-й_тон": [{"a1-й_тон": []}],
									"a2-й_тон": [{"a2-й_тон": []}],
									"локализация": [],
									"комментарий": []
								}],
								"шум": [{"шум": [], "описание_шумов": []}]
							}],
							"комментарий": []
						}]
					}]
				}],
				"температура_тела": [{
					"температура": [{"|unit": "Cel", "|magnitude": null}],
					"комментарий": []
				}],
				"чдд": [{"чдд": [{"|unit": "/min", "|magnitude": null}]}],
				"окружность_талии": [{"окружность_талии": [{"|unit": "cm", "|magnitude": null}]}],
				"функциональный_статус": [{
					"описание": [],
					"осмотр": [{
						"подробности": [{
							"патологий_не_выявлено": [null],
							"ходьба": [],
							"нарушение_походки": []
						}],
						"положение": [],
						"поза_ромберга": [{"поза_ромберга": [{"поза_ромберга": []}]}],
						"конституциональный_тип": []
					}]
				}],
				"кожные_покровы": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"подробности": [{
							"цвет_кожи": [],
							"тип_высыпаний": [],
							"локализация": [],
							"влажность": [],
							"цианоз": [{  
								"наличие": [],
								"характер_распространения": [],
								"локализация": [],
								"описание": []
							}]
						}],
						"клинические_особенности": [{
							"особенность": [],
							"описание": []
						}],
						"комментарий": []
					}]
				}],
				"склеры": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"цвет": []
					}]
				}],
				"лимфатические_узлы": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"подробности": [{
							"локализация_лимфатических_узлов": [],
							"другая_локализация": [],
							"размеры": [{
								"размеры": [],
								"описание_размеров": [],
								"увеличение": [{"увеличение_на": [{"|unit": "cm", "|magnitude": null}]}]
							}],
							"пальпация": [{
								"консистенция": [{"консистенция": []}],
								"болезненность": [{"болезненность_при_пальпации": []}],
								"комментарий": []
							}]
						}]
					}]
				}],
				"молочные_железы": [{
					"описание": [],
					"молочная_железа_справа": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"отделяемое_из_сосков": [{"отделяемое_из_сосков": []}],
						"при_пальпации": [{
							"консистенция": [{
								"консистенция": [],
								"локализация_уплотнений": []
							}]
						}],
						"комментарий": []
					}],
					"молочная_железа_слева": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"отделяемое_из_сосков": [{"отделяемое_из_сосков": [] }],
						"при_пальпации": [{
							"консистенция": [{
								"консистенция": [],
								"локализация_уплотнений": []
							}]
						}],
						"комментарий": []
					}]
				}],
				"отеки": [{
					"описание": [],
					"отеки": [{
						"наличие_отеков": [],
						"локализация": [],
						"степень_выраженности": [],
						"комментарий": []
					}]
				}],
				"опорно-двигательная_система": [{
					"суставы": [{
						"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"локализация": [{
								"локализация": [],
								"специфическая_локализация": [],
								"описание": []
							}],
							"патологий_не_выявлено": [null],
							"подробности": [{
								"суставы": [{"суставы": []}],
								"движения": [{
									"движения": [{ "движения": [{"движения": []}]}],
									"болезненность_при_движении": [{"болезненность_при_движении": []}]
								}],
								"болезненность_в_покое": [{"болезненность_в_покое": [] }]
							}],
							"клиническое_описание": [],
							"комментарий": []
						}]
					}],
					"позвоночник": [{
						"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"патологий_не_выявлено": [null],
							"клиническое_описание": [],
							"пальпация": [{
								"болезненность_при_пальпации": [{
									"болезненность_при_пальпации": [],
									"локализация_на_теле": []
								}]
							}],
							"симптомы_натяжения": [],
							"комментарий": []
						}]
					}]
				}],
				"полость_рта": [{
					"зев_и_миндалины": [{
						"описание": [],
						"осмотр": [{
							"патологий_не_выявлено": [null],
							"обследование_ротовой_полости": [{
								"зев": [{
									"зев": [],
									"цвет": [],
									"описание_зева": []
								}]
							}],
							"миндалины": [{
								"миндалины": [],
								"рыхлость": [],
								"размеры": [],
								"налёт": [{
									"налёт": [],
									"описание_налёта": []
								}]
							}],
							"комментарий": []
						}]
					}],
				"язык": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"налет": [],
						"влажность": []
					}]
				}]
			}],
				"органы_дыхания": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"носовое_дыхание": [],
						"выделение_из_носа": [{
							"выделение_из_носа": [],
							"количество": [],
							"характер": []
						}],
						"комментарий": []
					}]
				}],
				"грудная_клетка": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"грудная_клетка": [{
							"форма": [],
							"описание_формы": [],
							"участие_в_дыхании": [],
							"отставание_в_дыхании": [],
							"пальпация": []
						}],
						"аускультация_легких": [{
							"характер_дыхания": [],
							"крепитация": [],
							"локализация": [],
							"шум_трения_плевры": [],
							"комментарий": [],
							"хрипы": [{
								"наличие_хрипов": [],
								"влажность": [],
								"выслушиваются": [],
								"локализации": [],
								"характеристика_сухих_хрипов": [],
								"характеристика_влажных_хрипов": []
							}]
						}],
						"комментарий": []
					}]
				}],
				"живот": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"подробности": [{
							"подробности": [{
								"участие_в_акте_дыхания": []
							}],
							"пальпация": [{
								"состояние": [{"состояние": []}],
								"болезненность_при_пальпации": [{
									"болезненность_при_пальпации": [],
									"локализация_болезненности": []
								}]
							}],
							"симптомы_раздражения_брюшины": [],
							"комментарий": []
						}]
					}]
				}],
				"печень": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"пальпация": [{
							"поверхность": [{
								"границы": [],
								"увеличение": [{
									"увеличение_на": [{
										"|unit": "cm",
										"|magnitude": null
									}]
								}],
								"поверхность": []
							}],
							"консистенция": [{"консистенция": []}],
							"болезненность": [{"болезненность_при_пальпации": []}]
						}],
						"комментарий": []
					}]
				}],
				"селезенка": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [ null],
						"клиническое_описание": [],
						"пальпация": [{ "орган": []}],
						"комментарий": []
					}]
				}],
				"мочевыделительная_система": [{
					"мочеиспускание": [{
						"мочеиспускание": [],
						"болезненность_при_мочеиспускании": [{ "болезненность_при_мочеиспускании": []}]
					}],
				"почки": [{
					"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"патологий_области_почек_не_выявлено": [null],
							"клиническое_описание": [],
							"подробности": [{
								"симптом_поколачивания": [],
								"комментарий": []
							}]
						}]
					}]
				}],
				"стул": [{
					"клиническое_описание": [],
					"стул": [{
						"частота_испражнений": [{
						"за_период": [],
						"количество_раз_в_среднем": [],
						"количество_раз_интервал": [{"lower": [],"upper": []}]
					}],
						"патологические_примеси": [{
						"название_примеси": [],
						"наличие": [],
						"описание_примеси": []
					}]
					}],
					"цвет": []
				}],
				"комментарий": [{
					"описание": [],
					"комментарий": []
				}]
			}],
			"диагноз": [{
				"основной_диагноз": [{
					"основной_диагноз": [{
						"код_по_мкб_10": [{
							"|code": "A00.0",
							"|value": "A00.0 - Холера, вызванная холерным вибрионом 01, биовар cholerae"
						}],
						"развернутый_клинический_диагноз": [],
						"динамика_состояния": [{
							"динамика_заболевания": []
						}],
						"вид_диагноза": [{
							"диагностический_статус": [],
							"вид_диагноза": [{
								"|code": "at0064",
								"|value": "основной диагноз"
							}]
						}]
					}]
				}],
				"диагноз": [{
					"диагноз": [{
						"вид_диагноза": [{
							"вид_диагноза": [],
							"диагностический_статус": []
						}],
						"код_по_мкб_10": [],
						"развернутый_клинический_диагноз": []
					}]
				}]
			}],
			"рекомендации": [{
				"режим": [{"режим": [{"режим": []}]}],
				"рекомендации_по_питанию": [{"рекомендации_по_питанию": [{"рекомендации_по_питанию": []}]}],
				"прочие_рекомендации": [{"прочие_рекомендации": []}],
				"рекомендации_по_последующему_приему": [{
				"рекомендации_по_последующему_приему": [{
					"предположительная_дата_явки": [],
					"подробности_явки": []
				}]
			}]
			}],
			"сведения_о_выполнении_назначения": [{
				"выполнение": [{
					"_instruction_details": [{
						"|composition_uid":"${#TestCase#composition_uid}",
						"|instruction_uid": "${#TestCase#assignmentId}",
						"|activity_id": "activities[at0001]",
						"|path": "/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
					}],
					"ism_transition": [{
						"current_state": [{"|code": "532"}],
						"careflow_step": [{ "|code": "at0005"}]
					}],
					"специализация": [{"|code": "76","|value": "Терапия"}],
            			"обоснование": ["Обоснование 86"],
            			"причина_отмены": [{"|code": "2", "|value": "Получены новые данные о состоянии пациента" }]
          }]
      }]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentTherapistDraft" id="10fd01d8-1d08-4d89-844b-fa9f624f89b1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentTherapistDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" 
xmlns:core="http://emias.mos.ru/simi/core"
      xmlns:ns3="http://emias.mos.ru/simi/cct"
  xmlns:ns4="http://emias.mos.ru/simi/document" 
xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentTherapist#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentTherapist#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentTherapist#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentTherapist#Response#//*:careEventStarted}</core:careEventStarted>
                  <ns4:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>14951</code>
                     <description>Осмотр терапевта</description>
                     <ns3:cctParameters>
                        <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_therapist_examination.v3</entry>
                        <entry key="protocolMedicalSpecialization">Врач-терапевт</entry>
                        <entry key="Name">Осмотр терапевта</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_therapist_examination.v3</entry>
                        <entry key="ShortName">Осм. терапевта</entry>
                        <entry key="protocolMedicalSpecialization">Врач общей практики (семейный врач)</entry>
                        <entry key="protocolMedicalSpecialization">Врач-терапевт подростковый</entry>
                        <entry key="protocolMedicalSpecialization">Врач-терапевт участковый</entry>
                        <entry key="protocolMedicalSpecialization">Заведующий структурным подразделением - врач общей практики (семейный врач)</entry>
                        <entry key="protocolMedicalSpecialization">Заведующий структурным подразделением - врач-терапевт</entry>
                        <entry key="protocolMedicalSpecialization">Фельдшер</entry>
                        <entry key="openEhrCommonFormVersion">1.1.84</entry>
                     </ns3:cctParameters>
                     <ns3:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </ns3:contentTypeInfo>
                  </ns4:cctInfo>
                  <tags>

                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>   <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>documentPurpose</code>
                        <description>Протокол осмотра</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                   <cct:visualizationId>733F6AD7-762A-45D5-A85F-B571224E6421</cct:visualizationId>
                     <cct:cctCode>14951</cct:cctCode>
                     <visualizationInfo description="Для печати" name="Осмотр терапевта" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags>
                           <tag definedByCct="false">
                              <schema>ru.mos.emias.system.print_options</schema>
                              <code>Clinician protocol</code>
                              <description>{     "bottomMargin": 45,     "extraLines": [         {             "from": {                 "x": 80,                 "y": 45             },             "to": {                 "x": 575,                 "y": 45             },             "width": 0.5         }     ],     "extraTexts": [         {             "lines": [                 "Врач: ${doctor.fio:short}",                 "${healthcare_facility.name}",                 "${document.date.time:full}"             ],             "x": 80,             "y": 30         },         {             "lines": [                 "Пациент: ${patient.fio:full}",               "${patient.age:completed}(${patient.bd:dd} ${patient.bd:mm_text} ${patient.bd:yyyy}), ОМС ${patient.med_policy}"             ],             "x": 328,             "y": 30         }     ],     "isLandscape": true,     "leftMargin": 80,     "pageNumberPosition": {         "x": 565,         "y": 25     },     "pageSize": "A5",     "rightMargin": 20,     "topMargin": 0 }</description>
                           </tag>
                        </cct:tags>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertTherapist#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="false"/>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentTherapistSigned" id="61ebaed7-a126-45d4-8f06-7d305f2903d9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentTherapistSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentTherapist#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentTherapist#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentTherapist#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentTherapist#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>\r
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>14951</code>
             		 <description>Осмотр терапевта</description>
                     <cct:cctParameters>
  					<entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_therapist_examination.v3</entry>
                        <entry key="protocolMedicalSpecialization">Врач-терапевт</entry>
                        <entry key="Name">Осмотр терапевта</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_therapist_examination.v3</entry>
                        <entry key="ShortName">Осм. терапевта</entry>
                        <entry key="protocolMedicalSpecialization">Врач общей практики (семейный врач)</entry>
                        <entry key="protocolMedicalSpecialization">Врач-терапевт подростковый</entry>
                        <entry key="protocolMedicalSpecialization">Врач-терапевт участковый</entry>
                        <entry key="protocolMedicalSpecialization">Заведующий структурным подразделением - врач общей практики (семейный врач)</entry>
                        <entry key="protocolMedicalSpecialization">Заведующий структурным подразделением - врач-терапевт</entry>
                        <entry key="protocolMedicalSpecialization">Фельдшер</entry>
                        <entry key="openEhrCommonFormVersion">1.1.76</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>\r
                  </doc:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>   <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>documentPurpose</code>
                        <description>Протокол осмотра</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                  </tags>
               </doc:documentInfo>\r
               <cct:visualizations>
              <visualization>
                   <cct:visualizationId>733F6AD7-762A-45D5-A85F-B571224E6421</cct:visualizationId>
                     <cct:cctCode>14951</cct:cctCode>
                     <visualizationInfo description="Для печати" name="Осмотр терапевта" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags>
                           <tag definedByCct="false">
                              <schema>ru.mos.emias.system.print_options</schema>
                              <code>Clinician protocol</code>
                              <description>{     "bottomMargin": 45,     "extraLines": [         {             "from": {                 "x": 80,                 "y": 45             },             "to": {                 "x": 575,                 "y": 45             },             "width": 0.5         }     ],     "extraTexts": [         {             "lines": [                 "Врач: ${doctor.fio:short}",                 "${healthcare_facility.name}",                 "${document.date.time:full}"             ],             "x": 80,             "y": 30         },         {             "lines": [                 "Пациент: ${patient.fio:full}",               "${patient.age:completed}(${patient.bd:dd} ${patient.bd:mm_text} ${patient.bd:yyyy}), ОМС ${patient.med_policy}"             ],             "x": 328,             "y": 30         }     ],     "isLandscape": true,     "leftMargin": 80,     "pageNumberPosition": {         "x": 565,         "y": 25     },     "pageSize": "A5",     "rightMargin": 20,     "topMargin": 0 }</description>
                           </tag>
                        </cct:tags>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertTherapist#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="44081485-ac44-4f50-9c42-5dbc331d9d39"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetFinishedAssignment" id="0dc426e4-c777-4784-be6a-556d648cd2ce"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetFinishedAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="1c923e0f-4538-4843-801d-1c9214793369" name="Статус AssignmentFinished"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns3:assignmentStatus  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentFinished&lt;/ns3:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0a0ede91-274c-4c61-8c18-ec2b7b759bc9" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns3:documentId  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns3:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="7fb844d1-0e70-467a-ac76-3a6812089cfb" name="Направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">${GetAssignment#Response#//ns3:options/ns2:entry/text()}&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6a7e6809-f7da-4c20-930b-5905d3a8264b" name="allowChange"><con:configuration><path>//*:allowChange</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6a7e6809-f7da-4c20-930b-5905d3a8264b" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3733def7-5fba-4ed6-a20d-cea131ad72aa" name="TaskConductCompleted"><con:configuration><token><![CDATA[<ns3:tasks>
                  <ns3:id>${GetAssignment#Response#//ns3:tasks/ns3:id/text()}</ns3:id>
                  <ns3:type>Conduct</ns3:type>
                  <ns3:status>Completed</ns3:status>
                  <ns3:documentId>${CreateDocumentTherapist#Response#//*:documentId}</ns3:documentId>
               </ns3:tasks>]]></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmenta507b2ec-fb75-40b4-a974-c6f76a9a0382</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>3d77d92a-3c3b-446b-9150-74379faab6eb::default::1</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2021-11-04T18:55:36</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2021-10-28T18:55:36</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:properties><con:property><con:name>patientId</con:name><con:value>2242008606</con:value></con:property><con:property><con:name>login</con:name><con:value>GaliKirsanova</con:value></con:property><con:property><con:name>contractId</con:name><con:value>121397062</con:value></con:property><con:property><con:name>lpuId</con:name><con:value>206</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</con:value></con:property><con:property><con:name>careEventId</con:name><con:value>${=(int)(Math.random()*(100000))}</con:value></con:property><con:property><con:name>receiv_lpuId</con:name><con:value>10000369</con:value></con:property><con:property><con:name>test_careEventId</con:name><con:value>123</con:value></con:property><con:property><con:name>test_availiableRecourceId</con:name><con:value>123</con:value></con:property><con:property><con:name>systemName</con:name><con:value>INSTRUMENTAL</con:value></con:property><con:property><con:name>userRoleId</con:name><con:value>4</con:value></con:property></con:properties><con:reportParameters/></con:testSuite><con:testSuite id="78ee9c12-ccc2-4968-9040-339846b9e7a9" name="Referral"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="9e94576f-759a-4414-be89-4e612f55da81" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetReferral" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="92219c9d-eb8c-4128-b35d-5ca7b60d3fdb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
     <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="2093f468-1609-4670-accc-4f12833d68dc"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="5729cd0b-673b-4ae6-bda2-82830ad272c4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="c8a29633-fe05-41e9-8668-16f3a6fc9537"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="2f48e0ed-cf8f-4677-8150-4a195ef92239"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="aa59425a-dd7f-4baf-b1a0-ebb458246c54"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="7e3a17da-0f84-4ecc-b0d3-5840e986d09d"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="8220234f-2781-4643-a162-4f70952fd2a8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="d8f57e80-33fc-4154-8b8c-99914433e2e3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="27a92ee4-691e-4e0a-bb6f-b643d4699490"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="e1966b63-45ae-46bb-b94c-4a011ba6b083"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="933b585e-8ef4-49cb-b9d9-dca5929cfd5f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="a3b99f82-49f9-4555-be6c-56dfef66821d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="c9549f59-b8fc-4394-adf0-2bc9762a74df" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="3ba08837-fc05-4c3a-ba95-3cea96298366"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
    <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46082</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="f70e005d-2e5c-4dca-8071-34f8cc4e0378"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="406734c4-ac49-4a9b-b4e7-c629129bb3ac"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-29T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-29T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="a6d6159a-c27a-46be-a8f2-b29ee4cb3973"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="bfe27626-a36e-44df-95ad-56e7afcf79dd"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="ae5fadd7-8556-4131-8353-8222c7fe1f11"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${SaveDocumentReferralDraft#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="7f1a1800-fed5-419c-8080-c40234b762ff"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="2a170be6-66d7-4506-876c-744658c9b9b6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "10000454",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-13T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-15T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="3c5be38d-8930-4cad-bfef-93f5c5a5eeda"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                              <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="eede615b-90d6-4aa8-a632-b2ca8bd268a2"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="getReferral" id="36d4e405-733c-44c1-91a4-fee37f2797f3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferral</con:operation><con:request name="getReferral" id="1a222d23-5c01-4345-b951-aa030a902079"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">
   <soap:Header>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ref:GetReferralRequest>
         <ref:referralId>${#TestCase#referralId}</ref:referralId>
      </ref:GetReferralRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="859a0eee-3dc0-4b72-aab1-bc66a0939d3d"/><con:assertion type="SOAP Fault Assertion" id="20dabd32-0b3c-4475-a6ed-5002dd4371d1"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getReferralByAssignmentId" id="f50549d7-35a0-4a07-bcd0-92283d4782f8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralByAssignmentId</con:operation><con:request name="getReferralByAssignmentId" id="17888f7c-f607-4dcf-a525-ad876e7188f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByAssignmentIdRequest>\r
         <ref:assignmentId>${#TestCase#assignmentId}</ref:assignmentId>\r
      </ref:GetReferralByAssignmentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="1f490da4-b508-44c7-832f-336eed216757"/><con:assertion type="SOAP Fault Assertion" id="ab7efbad-e9c2-4122-8616-575debdbd9f2"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getReferralByDocumentId" id="ecf96428-abd9-4024-ae4b-1e649de3eed6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralByDocumentId</con:operation><con:request name="getReferralByDocumentId" id="82248059-c19b-4001-bb3a-dce095870eac"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByDocumentIdRequest>\r
         <ref:documentId>${CreateDocumentReferral#Response#//*:documentId}</ref:documentId>\r
      </ref:GetReferralByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="05ee664e-2b3f-47fc-b49c-b5e93b333537"/><con:assertion type="SOAP Fault Assertion" id="fb4efce5-9496-4e27-945f-434a29d2a166"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getReferralsByPatient" id="3f376f4a-893f-448f-b8ff-7846bdc6ad05"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralsByPatient</con:operation><con:request name="getReferralsByPatient" id="0935c428-61e8-4cfe-86fb-540faf3f6cf2"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralsByPatientRequest>\r
         <ref:patientId>30000000174002</ref:patientId>\r
      </ref:GetReferralsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6185653b-1451-4a4e-a9bc-44ea1c45a0a2"/><con:assertion type="SOAP Fault Assertion" id="4d383b1e-4cfe-418f-8ed0-3eca9d0b27e8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentb2a4fd29-c0b8-4013-baac-31f6606bb8e6</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T09:54:41</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T09:54:41</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferral16b2faa1-ab78-4de8-baec-b91b7c173d7d</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="8b7b911e-146a-46a8-9e54-e8348972fdf1" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetReferralByAssignmentId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="d92cba74-b031-4b33-b07e-31bc2051cddb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
    <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="e39b3464-b4b9-477d-bcd7-b3f8fb3d319d"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="0baa4ed8-ced0-48eb-8e1d-79a36d9c0682"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="82c20c44-5d1d-4806-8ce6-b3cae472e9b0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="04ccbb65-fa60-481e-a033-ff7440c79091"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="d24dec07-9aa9-4ead-b229-c4c3f0b361eb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="7bb4cefd-8a17-4d40-afa2-19fb4face350"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="471f2154-f282-4a7e-bf66-406f3d99bc19"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="6da03a20-9f15-40f1-8668-6b362ae2956d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="f255ec24-7cd8-4e14-99a1-fcc7797eac45"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="964c0842-a16a-406b-bb23-1ec9c3b4df3a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="c27d9e55-1bac-4079-a05e-28ec2481276f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="714a6463-be4d-4cbe-a9f7-4bdc22a31d1c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="bb9b2fb8-9917-4974-891a-17cbfea7b83d" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="c2a8fa36-cf3c-49ab-b140-26c4076ba773"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46082</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="043a780a-1038-480a-95fb-32f56b883ee1"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="1d7ac528-c81d-4a41-88a8-90e0a0a2f057"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2019-12-16T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2019-12-19T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="2dd38f1b-bcdf-4891-a904-a870de2d560e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="d3426e75-4882-4c4a-b3da-07bf68f0130c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="5a5ba048-f915-4e59-a33b-f8574a3a540f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${SaveDocumentReferralDraft#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="b441973f-26c6-4626-b5a9-6bbb115bc649"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="115478f9-7423-4c14-8624-dfee612a57e9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "10000454",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-13T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-15T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="b0a9e02b-a33c-4221-923c-8f1b45858675"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                              <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="880aed27-a72b-45b1-b85b-f9c7d83820a6"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="getReferralByAssignmentId" id="e2d197cb-ec14-4f0b-ba33-e10bf44d17e7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralByAssignmentId</con:operation><con:request name="getReferralByAssignmentId" id="17888f7c-f607-4dcf-a525-ad876e7188f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByAssignmentIdRequest>\r
         <ref:assignmentId>${#TestCase#assignmentId}</ref:assignmentId>\r
      </ref:GetReferralByAssignmentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="1f490da4-b508-44c7-832f-336eed216757"/><con:assertion type="SOAP Fault Assertion" id="ab7efbad-e9c2-4122-8616-575debdbd9f2"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentb2a4fd29-c0b8-4013-baac-31f6606bb8e6</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T09:54:41</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T09:54:41</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferral16b2faa1-ab78-4de8-baec-b91b7c173d7d</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="a7dbb117-7d19-491b-bdce-3ae1855c4eb9" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetReferralBydocumentId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="9bc6959c-7d9c-4b45-a911-36832c87e571"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="835a377c-a819-4fad-801c-4de17ba85b87"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="df7d6774-8c07-4b8c-8fa8-630d97b79fb1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="e0447829-d093-4c37-91bb-df4250ddf4c4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="002afb81-dc03-4f67-8ec5-0c2aae5e1f4f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="32a39b53-a15b-48db-80d5-cbad615282c9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="891c0a19-dfe1-4434-9913-c30ed3f26c97"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="23ba733f-4271-461c-b84f-eb8e7f982000"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="777d5d51-abd3-457f-affc-6403cc684760"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="b5f25f26-6445-4d7e-8724-8eaeead1ea46"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="3109674b-eb66-45b1-845c-67e08f76ab1b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="0c36ea0c-ed2d-4e31-b002-f3d8b28f222c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="851bd3b3-2610-414b-91fb-0f3b78a90b18"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="a1315170-2796-436c-801b-61ce11a94859" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="7434261d-90de-4eea-b858-24520e2a24ef"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46082</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="ffd3e4fd-5a6b-4c47-8379-a524b36f5fbd"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="bc63c29f-91ad-4303-a097-6715892cce31"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2019-12-16T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2019-12-19T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="7e745798-da7d-4ede-90b1-117437f121c0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="414c4160-de42-4f0f-9b83-9ed01ff9dc16"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="ed4f35d9-0ee3-4b82-b54e-ce3ee936f77b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${SaveDocumentReferralDraft#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="097265a8-3458-4b4e-aca9-f2a0a6876dbc"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="d80e69a5-0526-47f5-ae93-cace83e1feaf"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "10000454",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-13T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-15T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="b954169d-84ef-447e-9ebe-cbbe143a4f94"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                              <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="dbd8593b-3501-4d15-97cf-45729996d506"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="getReferralByDocumentId" id="f97d24e2-5822-447c-a04d-7d15dccf379a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralByDocumentId</con:operation><con:request name="getReferralByDocumentId" id="82248059-c19b-4001-bb3a-dce095870eac"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByDocumentIdRequest>\r
         <ref:documentId>${CreateDocumentReferral#Response#//*:documentId}</ref:documentId>\r
      </ref:GetReferralByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="05ee664e-2b3f-47fc-b49c-b5e93b333537"/><con:assertion type="SOAP Fault Assertion" id="fb4efce5-9496-4e27-945f-434a29d2a166"/><con:assertion type="Simple Contains" id="f0fd35bc-b1de-45aa-a8cb-04846749e37d" name="Contains"><con:configuration><token>referralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment8feee8c6-c83f-47df-8138-a0b807050569</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T10:12:26</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T10:12:26</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferral63b4ce7f-e25e-41bd-938f-4c76ba5b9281</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="8cae7fe6-d8e5-4028-a0ff-c87cdc6a1111" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetReferralByPatientId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="082d60f6-530a-4fa3-a7be-d0750235e166"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
    <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="d8bcbfa3-4cbd-4a5c-a383-e4cf810ff31d"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="832f87d7-c724-4eb0-a050-332a198bef08"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="498b82b3-ed87-4813-b5ec-0fd1903ffdfb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="5ed082b8-c4bf-4e27-9841-0ddd45e4234e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="10da5395-cad9-463b-89aa-78d1a8303c29"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="d4652ba1-c8be-4e32-a523-a5f1902fff4d"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="60b6f2f1-9194-4a51-acbf-07443f4decbe"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="a8b4661d-7492-4ada-a150-a23299981e97"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="73c7bb81-b07b-41c8-9bff-eebb2d77948b"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="978cac8c-ffcf-4bec-b5f4-01d16cb6cbef"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="407e150f-f2a2-438c-8e72-ae11e9d41fbc"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignmentByDocumentId" id="cf98c6e9-4935-4341-b6da-113b0295dcad"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignmentByDocumentId</con:operation><con:request name="GetAssignmentByDocumentId" id="3ea2c26f-5e0f-4d90-bed8-6a6bbac66468"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentByDocumentIdRequest>\r
         <ass:documentId>${CreateDocumentAssignment#Response#//*:documentId}</ass:documentId>\r
      </ass:GetAssignmentByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="acb74e5e-2019-4fab-a5d2-10e9f761bff9"/><con:assertion type="SOAP Fault Assertion" id="ecb40008-b8d8-484b-af0a-9c04e45018da"/><con:assertion type="Simple Contains" id="881b38b3-dea1-4afd-adb6-4745e5d1daa7" name="Contains"><con:configuration><token>suppReferralId</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple Contains" id="8ab93637-4f92-4532-9db5-fa6cca7423ca" name="tasks"><con:configuration><token>tasks</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="74aaa12c-ab53-4a16-b26e-33cacf5785b9" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="aab4e82d-b079-4bfd-a71e-36acce858f18"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
    <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46082</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="5cd43ca9-676a-4251-a56f-c7142fb5883a"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="8120c7c8-0b14-4d3b-b076-375981c91819"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2019-12-16T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2019-12-19T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="cf1b2896-2ca0-4b7c-a566-1a5de5681e76"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="a83b77bc-b41f-47da-bc2b-5425448a81b6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="df4820a2-6952-41d4-a822-fa31a8aadcb7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${SaveDocumentReferralDraft#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="7a8f9a46-00b6-4213-a5ed-4aef41e11c00"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="4f508148-1283-4b17-8a9c-ad12d44a2341"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "10000454",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-13T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-15T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="2881fe2e-2f93-45f7-936a-444a16abb0c8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                              <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="b1569849-15c6-4a35-9a8d-3a4c2b1afcbd"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="getReferralByDocumentId" id="7b775894-1f79-4552-91a2-6045f5ef5ead"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralByDocumentId</con:operation><con:request name="getReferralByDocumentId" id="82248059-c19b-4001-bb3a-dce095870eac"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralByDocumentIdRequest>\r
         <ref:documentId>${CreateDocumentReferral#Response#//*:documentId}</ref:documentId>\r
      </ref:GetReferralByDocumentIdRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="05ee664e-2b3f-47fc-b49c-b5e93b333537"/><con:assertion type="SOAP Fault Assertion" id="fb4efce5-9496-4e27-945f-434a29d2a166"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getReferralsByPatient" id="02bc6283-0c33-4257-b780-492a2e2a9a61"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferralsByPatient</con:operation><con:request name="getReferralsByPatient" id="0935c428-61e8-4cfe-86fb-540faf3f6cf2"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralsByPatientRequest>\r
         <ref:patientId>30000000174002</ref:patientId>\r
      </ref:GetReferralsByPatientRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6185653b-1451-4a4e-a9bc-44ea1c45a0a2"/><con:assertion type="SOAP Fault Assertion" id="4d383b1e-4cfe-418f-8ed0-3eca9d0b27e8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentb2a4fd29-c0b8-4013-baac-31f6606bb8e6</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T09:54:41</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T09:54:41</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferral16b2faa1-ab78-4de8-baec-b91b7c173d7d</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="f0cde517-912c-41c3-9f17-4fe2d2d98072" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Canseled Referral" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="18d931d6-76a4-4a3a-b8d2-76d36f30e9f6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
    <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="4e4b7e04-7e9a-4960-96ba-ec8ff90a8d0d"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="9005fed7-58c6-43d0-bb24-1ca10aa2a78c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="98722e31-af41-4d21-9bdb-7bf6fbe7f75e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="dc9a2214-11ca-4543-88f4-c1b5a4d04fa7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="12b3b49e-4698-4053-92a4-f1edb19b8674"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="b8e79df9-f419-42d2-a91a-a998be9bdc8d"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="3c74c114-d033-4797-bd29-51b3e97b0ded"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="f3b7704a-46b7-4228-a94f-643589a42bff"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="76c133b5-5a05-40b3-b272-0a18734b64de"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="2b61ac32-8a1d-478d-8183-dafd3ad260d0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="deprecateDocument" id="86ed4b26-f009-4881-b366-2ced7c49b95f" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>deprecateDocument</con:operation><con:request name="deprecateDocument" id="e747c1dd-649d-4649-90ca-f18e0149ed75"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:deprecateDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:deprecateDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8c0648aa-66c8-4e1b-abef-15e9fb272703"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="fa0a20e2-9f94-4c54-884d-242c5cece6d8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46082</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="dc9980d9-294a-4dce-addf-4b5f78ef2d6a"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="bd07a679-484a-4e68-993f-975c17cb4535"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-29T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-29T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="373a349c-3dbe-4cb7-bbd3-9bd0f566506f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="4d37dce4-794d-4c93-b61e-6c64b34f0be5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="a568686a-0e4e-4aa2-88ef-6a2f47bbe046"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${getDocumentReferral#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="50eae9e4-bea8-4f63-a7b4-bcb940078ad2"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="44a7a3c1-f8a7-4ad3-8f3b-1240096e7f1e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "10000454",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-29T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-29T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="6d7608fb-0082-45af-a1c4-1499050522ee"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46082</code>
                     <!--Optional:-->
                     <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Направление на госпитализацию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Направление</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertReferralContentSigned#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                              <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="57b0ca29-a317-4451-ae23-316163dac751"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="getReferral" id="86f71d55-d736-4f44-abf2-d9ea05d469c8" disabled="true"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferral</con:operation><con:request name="getReferral" id="1a222d23-5c01-4345-b951-aa030a902079"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">
   <soap:Header>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ref:GetReferralRequest>
         <ref:referralId>${#TestCase#referralId}</ref:referralId>
      </ref:GetReferralRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="859a0eee-3dc0-4b72-aab1-bc66a0939d3d"/><con:assertion type="SOAP Fault Assertion" id="20dabd32-0b3c-4475-a6ed-5002dd4371d1"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentCancelReferral" id="f514a776-7329-49e4-86fd-eb0bbb49c476"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentCancelReferral" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
    <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>16952</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelReferralContentDraft" id="d3fe3eda-c2d8-42da-a71c-1c3355c8280a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertCancelReferralContentDraft" id="ec78cacb-3002-45a7-b026-29f87bcb01a7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
  "отмена_направления_во_внешнюю_организацию": {
   		"language":"ru",
          "territory":"RU",
           "_link": [
      {
        "|meaning": "Assignment Consultations",
        "|type": "Assignment",
        "|target": "${#TestCase#assignmentId}"
      }
      ],
    "context":[{
                "_health_care_facility":[{
                  "|id":"1117746711180",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
               "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы"
                ],
                "родительский_ид": [
                  {
                    "|id": "",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ]
              }
            ],
             "адрес_медицинской_организации":[{
                        "субъект_рф":["Субъект РФ 88"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                        "поселение":["Поселение 76"],
                        "населенный_пункт":["Населенный пункт 40"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                        "улица":["Улица 6"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 60"],
                              "номер_строения":["Номер строения 92"],
                              "номер_корпуса":["Номер корпуса 93"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 28"],
                        "дополнительная_информация":["Дополнительная информация 49"]
                     }],
                  "информация_о_месте_cобытия":[{
                        "событие_произошло":[{"|code":"at0071"}],
                        "субъект_рф":["Субъект РФ 51"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                        "поселение":["Поселение 34"],
                        "населенный_пункт":["Населенный пункт 48"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                        "улица":["Улица 26"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 68"],
                              "номер_строения":["Номер строения 30"],
                              "номер_корпуса":["Номер корпуса 66"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 27"],
                        "номер_помещения":["Номер помещения 99"],
                        "дополнительная_информация":["Дополнительная информация 24"]
                     }
                  ],
                  "дополнительная_информация":[{
                        "профиль_медицинской_помощи":[{"|code":"at0087"}],
                        "виды_медицинской_помощи":[{"|code":"at0050"}],
                        "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                        "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                     }]
               }]
        }],       
    "сведения_о_выполнении": [
      {
        "направление": [
         {
 
              "_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
              "ism_transition":[
                 {
                    "current_state":[
                       {
                          "|code":"528"
                       }
                    ],
                    "careflow_step":[
                       {
                          "|code":"at0009"
                       }
                    ]
                 }
              ],                     
            "идентификатор_услуги": [
              "Идентификатор услуги 93"
            ],
            "тип_услуги": [
              "Тип услуги 78"
            ],
            "причина": [
              "Причина 3"
            ],
            "описание": [
              "Описание 38"
            ],
            "срок_действия": [
              "P1DT9H29M"
            ],
            "ид_запроса_у_инциатора": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              7
            ],
            "общее_число_услуг": [
              2
            ],
            "time": [
              "2022-09-29T15:12:36.192+03:00"
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b5f3a7fe-260c-4ae9-ae56-9ccd94a09bcc"/><con:assertion type="SOAP Fault Assertion" id="cce44908-9403-4e01-a904-ec8449feddae"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft1" id="f49a936e-bdc3-4c22-a97c-e93fec811280"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft1" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentCancelReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentCancelReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentCancelReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>16952</code>
                     <!--Optional:-->
                     <value>Отмена направления на госпит-ию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Отмена направления на госпит-ию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</value>
                        </tag>
                     <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertCancelReferralContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral1" id="518234c3-abb7-4379-9dc6-4099166de05b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral1" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelReferralData" id="6fee5abc-c70b-4d22-8167-8a7eb1683707"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertCancelReferralData" id="745b2c12-ace7-420d-9b49-6b9b29eab7c9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertBase64TddToJson>
         <typ:base64CompositionTdd>${getDocumentReferral1#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6fb29f80-b06e-4d74-b65f-b77a9c22f547"/><con:assertion type="SOAP Fault Assertion" id="fed00cdd-3e13-4f8d-8202-fe4c9557837a"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelReferralContentSigned" id="4e996116-ae79-46d5-93ef-47581b2b36ee"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertCancelReferralContentSigned" id="a71f1055-ea86-4ae9-821f-e893f0cb43d1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
  "отмена_направления_во_внешнюю_организацию": {
   		"language":"ru",
          "territory":"RU",
            "_link": [
      {
        "|meaning": "Assignment Consultations",
        "|type": "Assignment",
        "|target": "${#TestCase#assignmentId}"
      }
      ],
    "context":[{
                "_health_care_facility":[{
                  "|id":"1117746711180",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
               "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "ВРАЧ"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы"
                ],
                "родительский_ид": [
                  {
                    "|id": "",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ]
              }
            ],
             "адрес_медицинской_организации":[{
                        "субъект_рф":["Субъект РФ 88"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                        "поселение":["Поселение 76"],
                        "населенный_пункт":["Населенный пункт 40"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                        "улица":["Улица 6"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 60"],
                              "номер_строения":["Номер строения 92"],
                              "номер_корпуса":["Номер корпуса 93"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 28"],
                        "дополнительная_информация":["Дополнительная информация 49"]
                     }],
                  "информация_о_месте_cобытия":[{
                        "событие_произошло":[{"|code":"at0071"}],
                        "субъект_рф":["Субъект РФ 51"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                        "поселение":["Поселение 34"],
                        "населенный_пункт":["Населенный пункт 48"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                        "улица":["Улица 26"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 68"],
                              "номер_строения":["Номер строения 30"],
                              "номер_корпуса":["Номер корпуса 66"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 27"],
                        "номер_помещения":["Номер помещения 99"],
                        "дополнительная_информация":["Дополнительная информация 24"]
                     }
                  ],
                  "дополнительная_информация":[{
                        "профиль_медицинской_помощи":[{"|code":"at0087"}],
                        "виды_медицинской_помощи":[{"|code":"at0050"}],
                        "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                        "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                     }]
               }]
        }],       
    "сведения_о_выполнении": [
      {
        "направление": [
         {
 
              "_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
              "ism_transition":[
                 {
                    "current_state":[
                       {
                          "|code":"528"
                       }
                    ],
                    "careflow_step":[
                       {
                          "|code":"at0009"
                       }
                    ]
                 }
              ],                     
            "идентификатор_услуги": [
              "Идентификатор услуги 93"
            ],
            "тип_услуги": [
              "Тип услуги 78"
            ],
            "причина": [
              "Причина 3"
            ],
            "описание": [
              "Описание 38"
            ],
            "срок_действия": [
              "P1DT9H29M"
            ],
            "ид_запроса_у_инциатора": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              7
            ],
            "общее_число_услуг": [
              2
            ],
            "time": [
              "2019-12-02T15:12:36.192+03:00"
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a420009-28d8-41fe-b06c-0e56a91b9375"/><con:assertion type="SOAP Fault Assertion" id="ce3f0990-ee48-4a48-95d9-4c1669e2aaa9"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentCancelReferralSigned" id="95f4f65d-b7fe-4223-a2d3-bb66a5069a00"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentCancelReferralSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentCancelReferral#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentCancelReferral#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentCancelReferral#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>16952</code>
                     <!--Optional:-->
                     <value>Отмена направления на госпит-ию, обсл-ие, конс-ию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Отмена направления на госпит-ию, обсл-ие, конс-ию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</value>
                        </tag>
                                                       <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                                           </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</value>
                     </tag>
                   </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertCancelReferralContentSigned#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                              <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral2" id="612dc559-aa34-40d8-be1f-68bdbd24707a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral2" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmente87a6aa0-becc-47ec-b26a-b819679ff95c</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>b351f918-2881-46fd-8e0b-40b0baff3d2f::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T11:09:27</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T11:09:27</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferraled09d806-8288-4ab6-844b-2f1a7d190b6d</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="e136822b-706f-46b7-a7b6-b722fad6f16d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="GetReferral_simi4" searchProperties="true"><con:settings/><con:testStep type="request" name="CreateDocumentAssignment" id="d1b447d2-cf53-4ef5-aa01-4b328714f552"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46081</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="c7e0ed23-1785-4d84-9ed3-9d0e44e45a08"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="7bd02304-ce46-4dbc-a048-4392eef7f3fe"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "9",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A01.0", "|value": "A01.0 - Брюшной тиф"}],
                "развернутый_клинический_диагноз": ["A01.0 - Брюшной тиф"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "90", "|value": "Хирург"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["666"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "12565786",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="0e7d69bf-724e-44f4-801f-2e6626da0a51"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <description>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <description>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="false"/>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="ea9bcdc2-d05a-4b13-9f5c-bff3239489a5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="0647f5d6-ecad-4008-b8e1-a76e1d07cae8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="53c8fdfd-8ed5-4d25-b66c-0380f87a4c1f"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="677c3abf-f821-4e14-afc7-5b9308d46a0f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
   <soapenv:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
         </wsse:UsernameToken>
      </wsse:Security>
   </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["10000454"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "10000454"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "10",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["PDN"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="598276ac-7ce5-46ea-b14e-30555fae4eb1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentSigned#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="02e6ba41-3f5a-457f-b1b0-16375a13bdf5"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="588b2625-69b7-4c88-9581-3954630035ce"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="071750e1-bd50-4b1c-9f01-9107579d8ab8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46082</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="687e967a-d0b7-4973-8ad8-228a278a559c"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="b9b0274b-29dc-4b7f-8231-6beed784053a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2019-12-16T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2019-12-19T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="b1374737-bad6-4794-8563-a5cbf2105c3b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentReferral#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentReferral#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                  	 <code>46082</code>
                     <description>Направление на госпитализацию, обсл-ие, конс-ию</description>           
                     <cct:cctParameters>
 				    <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="openEhrCommonFormVersion">1.0.17</entry>
                        <entry key="Name">Направление на госпитализацию, обсл-ие, конс-ию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="ShortName">Направление</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
            <doc:signature technicalSignature="false"/>
         </doc:document>
      </typ:saveDocument>

   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="1584f3a5-be62-43af-bed5-44f23c435609"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentReferral#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="f5458422-025a-48a3-aa80-b5f693b532ff"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${getDocumentReferral#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="be6ac537-10c8-4fa1-8d29-207fc4949d27"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="b901f3f9-7512-43e4-97cc-0e2be1b1ed48"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "10000454",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2022-09-13T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2022-09-15T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "10000454"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="d223e6ca-b785-4aa3-9edc-74bdc43a9e26"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="DRAFT" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentReferral#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentReferral#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                  	 <code>46082</code>
                     <description>Направление на госпитализацию, обсл-ие, конс-ию</description>           
                     <cct:cctParameters>
 				    <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="openEhrCommonFormVersion">1.0.17</entry>
                        <entry key="Name">Направление на госпитализацию, обсл-ие, конс-ию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="ShortName">Направление</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertReferralContentSigned#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
  			<doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
               <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
            </doc:signature>
         </doc:document>
      </typ:saveDocument>

   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getReferral" id="01f212be-b3b9-48df-bb08-215cb25a4255"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferral</con:operation><con:request name="getReferral" id="1a222d23-5c01-4345-b951-aa030a902079"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">
   <soap:Header>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ref:GetReferralRequest>
         <ref:referralId>ConsultationReferraldcc2be52-8c74-47d6-8b87-6d287092cf81</ref:referralId>
      </ref:GetReferralRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="859a0eee-3dc0-4b72-aab1-bc66a0939d3d"/><con:assertion type="SOAP Fault Assertion" id="20dabd32-0b3c-4475-a6ed-5002dd4371d1"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="7dd6a96a-7af5-46fb-babe-ffec23bd2df2"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetReferralSUPP" id="f67265a1-ff01-4dc6-aa85-c93d4385fefa"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AppointmentServiceV1Binding</con:interface><con:operation>getReferralsByIDs</con:operation><con:request name="GetReferralSUPP" id="41eb2dd5-d701-4621-88c5-0915a7994fd9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AppointmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v1="http://emias2.gov.ru/appointment/v1/">\r
   <soap:Header>\r
       <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
      <v1:UserContextInfo>\r
         <v1:lpuId>${#TestSuite#lpuId}</v1:lpuId>\r
         <v1:jobId>${#TestSuite#contractId}</v1:jobId>\r
         <v1:userRoleId>4</v1:userRoleId>\r
      </v1:UserContextInfo>\r
   </soap:Header>\r
   <soap:Body>\r
      <v1:getReferralsByIDs>\r
         <!--1 or more repetitions:-->\r
         <v1:referralId>${GetAssignment#Response#//ns3:options/ns2:entry/text()}</v1:referralId>\r
      </v1:getReferralsByIDs>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f25e1e79-a400-403e-ae8e-ae466855c662"/><con:assertion type="SOAP Fault Assertion" id="9f09b829-1eb0-424b-8de8-5ae39b679067"/><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isActive = true"><con:configuration><path>//*:isActive</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="d936dfc9-c817-44f0-8d1d-062c969644d8" name="isCanceled = false"><con:configuration><path>//*:isCanceled</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment3ce9f220-5275-402a-bfa8-0f0679f3ad83</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>2d066aba-adc3-428a-b782-deee5d942d68::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-13T17:55:01</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-09-20T17:55:01</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferraldcc2be52-8c74-47d6-8b87-6d287092cf81</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="90df805f-d9ee-4a63-b08e-d7bd2f1a4d28" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Cancel Referral_simi4" searchProperties="true"><con:settings/><con:testStep type="request" name="CreateDocumentAssignment" id="50616a05-dc35-4af9-ac6f-4f1651721baf"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46081</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="52e82912-f3cd-42a1-8775-514cb8e1cb4b"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="aede77c1-83b7-4f03-bb17-88ead579e43d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "9",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A01.0", "|value": "A01.0 - Брюшной тиф"}],
                "развернутый_клинический_диагноз": ["A01.0 - Брюшной тиф"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "90", "|value": "Хирург"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["666"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "12565786",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="d8df7d16-0179-4a3b-abdc-8f2556d78949"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <description>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <description>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="false"/>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="4bab1b34-3b92-44da-8ca7-cef587c4dd28"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="f64ad662-39ad-4f4b-8e3f-9b035e69b6b2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="50e8b94d-5342-4aea-a9fd-9a7db34551a8"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="a91e9628-46d0-4591-bf68-ad6c1eb71d82"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
   <soapenv:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
         </wsse:UsernameToken>
      </wsse:Security>
   </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "897",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1863"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="4afbdc35-fe6e-4fa8-a04d-65a79421a114"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentSigned#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="351cbc5a-ef72-4fb4-be01-7f9da4991d6a"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="71c40106-86ba-4ccb-b5e9-de13dbde022c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentReferral" id="bcdb9e3c-0e31-4115-a11e-b27be5e42346"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentReferral" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46082</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetReferralId" id="e2be75bd-6cf1-4170-abe2-0c0a73aeb595"><con:settings/><con:config><script>  UUID uuid = UUID.randomUUID()
 def referralId = "ConsultationReferral" + uuid
testRunner.testCase.setPropertyValue("referralId",referralId)
  log.info (referralId)</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentDraft" id="ca0432e3-8dd8-4388-b9fc-941189544c83"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>\r
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2019-12-16T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2019-12-19T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "526"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0002"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft" id="1da16c8d-84d9-49c2-bfb5-65f302bca34e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentReferral#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentReferral#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                  	 <code>46082</code>
                     <description>Направление на госпитализацию, обсл-ие, конс-ию</description>           
                     <cct:cctParameters>
 				    <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="openEhrCommonFormVersion">1.0.17</entry>
                        <entry key="Name">Направление на госпитализацию, обсл-ие, конс-ию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="ShortName">Направление</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertReferralContentDraft#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
            <doc:signature technicalSignature="false"/>
         </doc:document>
      </typ:saveDocument>

   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral" id="e0bb7bdc-5493-4c82-b16e-ecd486c93b65"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentReferral#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertReferralData" id="4e0c1b0a-f9c1-42c8-98a1-60ed45b9918e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertReferralData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
<!--         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r-->
     <typ:base64CompositionTdd>${getDocumentReferral#Response#//*:data}</typ:base64CompositionTdd>
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getReferralCompositionUid" id="42a308fa-a248-4b3a-9a1c-a5629b62a043"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertReferralData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.направление_во_внешнюю_организацию.сведения_о_выполнении.направление[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertReferralContentSigned" id="7a745b6b-8a54-44b6-8108-6177c355f3f0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertReferralContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
    "направление_во_внешнюю_организацию":{ 
    	  "_link": [{
        	"|meaning": "Assignment Consultations",
        	"|type": "Assignment",
        	"|target": "${#TestCase#assignmentId}"
    	}],
        "language":"ru",
        "territory":"RU",
         "composer":[{
            "|id":"${#TestSuite#contractId}",
            "|name":"ФИО врача",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
    "context":[{
              "_health_care_facility":[{
                  "|id":"${#TestSuite#lpuId}",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
                "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Врач"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы 'Детская городская поликлиника № 140 ДЗМ'" ]
                
              }
            ],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 88"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 66"
                ],
                "поселение": [
                  "Поселение 76"
                ],
                "населенный_пункт": [
                  "Населенный пункт 40"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 38"
                ],
                "улица": [
                  "Улица 6"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 60"
                    ],
                    "номер_строения": [
                      "Номер строения 92"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 93"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 28"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 49"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 51"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 29"
                ],
                "поселение": [
                  "Поселение 34"
                ],
                "населенный_пункт": [
                  "Населенный пункт 48"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 96"
                ],
                "улица": [
                  "Улица 26"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 68"
                    ],
                    "номер_строения": [
                      "Номер строения 30"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 66"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 27"
                ],
                "номер_помещения": [
                  "Номер помещения 99"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 24"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0087"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0050"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0055"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0060"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_направлении": [
      {
        "направление": [
          {
            "_uid": [
              "${#TestCase#referralId}"
            ],
            "запрос": [
              {
                "идентификатор_запрашиваемой_услуги": [
                  "Идентификатор запрашиваемой услуги 88"
                ],
                "описание_услуги": [
                  "Описание услуги 74"
                ],
                "клиническая_причина": [
                  "Клиническая причина 93"
                ],
                "описание_причины": [
                  "Описание причины 92"
                ],
                "диагностическая_задача": [
                  "Диагностическая задача 64"
                ],
                "срочность": [
                  {
                    "|code": "at0137"
                  }
                ],
                "дата_время_выполнения": [
                  "2019-12-16T17:59:07.298+03:00"
                ],
                "крайняя_дата_выполнения": [
                  "2019-12-19T17:59:07.298+03:00"
                ],
                "будет_направлена_дополнительная_информация": [
                  true
                ],
                "описание_информации": [
                  "Описание информации 47"
                ]
               
              }
            ],
            "идентификатор_направления": [
              "${#TestCase#referralId}"
            ],
            "ид_запроса_у_исполнителя": [
              "ИД запроса у исполнителя 94"
            ],
            "статус_запроса": [
              "Статус запроса 63"
            ],
            "длительность_действия": [
              {
                "длительность_действия": [
                  "P1DT8H17M"
                ],
                "бессрочное": [
                  true
                ]
              }
            ],
            "медицинская_организация": [
              {
                "название": [
                  "Название МО"
                ],
                "идентификатор": [
                  "${#TestSuite#receiv_lpuId}"
                ]
              }
            ],
            "срок_действия": [
              {
                "срочность": [
                  "Срочность 7"
                ],
                "дата_начала_действия": [
                  "${#TestSuite#assignmentStartDate}"
                ],
                "дата_окончания_действия": [
                  "${#TestSuite#assignmentEndDate}"
                ]
              }
            ],
            "медицинское_учреждение": [
              {
                "название": [
                  "Название МУ"
                ],
                "идентификатор": [
                  "2"
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_выполнении": [
      {
        "направление": [
          {
			"_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
            "ism_transition": [
              {
                "current_state": [
                  {
                    "|code": "532"
                  }
                ],
				"careflow_step":[
                       {
                          "|code":"at0005"
                       }
                    ]
              }
            ],
            "идентификатор_услуги": [
              "Идентификатор услуги 17"
            ],
            "тип_услуги": [
              "Тип услуги 38"
            ],
           
            "описание": [
              "Описание 71"
            ],
            "срок_действия": [
              "P7D"
            ],
            "идентификатор_направления": [
              {
                "|id": "${#TestCase#referralId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "f07b0aef-302d-483b-bea2-82db306ef63b",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              5
            ],
            "общее_число_услуг": [
              3
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralSigned" id="e049a24f-6cf3-41cd-bebd-d0e1e18abc62"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="DRAFT" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentReferral#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentReferral#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentReferral#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentReferral#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                  	 <code>46082</code>
                     <description>Направление на госпитализацию, обсл-ие, конс-ию</description>           
                     <cct:cctParameters>
 				    <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="openEhrCommonFormVersion">1.0.17</entry>
                        <entry key="Name">Направление на госпитализацию, обсл-ие, конс-ию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_external_referral.v1.1</entry>
                        <entry key="ShortName">Направление</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_external_referral.v1.1</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertReferralContentSigned#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
  			<doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
               <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
            </doc:signature>
         </doc:document>
      </typ:saveDocument>

   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay2" id="cacc9cf1-268b-4697-9ed1-f171321cd565"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="getReferral" id="91cdbe58-7fc1-4fd7-8b67-2a9d7f3fff9b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferral</con:operation><con:request name="getReferral" id="dfe9f06b-ba84-40c2-a102-d950b143d8f2"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralRequest>\r
         <ref:referralId>${#TestCase#referralId}</ref:referralId>\r
      </ref:GetReferralRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="1cf352d8-dae5-4459-812f-d63aa93fc9b9"/><con:assertion type="SOAP Fault Assertion" id="6716b68a-92e2-496b-92ea-bd5a3c6225e9"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentCancelReferral" id="36f5e8b8-58f2-44bf-9998-d52b312717c2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentCancelReferral" id="ea06e442-a9ca-48b8-a523-062754fc1371"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:createDocument>
         <cct:cctCode>16952</cct:cctCode>
         <core:patientId>${#TestSuite#patientId}</core:patientId>
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>
      </typ:createDocument>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d57e5ef9-2e24-4fe8-99b0-da8495aafde7"/><con:assertion type="SOAP Fault Assertion" id="e317d7c0-c5a9-4e70-9ee5-d419d1f766e1"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelReferralContentDraft" id="eeacfd37-16c8-48da-8451-371015212a1c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertCancelReferralContentDraft" id="ec78cacb-3002-45a7-b026-29f87bcb01a7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
  "отмена_направления_во_внешнюю_организацию": {
   		"language":"ru",
          "territory":"RU",
           "_link": [
      {
        "|meaning": "Assignment Consultations",
        "|type": "Assignment",
        "|target": "${#TestCase#assignmentId}"
      }
      ],
    "context":[{
                "_health_care_facility":[{
                  "|id":"1117746711180",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
               "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "Наименование должности 68"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы"
                ],
                "родительский_ид": [
                  {
                    "|id": "",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ]
              }
            ],
             "адрес_медицинской_организации":[{
                        "субъект_рф":["Субъект РФ 88"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                        "поселение":["Поселение 76"],
                        "населенный_пункт":["Населенный пункт 40"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                        "улица":["Улица 6"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 60"],
                              "номер_строения":["Номер строения 92"],
                              "номер_корпуса":["Номер корпуса 93"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 28"],
                        "дополнительная_информация":["Дополнительная информация 49"]
                     }],
                  "информация_о_месте_cобытия":[{
                        "событие_произошло":[{"|code":"at0071"}],
                        "субъект_рф":["Субъект РФ 51"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                        "поселение":["Поселение 34"],
                        "населенный_пункт":["Населенный пункт 48"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                        "улица":["Улица 26"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 68"],
                              "номер_строения":["Номер строения 30"],
                              "номер_корпуса":["Номер корпуса 66"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 27"],
                        "номер_помещения":["Номер помещения 99"],
                        "дополнительная_информация":["Дополнительная информация 24"]
                     }
                  ],
                  "дополнительная_информация":[{
                        "профиль_медицинской_помощи":[{"|code":"at0087"}],
                        "виды_медицинской_помощи":[{"|code":"at0050"}],
                        "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                        "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                     }]
               }]
        }],       
    "сведения_о_выполнении": [
      {
        "направление": [
         {
 
              "_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
              "ism_transition":[
                 {
                    "current_state":[
                       {
                          "|code":"528"
                       }
                    ],
                    "careflow_step":[
                       {
                          "|code":"at0009"
                       }
                    ]
                 }
              ],                     
            "идентификатор_услуги": [
              "Идентификатор услуги 93"
            ],
            "тип_услуги": [
              "Тип услуги 78"
            ],
            "причина": [
              "Причина 3"
            ],
            "описание": [
              "Описание 38"
            ],
            "срок_действия": [
              "P1DT9H29M"
            ],
            "ид_запроса_у_инциатора": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              7
            ],
            "общее_число_услуг": [
              2
            ],
            "time": [
              "2019-12-02T15:12:36.192+03:00"
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b5f3a7fe-260c-4ae9-ae56-9ccd94a09bcc"/><con:assertion type="SOAP Fault Assertion" id="cce44908-9403-4e01-a904-ec8449feddae"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentReferralDraft 1" id="a507626e-7bee-4567-80e6-f5a00a35b05d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentReferralDraft 1" id="0e631535-13b1-43b8-8b89-85486b70f74c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentCancelReferral#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentCancelReferral#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentCancelReferral#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                  	 <code>16952</code>
                     <description>Отмена направления на госпит-ию, обсл-ие, конс-ию</description>           
                     <cct:cctParameters>
 				    <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</entry>
                        <entry key="openEhrCommonFormVersion">1.0.17</entry>
                        <entry key="Name">Отмена направления на госпит-ию, обсл-ие, конс-ию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</entry>
                        <entry key="ShortName">Направление</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertCancelReferralContentDraft#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
            <doc:signature technicalSignature="false"/>
         </doc:document>
      </typ:saveDocument>

   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="0b9be6ae-862d-49d4-881d-864063bdb7cf"/><con:assertion type="SOAP Fault Assertion" id="2c786690-6fd1-489b-bede-7ad451bac09d"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral1" id="8aeda540-ebab-4e34-b315-6283cbce7cf2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral1" id="1d0dc012-6475-4e5b-9b49-53ce65404202"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:getDocument>
         <doc:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</doc:documentId>
      </typ:getDocument>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8d3971ca-6269-4147-b989-27378a0216a4"/><con:assertion type="SOAP Fault Assertion" id="fd4dd7c2-b188-4b69-9289-a1eb4e4f05b2"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelReferralData" id="b7da8faf-99f8-4715-a257-38eb86559674"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertCancelReferralData" id="745b2c12-ace7-420d-9b49-6b9b29eab7c9"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertBase64TddToJson>
         <typ:base64CompositionTdd>${getDocumentReferral1#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="6fb29f80-b06e-4d74-b65f-b77a9c22f547"/><con:assertion type="SOAP Fault Assertion" id="fed00cdd-3e13-4f8d-8202-fe4c9557837a"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertCancelReferralContentSigned" id="fed6adb3-d2e1-4c51-ab64-a93251ae0ee7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertCancelReferralContentSigned" id="a71f1055-ea86-4ae9-821f-e893f0cb43d1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</typ:templateId>
         <typ:structuredJson>{
   "ctx": {
       "language": "ru",
       "territory":"RU"
    },
  "отмена_направления_во_внешнюю_организацию": {
   		"language":"ru",
          "territory":"RU",
            "_link": [
      {
        "|meaning": "Assignment Consultations",
        "|type": "Assignment",
        "|target": "${#TestCase#assignmentId}"
      }
      ],
    "context":[{
                "_health_care_facility":[{
                  "|id":"1117746711180",
                  "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                  "|id_namespace":"Справочник медицинских организаций",
                  "|id_scheme":"undefined"
               }],
               "_participation":[{
                 	 "|function":"Врач",
                  	 "|id":"012",
                  	 "|name":"ФИО врача"
               }],
        "подробности_контекста": [
          {
            "ид_события": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:careEventId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_документа": [
              {
                "|id": "${CreateDocumentCancelReferral#Response#//*:documentId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_пациента": [
              {
                "|id": "${#TestSuite#patientId}",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "автор_информации": [
              {
                "идентификатор_исполнения_должности_медработника": [
                  {
                    "|id": "${#TestSuite#contractId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "наименование_должности": [
                  "ВРАЧ"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 28"
                ],
                "наименование_филиала": [
                  "Наименование филиала 38"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 26"
                ]
              }
            ],
            "структура_медицинской_организации": [
              {
                "ид_объекта": [
                  {
                    "|id": "${#TestSuite#lpuId}",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ],
                "тип_объекта": [
                  {
                    "|code": "at0019"
                  }
                ],
                "наименование": [
                  "ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы"
                ],
                "родительский_ид": [
                  {
                    "|id": "",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ]
              }
            ],
             "адрес_медицинской_организации":[{
                        "субъект_рф":["Субъект РФ 88"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                        "поселение":["Поселение 76"],
                        "населенный_пункт":["Населенный пункт 40"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                        "улица":["Улица 6"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 60"],
                              "номер_строения":["Номер строения 92"],
                              "номер_корпуса":["Номер корпуса 93"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 28"],
                        "дополнительная_информация":["Дополнительная информация 49"]
                     }],
                  "информация_о_месте_cобытия":[{
                        "событие_произошло":[{"|code":"at0071"}],
                        "субъект_рф":["Субъект РФ 51"],
                        "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                        "поселение":["Поселение 34"],
                        "населенный_пункт":["Населенный пункт 48"],
                        "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                        "улица":["Улица 26"],
                        "номер_здания_сооружения":[{
                              "номер_дома":["Номер дома 68"],
                              "номер_строения":["Номер строения 30"],
                              "номер_корпуса":["Номер корпуса 66"]
                           }],
                        "номер_земельного_участка":["Номер земельного участка 27"],
                        "номер_помещения":["Номер помещения 99"],
                        "дополнительная_информация":["Дополнительная информация 24"]
                     }
                  ],
                  "дополнительная_информация":[{
                        "профиль_медицинской_помощи":[{"|code":"at0087"}],
                        "виды_медицинской_помощи":[{"|code":"at0050"}],
                        "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                        "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                     }]
               }]
        }],       
    "сведения_о_выполнении": [
      {
        "направление": [
         {
 
              "_instruction_details":[
                 {
                    "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#referralId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о направлении']/items[openEHR-EHR-INSTRUCTION.request-referral.v1 and uid/value='${#TestCase#referralId}','Направление']"
                 }
              ],
              "ism_transition":[
                 {
                    "current_state":[
                       {
                          "|code":"528"
                       }
                    ],
                    "careflow_step":[
                       {
                          "|code":"at0009"
                       }
                    ]
                 }
              ],                     
            "идентификатор_услуги": [
              "Идентификатор услуги 93"
            ],
            "тип_услуги": [
              "Тип услуги 78"
            ],
            "причина": [
              "Причина 3"
            ],
            "описание": [
              "Описание 38"
            ],
            "срок_действия": [
              "P1DT9H29M"
            ],
            "ид_запроса_у_инциатора": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "ид_запроса_у_исполнителя": [
              {
                "|id": "",
                "|issuer": "Issuer",
                "|assigner": "Assigner",
                "|type": "Prescription"
              }
            ],
            "порядковый_номер_услуги": [
              7
            ],
            "общее_число_услуг": [
              2
            ],
            "time": [
              "2019-12-02T15:12:36.192+03:00"
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5a420009-28d8-41fe-b06c-0e56a91b9375"/><con:assertion type="SOAP Fault Assertion" id="ce3f0990-ee48-4a48-95d9-4c1669e2aaa9"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentCancelReferralSigned" id="7b5bcc07-1c2e-4de1-acd1-e28386081d30"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentCancelReferralSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:saveDocument>
         <doc:document>
            <metadata status="DRAFT" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">
           	   <core:patientId>${CreateDocumentCancelReferral#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentCancelReferral#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentCancelReferral#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                  	 <code>16952</code>
                     <description>Отмена направления на госпит-ию, обсл-ие, конс-ию</description>           
                     <cct:cctParameters>
 				    <entry key="openEhrCommonFormName">openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</entry>
                        <entry key="openEhrCommonFormVersion">1.0.17</entry>
                        <entry key="Name">Отмена направления на госпит-ию, обсл-ие, конс-ию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</entry>
                        <entry key="ShortName">Направление</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <description>openEHR-EHR-COMPOSITION.t_external_referral_cancellation.v1</description>
                     </tag>
                  </tags>
               </doc:documentInfo>
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>
               <confidentialityTags/>
               <links/>
            </metadata>
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertCancelReferralContentSigned#Response#//*:base64CompositionTdd}</doc:data>
            </doc:content>
  			<doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
               <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
            </doc:signature>
         </doc:document>
      </typ:saveDocument>

   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentReferral1 1" id="338164c8-cf9e-46d8-a579-f0f0da632025"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentReferral1 1" id="1d0dc012-6475-4e5b-9b49-53ce65404202"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:getDocument>
         <doc:documentId>${CreateDocumentCancelReferral#Response#//*:documentId}</doc:documentId>
      </typ:getDocument>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="8d3971ca-6269-4147-b989-27378a0216a4"/><con:assertion type="SOAP Fault Assertion" id="fd4dd7c2-b188-4b69-9289-a1eb4e4f05b2"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getReferral 2" id="9a3fb91f-4b15-49be-b3b8-cbb27690291b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>ReferralServicePortTypeBinding</con:interface><con:operation>getReferral</con:operation><con:request name="getReferral 2" id="dfe9f06b-ba84-40c2-a102-d950b143d8f2"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#ReferralWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ref="http://emias.mos.ru/consultations/v1/referral/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ref:GetReferralRequest>\r
         <ref:referralId>${#TestCase#referralId}</ref:referralId>\r
      </ref:GetReferralRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="1cf352d8-dae5-4459-812f-d63aa93fc9b9"/><con:assertion type="SOAP Fault Assertion" id="6716b68a-92e2-496b-92ea-bd5a3c6225e9"/><con:assertion type="Simple Contains" id="1397a692-87fd-4893-84ec-d45599388aef" name="Contains referralStatus Cancelled"><con:configuration><token>&lt;ns2:referralStatus>Cancelled&lt;/ns2:referralStatus></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment1c3ff08a-1649-4904-a172-92fa0f3eeb21</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>0b623053-05a2-418e-a4d6-50f487bf7d3f::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2021-02-12T15:46:41</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2021-02-19T15:46:41</con:value></con:property><con:property><con:name>referralId</con:name><con:value>ConsultationReferral28c0ba61-79f0-4a79-82d6-c90e19894734</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:properties><con:property><con:name>patientId</con:name><con:value>30000000174002</con:value></con:property><con:property><con:name>contractId</con:name><con:value>9555702008</con:value></con:property><con:property><con:name>lpuId</con:name><con:value>204</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</con:value></con:property><con:property><con:name>availableResourceId</con:name><con:value>15903189</con:value></con:property><con:property><con:name>careEventId</con:name><con:value>${=(int)(Math.random()*(100000))}</con:value></con:property><con:property><con:name>login</con:name><con:value>OSHkuratova</con:value></con:property><con:property><con:name>receiv_lpuId</con:name><con:value>10000454</con:value></con:property><con:property><con:name>systemName</con:name><con:value>INSTRUMENTAL</con:value></con:property><con:property><con:name>userRoleId</con:name><con:value>4</con:value></con:property></con:properties><con:reportParameters/></con:testSuite><con:testSuite id="9e75ae4f-eb8c-4510-b7c6-68c6daf31931" name="Tasks"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:runType>SEQUENTIAL</con:runType><con:testCase id="a8dccb25-7ecc-4aaf-a1d6-d37de3bacca0" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Create Task" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="3d614c67-5fb5-4b8c-b5af-33c53ef6aa52"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="a139e871-80c7-4f4e-9bdf-4aa1b62b8ce5"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="86bd21b7-949c-4442-8ce7-6b6bde93055c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="e8f2dba7-55fd-4020-aa39-618bbb03ac51"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="063547aa-3d58-4fab-a16a-67c28d324271"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="946f830f-7e3a-4825-8035-e56542eb1810"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="060d7d15-f998-4ec5-953d-ec65c2be08d8"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="1d3c03f5-4b1c-412c-b9b0-d24d0e7d79d5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="1d5bf9ea-5aee-43b5-b6bb-f136c935903b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="634ced86-b6d7-45b1-92af-6c1693cfaccd"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="246d20ae-c604-43ca-a48d-193f6d405f6b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getTask" id="3866af7d-f259-4e0d-86a5-ace92a59efae"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getTask</con:operation><con:request name="getTask" id="e92690d5-71f5-4f5f-94c6-028e51fbc2b1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="76140f3b-8b7f-406d-975a-fe4c04ed4527"/><con:assertion type="SOAP Fault Assertion" id="b5980b00-0004-40a0-a227-48b85d980e59"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment08b02103-1717-4d51-8d79-dffe56d6a17d</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T11:37:26</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T11:37:26</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="e5e2d782-986f-4b64-9c98-9ccde793fd30" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Get tasks by patient ID" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="4804cf4d-4da3-449c-b87a-89fce748bd0e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="e6ce8a09-c5b5-40b9-92c3-11556c4760f4"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="07cc94d3-4926-4c4a-a0db-144eaff1e06d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="8fa69e5b-0d16-425c-8eb7-70982b34cad1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="55e14e2c-950d-470a-8af8-71074ebeda47"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="a3a23945-59e3-4fe3-94e5-7f2cf8c27860"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="8dd26e30-9e3b-4aaf-81e8-54e33c6ff014"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="eaaba04e-137a-461c-ba0a-8fcbe4db3082"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="184a5f37-9007-4781-83f0-ba4e8478da80"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="05d164d2-22b9-45d9-9b65-471de1c5edf5"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="54f7f1ff-1775-4568-8171-40151b69f3fc"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getTask" id="cea8f647-b61a-439a-8b66-5e39f6dad244"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getTask</con:operation><con:request name="getTask" id="e92690d5-71f5-4f5f-94c6-028e51fbc2b1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTaskRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
      </task:GetTaskRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="76140f3b-8b7f-406d-975a-fe4c04ed4527"/><con:assertion type="SOAP Fault Assertion" id="b5980b00-0004-40a0-a227-48b85d980e59"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getPatientTasks" id="8b1d505a-f177-4a40-8a76-b38c90da3a28"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getPatientTasks</con:operation><con:request name="getPatientTasks" id="49eeb4a0-12af-4e7b-9885-f9fe5fa4df19"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetPatientTasksRequest>\r
         <task:patientId>${#TestSuite#patientId}</task:patientId>\r
      </task:GetPatientTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="db9de52f-1ddb-4f65-9593-bb95f31a167e"/><con:assertion type="SOAP Fault Assertion" id="467ba540-f047-4590-ac6d-ad6fe63ddd2e"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment08b02103-1717-4d51-8d79-dffe56d6a17d</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T11:37:26</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T11:37:26</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="62b364d4-f802-45bb-9787-a8328a1a1d25" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Create Appointment (task status Assigned)" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="5d5ae29e-a741-4f61-86ea-2a32d4068cc3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
  <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="b4a62bc9-e139-4ae2-9aa1-02da65a2673f"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="178ab764-3e2a-462f-b797-1a93248308a9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="e01c85d1-9516-403b-9c21-399aefd9d7e0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="8a0fc968-4886-4234-bbe0-4dbaa4150b8b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="7479e3b8-974a-4550-a9f2-f86200ad5060"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="b2975510-1919-4498-b9ac-9a5004ca3e03"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="e57c1c76-0037-4dae-9cec-62e09470809f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="d9b211a5-745f-4219-ba1e-f977799412a6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="bd2f13e8-5a4b-4991-a8aa-e46d701d5d67"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="b801aac6-669d-4173-b51a-60d8d1c2e862"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="assignAppointment" id="226e540b-7174-4661-ba7d-bdad9c6e25a4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>assignAppointment</con:operation><con:request name="assignAppointment" id="bf25e3f0-0e5a-45ed-abca-1e7bc02178f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:appointmentId>${#TestSuite#test_appointmentId}</task:appointmentId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b9538be6-a8b3-4b69-a40b-f4142a8f4dd5"/><con:assertion type="SOAP Fault Assertion" id="1cc38450-bdd3-4c1e-bc78-b11de4c41561"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment(Assigned)" id="521ca469-bed3-4dc2-b566-f7ee6f4a53c4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment(Assigned)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Assigned&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment0c1c0fe0-ce78-4fd6-aba7-ac9c22efe440</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T13:22:17</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T13:22:17</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="758b1e2d-46a7-4783-944e-a29a21165558" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Cancel Conduct" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="7ceb2e97-2e08-4d71-9ad3-720f4be390d3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="42e4f644-d025-4474-b282-ac200803aec2"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="c8735b91-526c-4124-8b74-ded5881ef970"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="0605bf1d-264b-4f59-8f2c-2ee78922b38a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="13a7231d-9ff5-4c7f-93af-e91eed8d3626"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="e1535728-84bc-4c88-9778-375acfde86a0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="e635baef-1274-4f68-8744-58ef5a82a40a"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="0f8386ae-7d67-4e15-8312-0e226ca51694"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="0e56ef74-1bdb-4435-95b7-9e2a7c892d6d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="15c265e3-e928-476f-a73b-fa966e481995"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="171dcf78-46e9-4cc1-b902-71a394d66ada"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="assignAppointment" id="205fdfe8-dea7-43fe-a7fc-a092303848ed"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>assignAppointment</con:operation><con:request name="assignAppointment" id="bf25e3f0-0e5a-45ed-abca-1e7bc02178f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:appointmentId>${#TestSuite#test_appointmentId}</task:appointmentId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b9538be6-a8b3-4b69-a40b-f4142a8f4dd5"/><con:assertion type="SOAP Fault Assertion" id="1cc38450-bdd3-4c1e-bc78-b11de4c41561"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="startConduct" id="e6c7e30a-81c1-4a73-b163-3b1f55f3e20c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>startConduct</con:operation><con:request name="startConduct" id="a642c736-8114-40f3-94bf-54ced3f8293a"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:careEventId>${#TestSuite#test_careEventId}</task:careEventId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="83f8ad1e-bf95-49cf-a5b9-767c188cb63f"/><con:assertion type="SOAP Fault Assertion" id="e262c205-b503-4a9a-8cf9-371bb73c0877"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="cancelConduct" id="714fa348-9d84-4ed9-b6c3-0f0bcb783edb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>cancelConduct</con:operation><con:request name="cancelConduct" id="a969d013-e3a8-4415-bdbc-cbfb806d48c2"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:CancelConductRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
         <task:nullCareEvent>true</task:nullCareEvent>\r
      </task:CancelConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d2c8f566-97cd-47eb-ae69-b89f083e8e73"/><con:assertion type="SOAP Fault Assertion" id="b32e2038-d5b0-4b59-8de0-d03baa37f2ca"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment(Assigned)" id="bac5af1a-1e25-47e4-a983-026baa90e4ef"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment(Assigned)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Assigned&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment0c1c0fe0-ce78-4fd6-aba7-ac9c22efe440</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T13:22:17</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T13:22:17</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="214aeaf7-ae4d-44ed-a6e0-6506132f3672" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Cancel Appointment (task status Created)" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="7b0aeb8d-5182-4f8f-9849-b86cdf43346c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
  <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="5394d72e-ee74-4361-9001-f2cdbeeeb634"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="e8a48f14-f954-4088-8c06-b969849611a6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="e166c7cf-b431-4a0e-b8c6-cc821a7d14ef"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="509bce67-6f8c-4990-814c-31d8a78fc3dd"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="3a8c1b1b-c858-475b-a8ed-f416bea397be"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="c9a2f39e-46f0-4f17-8413-4fac90b6f420"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="8b747f81-c93d-40bb-8a4d-4d13e64d8de2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="bd603c3f-0e5d-4d19-b1fc-574c9e566fd3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="9220629d-365c-4965-994e-0ff441adef60"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="e9f07195-7f97-4635-bad0-ac3718ac7b7f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="assignAppointment" id="f371d6a7-0808-49d5-afb0-bd3ed6e857b3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>assignAppointment</con:operation><con:request name="assignAppointment" id="bf25e3f0-0e5a-45ed-abca-1e7bc02178f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:appointmentId>${#TestSuite#test_appointmentId}</task:appointmentId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b9538be6-a8b3-4b69-a40b-f4142a8f4dd5"/><con:assertion type="SOAP Fault Assertion" id="1cc38450-bdd3-4c1e-bc78-b11de4c41561"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="cancelAppointment" id="15acb72a-5ea1-4303-b5e6-c7cc2582c2e0"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>cancelAppointment</con:operation><con:request name="cancelAppointment" id="239d8508-bd60-4d2f-958e-968a96450116"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:CancelAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
      </task:CancelAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="c4f84c11-4b7d-4c49-ab26-3cc1d26e60af"/><con:assertion type="SOAP Fault Assertion" id="1729b648-aa23-4ee1-be85-fb031d38109d"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment(Assigned)" id="921a8792-3771-40bb-b614-a0fba58b7bcc"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment(Assigned)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentad205899-787e-4461-8441-86805b15b1df</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T13:36:42</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T13:36:42</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="9daccd10-ba1b-4b3d-82b9-9caff60997b7" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Assigned Task list by AR" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="139d6604-7f33-418d-8562-90c191a84ca4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
  <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="4bb9ce74-2dc1-477e-8636-7cf4198dd0d3"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="33c2fae5-c183-422b-856d-68cacfbe4ee1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="f2be33a3-1632-441b-8777-e7144b542f0e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="b3126942-4ca5-4997-8191-6f3e68f4eb58"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="a610eb73-258f-4a8b-bac7-d2516fdd6ab4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="0a402c13-0afa-4f6d-a982-ee3caaf69ae9"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="8ba28a82-838f-4933-aa04-451da549e1e7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="26e3aa6f-c2d0-4288-9d06-8cd53d1afa20"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="6b38ae71-4bae-4f3c-b421-ab781e3fcf14"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="f1986776-aedd-408d-aebb-c9b8add200bd"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="assignAppointment" id="84fef266-e4ee-45a4-a225-13bb2ef1d085"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>assignAppointment</con:operation><con:request name="assignAppointment" id="bf25e3f0-0e5a-45ed-abca-1e7bc02178f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:appointmentId>${#TestSuite#test_appointmentId}</task:appointmentId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b9538be6-a8b3-4b69-a40b-f4142a8f4dd5"/><con:assertion type="SOAP Fault Assertion" id="1cc38450-bdd3-4c1e-bc78-b11de4c41561"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment(Assigned)" id="5ec5aedd-b5f4-4810-8bf1-161dd67a23aa"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment(Assigned)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Assigned&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAvailableResourceTasks" id="90bbd9ee-6112-47c9-b148-3e0d2130811e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getAvailableResourceTasks</con:operation><con:request name="GetAvailableResourceTasks" id="496885ad-c876-42c3-a67a-203c9fcfff9d"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:GetAvailableResourceTasksRequest>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:GetAvailableResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="a47667a7-460e-4e04-8e91-f57e60ffa806"/><con:assertion type="SOAP Fault Assertion" id="13a0c22a-c460-4e49-9dca-c660a845ef75"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment0c1c0fe0-ce78-4fd6-aba7-ac9c22efe440</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T13:22:17</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T13:22:17</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="51f29615-89e0-405d-9943-34565662c7c3" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Assigned Task list by AppointmentID" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="3e66f245-f673-4c98-9c07-e91d8c99a873"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
  <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="e05b5387-088d-474a-b872-03cac4e4d1b3"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="6cf6d8c3-c396-4ae3-b4e8-c066cf389718"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="1227510d-bd9b-4d30-87cb-c06d0ca3e8b4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="7d6235a4-a05b-48e3-816b-b526417b3b6a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="eb66c8c6-f927-4db3-8ef5-e8945e32e4c9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="bd6836c7-b29d-4934-91c8-b27dd8d1c89b"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="1de06603-237e-4fc7-bb45-f203d8cadd02"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="2897f7a2-a77a-496a-96af-364a58be9fc6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="1d9ab655-bafe-4d81-9eff-05a4f80ebddb"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="9d89b127-cb68-48b0-9603-41ed169f7535"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="assignAppointment" id="3cf27ab6-92fa-40b3-9416-294b9f7a1c43"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>assignAppointment</con:operation><con:request name="assignAppointment" id="bf25e3f0-0e5a-45ed-abca-1e7bc02178f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:appointmentId>${#TestSuite#test_appointmentId}</task:appointmentId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b9538be6-a8b3-4b69-a40b-f4142a8f4dd5"/><con:assertion type="SOAP Fault Assertion" id="1cc38450-bdd3-4c1e-bc78-b11de4c41561"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment(Assigned)" id="74090075-25d3-4b42-82cc-e45efb1dc3fa"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment(Assigned)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Assigned&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getPlanResourceTasks" id="901072dc-d685-4e43-8aaf-a8c810d1e363"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getPlanResourceTasks</con:operation><con:request name="getPlanResourceTasks" id="d72797f0-3923-4f4f-b7d2-2f8b8c28c91f"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:GetPlanResourceTasksRequest>\r
         <!--1 or more repetitions:-->\r
         <task:appointmentIds>${#TestSuite#test_appointmentId}</task:appointmentIds>\r
      </task:GetPlanResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e4e2ea80-076d-413a-9d70-5d57929563eb"/><con:assertion type="SOAP Fault Assertion" id="2a15e3b5-7e6d-4cda-bdc0-6548b873f396"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment3f754344-1742-43e2-ac45-d9522c7a6370</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T14:13:37</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T14:13:37</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="1934b3ca-494b-446d-b00e-d5f7f2eaead9" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Cito Tasks by AR" searchProperties="true"><con:settings/><con:testStep type="request" name="CreateDocumentAssignment" id="7cd30690-a789-4440-af2c-1d0108ce4d65"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="befb3b3d-7e8c-46b7-8510-8ec3c086858b"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:cct="http://emias.mos.ru/simi/cct" xmlns:core="http://emias.mos.ru/simi/core">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:createDocument>\r
         <cct:cctCode>46081</cct:cctCode>\r
         <core:patientId>${#TestSuite#patientId}</core:patientId>\r
         <core:careEventId>${=(int)(Math.random()*(100000))}</core:careEventId>\r
         <core:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</core:careEventStarted>\r
      </typ:createDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="e7997f11-4f6f-4823-9223-60316248bc51"/><con:assertion type="SOAP Fault Assertion" id="739e041a-32f8-4bf8-9313-4692095dcba7"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="5e53f520-2e19-4cdb-8106-8c17dafe0cfd"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="ec78cf33-3b5d-489b-b850-1eb8aab21246"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "06bc29cd-baf9-4507-aedb-c01ff37c79bd",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["666"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="6eb2cc2f-4c58-4591-9a04-a2553776b0a3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <description>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <description>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="false"/>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="6b87e357-2fa9-4c39-a7e5-26729a7979bc"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="850c897f-0818-4343-9e59-0d29ba463ae7"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types" xmlns:doc="http://emias.mos.ru/simi/document">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:getDocument>\r
         <doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>\r
      </typ:getDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="f4ce9755-203e-42fb-9d94-035b599a62f8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="afff9014-c6c2-42b3-97c2-3ba47090c40f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="abfac91b-142d-4181-8bfd-ebf0d64bdcfe"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="5a8e9f78-979f-425d-bd1f-ec639eda9fd8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "61", "|value": "Терап1ия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1920"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "18682760910",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "61","|value": "Тера1пия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="2d8f4950-6fea-4ad8-a3d6-34f64442f050"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>SimiServiceV4PortBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="b2f5fedd-7b62-4eaf-a174-57c4ade632b6"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#SimiWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:ns6="http://www.w3.org/2000/09/xmldsig#"
xmlns:typ="http://emias.mos.ru/simi/v4/simiService/types"
xmlns:doc="http://emias.mos.ru/simi/document" xmlns:core="http://emias.mos.ru/simi/core" xmlns:cct="http://emias.mos.ru/simi/cct">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:saveDocument>\r
         <doc:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">
  			<doc:documentId>${CreateDocumentAssignment#Response#//*:documentId}</doc:documentId>
               <doc:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="4">\r
           	   <core:patientId>${CreateDocumentAssignment#Response#//*:patientId}</core:patientId>
                  <core:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</core:careEventId>
                  <core:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</core:careEventStarted>
                  <doc:cctInfo>
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <code>46081</code>
                     <description>Назначение на консультацию</description>
                     <cct:cctParameters>
                        <entry key="Name">Назначение на консультацию</entry>
                        <entry key="openEhrTemplateId">openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</entry>
                        <entry key="ShortName">Назнач. Консул.</entry>
                        <entry key="specificationVersion">2.0.0</entry>
                     </cct:cctParameters>
                     <cct:contentTypeInfo mimeClass="APPLICATION">
                        <mimeType>application/tdd</mimeType>
                     </cct:contentTypeInfo>
                  </doc:cctInfo>
                  <tags>
                        <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <description>Protocol</description>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <description>{"index": 0,"displayMode": "FULL"}</description>
                     </tag>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <description>{"index":0,"visualizable":true,"group":null}</description>
                     </tag>
                  </tags>\r
               </doc:documentInfo>\r
               <cct:visualizations>
               <visualization>
                     <cct:cctCode>0</cct:cctCode>
                     <visualizationInfo description="DEFAULT" name="DEFAULT" signature="true" xsltVersion="XSLT_2_0">
                        <cct:tags/>
                     </visualizationInfo>
                  </visualization>
               </cct:visualizations>\r
               <confidentialityTags/>\r
               <links/>\r
            </metadata>\r
            <doc:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
               <doc:data>${ConvertAssignmentContentSigned#Response#//*:base64CompositionTdd}</doc:data>\r
            </doc:content>\r
            <doc:signature technicalSignature="true" signeeLogin="${#TestSuite#login}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature></doc:signature>\r
         </doc:document>\r
      </typ:saveDocument>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ce57c7e8-b7f9-4746-936b-03401cfca4c9"/><con:assertion type="SOAP Fault Assertion" id="43b01ddf-83e9-43b4-aa7e-212749282cd8"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="f4805b51-aeb0-46ff-91bf-5eab9e2abd83"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="fb581605-7fd8-4a88-9480-8f7646c3165d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Assigned&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getCitoResourceTasks" id="70501185-a5c9-4dbb-8b31-12809d82ac75"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getCitoResourceTasks</con:operation><con:request name="getCitoResourceTasks" id="e50b53ab-ee5c-4894-b8d4-e6dc8c5febb8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>18682760910</task:availableResourceId>\r
         <task:date>${#TestSuite#test_date}</task:date>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2a8d5bb2-8fed-4e18-bbb8-155bacd78f6c"/><con:assertion type="SOAP Fault Assertion" id="34569e7e-4d92-4d0b-bd93-0179837ac733"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment0fcbbf97-2e82-48f4-bf62-1d7d2ded67d1</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>4ed87ac5-0e52-47f0-916e-65ab6e632193::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T16:54:19</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T16:54:19</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="4becdda9-6bad-4da8-b164-cceee04c1cad" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Cito Tasks by AR1" searchProperties="true" disabled="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="f0a7ecca-58a2-471c-98ff-ff147c36dce7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
  <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="6cbaa091-305f-47b4-bab0-febb3c83925d"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="9bd97ba6-3066-4a17-8493-3dcad2178ea1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "срочность": [{"|code": "1","|value": "Сегодня" }],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "19997673565",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="8b9f92f6-6257-49cb-8eaa-e769923efad6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="d8cfc978-4e07-4e98-9bc1-fcccf7982d72"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="c4479be7-0670-4b52-a281-d80e21e85136"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="bfcd459f-118f-462d-9416-8b8671caa0b6"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="7df435c0-4026-4ba0-86d1-1990d9b6221b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
        "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                "наименование_должности": [
                  "Наименование должности 36"
                ],
                "наименование_структурного_подразделения": [
                  "Наименование структурного подразделения 9"
                ],
                "наименование_филиала": [
                  "Наименование филиала 59"
                ],
                "наименование_юридического_лица": [
                  "Наименование юридического лица 34"
                ]
              }
            ],
              "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
            "адрес_медицинской_организации": [
              {
                "субъект_рф": [
                  "Субъект РФ 55"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 75"
                ],
                "поселение": [
                  "Поселение 3"
                ],
                "населенный_пункт": [
                  "Населенный пункт 71"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 35"
                ],
                "улица": [
                  "Улица 49"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 8"
                    ],
                    "номер_строения": [
                      "Номер строения 86"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 10"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 5"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 8"
                ]
              }
            ],
            "информация_о_месте_cобытия": [
              {
                "событие_произошло": [
                  {
                    "|code": "at0071"
                  }
                ],
                "субъект_рф": [
                  "Субъект РФ 68"
                ],
                "муниципальный_район_городской_округ": [
                  "Муниципальный район (городской округ) 24"
                ],
                "поселение": [
                  "Поселение 61"
                ],
                "населенный_пункт": [
                  "Населенный пункт 43"
                ],
                "элемент_планировочной_структуры": [
                  "Элемент планировочной структуры 14"
                ],
                "улица": [
                  "Улица 39"
                ],
                "номер_здания_сооружения": [
                  {
                    "номер_дома": [
                      "Номер дома 56"
                    ],
                    "номер_строения": [
                      "Номер строения 5"
                    ],
                    "номер_корпуса": [
                      "Номер корпуса 87"
                    ]
                  }
                ],
                "номер_земельного_участка": [
                  "Номер земельного участка 15"
                ],
                "номер_помещения": [
                  "Номер помещения 42"
                ],
                "дополнительная_информация": [
                  "Дополнительная информация 7"
                ]
              }
            ],
            "дополнительная_информация": [
              {
                "профиль_медицинской_помощи": [
                  {
                    "|code": "at0091"
                  }
                ],
                "виды_медицинской_помощи": [
                  {
                    "|code": "at0053"
                  }
                ],
                "условия_оказания_медицинской_помощи": [
                  {
                    "|code": "at0056"
                  }
                ],
                "форма_оказания_медицинской_помощи": [
                  {
                    "|code": "at0058"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "информация_о_принимающей_стороне": [
      {
        "идентификатор_принимающей_мо": [
          {
            "идентификатор_принимающей_мо": [
              "204"
            ]
          }
        ],
        "идентификатор_принимающего_му": [
          {
            "наименование_принимающего_му": [
              "204"
            ],
            "идентификатор_принимающего_му": [
              "204"
            ]
          }
        ]
      }
    ],
    "идентификатор_специальности": [
      {
        "подробности": [
          {
            "профессиональные_подробности": [
              {
                "идентификатор_специальности": [
                  {
                    "|id": "69",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "сведения_о_назначении": [
      {
          "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
        "назначение": [
          {
            "_uid":  ["${#TestCase#assignmentId}"],
            "запрос": [
              {
                  "специализация": [{"|code": "61", "|value": "Терап1ия"}],
                "обоснование": [
                  "Обоснование 52"
                ],
                "срочность": [
                  {
                    "|code": "1",
                    "|value": "Сегодня"
                  }
                ],
                "дата_начала_действия": [
                  "2022-09-29T16:19:16.319649+03:00"
                ],
                "дата_окончания_действия": [
                  "2022-09-29T18:19:16.319687+03:00"
                ]              
              }
            ],
            "ид_вида_приема": [
              "2295"
            ]
			}  ],
        "направление_для_cito-пациента": [
          {
            "доступный_ресурс": [
              {
                "идентификатор_ресурса": [
                  {
                    "|id": "19997673565",
                    "|issuer": "Issuer",
                    "|assigner": "Assigner",
                    "|type": "Prescription"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
     "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
            "специализация": [{"|code": "76","|value": "Терапия"}],
            "обоснование": [
              "Обоснование 19"
            ],
            "time": [
              "2022-09-29T16:19:16.319902+03:00"
            ]
          }
        ]
      }
    ]
  }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="b357106d-34d5-4b45-b151-493b2b65a0e1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentSigned#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="5669b059-59d5-49a0-95fc-04216ec74610"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="0a9f2b49-4242-463e-be57-e401746ca4d7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getCitoResourceTasks" id="61663617-4a1c-4a12-a55c-530a873000f5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getCitoResourceTasks</con:operation><con:request name="getCitoResourceTasks" id="e50b53ab-ee5c-4894-b8d4-e6dc8c5febb8"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:GetCitoResourceTasksRequest>\r
         <task:availableResourceId>19997673565</task:availableResourceId>\r
         <task:date>${#TestSuite#test_date}</task:date>\r
      </task:GetCitoResourceTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="2a8d5bb2-8fed-4e18-bbb8-155bacd78f6c"/><con:assertion type="SOAP Fault Assertion" id="34569e7e-4d92-4d0b-bd93-0179837ac733"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment6013f37c-9f52-4f52-8014-442f72bf4f74</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T17:58:55</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T17:58:55</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="8a5d90c0-d578-4cd3-a78b-4e14a0c4e828" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Start Conduct (task status Progress)" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="b3219d62-8ad0-46f8-91fe-c95a8ea5cd7f"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
  <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="672b7def-a273-4a65-ae75-a093c92f9518"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="fd8ecdfc-feb2-4a17-9ea7-9374c19907d9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="e6bb0c24-f3c3-4b8b-ba56-69a81c139e22"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="fe5ef02d-730c-4a6c-814d-051399de0a17"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="febfdcc5-f014-4509-8994-cc1d6e1f7d7a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${SaveDocumentAssignmentDraft#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="c6fac17d-ba57-4396-b5dc-2cbedf5b2a93"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="40b27f44-1848-412b-8fd8-3ea548c701c1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="75cca301-f0b2-4dbd-aeb2-0980c0d8684b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="a2cb98eb-5a2a-4060-8f86-202bc939b8a6"><con:settings/><con:config><delay>7000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="186d400a-096a-4376-af9c-086aa15ff9b8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="assignAppointment" id="c7847f3d-e11f-41e1-a122-fc7581f7d2f3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>assignAppointment</con:operation><con:request name="assignAppointment" id="bf25e3f0-0e5a-45ed-abca-1e7bc02178f1"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:AssignAppointmentRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:appointmentId>${#TestSuite#test_appointmentId}</task:appointmentId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:AssignAppointmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b9538be6-a8b3-4b69-a40b-f4142a8f4dd5"/><con:assertion type="SOAP Fault Assertion" id="1cc38450-bdd3-4c1e-bc78-b11de4c41561"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment(Assigned)" id="973f5b0c-367c-4d9a-9952-525d15e0a12c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment(Assigned)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Assigned&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="startConduct" id="4d787648-6467-4638-a773-0ff867ec85f4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>startConduct</con:operation><con:request name="startConduct" id="a642c736-8114-40f3-94bf-54ced3f8293a"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:careEventId>${#TestSuite#test_careEventId}</task:careEventId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="83f8ad1e-bf95-49cf-a5b9-767c188cb63f"/><con:assertion type="SOAP Fault Assertion" id="e262c205-b503-4a9a-8cf9-371bb73c0877"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="GetAssignment (Progress)" id="0a4a258f-87af-4be5-ae96-6401f218a6f1"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment (Progress)" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Progress"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Progress&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">false&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">false&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment12e435e2-9360-49e7-a2f7-f206903bdc4c</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>$selfComposition</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T15:27:47</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T15:27:47</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="dda264d7-78c5-45df-89e0-f6e6a1e25e3a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Task status Completed" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="166187bb-f796-4c50-87f9-bec1ad91d326"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="b861edf3-2e45-4611-8af6-90ee38e21197"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="c8d466c6-9114-4e6c-81bb-fb5c873a1c0b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="971c0b0c-fd22-49e9-a8b4-990a4b72dc5b"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="40444121-a76f-4bad-8adf-28b4dc9c4a24"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="1943072d-0fd8-4ec4-855c-e8e7ff2c45c6"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="483bbbee-a202-495b-9a64-35ba579ba3a8"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="aac2a9b6-aeb8-4415-b8df-95b15db6e971"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="ee6bad85-4067-4a8e-8d9a-1b9f64877cc3"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="be154164-f8bc-4bfd-85b2-33ded64614e2"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="c742ab9f-f93c-43db-ba55-da0afe5891d9"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="startConduct" id="463ae1f1-e212-4537-a7f5-d8ae87cb268e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>startConduct</con:operation><con:request name="startConduct" id="a642c736-8114-40f3-94bf-54ced3f8293a"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-B39FB683EA274D07F71467989313179205">
            <wsse:Username>HAdiatullina</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext 
xmlns="http://emias.mos.ru/consultations/v1/common/types/">
         <employeeJobId>204</employeeJobId>
         <fullName>ФИО</fullName>
         <position>Должность</position>
      </typ:ConsultationsUserContext>
   </soap:Header>
   <soap:Body>\r
      <task:StartConductRequest>\r
         <task:taskId>${GetAssignment#Response#//*:tasks/*:id}</task:taskId>\r
         <task:careEventId>${#TestSuite#test_careEventId}</task:careEventId>\r
         <task:availableResourceId>${#TestSuite#test_availiableRecourceId}</task:availableResourceId>\r
      </task:StartConductRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="83f8ad1e-bf95-49cf-a5b9-767c188cb63f"/><con:assertion type="SOAP Fault Assertion" id="e262c205-b503-4a9a-8cf9-371bb73c0877"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="CreateDocumentTherapist" id="451e355d-5cbe-4c2b-b85a-ece30bf57cd5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentTherapist" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>14951</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertTherapist" id="86b7f92b-210c-4a7f-b5a7-96b5ea42d6db"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertTherapist" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>
      <typ:convertJsonToBase64Tdd>
         <typ:templateId>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</typ:templateId>
         <typ:structuredJson>{
    "осмотр_терапевта": {
		"language":[{"|code":"ru"}],
			"territory":[{"|code":"RU"}],
			"context":[{
				"_health_care_facility":[{
					"|id":"1117746711180",
					"|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
					"|id_namespace":"Справочник медицинских организаций",
					"|id_scheme":"undefined"
				}],
				"_participation":[{
					"|function":"Дежурный врач",
					"|id":"012",
					"|name":"Тестовый Петр Сергеевич"
				}],
				"подробности_контекста":[{
					"ид_события":[{
						"|id":"${CreateDocumentTherapist#Response#//*:careEventId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"ид_документа":[{
						"|id":"${CreateDocumentTherapist#Response#//*:documentId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"ид_пациента":[{
						"|id":"${#TestSuite#patientId}",
						"|issuer":"Issuer",
						"|assigner":"Assigner",
						"|type":"Prescription"
					}],
					"автор_информации":[{
						"идентификатор_исполнения_должности_медработника":[{
							"|id":"${#TestSuite#contractId}",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}],
						"наименование_должности":["Наименование должности 68"],
						"наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
						"наименование_филиала":["Наименование филиала 38"],
						"наименование_юридического_лица":["Наименование юридического лица 26"]
					}],
					"структура_медицинской_организации":[{
						"ид_объекта":[{
							"|id":"${#TestSuite#lpuId}",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}],
						"тип_объекта":[{"|code":"at0019"}],
						"наименование":["Наименование 94"],
						"родительский_ид":[{
							"|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
							"|issuer":"Issuer",
							"|assigner":"Assigner",
							"|type":"Prescription"
						}]
					}],
					"адрес_медицинской_организации":[{
						"субъект_рф":["Субъект РФ 88"],
						"муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
						"поселение":["Поселение 76"],
						"населенный_пункт":["Населенный пункт 40"],
						"элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
						"улица":["Улица 6"],
						"номер_здания_сооружения":[{
							"номер_дома":["Номер дома 60"],
							"номер_строения":["Номер строения 92"],
							"номер_корпуса":["Номер корпуса 93"]
						}],
						"номер_земельного_участка":["Номер земельного участка 28"],
						"дополнительная_информация":["Дополнительная информация 49"]
					}],
					"информация_о_месте_cобытия":[{
						"событие_произошло":[{"|code":"at0071"}],
						"субъект_рф":["Субъект РФ 51"],
						"муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
						"поселение":["Поселение 34"],
						"населенный_пункт":["Населенный пункт 48"],
						"элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
						"улица":["Улица 26"],
						"номер_здания_сооружения":[{
							"номер_дома":["Номер дома 68"],
							"номер_строения":["Номер строения 30"],
							"номер_корпуса":["Номер корпуса 66"]
						}],
						"номер_земельного_участка":["Номер земельного участка 27"],
						"номер_помещения":["Номер помещения 99"],
						"дополнительная_информация":["Дополнительная информация 24"]
					}],
					"дополнительная_информация":[{
						"профиль_медицинской_помощи":[{"|code":"at0087"}],
						"виды_медицинской_помощи":[{"|code":"at0050"}],
						"условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
						"форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
					}]
				}]	
			}],  
			"category": [{
				"|code": "433",
				"|value": "event",
				"|terminology": "openehr"
			}],
			"composer": [{
				"|name": "Кучерова Зоя Викторовна",
				"|id": "02237485436",
				"|id_namespace": "Парус",
				"|id_scheme": "undefined"
			}],
			"жалобы_и_анамнез_заболевания": [{
				"жалобы_и_анамнез_заболевания": [{
					"жалобы": [{
						"на_момент_осмотра_жалобы": [{
							"|code": "at0002",
							"|value": "не предъявляет"
						}],
						"жалобы_пациента": [{
							"жалоба": []
						}]
					}],
					"подробности_истории_болезни": [{
						"считает_себя_больным_с": [],
						"болеет_в_течение": []
					}],
					"анамнез_заболевания": []
				}]
			}],
			"интерпретация_результатов_обследования": [{
				"исследование": [{
					"сведения_об_исследовании": [{
						"сведения_об_исследовании": [{
							"название_исследования": [],
							"дата_обследования": [],
							"результат": [],
							"комментарий": []
						}]
					}],
					"интерпретация_результатов": [{"интерпретация_результатов": []}]
				}]
			}],
			"общий_осмотр": [{
				"общее_состояние": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"подробности": [{
							"общее_состояние": [],
							"уровень_сознания": [],
							"нервно-психический_статус": []
						}]
					}]
				}],
				"рост": [{"рост": [{"|unit": "cm", "|magnitude": null}]}],
				"вес": [{"вес": [{"|unit": "kg", "|magnitude": null}]}],
				"имт": [{"индекс_массы_тела": [{"|unit": "kg/m2", "|magnitude": null}]}],
				"сердечно-сосудистая_система": [{
					"артериальное_давление": [{
						"систолическое": [{"|unit": "mm[Hg]", "|magnitude": null}],
						"диастолическое": [{"|unit": "mm[Hg]", "|magnitude": null}]
					}],
					"чсс": [{"чсс": [{"|unit": "/min", "|magnitude": null}]}],
					"пульс": [{
						"пульс": [{"|unit": "/min","|magnitude": null}],
						"ритм": []
					}],
					"сердце": [{
						"описание": [],
						"осмотр": [{
							"патологий_не_выявлено": [null],
							"клиническое_описание": [],
							"пальпация_сердца": [{"верхушечный_толчок": []}],
							"аускультация_сердца": [{
								"тоны_сердца": [],
								"ритм": [],
								"описание_ритма": [],
								"сердечные_тоны": [{
									"a1-й_тон": [{"a1-й_тон": []}],
									"a2-й_тон": [{"a2-й_тон": []}],
									"локализация": [],
									"комментарий": []
								}],
								"шум": [{"шум": [], "описание_шумов": []}]
							}],
							"комментарий": []
						}]
					}]
				}],
				"температура_тела": [{
					"температура": [{"|unit": "Cel", "|magnitude": null}],
					"комментарий": []
				}],
				"чдд": [{"чдд": [{"|unit": "/min", "|magnitude": null}]}],
				"окружность_талии": [{"окружность_талии": [{"|unit": "cm", "|magnitude": null}]}],
				"функциональный_статус": [{
					"описание": [],
					"осмотр": [{
						"подробности": [{
							"патологий_не_выявлено": [null],
							"ходьба": [],
							"нарушение_походки": []
						}],
						"положение": [],
						"поза_ромберга": [{"поза_ромберга": [{"поза_ромберга": []}]}],
						"конституциональный_тип": []
					}]
				}],
				"кожные_покровы": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"подробности": [{
							"цвет_кожи": [],
							"тип_высыпаний": [],
							"локализация": [],
							"влажность": [],
							"цианоз": [{  
								"наличие": [],
								"характер_распространения": [],
								"локализация": [],
								"описание": []
							}]
						}],
						"клинические_особенности": [{
							"особенность": [],
							"описание": []
						}],
						"комментарий": []
					}]
				}],
				"склеры": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"цвет": []
					}]
				}],
				"лимфатические_узлы": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"подробности": [{
							"локализация_лимфатических_узлов": [],
							"другая_локализация": [],
							"размеры": [{
								"размеры": [],
								"описание_размеров": [],
								"увеличение": [{"увеличение_на": [{"|unit": "cm", "|magnitude": null}]}]
							}],
							"пальпация": [{
								"консистенция": [{"консистенция": []}],
								"болезненность": [{"болезненность_при_пальпации": []}],
								"комментарий": []
							}]
						}]
					}]
				}],
				"молочные_железы": [{
					"описание": [],
					"молочная_железа_справа": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"отделяемое_из_сосков": [{"отделяемое_из_сосков": []}],
						"при_пальпации": [{
							"консистенция": [{
								"консистенция": [],
								"локализация_уплотнений": []
							}]
						}],
						"комментарий": []
					}],
					"молочная_железа_слева": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"отделяемое_из_сосков": [{"отделяемое_из_сосков": [] }],
						"при_пальпации": [{
							"консистенция": [{
								"консистенция": [],
								"локализация_уплотнений": []
							}]
						}],
						"комментарий": []
					}]
				}],
				"отеки": [{
					"описание": [],
					"отеки": [{
						"наличие_отеков": [],
						"локализация": [],
						"степень_выраженности": [],
						"комментарий": []
					}]
				}],
				"опорно-двигательная_система": [{
					"суставы": [{
						"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"локализация": [{
								"локализация": [],
								"специфическая_локализация": [],
								"описание": []
							}],
							"патологий_не_выявлено": [null],
							"подробности": [{
								"суставы": [{"суставы": []}],
								"движения": [{
									"движения": [{ "движения": [{"движения": []}]}],
									"болезненность_при_движении": [{"болезненность_при_движении": []}]
								}],
								"болезненность_в_покое": [{"болезненность_в_покое": [] }]
							}],
							"клиническое_описание": [],
							"комментарий": []
						}]
					}],
					"позвоночник": [{
						"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"патологий_не_выявлено": [null],
							"клиническое_описание": [],
							"пальпация": [{
								"болезненность_при_пальпации": [{
									"болезненность_при_пальпации": [],
									"локализация_на_теле": []
								}]
							}],
							"симптомы_натяжения": [],
							"комментарий": []
						}]
					}]
				}],
				"полость_рта": [{
					"зев_и_миндалины": [{
						"описание": [],
						"осмотр": [{
							"патологий_не_выявлено": [null],
							"обследование_ротовой_полости": [{
								"зев": [{
									"зев": [],
									"цвет": [],
									"описание_зева": []
								}]
							}],
							"миндалины": [{
								"миндалины": [],
								"рыхлость": [],
								"размеры": [],
								"налёт": [{
									"налёт": [],
									"описание_налёта": []
								}]
							}],
							"комментарий": []
						}]
					}],
				"язык": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"налет": [],
						"влажность": []
					}]
				}]
			}],
				"органы_дыхания": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"носовое_дыхание": [],
						"выделение_из_носа": [{
							"выделение_из_носа": [],
							"количество": [],
							"характер": []
						}],
						"комментарий": []
					}]
				}],
				"грудная_клетка": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"грудная_клетка": [{
							"форма": [],
							"описание_формы": [],
							"участие_в_дыхании": [],
							"отставание_в_дыхании": [],
							"пальпация": []
						}],
						"аускультация_легких": [{
							"характер_дыхания": [],
							"крепитация": [],
							"локализация": [],
							"шум_трения_плевры": [],
							"комментарий": [],
							"хрипы": [{
								"наличие_хрипов": [],
								"влажность": [],
								"выслушиваются": [],
								"локализации": [],
								"характеристика_сухих_хрипов": [],
								"характеристика_влажных_хрипов": []
							}]
						}],
						"комментарий": []
					}]
				}],
				"живот": [{
					"описание": [],
					"осмотр": [{
						"патологий_не_выявлено": [null],
						"клиническое_описание": [],
						"подробности": [{
							"подробности": [{
								"участие_в_акте_дыхания": []
							}],
							"пальпация": [{
								"состояние": [{"состояние": []}],
								"болезненность_при_пальпации": [{
									"болезненность_при_пальпации": [],
									"локализация_болезненности": []
								}]
							}],
							"симптомы_раздражения_брюшины": [],
							"комментарий": []
						}]
					}]
				}],
				"печень": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [null],
						"пальпация": [{
							"поверхность": [{
								"границы": [],
								"увеличение": [{
									"увеличение_на": [{
										"|unit": "cm",
										"|magnitude": null
									}]
								}],
								"поверхность": []
							}],
							"консистенция": [{"консистенция": []}],
							"болезненность": [{"болезненность_при_пальпации": []}]
						}],
						"комментарий": []
					}]
				}],
				"селезенка": [{
					"описание": [],
					"осмотр": [{
						"исследуемая_структура_или_система": [],
						"патологий_не_выявлено": [ null],
						"клиническое_описание": [],
						"пальпация": [{ "орган": []}],
						"комментарий": []
					}]
				}],
				"мочевыделительная_система": [{
					"мочеиспускание": [{
						"мочеиспускание": [],
						"болезненность_при_мочеиспускании": [{ "болезненность_при_мочеиспускании": []}]
					}],
				"почки": [{
					"описание": [],
						"осмотр": [{
							"исследуемая_структура_или_система": [],
							"патологий_области_почек_не_выявлено": [null],
							"клиническое_описание": [],
							"подробности": [{
								"симптом_поколачивания": [],
								"комментарий": []
							}]
						}]
					}]
				}],
				"стул": [{
					"клиническое_описание": [],
					"стул": [{
						"частота_испражнений": [{
						"за_период": [],
						"количество_раз_в_среднем": [],
						"количество_раз_интервал": [{"lower": [],"upper": []}]
					}],
						"патологические_примеси": [{
						"название_примеси": [],
						"наличие": [],
						"описание_примеси": []
					}]
					}],
					"цвет": []
				}],
				"комментарий": [{
					"описание": [],
					"комментарий": []
				}]
			}],
			"диагноз": [{
				"основной_диагноз": [{
					"основной_диагноз": [{
						"код_по_мкб_10": [{
							"|code": "A00.0",
							"|value": "A00.0 - Холера, вызванная холерным вибрионом 01, биовар cholerae"
						}],
						"развернутый_клинический_диагноз": [],
						"динамика_состояния": [{
							"динамика_заболевания": []
						}],
						"вид_диагноза": [{
							"диагностический_статус": [],
							"вид_диагноза": [{
								"|code": "at0064",
								"|value": "основной диагноз"
							}]
						}]
					}]
				}],
				"диагноз": [{
					"диагноз": [{
						"вид_диагноза": [{
							"вид_диагноза": [],
							"диагностический_статус": []
						}],
						"код_по_мкб_10": [],
						"развернутый_клинический_диагноз": []
					}]
				}]
			}],
			"рекомендации": [{
				"режим": [{"режим": [{"режим": []}]}],
				"рекомендации_по_питанию": [{"рекомендации_по_питанию": [{"рекомендации_по_питанию": []}]}],
				"прочие_рекомендации": [{"прочие_рекомендации": []}],
				"рекомендации_по_последующему_приему": [{
				"рекомендации_по_последующему_приему": [{
					"предположительная_дата_явки": [],
					"подробности_явки": []
				}]
			}]
			}],
			"сведения_о_выполнении_назначения": [{
				"выполнение": [{
					"_instruction_details": [{
						"|composition_uid":"${#TestCase#composition_uid}",
						"|instruction_uid": "${#TestCase#assignmentId}",
						"|activity_id": "activities[at0001]",
						"|path": "/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
					}],
					"ism_transition": [{
						"current_state": [{"|code": "532"}],
						"careflow_step": [{ "|code": "at0005"}]
					}],
					"специализация": [{"|code": "76","|value": "Терапия"}],
            			"обоснование": ["Обоснование 86"],
            			"причина_отмены": [{"|code": "2", "|value": "Получены новые данные о состоянии пациента" }]
          }]
      }]
  }
}</typ:structuredJson>
      </typ:convertJsonToBase64Tdd>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentTherapistDraft" id="0f54b801-fadf-4601-93b0-cd9098ac5afd"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentTherapistDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentTherapist#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentTherapist#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentTherapist#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentTherapist#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>14951</code>
                     <!--Optional:-->
                     <value>Осмотр терапевта</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Осмотр терапевта</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Осм. терапевта</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="protocolMedicalSpecialization">
                           <value>Врач-терапевт</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                    <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>documentPurpose</code>
                        <value>Протокол осмотра</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>733F6AD7-762A-45D5-A85F-B571224E6421</v52:visualizationId>
                     <v52:cctCode>14951</v52:cctCode>
                    <visualizationInfo name="Для печати" description="Осмотр терапевта" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertTherapist#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
<!--                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#Username}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">-->
<!--               <xd:Signature>-->
<!--                  <xd:SignedInfo>-->
<!--                     <xd:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>-->
<!--                     <xd:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>-->
<!--                     <xd:Reference URI="">-->
<!--                        <xd:Transforms>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>-->
<!--                           <xd:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">-->
<!--                              <xd:XPath>ancestor-or-self::content</xd:XPath>-->
<!--                           </xd:Transform>-->
<!--                        </xd:Transforms>-->
<!--                        <xd:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>-->
<!--                        <xd:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</xd:DigestValue>-->
<!--                     </xd:Reference>-->
<!--                  </xd:SignedInfo>-->
<!--                  <xd:SignatureValue>dGVzdA==</xd:SignatureValue>-->
<!--                  <xd:KeyInfo>-->
<!--                     <xd:X509Data>-->
<!--                        <xd:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</xd:X509Certificate>-->
<!--                     </xd:X509Data>-->
<!--                  </xd:KeyInfo>-->
<!--               </xd:Signature>-->
<!--            </v5:signature>-->
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentTherapistSigned" id="d6839e06-3ea4-47ef-819e-d1dbc8b40fa8"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentTherapistSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentTherapist#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentTherapist#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentTherapist#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentTherapist#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>14951</code>
                     <!--Optional:-->
                     <value>Осмотр терапевта</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Осмотр терапевта</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Осм. терапевта</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="protocolMedicalSpecialization">
                           <value>Врач-терапевт</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                    <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>openEhrTemplateId</code>
                        <value>openEHR-EHR-COMPOSITION.t_therapist_examination.v3</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.emias.simi.terminology.cct</schema>
                        <code>documentPurpose</code>
                        <value>Протокол осмотра</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>733F6AD7-762A-45D5-A85F-B571224E6421</v52:visualizationId>
                     <v52:cctCode>14951</v52:cctCode>
                    <visualizationInfo name="Для печати" description="Осмотр терапевта" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertTherapist#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
  <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay 1" id="1f261d6b-0efe-4232-9876-fd24c3d6efc3"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetFinishedAssignment" id="62d11f31-68d5-4f64-b03f-7c8c4f48491c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetFinishedAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">\r
   <soap:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR/${#TestSuite#login}</wsse:Username>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <ass:GetAssignmentRequest>\r
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>\r
      </ass:GetAssignmentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="1c923e0f-4538-4843-801d-1c9214793369" name="Статус AssignmentFinished"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns3:assignmentStatus  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentFinished&lt;/ns3:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0a0ede91-274c-4c61-8c18-ec2b7b759bc9" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns3:documentId  xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns3:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="7fb844d1-0e70-467a-ac76-3a6812089cfb" name="Направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">${GetAssignment#Response#//ns3:options/ns2:entry/text()}&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6a7e6809-f7da-4c20-930b-5905d3a8264b" name="allowChange"><con:configuration><path>//*:allowChange</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6a7e6809-f7da-4c20-930b-5905d3a8264b" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>false</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="Simple Contains" id="3733def7-5fba-4ed6-a20d-cea131ad72aa" name="TaskConductCompleted"><con:configuration><token><![CDATA[<ns3:tasks>
                  <ns3:id>${GetAssignment#Response#//ns3:tasks/ns3:id/text()}</ns3:id>
                  <ns3:type>Conduct</ns3:type>
                  <ns3:status>Completed</ns3:status>
                  <ns3:documentId>${CreateDocumentTherapist#Response#//*:documentId}</ns3:documentId>
               </ns3:tasks>]]></token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignment310ce4e6-101b-424c-9ee4-465b849520de</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>11d9c564-3229-4bbf-950a-6be6f0db0d42::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-29T15:30:11</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-06T15:30:11</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="2625068c-785f-4f38-9c2a-55054f61c509" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Task list by AssignmentId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="949b0bc1-b54c-4770-aee9-0ef667388366"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>INSTRUMENTAL/RBeda</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>INSTRUMENTAL</user:systemName>
         <user:userName>RBeda</user:userName>
         <user:userRoleId>4</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="caac5109-c9a0-4599-b9bf-2e361772692e"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="bd9d4042-0400-431b-8706-a893536547cb"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="a2b38200-89b7-4a26-ab9c-33c1ac298c86"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="6d8353f4-259e-4bca-b59e-5ae2782cac7a"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="08eab639-1f3f-46e0-b6cd-431645d426d5"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="35fce945-29b0-40f0-a928-4f81e7b58bf1"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="9f8af337-94e9-4d83-8034-3ee1df0dc48c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="03184736-413d-42c2-9d45-fa0cbd84d4df"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="5aaee749-5cdb-4edc-bfc9-68eaf32fcccd"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="c526c0fb-6fb4-448b-a87d-f435c7e57930"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getTasksByAssignmentId" id="6c6db6e1-863c-45a8-b2e6-099ecc26f1f4"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getAssignmentTasks</con:operation><con:request name="getTasksByAssignmentId" id="7f5eef54-0dc2-4049-a9c9-ba12a6e65b31"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetAssignmentTasksRequest>\r
         <task:assignmentId>${#TestCase#assignmentId}</task:assignmentId>\r
      </task:GetAssignmentTasksRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="78b35b5b-ba23-495b-a7d6-8324603ca748"/><con:assertion type="SOAP Fault Assertion" id="57c61b51-acea-42cd-ad6a-ae4dc1cf35a3"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentf7d248bc-29e5-4496-90e0-898203a19230</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>bee99a0b-bef9-470a-ba81-336b823b034b::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T15:53:55</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T15:53:55</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:testCase id="daf5aee9-6fc5-4d7b-a448-2c621b8ea620" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="Task list by CareEventId" searchProperties="true"><con:settings/><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="request" name="CreateDocumentAssignment" id="9cb7940f-ab46-4673-82f1-caa1b9c80ea7"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>createDocument</con:operation><con:request name="CreateDocumentAssignment" id="01c2d400-146e-4a40-8553-a87a6e402f7c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/cct/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
     <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>
      <typ:createDocumentRequest>
         <v5:cctCode>46081</v5:cctCode>
         <v51:patientId>${#TestSuite#patientId}</v51:patientId>
         <v51:careEventId>${=(int)(Math.random()*(100000))}</v51:careEventId>
         <v51:careEventStarted>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</v51:careEventStarted>
            </typ:createDocumentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="ef4020fc-9ddf-4afa-9bb2-27e4f26ee19d"/><con:assertion type="SOAP Fault Assertion" id="7f285a73-eb54-4397-9e86-eb8fae0c4552" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="SetAssignmentId" id="a9193e17-09d0-4c72-847a-276dc8cb9e4b"><con:settings/><con:config><script> UUID uuid = UUID.randomUUID()
 
 def assignmentId = "ConsultationAssignment" + uuid
 def assignmentStartDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())
 def c = Calendar.getInstance(); 
        c.setTime(new java.util.Date()); 
        c.add(Calendar.DATE, 7);
 def assignmentEndDate = new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(c.getTime());
 
 testRunner.testCase.setPropertyValue("assignmentId",assignmentId)
 testRunner.testCase.setPropertyValue("assignmentStartDate",assignmentStartDate)
 testRunner.testCase.setPropertyValue("assignmentEndDate",assignmentEndDate)
 
 log.info (assignmentId)
 log.info (assignmentStartDate)
 log.info (assignmentEndDate)</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentDraft" id="eb7a7e64-33e7-4683-ad67-b6fda805084e"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentDraft" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Адиатуллина Хамдия Салиховна",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"1117746711180",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Дежурный врач",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["1"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "2"]
          }]
        }],
        "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "76", "|value": "Терапия"}],
                    "обоснование": ["Обоснование 69"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
                    "|composition_uid":"$selfComposition",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "76","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentDraft" id="a4391c5b-644a-42a8-8f73-edd39654f70c"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentDraft" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="CREATED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="0b369e87-52a4-4127-b9f0-d3c9a7c35631" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getDocumentAssignment" id="bff766e8-63ac-4e78-a9a1-3df0fcdbc1fc"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>getDocument</con:operation><con:request name="getDocumentAssignment" id="9d75eb6f-79ae-4b2a-93f0-bbde698e845c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/">\r
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:getDocumentRequest>\r
         <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
      </typ:getDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="d1c151d2-aa51-4caf-8331-af573a7fed4b"/><con:assertion type="SOAP Fault Assertion" id="b7c96982-e4ed-4771-911e-c6a26e5decfb" name="Not SOAP Fault"/><con:assertion type="Simple Contains" id="8efed455-a631-4045-a887-5c445678fdd2" name="Contains"><con:configuration><token>Назначение на консультацию</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentData" id="6bba51b5-c7f6-4f1b-8109-f0c5e43f4b49"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertBase64TddToJson</con:operation><con:request name="ConvertAssignmentData" id="336cda0f-196b-4fc5-901e-454ba7d70804"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
  <soapenv:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
      <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
        <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>
        <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>
      </wsse:UsernameToken>
    </wsse:Security>
  </soapenv:Header>
   <soapenv:Body>\r
      <typ:convertBase64TddToJson>\r
         <typ:base64CompositionTdd>${getDocumentAssignment#Response#//*:data}</typ:base64CompositionTdd>\r
      </typ:convertBase64TddToJson>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="5de38f49-4d53-4761-822c-3a3293e21f70"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="groovy" name="getCompositionUid" id="297a0a63-f852-4553-a0d9-7b307d13ea52"><con:settings/><con:config><script> import groovy.json.JsonSlurper
 
 def data = context.expand('${ConvertAssignmentData#Response#//*:structuredJson}')
 log.info (data)
 
def slurper = new JsonSlurper()
def result = slurper.parseText(data)
def composition_uid = result.назначение_на_консультацию.сведения_о_выполнении.выполнение[0]._instruction_details[0]."|composition_uid"[0]
log.info(composition_uid)

testRunner.testCase.setPropertyValue("composition_uid",composition_uid)


</script></con:config></con:testStep><con:testStep type="request" name="ConvertAssignmentContentSigned" id="b42c972c-0d12-48f1-90fb-dcc261515c63"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>OpenEhrServiceV4PortBinding</con:interface><con:operation>convertJsonToBase64Tdd</con:operation><con:request name="ConvertAssignmentContentSigned" id="3c759f02-5806-41f2-9517-ee700cf1fa27"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#OpenEhrWSDL}</con:endpoint><con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:typ="http://emias.mos.ru/simi/v4/openEhrService/types">\r
   <soapenv:Header>\r
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">\r
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">\r
            <wsse:Username>KPI_DOCTOR_X/${#TestSuite#login}</wsse:Username>\r
            <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">KPI_DOCTOR/ESilenkova</wsse:Password>\r
         </wsse:UsernameToken>\r
      </wsse:Security>\r
   </soapenv:Header>\r
   <soapenv:Body>\r
      <typ:convertJsonToBase64Tdd>\r
         <typ:templateId>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</typ:templateId>\r
         <typ:structuredJson>{
    "назначение_на_консультацию": {
        "language":[{"|code":"ru"}],
		"territory":[{"|code":"RU"}],
		"composer":[{
            "|id":"11111",
            "|name":"Кирсанова Галина",
            "|id_namespace":"Парус",
            "|id_scheme":"undefined"
        }],
		"context":[{
            "_health_care_facility":[{
                "|id":"206",
                "|name":"ГБУЗ г. Москвы ГП №107 Департамента здравоохранения г. Москвы",
                "|id_namespace":"Справочник медицинских организаций",
                "|id_scheme":"undefined"
            }],
            "_participation":[{
                "|function":"Врач-нефролог",
                "|id":"012",
                "|name":"Тестовый Петр Сергеевич"
            }],
            "подробности_контекста":[{
                "ид_события":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:careEventId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_документа":[{
                    "|id":"${CreateDocumentAssignment#Response#//*:documentId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "ид_пациента":[{
                    "|id":"${#TestSuite#patientId}",
                    "|issuer":"Issuer",
                    "|assigner":"Assigner",
                    "|type":"Prescription"
                }],
                "автор_информации":[{
                    "идентификатор_исполнения_должности_медработника":[{
                        "|id":"${#TestSuite#contractId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "наименование_должности":["Наименование должности 68"],
                    "наименование_структурного_подразделения":["Наименование структурного подразделения 28"],
                    "наименование_филиала":["Наименование филиала 38"],
                    "наименование_юридического_лица":["Наименование юридического лица 26"]
                }],
                "структура_медицинской_организации":[{
                    "ид_объекта":[{
                        "|id":"${#TestSuite#lpuId}",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }],
                    "тип_объекта":[{"|code":"at0019"}],
                    "наименование":["Наименование 94"],
                    "родительский_ид":[{
                        "|id":"790c7a26-a200-4379-b75a-605c9f30f1fe",
                        "|issuer":"Issuer",
                        "|assigner":"Assigner",
                        "|type":"Prescription"
                    }]
                }],
                "адрес_медицинской_организации":[{
                    "субъект_рф":["Субъект РФ 88"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 66"],
                    "поселение":["Поселение 76"],
                    "населенный_пункт":["Населенный пункт 40"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 38"],
                    "улица":["Улица 6"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 60"],
                        "номер_строения":["Номер строения 92"],
                        "номер_корпуса":["Номер корпуса 93"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 28"],
                    "дополнительная_информация":["Дополнительная информация 49"]
                }],
                "информация_о_месте_cобытия":[{
                    "событие_произошло":[{"|code":"at0071"}],
                    "субъект_рф":["Субъект РФ 51"],
                    "муниципальный_район_городской_округ":["Муниципальный район (городской округ) 29"],
                    "поселение":["Поселение 34"],
                    "населенный_пункт":["Населенный пункт 48"],
                    "элемент_планировочной_структуры":["Элемент планировочной структуры 96"],
                    "улица":["Улица 26"],
                    "номер_здания_сооружения":[{
                        "номер_дома":["Номер дома 68"],
                        "номер_строения":["Номер строения 30"],
                        "номер_корпуса":["Номер корпуса 66"]
                    }],
                    "номер_земельного_участка":["Номер земельного участка 27"],
                    "номер_помещения":["Номер помещения 99"],
                    "дополнительная_информация":["Дополнительная информация 24"]
                }],
                "дополнительная_информация":[{
                    "профиль_медицинской_помощи":[{"|code":"at0087"}],
                    "виды_медицинской_помощи":[{"|code":"at0050"}],
                    "условия_оказания_медицинской_помощи":[{"|code":"at0055"}],
                    "форма_оказания_медицинской_помощи":[{"|code":"at0060"}]
                }]
            }]
        }],
        "информация_о_принимающей_стороне": [ {
        "идентификатор_принимающей_мо": [{ "идентификатор_принимающей_мо": ["${#TestSuite#lpuId}"] }],
        "идентификатор_принимающего_му": [{
            "наименование_принимающего_му": ["Наименование принимающего МУ"],
            "идентификатор_принимающего_му": [ "${#TestSuite#lpuId}"]
          }]
        }],
       "идентификатор_специальности": [{
            "подробности": [ {
                "профессиональные_подробности": [ {
                   "идентификатор_специальности": [  {
	                    "|id": "602",
                    	"|issuer": "Issuer",
                    	"|assigner": "Assigner",
                    	"|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_назначении": [{
            "диагноз": [{
                "код_по_мкб": [{"|code": "A04.2", "|value": "A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"}],
                "развернутый_клинический_диагноз": ["A04.2 - Энтерогеморрагическая инфекция, вызванная Escherichia coli"]
            }],
            "назначение": [{
                "_uid": ["${#TestCase#assignmentId}"],
                "запрос": [{
                    "специализация": [{"|code": "79", "|value": "Терапия"}],
                    "обоснование": ["обоснование"],
                    "дата_начала_действия": ["${#TestCase#assignmentStartDate}"],
                    "дата_окончания_действия": ["${#TestCase#assignmentEndDate}"]
                }],
		        "ид_вида_приема": ["1888"]                
            }],
            "направление_для_cito-пациента": [{
                "доступный_ресурс": [{
                    "идентификатор_ресурса": [{
                        "|id": "",
                        "|issuer": "Issuer",
                        "|assigner": "Assigner",
                        "|type": "Prescription"
                    }]
                }]
            }]
        }],
        "сведения_о_выполнении": [{
            "выполнение": [{
                "_instruction_details":[{
           	     "|composition_uid":"${#TestCase#composition_uid}",
                    "|instruction_uid":"${#TestCase#assignmentId}",
                    "|activity_id":"activities[at0001]",
                    "|path":"/content[openEHR-EHR-SECTION.adhoc.v1,'Сведения о назначении']/items[openEHR-EHR-INSTRUCTION.service_request_consultation-simi.v1 and uid/value='${#TestCase#assignmentId}','Назначение']"
                }],
                "ism_transition":[{
                    "current_state":[{"|code":"526"}],
                    "careflow_step":[{"|code":"at0002"}]
                }],
                "специализация": [{"|code": "79","|value": "Терапия"}],
                "обоснование": ["Обоснование 42"]
            }]
        }]
    }
}</typ:structuredJson>\r
      </typ:convertJsonToBase64Tdd>\r
   </soapenv:Body>\r
</soapenv:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3606c38f-01e2-40a5-a3d6-2d08188f4033"/><con:assertion type="SOAP Fault Assertion" id="d455933c-3857-4ef8-8281-699c6f1322c4"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="SaveDocumentAssignmentSigned" id="1197218a-6a65-4241-91d3-bb25a78c06a2"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>simiServiceBinding</con:interface><con:operation>saveDocument</con:operation><con:request name="SaveDocumentAssignmentSigned" id="25920ebf-35e1-4c14-a36a-abbf3ec03c9c"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#Simi5WSDL}</con:endpoint><con:request><![CDATA[ <soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:v52="http://emias.mos.ru/simi/cct/v5/" xmlns:user="http://emias.mos.ru/system/v1/userContext/" xmlns:typ="http://emias.mos.ru/simi/simiService/v5/types/" xmlns:v5="http://emias.mos.ru/simi/document/v5/" xmlns:v51="http://emias.mos.ru/simi/core/v5/" xmlns:ns6="http://www.w3.org/2000/09/xmldsig#">
   <soap:Header>
    <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-2" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
             <wsse:Username>${#TestSuite#systemName}/${#TestSuite#login}</wsse:Username>             
         </wsse:UsernameToken>
      </wsse:Security>
      <user:userContext>
         <user:systemName>${#TestSuite#systemName}</user:systemName>
         <user:userName>${#TestSuite#login}</user:userName>
         <user:userRoleId>${#TestSuite#userRoleId}</user:userRoleId>
                <user:userRights>
            <!--Zero or more repetitions:-->
            <user:userRightId>400001</user:userRightId>
         </user:userRights>
         <user:jobExecutionId>${#TestSuite#contractId}</user:jobExecutionId>
             </user:userContext>
   </soap:Header>
   <soap:Body>\r
      <typ:saveDocumentRequest>\r
         <v5:document>\r
            <metadata status="SIGNED" authorLogin="${#TestSuite#login}">\r
               <v5:documentId>${CreateDocumentAssignment#Response#//*:documentId}</v5:documentId>\r
               <v5:documentInfo documentCreated="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}" simiVersion="5">\r
                  <v51:patientId>${CreateDocumentAssignment#Response#//*:patientId}</v51:patientId>\r
                  <v51:careEventId>${CreateDocumentAssignment#Response#//*:careEventId}</v51:careEventId>\r
                  <v51:careEventStarted>${CreateDocumentAssignment#Response#//*:careEventStarted}</v51:careEventStarted>\r
                 <v5:cctInfo role="Name">
                     <!--Optional:-->
                     <schema>ru.emias.simi.terminology.cct</schema>
                     <!--Optional:-->
                     <code>46081</code>
                     <!--Optional:-->
                     <value>Назначение на консультацию</value>
                     <v52:cctParameters>
                        <!--Zero or more repetitions:-->
                                  <tag role="Name">
                           <value>Назначение на консультацию</value>
                        </tag>
                        <tag role="openEhrTemplateId">
                           <value>openEHR-EHR-COMPOSITION.t_consultation_order.v1.1</value>
                        </tag>
                        <tag role="ShortName">
                           <value>Назнач. Консул.</value>
                        </tag>
                               <tag role="specificationVersion">
                           <value>2.0.0</value>
                        </tag>
                        <tag role="idEhrForm">
                           <value>3e56c2c7-a05b-414f-8dba-9f51620cc693:79</value>
                        </tag>
                     </v52:cctParameters>
                     <v52:contentTypeInfo mimeClass="APPLICATION">\r
                        <!--1 or more repetitions:-->\r
                        <mimeType>application/tdd</mimeType>\r
                     </v52:contentTypeInfo>\r
                  </v5:cctInfo>\r
                 <tags>
                      <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_mainstay_document</schema>
                        <code>20</code>
                        <value>Protocol</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Clinician protocol</code>
                        <value>{"index": 0,"displayMode": "FULL"}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Clinician protocol</code>
                        <value>{"index":0,"visualizable":true,"group":null}</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydescr</schema>
                        <code>Consultancy assignment</code>
                        <value>{     "index": 0,     "visualizable": false,     "group": {         "name": "Консультации специалистов",         "index": 50,         "visualPattern": "SGL_COL_GROUP",         "group": {             "name": "Лист назначений",             "index": 10,             "visualPattern": "DBL_COL_GROUP",             "group": null         }     } }</value>
                     </tag>
                     <tag definedByCct="true">
                        <schema>ru.mos.emias.system.careevent_documentlist_hierarchydelist</schema>
                        <code>Consultancy assignment</code>
                        <value>{  "name": "Документы",  "index": 10,  "children": {         "name": "Консультации",         "index": 50,         "children": {             "index": 0,             "displayMode": "ONLY_NAME"         }     } }</value>
                     </tag>
                  </tags>
               </v5:documentInfo>\r
                 <v52:visualizations>
                  <!--Zero or more repetitions:-->
                  <visualization>
                     <!--Optional:-->
                     <v52:visualizationId>300C9753-3354-473E-A996-67BDD751D02B</v52:visualizationId>
                     <v52:cctCode>0</v52:cctCode>
                    <visualizationInfo name="DEFAULT" description="DEFAULT" xsltVersion="XSLT_2_0" signature="false">
                       <v52:tags>
                           </v52:tags>
                     </visualizationInfo>
                                      </visualization>
               </v52:visualizations>
               <confidentialityTags/>\r
               <links/>\r
               <associations/>\r
            </metadata>\r
             <v5:content mimeClass="APPLICATION" mimeType="application/tdd" valid="false">
                            <v5:data>${ConvertAssignmentContentDraft#Response#//*:base64CompositionTdd}</v5:data>
                            </v5:content>
                            <v5:signature technicalSignature="true" signeeLogin="${#TestSuite#login}" dateSign="${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}">
                  <ns6:Signature>
                  <ns6:SignedInfo>
                     <ns6:CanonicalizationMethod Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
                     <ns6:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411"/>
                     <ns6:Reference URI="">
                        <ns6:Transforms>
                           <ns6:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
                           <ns6:Transform Algorithm="http://www.w3.org/TR/1999/REC-xpath-19991116">
                              <ns6:XPath>ancestor-or-self::content</ns6:XPath>
                           </ns6:Transform>
                        </ns6:Transforms>
                        <ns6:DigestMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#gostr3411"/>
                        <ns6:DigestValue>bUI1ZlBLTU1oQlNIZ3crRSswTStFNndSQVZhYm5CTllTc1NESTB6V1ZzQT08</ns6:DigestValue>
                     </ns6:Reference>
                  </ns6:SignedInfo>
                  <ns6:SignatureValue>dGVzdA==</ns6:SignatureValue>              
                  <ns6:KeyInfo>
                     <ns6:X509Data>
                        <ns6:X509Certificate>dGVjaG5pY2FsIHNpZ24gc3R1Yg==</ns6:X509Certificate>
                     </ns6:X509Data>
                  </ns6:KeyInfo>
               </ns6:Signature>
               </v5:signature>
         </v5:document>\r
      </typ:saveDocumentRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="cded6455-8433-4c24-92ed-ce69811f5d87"/><con:assertion type="SOAP Fault Assertion" id="4845f887-9362-49bd-9879-0f9611a3dd79" name="Not SOAP Fault"/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="delay" name="Delay" id="36b3d74d-09ee-4096-bcbf-9773380a7da4"><con:settings/><con:config><delay>5000</delay></con:config></con:testStep><con:testStep type="request" name="GetAssignment" id="17120f1a-aaa7-4836-875e-22ee0c6cff25"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>AssignmentServicePortTypeBinding</con:interface><con:operation>getAssignment</con:operation><con:request name="GetAssignment" id="bedc754f-68e2-43f9-a0de-d723105de714"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#AssignmentWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ass="http://emias.mos.ru/consultations/v1/assignment/">
   <soap:Header>
      <wsse:Security xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd">
         <wsse:UsernameToken wsu:Id="UsernameToken-61ba1c58-5698-41c3-8366-5f0de9147f85">
            <wsse:Username>CONSULTATIONS/${#TestSuite#login}</wsse:Username>
         </wsse:UsernameToken>
      </wsse:Security>
      <typ:ConsultationsUserContext/>
   </soap:Header>
   <soap:Body>
      <ass:GetAssignmentRequest>
         <ass:assignmentId>${#TestCase#assignmentId}</ass:assignmentId>
      </ass:GetAssignmentRequest>
   </soap:Body>
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="b8231934-c136-4a76-9948-29a4fffae17d"/><con:assertion type="SOAP Fault Assertion" id="99d78b1c-1f50-45a3-a0f3-7a91b5fad5e7"/><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="Статус AssignmentCreated"><con:configuration><path>//*:assignmentStatus</path><content>&lt;ns2:assignmentStatus  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >AssignmentCreated&lt;/ns2:assignmentStatus></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>true</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="9518184a-b03c-48df-aaaf-ded8b625be5d" name="Документ СИМИ"><con:configuration><path>//*:documentId</path><content>&lt;ns2:documentId  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/" >${CreateDocumentAssignment#Response#//*:documentId}&lt;/ns2:documentId></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Conduct"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return   &lt;ns2:type>Conduct&lt;/ns2:type>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:type xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Conduct&lt;/ns2:type>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XQuery Match" id="2f9c0d0d-d560-44eb-ac8a-92ef070df961" name="Task Created"><con:configuration><path>declare namespace ns2='http://emias.mos.ru/consultations/v1/assignment/types/';
&lt;Responce>
{
for $x in //*:tasks
return  &lt;ns2:status>{data($x/ns2:status/text())}&lt;/ns2:status>
}
&lt;/Responce></path><content>&lt;Responce>
  &lt;ns2:status xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">Created&lt;/ns2:status>
&lt;/Responce></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="3d56541a-a939-422e-89a5-0e3a95e9a3b3" name="Есть направление СУПП"><con:configuration><path>//*:options</path><content>&lt;ns3:options xmlns="http://emias.mos.ru/consultations/v1/assignment/" xmlns:ns2="http://emias.mos.ru/consultations/v1/common/types/" xmlns:ns3="http://emias.mos.ru/consultations/v1/assignment/types/" xmlns:ns4="http://emias.mos.ru/system/v1/userContext/" xmlns:ns5="http://emias.mos.ru/system/v1/faults/" xmlns:ns6="http://emias.mos.ru/consultations/v1/task/types/" xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  &lt;ns2:entry key="suppReferralId">*&lt;/ns2:entry>
&lt;/ns3:options></content><allowWildcards>true</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowChange"><con:configuration><path>//*:allowChange</path><content>&lt;ns2:allowChange  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowChange>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="6b76f186-9a51-4b22-92cb-c7f85eafadf8" name="allowCancel"><con:configuration><path>//*:allowCancel</path><content>&lt;ns2:allowCancel  xmlns:ns2="http://emias.mos.ru/consultations/v1/assignment/types/">true&lt;/ns2:allowCancel>
</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>true</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:testStep type="request" name="getTasksByCareEvents" id="838050b1-1082-48e5-b848-1182f2a1e58d"><con:settings/><con:config xsi:type="con:RequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:interface>TaskServicePortTypeBinding</con:interface><con:operation>getTasksByCareEvents</con:operation><con:request name="getTasksByCareEvents" id="6bba70be-0970-47aa-928e-e4c68e8b6639"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#TaskWSDL}</con:endpoint><con:request><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:typ="http://emias.mos.ru/consultations/v1/common/types/" xmlns:task="http://emias.mos.ru/consultations/v1/task/">\r
   <soap:Header>\r
      <typ:ConsultationsUserContext/>\r
   </soap:Header>\r
   <soap:Body>\r
      <task:GetTasksByCareEventsRequest>\r
         <!--1 or more repetitions:-->\r
         <task:careEventIds>${#TestSuite#test_careEventId}</task:careEventIds>\r
      </task:GetTasksByCareEventsRequest>\r
   </soap:Body>\r
</soap:Envelope>]]></con:request><con:assertion type="SOAP Response" id="3f246fdf-0e22-4d39-9562-a0408d7fcd25"/><con:assertion type="SOAP Fault Assertion" id="1dafa824-36f0-4c34-9454-c9ea5f11877f"/><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:wsaConfig mustUnderstand="NONE" version="200508"/><con:wsrmConfig version="1.2"/></con:request></con:config></con:testStep><con:properties><con:property><con:name>assignmentId</con:name><con:value>ConsultationAssignmentf7d248bc-29e5-4496-90e0-898203a19230</con:value></con:property><con:property><con:name>id</con:name><con:value>${=(long)(Math.random()*10000000000000000000)}</con:value></con:property><con:property><con:name>composition_uid</con:name><con:value>bee99a0b-bef9-470a-ba81-336b823b034b::default::1</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>2022-09-28T15:53:55</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>2022-10-05T15:53:55</con:value></con:property></con:properties><con:reportParameters/></con:testCase><con:properties><con:property><con:name>patientId</con:name><con:value>30000000174002</con:value></con:property><con:property><con:name>login</con:name><con:value>OSHkuratova</con:value></con:property><con:property><con:name>contractId</con:name><con:value>9555702008</con:value></con:property><con:property><con:name>lpuId</con:name><con:value>204</con:value></con:property><con:property><con:name>assignmentStartDate</con:name><con:value>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</con:value></con:property><con:property><con:name>assignmentEndDate</con:name><con:value>${=new java.text.SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(new java.util.Date())}</con:value></con:property><con:property><con:name>careEventId</con:name><con:value>${=(int)(Math.random()*(100000))}</con:value></con:property><con:property><con:name>receiv_lpuId</con:name><con:value>10000369</con:value></con:property><con:property><con:name>task</con:name><con:value>65110</con:value></con:property><con:property><con:name>test_appointmentId</con:name><con:value>123</con:value></con:property><con:property><con:name>test_availiableRecourceId</con:name><con:value>123</con:value></con:property><con:property><con:name>test_date</con:name><con:value>2022-09-29</con:value></con:property><con:property><con:name>test_careEventId</con:name><con:value>123</con:value></con:property><con:property><con:name>systemName</con:name><con:value>INSTRUMENTAL</con:value></con:property><con:property><con:name>userRoleId</con:name><con:value>4</con:value></con:property></con:properties><con:reportParameters/></con:testSuite><con:savedRecentRuns>1</con:savedRecentRuns><con:requirements/><con:properties><con:property><con:name>SimiWSDL</con:name><con:value>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v4S/ProxyService?wsdl</con:value></con:property><con:property><con:name>AssignmentWSDL</con:name><con:value>http://esbcamel.test.emias.mos.ru/proxy/consultations/Assignment/v1S/ProxyService?wsdl</con:value></con:property><con:property><con:name>AppointmentWSDL</con:name><con:value>http://esbcamel.test.emias.mos.ru/proxy/Appointment2/Appointment/v1S/ProxyService</con:value></con:property><con:property><con:name>OpenEhrWSDL</con:name><con:value>http://esbcamel.test.emias.mos.ru/proxy/SIMI/OpenEhrService/v4S/ProxyService</con:value></con:property><con:property><con:name>TaskWSDL</con:name><con:value>http://consultations.test.emias.mos.ru/consultations/application/api/TaskService</con:value></con:property><con:property><con:name>ReferralWSDL</con:name><con:value>http://consultations.test.emias.mos.ru/consultations/application/api/ReferralService</con:value></con:property><con:property><con:name>http://consultations.test.emias.mos.ru/consultations/application/api/AssignmentService</con:name><con:value/></con:property><con:property><con:name>Simi5WSDL</con:name><con:value>http://esbcamel.test.emias.mos.ru/proxy/SIMI/SIMI/v5S/ProxyService</con:value></con:property></con:properties><con:wssContainer/><con:databaseConnectionContainer/><con:jmsConnectionContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:reporting><con:xmlTemplates/><con:parameters/></con:reporting><con:sensitiveInformation/><con:authRepository/><con:tags/></con:soapui-project>