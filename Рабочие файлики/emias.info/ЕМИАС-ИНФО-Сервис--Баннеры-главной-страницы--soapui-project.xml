<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="7edf9b75-e9da-4e64-b29a-acab4cb38933" activeEnvironment="Default" name="ЕМИАС.ИНФО Сервис &quot;Баннеры главной страницы&quot;" resourceRoot="" soapui-version="5.7.2" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="94d05f63-3c21-4c22-b410-b840fc00b4c7" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://application-emiasinfo3.emias.solit-clouds.ru" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://application-emiasinfo3.emias.solit-clouds.ru</con:endpoint></con:endpoints><con:resource name="create" path="/api/v1/banners/create" id="199fd907-f510-4447-91c2-9dd4385cb9ae"><con:settings/><con:parameters/><con:method name="Method 1" id="367467fa-b3f5-41a3-bb31-2f0def161acc" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:cre="http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create">cre:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:chec="http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check">chec:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="update" path="/api/v1/banners/update" id="199fd907-f510-4447-91c2-9dd4385cb9ae"><con:settings/><con:parameters/><con:method name="Method 1" id="367467fa-b3f5-41a3-bb31-2f0def161acc" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json</con:mediaType><con:status>400 500</con:status><con:params/><con:element xmlns:cre="http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create">cre:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="check" path="/api/v1/banners/check" id="4aee2c1c-797d-433e-a1e4-9366d99d8814"><con:settings/><con:parameters/><con:method name="Method 1" id="8298a73e-9ca8-4a81-b98e-2e1de7d039ac" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="ffe77587-0442-4046-afa1-a8f98c3a2178" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://application-emiasinfo3.emias.solit-clouds.ru</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="efada361-4f0a-4403-bd0a-2e5b49e14667" name="POST banners/create"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="0c1107a5-6e3f-4ca2-a1fd-3d90176796bf" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Добавить баннер с title только с обязательными параметрами. Параметры closable, authentication, userUpload=false. 406936" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="1b6e3d56-a030-4ad3-b83d-ad892c2093d2"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Создать баннер" id="bea62b02-e909-4979-bda5-4724be8d45fe"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Создать баннер" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"title": "${#TestCase#bannerTitle}",
		"closable": false,
		"authentication": false,
		"location": "${#TestCase#location}",
		"userUpload": false
	}
} </con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="39b3053a-c0d7-4d1b-a894-59f5c269aed2" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Проверить создание в БД f_banner_campaign" id="34f730a4-e90a-48c0-be6a-5f7e7211185b"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>select * from f_banner_campaign fbc
where fbc.banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить banner_code"><con:configuration><path>//*:F_BANNER_CAMPAIGN.BANNER_CODE</path><content>${#TestCase#bannerCode}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить title"><con:configuration><path>//*:F_BANNER_CAMPAIGN.TITLE</path><content>${#TestCase#bannerTitle}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить body=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.BODY/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить closable"><con:configuration><path>//*:F_BANNER_CAMPAIGN.CLOSABLE</path><content>f</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.INFOSCREEN/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить authentication_check"><con:configuration><path>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</path><content>f</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить start_date=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.START_DATE/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить end_date=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.END_DATE/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить location"><con:configuration><path>//*:F_BANNER_CAMPAIGN.LOCATION</path><content>${#TestCase#location}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить user_upload"><con:configuration><path>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</path><content>f</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить upload_status=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить active"><con:configuration><path>//*:F_BANNER_CAMPAIGN.ACTIVE</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="jdbc" name="Проверить создание в БД f_banner_infoscreen" id="ece6e5c5-8fd3-42a4-8ddf-cf955cade6bc"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>select * from f_banner_campaign fbc
join f_banner_infoscreen fbi on fbc.id = fbi.banner_campaign_id
where fbc.banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="XPath Match" id="f96e0570-b700-4f06-93cb-8c455f668470" name="Найдено 0 записей"><con:configuration><path>count(//*:Row)</path><content>0</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>7drwpay</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>lFMwHPrUGXYogue</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>MSlvUgyfkYFVCcpxdLqzsiRDhTQuEK</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-10T16:05:28</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-10 16:05:28</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-10T16:07:28</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-10 16:07:28</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>TzfnBUISMRbAsYg</con:value></con:property><con:property><con:name>infoText</con:name><con:value>qIBmMNrGUtDbAYyhJeLQSplvPdjXCw</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>FBKJIvikljyZUCphXWDeHTrunRVNPS</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://THAKrzcDWkjxfqJbNnBaUVQyEXSipL.ru</con:value></con:property></con:properties></con:testCase><con:testCase id="2a84b9f0-a613-44b4-99dc-d743c641ee6d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Добавить баннер со всеми необязательными параметрами. Параметры closable, authentication, userUpload=true. 407140" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="cc529b60-58b2-4f17-8b5b-494e62ae02bd"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Создать баннер" id="25d125cf-bb77-47e5-8184-0a7e3db49f63"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Создать баннер" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"title": "${#TestCase#bannerTitle}",
		"body": "${#TestCase#bannerBody}",
		"closable": true,
		"authentication": true,
		"startDate": "${#TestCase#startTime}",
		"endDate": "${#TestCase#endTime}",
		"location": "${#TestCase#location}",
		"userUpload": true,
		"infoscreenObject": {
			"title": "${#TestCase#infoTitle}",
			"text": "${#TestCase#infoText}",
			"button": {
				"text": "${#TestCase#buttonText}",
				"link": "${#TestCase#buttonLink}"
			}
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="39b3053a-c0d7-4d1b-a894-59f5c269aed2" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Проверить создание в БД f_banner_campaign и f_banner_infoscreen" id="aec31e6b-9018-4fe4-ba84-e3cf671bf060"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>select * from f_banner_campaign fbc
join f_banner_infoscreen fbi on fbc.id = fbi.banner_campaign_id
where fbc.banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить banner_code"><con:configuration><path>//*:F_BANNER_CAMPAIGN.BANNER_CODE</path><content>${#TestCase#bannerCode}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить title"><con:configuration><path>//*:F_BANNER_CAMPAIGN.TITLE</path><content>${#TestCase#bannerTitle}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить body"><con:configuration><path>//*:F_BANNER_CAMPAIGN.BODY</path><content>${#TestCase#bannerBody}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить closable"><con:configuration><path>//*:F_BANNER_CAMPAIGN.CLOSABLE</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.INFOSCREEN/text(),"")</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить authentication_check"><con:configuration><path>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить start_date"><con:configuration><path>//*:F_BANNER_CAMPAIGN.START_DATE</path><content>${#TestCase#startTimeDb}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить end_date"><con:configuration><path>//*:F_BANNER_CAMPAIGN.END_DATE</path><content>${#TestCase#endTimeDb}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить location"><con:configuration><path>//*:F_BANNER_CAMPAIGN.LOCATION</path><content>${#TestCase#location}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить user_upload"><con:configuration><path>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить upload_status=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить active"><con:configuration><path>//*:F_BANNER_CAMPAIGN.ACTIVE</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.title"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TITLE</path><content>${#TestCase#infoTitle}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.text"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TEXT</path><content>${#TestCase#infoText}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.button_title"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_TITLE</path><content>${#TestCase#buttonText}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.button_link"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_LINK</path><content>${#TestCase#buttonLink}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>2sefxqo</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>FLoIdPfWHYQJACr</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>sfJVpEBmdubFDkUMOacGAjighYNeWH</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUnderReferral</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-10T16:05:29</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-10T16:07:29</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>EjCVAsmedaDwphF</con:value></con:property><con:property><con:name>infoText</con:name><con:value>JXTMPdKuRAgOLlCsjeVbQWyUhtmvqB</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>AvXGFMIoscEqgOkQZUzHCVDawhrxPe</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://ndvcRIQYNsAZwGypFtMelgoCrXWufq.ru</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-10 16:05:29</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-10 16:07:29</con:value></con:property></con:properties></con:testCase><con:testCase id="e65dee19-b03e-4695-a397-9c7fe34488be" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Добавить баннер с body. Параметры infoScreen.title, infoscreen.button не переданы. 407233" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="67b379e1-84fb-4d90-95d5-05c4bf957d75"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Создать баннер" id="8c549aec-f313-4942-acb1-c4f56aca9932"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Создать баннер" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"body": "${#TestCase#bannerBody}",
		"closable": true,
		"authentication": true,
		"startDate": "${#TestCase#startTime}",
		"endDate": "${#TestCase#endTime}",
		"location": "${#TestCase#location}",
		"userUpload": true,
		"infoscreenObject": {
			"text": "${#TestCase#infoText}"
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="39b3053a-c0d7-4d1b-a894-59f5c269aed2" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Проверить создание в БД f_banner_campaign и f_banner_infoscreen" id="205ac1e9-ef20-440c-b6f3-344fb3d6c595"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>select * from f_banner_campaign fbc
join f_banner_infoscreen fbi on fbc.id = fbi.banner_campaign_id
where fbc.banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить banner_code"><con:configuration><path>//*:F_BANNER_CAMPAIGN.BANNER_CODE</path><content>${#TestCase#bannerCode}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить title=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.TITLE/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить body"><con:configuration><path>//*:F_BANNER_CAMPAIGN.BODY</path><content>${#TestCase#bannerBody}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить closable"><con:configuration><path>//*:F_BANNER_CAMPAIGN.CLOSABLE</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.INFOSCREEN/text(),"")</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить authentication_check"><con:configuration><path>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить start_date"><con:configuration><path>//*:F_BANNER_CAMPAIGN.START_DATE</path><content>${#TestCase#startTimeDb}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить end_date"><con:configuration><path>//*:F_BANNER_CAMPAIGN.END_DATE</path><content>${#TestCase#endTimeDb}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить location"><con:configuration><path>//*:F_BANNER_CAMPAIGN.LOCATION</path><content>${#TestCase#location}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить user_upload"><con:configuration><path>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить upload_status=NULL"><con:configuration><path>concat(//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить active"><con:configuration><path>//*:F_BANNER_CAMPAIGN.ACTIVE</path><content>t</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.title=NULL"><con:configuration><path>concat(//*:F_BANNER_INFOSCREEN.TITLE/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.text"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TEXT</path><content>${#TestCase#infoText}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.button_title=NULL"><con:configuration><path>concat(//*:F_BANNER_INFOSCREEN.BUTTON_TITLE/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="0c9e2723-ec5c-476b-8f27-ac2b2cb9b97c" name="Проверить infoscreen.button_link=NULL"><con:configuration><path>concat(//*:F_BANNER_INFOSCREEN.BUTTON_LINK/text(),"")</path><content/><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>p7sd5j3</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>ToJfsiOuYaPKkRq</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>iJbdTSNlfZQvuYatGpEWoyFOrMsIjK</con:value></con:property><con:property><con:name>location</con:name><con:value>homeAboveForYou</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-10T16:05:29</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-10T16:07:29</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>SNZwpKzTXEinaCf</con:value></con:property><con:property><con:name>infoText</con:name><con:value>tOgdCKxjiDEwflpnZyHYraPuvMoAVq</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>bflOgJNIdjUnTRAKvMPrQDyEsBuGho</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://NvThLYFJDuAXiSUcbwqgCnIBElQHdG.ru</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-10 16:05:29</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-10 16:07:29</con:value></con:property></con:properties></con:testCase><con:testCase id="e16492da-c070-4756-a309-be5bdf0c41c1" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="АС1. Ошибка &quot;BANNER_ALREADY_EXISTS&quot;. 407234" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="7c937915-ae3f-4dc1-bc30-7d572f94bf5a"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Создать баннер" id="6e569bf8-217f-4185-8978-f055568a1c19"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Создать баннер" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"body": "${#TestCase#bannerBody}",
		"closable": true,
		"authentication": true,
		"startDate": "${#TestCase#startTime}",
		"endDate": "${#TestCase#endTime}",
		"location": "${#TestCase#location}",
		"userUpload": true,
		"infoscreenObject": {
			"text": "${#TestCase#infoText}"
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="39b3053a-c0d7-4d1b-a894-59f5c269aed2" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Создать баннер с тем же кодом" id="f6e2276b-ef27-4dd7-9be3-b6352316e19a"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Создать баннер с тем же кодом" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"body": "${#TestCase#bannerBody}",
		"closable": true,
		"authentication": true,
		"startDate": "${#TestCase#startTime}",
		"endDate": "${#TestCase#endTime}",
		"location": "${#TestCase#location}",
		"userUpload": true,
		"infoscreenObject": {
			"text": "${#TestCase#infoText}"
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="39b3053a-c0d7-4d1b-a894-59f5c269aed2" name="Код ответа 400"><con:configuration><codes>400</codes></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="068e469c-920c-4600-9398-427c05bd872f" name="code=BANNER_ALREADY_EXISTS"><con:configuration><path>$.error.code</path><content>BANNER_ALREADY_EXISTS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="068e469c-920c-4600-9398-427c05bd872f" name="description=Баннер с таким кодом уже существует  "><con:configuration><path>$.error.description</path><content>Баннер с таким кодом уже существует</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="068e469c-920c-4600-9398-427c05bd872f" name="type=BUSINESS"><con:configuration><path>$.error.type</path><content>BUSINESS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>cxburdv</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>sguNCtUVbqxyjMO</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>viRXKBMasSHVjyWDbzFqApUekPmJuQ</con:value></con:property><con:property><con:name>location</con:name><con:value>homeAboveForYou</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-10T16:05:29</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-10T16:07:29</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>rLyKPFYplwNhTmH</con:value></con:property><con:property><con:name>infoText</con:name><con:value>TOpcEYxQlRUbBhgDtVfHXenGANsWaq</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>gsBqOUajpneTbkWPfChVQytJYiXRrG</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://ROvVsJldDtPHieAgjUzaWofkxySmKq.ru</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-10 16:05:29</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-10 16:07:29</con:value></con:property></con:properties></con:testCase><con:testCase id="24d997a3-2f41-4583-911f-75f96332ec30" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Добавить баннер без body и title. 408795" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="7666df0b-21a2-4b3c-ba2f-5803a188cf62"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Создать баннер" id="94a2a575-6aad-46f8-9cec-04c604e7578c"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Создать баннер" id="7cb720a0-8a5a-4613-b44e-3c6ddaeb40b0" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"closable": false,
		"authentication": false,
		"location": "${#TestCase#location}",
		"userUpload": false
	}
} </con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="39b3053a-c0d7-4d1b-a894-59f5c269aed2" name="Код ответа 500"><con:configuration><codes>500</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>7drwpay</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>lFMwHPrUGXYogue</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>MSlvUgyfkYFVCcpxdLqzsiRDhTQuEK</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-10T16:05:28</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-10 16:05:28</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-10T16:07:28</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-10 16:07:28</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>TzfnBUISMRbAsYg</con:value></con:property><con:property><con:name>infoText</con:name><con:value>qIBmMNrGUtDbAYyhJeLQSplvPdjXCw</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>FBKJIvikljyZUCphXWDeHTrunRVNPS</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://THAKrzcDWkjxfqJbNnBaUVQyEXSipL.ru</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite id="1ea1222b-5ad0-46ad-a4e4-1c93e2ef6de8" name="POST banners/update"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="c744a46f-675a-4b06-a3c3-19772c59a4e4" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="406988_ОС. Передан только обязательный параметр (есть запись в таблице f_banner_infoscreen)" searchProperties="true"><con:settings/><con:testStep type="jdbc" name="Найти bannerCode" id="0504d723-1c86-49fa-8332-891e224758f3"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
infoscreen is true</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_CAMPAIGN.ID"><con:configuration><token>F_BANNER_CAMPAIGN.ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign" id="afd6b65d-a930-4d1b-97c3-51098d1eadf1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_code</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BANNER_CODE</con:sourcePath><con:targetType>bannerCode</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>title</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>body</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closable</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreen</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authenticationCheck</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>location</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUpload</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatus</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>active</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_campaign_id</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ID</con:sourcePath><con:targetType>bannerId</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_infoscreen" id="f7150624-f89d-4bf4-8610-88a6289e7638"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_infoscreen" id="ca9d4dd4-5f02-4bff-9f0a-154e4f2ce1e4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.TITLE</con:sourcePath><con:targetType>titleInfoscreen</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>text</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.TEXT</con:sourcePath><con:targetType>textInfoscreen</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>buttonTitle</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.BUTTON_TITLE</con:sourcePath><con:targetType>buttonTitle</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>buttonLink</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.BUTTON_LINK</con:sourcePath><con:targetType>buttonLink</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="update" id="67d5b9a5-b0f6-40c2-bbdf-bb7b7d8646cd"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/update" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="update" id="bda6dd6a-a013-4c35-9c22-e52261ba5ab8" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerCode": "${#TestCase#bannerCode}"
	}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/update</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="edee3d73-15ae-455c-9bad-f0a3b3e601ec" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_campaign после update" id="d1c0aeb7-2f38-4020-b061-a3b48c913a58"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_CAMPAIGN.ID"><con:configuration><token>F_BANNER_CAMPAIGN.ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign после update" id="323f8ca5-d389-4c97-9411-82c5f1c93eb0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>titleAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>bodyAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closableAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreenAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authCheckAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDateAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDateAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>locationAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUploadAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatusAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>activeAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Проверить отсутствие изменений в f_banner_campaign" id="b33f696d-4d4c-4836-aa88-906bc92c5e9b"><con:settings/><con:config><script>import groovy.sql.Sql
import groovy.json.JsonSlurper
import groovy.xml.XmlSlurper
import java.util.ArrayList
import java.time.format.DateTimeFormatter

//Подключение к БД
//emiasInfoFullDbConnection = testRunner.testCase.testSuite.Project.getPropertyValue("emiasInfoFullDbConnection")
//emiasInfoDBDriver = testRunner.testCase.testSuite.Project.getPropertyValue("emiasInfoDBDriver")
//sql = Sql.newInstance(emiasInfoFullDbConnection, emiasInfoDBDriver)

bannerCode = testRunner.testCase.getPropertyValue("bannerCode")
title = testRunner.testCase.getPropertyValue("title")
body = testRunner.testCase.getPropertyValue("body")
closable = testRunner.testCase.getPropertyValue("closable")
infoscreen = testRunner.testCase.getPropertyValue("infoscreen")
authenticationCheck = testRunner.testCase.getPropertyValue("authenticationCheck")
startDate = testRunner.testCase.getPropertyValue("startDate")
endDate = testRunner.testCase.getPropertyValue("endDate")
location = testRunner.testCase.getPropertyValue("location")
userUpload = testRunner.testCase.getPropertyValue("userUpload")
uploadStatus = testRunner.testCase.getPropertyValue("uploadStatus")
active = testRunner.testCase.getPropertyValue("active")

bannerCodeAfterUpdate = testRunner.testCase.getPropertyValue("bannerCodeAfterUpdate")
titleAfterUpdate = testRunner.testCase.getPropertyValue("titleAfterUpdate")
bodyAfterUpdate = testRunner.testCase.getPropertyValue("bodyAfterUpdate")
closableAfterUpdate = testRunner.testCase.getPropertyValue("closableAfterUpdate")
infoscreenAfterUpdate = testRunner.testCase.getPropertyValue("infoscreenAfterUpdate")
authCheckAfterUpdate = testRunner.testCase.getPropertyValue("authCheckAfterUpdate")
startDateAfterUpdate = testRunner.testCase.getPropertyValue("startDateAfterUpdate")
endDateAfterUpdate = testRunner.testCase.getPropertyValue("endDateAfterUpdate")
locationAfterUpdate = testRunner.testCase.getPropertyValue("locationAfterUpdate")
userUploadAfterUpdate = testRunner.testCase.getPropertyValue("userUploadAfterUpdate")
uploadStatusAfterUpdate = testRunner.testCase.getPropertyValue("uploadStatusAfterUpdate")
activeAfterUpdate = testRunner.testCase.getPropertyValue("activeAfterUpdate")

//query="select * from f_banner_campaign where \"banner_campaign_id\"= '"+bannerId+"'"
//def titleAfterUpdate = sql.firstRow(query).title
//def bodyAfterUpdate = sql.firstRow(query).body
//def closableAfterUpdate = sql.firstRow(query).closable.toString()
//def infoscreenAfterUpdate = sql.firstRow(query).infoscreen.toString()
//def authenticationCheckAfterUpdate = sql.firstRow(query).authentication_check.toString()
//def startDateAfterUpdate = sql.firstRow(query).start_date
//def endDateAfterUpdate = sql.firstRow(query).end_date.toString()
//def locationAfterUpdate = sql.firstRow(query).location.toString()
//def userUploadAfterUpdate = sql.firstRow(query).user_upload.toString()
//def uploadStatusAfterUpdate = sql.firstRow(query).upload_status
//if (uploadStatus == '&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/>'){
//	uploadStatus = null
//	}
//def activeAfterUpdate = sql.firstRow(query).active.toString()

assert title == titleAfterUpdate
assert body == bodyAfterUpdate
assert closable == closableAfterUpdate
assert infoscreen == infoscreenAfterUpdate
assert authenticationCheck == authCheckAfterUpdate //.substring(0,1) // сравниваем только с первым символом строки
assert startDate == startDateAfterUpdate
assert endDate == endDateAfterUpdate
assert location == locationAfterUpdate
assert userUpload == userUploadAfterUpdate
assert uploadStatus == uploadStatusAfterUpdate
assert active == activeAfterUpdate</script></con:config></con:testStep><con:testStep type="groovy" name="Проверить отсутствие изменений в f_banner_infoscreen" id="621d40e3-2ba3-433e-b2f7-cf5e67e419df"><con:settings/><con:config><script>import groovy.sql.Sql
import groovy.json.JsonSlurper
import groovy.xml.XmlSlurper
import java.util.ArrayList
import java.time.format.DateTimeFormatter

//Подключение к БД
emiasInfoFullDbConnection = testRunner.testCase.testSuite.Project.getPropertyValue("emiasInfoFullDbConnection")
emiasInfoDBDriver = testRunner.testCase.testSuite.Project.getPropertyValue("emiasInfoDBDriver")
sql = Sql.newInstance(emiasInfoFullDbConnection, emiasInfoDBDriver)

bannerCode = testRunner.testCase.getPropertyValue("bannerCode")
title = testRunner.testCase.getPropertyValue("titleInfoscreen")
text = testRunner.testCase.getPropertyValue("textInfoscreen")
buttonTitle = testRunner.testCase.getPropertyValue("buttonTitle")
buttonLink = testRunner.testCase.getPropertyValue("buttonLink")
bannerId = testRunner.testCase.getPropertyValue("bannerId")

query="select * from f_banner_infoscreen where \"banner_campaign_id\"= '"+bannerId+"'"
def titleAfterUpdate = sql.firstRow(query).title
def textAfterUpdate = sql.firstRow(query).text
def buttonTitleAfterUpdate = sql.firstRow(query).button_title.toString()
def buttonLinkAfterUpdate = sql.firstRow(query).button_link.toString()

assert title == titleAfterUpdate
assert text == textAfterUpdate
assert buttonTitle == buttonTitleAfterUpdate
assert buttonLink == buttonLinkAfterUpdate</script></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>BC1</con:value></con:property><con:property><con:name>title</con:name><con:value>Заголовок_баннера</con:value></con:property><con:property><con:name>body</con:name><con:value>Тело_баннера</con:value></con:property><con:property><con:name>closable</con:name><con:value>t</con:value></con:property><con:property><con:name>infoscreen</con:name><con:value>t</con:value></con:property><con:property><con:name>authenticationCheck</con:name><con:value>t</con:value></con:property><con:property><con:name>startDate</con:name><con:value>2024-04-04 12:52:30</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2024-04-08 12:52:30</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>userUpload</con:name><con:value>t</con:value></con:property><con:property><con:name>uploadStatus</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>active</con:name><con:value>t</con:value></con:property><con:property><con:name>titleInfoscreen</con:name><con:value>Заголовок_инфоскрина</con:value></con:property><con:property><con:name>textInfoscreen</con:name><con:value>string</con:value></con:property><con:property><con:name>buttonTitle</con:name><con:value>Название кнопки</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://ssilka.ru</con:value></con:property><con:property><con:name>bannerId</con:name><con:value>5</con:value></con:property><con:property><con:name>titleAfterUpdate</con:name><con:value>Заголовок_баннера</con:value></con:property><con:property><con:name>bodyAfterUpdate</con:name><con:value>Тело_баннера</con:value></con:property><con:property><con:name>closableAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>infoscreenAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>authCheckAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>startDateAfterUpdate</con:name><con:value>2024-04-04 12:52:30</con:value></con:property><con:property><con:name>endDateAfterUpdate</con:name><con:value>2024-04-08 12:52:30</con:value></con:property><con:property><con:name>locationAfterUpdate</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>userUploadAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>uploadStatusAfterUpdate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>activeAfterUpdate</con:name><con:value>t</con:value></con:property></con:properties></con:testCase><con:testCase id="fce91db2-6370-4a99-b37a-79222f4078f1" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="406990_ОС. Переданы все необязательные параметры, отличные от существующих (есть запись в f_banner_infoscreen)" searchProperties="true"><con:settings/><con:testStep type="jdbc" name="Найти bannerCode" id="22ce906d-a87d-435e-af7e-170e47768f3c"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
infoscreen is true</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_CAMPAIGN.ID"><con:configuration><token>F_BANNER_CAMPAIGN.ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign" id="7c21b548-cf9f-41dc-830b-912c4671b623"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_code</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BANNER_CODE</con:sourcePath><con:targetType>bannerCode</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>title</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>body</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closable</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreen</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authenticationCheck</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>location</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUpload</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatus</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти bannerCode</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>active</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_infoscreen" id="c9dd6215-d3a6-4de2-89b2-958ee2780605"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerCode}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_infoscreen" id="34d4b388-ad20-4742-b489-995e469d7f68"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.TITLE</con:sourcePath><con:targetType>titleInfoscreen</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>text</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.TEXT</con:sourcePath><con:targetType>textInfoscreen</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>buttonTitle</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.BUTTON_TITLE</con:sourcePath><con:targetType>buttonTitle</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>buttonLink</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_infoscreen</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.BUTTON_LINK</con:sourcePath><con:targetType>buttonLink</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Записать в переменные новые значения для входных параметров" id="9f6ae9be-f62a-45ae-8fd4-dd5a14adc48f"><con:settings/><con:config><script>import java.util.Date
import java.text.SimpleDateFormat
import java.time.LocalDateTime

title = testRunner.testCase.getPropertyValue("title")
body = testRunner.testCase.getPropertyValue("body")
closable = testRunner.testCase.getPropertyValue("closable")
infoscreen = testRunner.testCase.getPropertyValue("infoscreen")
authenticationCheck = testRunner.testCase.getPropertyValue("authenticationCheck")
startDate = testRunner.testCase.getPropertyValue("startDate")
endDate = testRunner.testCase.getPropertyValue("endDate")
location = testRunner.testCase.getPropertyValue("location")
userUpload = testRunner.testCase.getPropertyValue("userUpload")
uploadStatus = testRunner.testCase.getPropertyValue("uploadStatus")
active = testRunner.testCase.getPropertyValue("active")
titleInfoscreen = testRunner.testCase.getPropertyValue("titleInfoscreen")
textInfoscreen = testRunner.testCase.getPropertyValue("textInfoscreen")
buttonTitle = testRunner.testCase.getPropertyValue("buttonTitle")
buttonLink = testRunner.testCase.getPropertyValue("buttonLink")

def titleChanged = title + '_changed'
testRunner.testCase.setPropertyValue("titleChanged", titleChanged)
def bodyChanged = body + '_changed'
testRunner.testCase.setPropertyValue("bodyChanged", bodyChanged)

if (closable == 't') {
	def closableChanged = 'false'
	testRunner.testCase.setPropertyValue("closableChanged", closableChanged)
	}
if (closable != 't') {
	def closableChanged = 'true'
	testRunner.testCase.setPropertyValue("closableChanged", closableChanged)
	}

if (authenticationCheck == 't') {
	def authenticationChanged = 'false'
	testRunner.testCase.setPropertyValue("authenticationChanged", authenticationChanged)
	}
if (authenticationCheck != 't') {
	def authenticationChanged = 'true'
	testRunner.testCase.setPropertyValue("authenticationChanged", authenticationChanged)
	}

Date startDateFormat = Date.parse( "yyyy-MM-dd' 'hh:mm:ss.SSS", testRunner.testCase.getPropertyValue('startDate'))
Date now = new Date()
Date startDateChanged = LocalDateTime.now().plusMinutes(1).toDate()
sdf = new SimpleDateFormat("yyyy-MM-dd'T'hh:mm:ss.SSS'Z'")
def nowNewFormat = sdf.format(startDateChanged)
testRunner.testCase.setPropertyValue("startDateChanged", nowNewFormat.toString())

Date endDateChanged = LocalDateTime.now().plusMinutes(2).toDate()
def now2NewFormat = sdf.format(endDateChanged)
testRunner.testCase.setPropertyValue("endDateChanged", now2NewFormat.toString())

if (location == 'homeUp') {
	def locationChanged = 'homeUnderReferral'
	testRunner.testCase.setPropertyValue("locationChanged", locationChanged)
	}
if (location == 'homeUnderReferral') {
	def locationChanged = 'homeAboveForYou'
	testRunner.testCase.setPropertyValue("locationChanged", locationChanged)
	}
if (location == 'homeAboveForYou') {
	def locationChanged = 'homeUp'
	testRunner.testCase.setPropertyValue("locationChanged", locationChanged)
	}

if (active == 't') {
	def activeChanged = 'false'
	testRunner.testCase.setPropertyValue("activeChanged", activeChanged)
	}
if (active != 't') {
	def activeChanged = 'true'
	testRunner.testCase.setPropertyValue("activeChanged", activeChanged)
	}

def titleInfoscreenChanged = titleInfoscreen + '_changed'
testRunner.testCase.setPropertyValue("titleInfoscreenChanged", titleInfoscreenChanged)

def textInfoscreenChanged = textInfoscreen + '_changed'
testRunner.testCase.setPropertyValue("textInfoscreenChanged", textInfoscreenChanged)

def buttonTitleChanged = buttonTitle + '_changed'
testRunner.testCase.setPropertyValue("buttonTitleChanged", buttonTitleChanged)

def buttonLinkChanged = buttonLink + '_changed'
testRunner.testCase.setPropertyValue("buttonLinkChanged", buttonLinkChanged)
</script></con:config></con:testStep><con:testStep type="restrequest" name="update" id="503c10b7-9da1-4359-8d4c-6816ba707061"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/update" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="update" id="bda6dd6a-a013-4c35-9c22-e52261ba5ab8" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerCode": "${#TestCase#bannerCode}",
	"banner": {
		"title": "${#TestCase#titleChanged}",
		"body": "${#TestCase#bodyChanged}",
		"closable": "${#TestCase#closableChanged}",
		"authentication": "${#TestCase#authenticationChanged}",
		"startDate": "${#TestCase#startDateChanged}",
		"endDate": "${#TestCase#endDateChanged}",
		"location": "${#TestCase#locationChanged}",
		"active": "${#TestCase#activeChanged}"
		},
	"infoscreen": {
		"title": "${#TestCase#titleInfoscreenChanged}",
		"text": "${#TestCase#textInfoscreenChanged}",
		"buttonText": "${#TestCase#buttonTitleChanged}",
		"buttonLink": "${#TestCase#buttonLinkChanged}"
		}
	}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/update</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="edee3d73-15ae-455c-9bad-f0a3b3e601ec" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Найти измененную запись в f_banner_campaign" id="48b9ceb8-e5a9-465b-8644-5584a3fab18b"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_CAMPAIGN.ID"><con:configuration><token>F_BANNER_CAMPAIGN.ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="groovy" name="Проверить изменения в f_banner_campaign" id="c82d7d75-7070-42e6-819b-74ae56800ea2"><con:settings/><con:config><script>import groovy.sql.Sql
import groovy.json.JsonSlurper
import groovy.xml.XmlSlurper
import java.util.ArrayList
import java.time.format.DateTimeFormatter
import java.text.SimpleDateFormat
import java.time.LocalDateTime
//Подключение к БД
emiasInfoFullDbConnection = testRunner.testCase.testSuite.Project.getPropertyValue("emiasInfoFullDbConnection")
emiasInfoDBDriver = testRunner.testCase.testSuite.Project.getPropertyValue("emiasInfoDBDriver")
sql = Sql.newInstance(emiasInfoFullDbConnection, emiasInfoDBDriver)

bannerCode = testRunner.testCase.getPropertyValue("bannerCode")
titleChanged = testRunner.testCase.getPropertyValue("titleChanged")
bodyCha
nged = testRunner.testCase.getPropertyValue("bodyChanged")
closableChanged = testRunner.testCase.getPropertyValue("closableChanged")
infoscreen = testRunner.testCase.getPropertyValue("infoscreen")
authenticationChanged = testRunner.testCase.getPropertyValue("authenticationChanged")
startDateChanged = testRunner.testCase.getPropertyValue("startDateChanged")
endDateChanged = testRunner.testCase.getPropertyValue("endDateChanged")
locationChanged = testRunner.testCase.getPropertyValue("locationChanged")
userUpload = testRunner.testCase.getPropertyValue("userUpload")
uploadStatus = testRunner.testCase.getPropertyValue("uploadStatus")
activeChanged = testRunner.testCase.getPropertyValue("activeChanged")

query="select * from f_banner_campaign where \"banner_code\"= '"+bannerCode+"'"
def titleAfterUpdate = sql.firstRow(query).title
def bodyAfterUpdate = sql.firstRow(query).body
def closableAfterUpdate = sql.firstRow(query).closable.toString()
def infoscreenAfterUpdate = sql.firstRow(query).infoscreen.toString()
def authenticationCheckAfterUpdate = sql.firstRow(query).authentication_check.toString()
def startDateAfterUpdate = sql.firstRow(query).start_date
def endDateAfterUpdate = sql.firstRow(query).end_date
def locationAfterUpdate = sql.firstRow(query).location.toString()
def userUploadAfterUpdate = sql.firstRow(query).user_upload.toString()
def uploadStatusAfterUpdate = sql.firstRow(query).upload_status
if (uploadStatus == '&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/>'){
	uploadStatus = null
	}
def activeAfterUpdate = sql.firstRow(query).active.toString()

assert titleChanged == titleAfterUpdate
assert bodyChanged == bodyAfterUpdate
assert closableChanged == closableAfterUpdate
assert infoscreen == infoscreenAfterUpdate.substring(0,1)
assert authenticationChanged.substring(0,1) == authenticationCheckAfterUpdate.substring(0,1) // сравниваем только с первым символом строки
sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS'Z'")
def startDateAfterUpdateNewFormat = sdf.format(startDateAfterUpdate)
assert startDateChanged == startDateAfterUpdateNewFormat
def endDateAfterUpdateNewFormat = sdf.format(endDateAfterUpdate)
assert endDateChanged == endDateAfterUpdateNewFormat
assert locationChanged == locationAfterUpdate
assert userUpload == userUploadAfterUpdate.substring(0,1) // сравниваем только с первым символом строки
assert uploadStatus == uploadStatusAfterUpdate
assert activeChanged == activeAfterUpdate</script></con:config></con:testStep><con:testStep type="jdbc" name="Проверить изменения в f_banner_infoscreen" id="f9afb209-c936-4cb0-b7bb-852d0a025ef2"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerCode}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.TITLE соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TITLE</path><content>${#TestCase#titleInfoscreenChanged}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.TEXT соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TEXT</path><content>${#TestCase#textInfoscreenChanged}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.BUTTON_TITLE соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_TITLE</path><content>${#TestCase#buttonTitleChanged}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.BUTTON_LINK соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_LINK</path><content>${#TestCase#buttonLinkChanged}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="groovy" name="Записать переменные для возврата первоначальных значений" id="a4408bf0-f834-4553-aac6-bfe416eeb379"><con:settings/><con:config><script>import java.util.Date
import java.text.SimpleDateFormat
import java.time.LocalDateTime

closable = testRunner.testCase.getPropertyValue("closable")
if(closable == 't') closable = 'true'
if(closable == 'f') closable = 'false'
testRunner.testCase.setPropertyValue("closable", closable)

authenticationCheck = testRunner.testCase.getPropertyValue("authenticationCheck")
if(authenticationCheck == 't') authenticationCheck = 'true'
if(authenticationCheck == 'f') authenticationCheck = 'false'
testRunner.testCase.setPropertyValue("authenticationCheck", authenticationCheck)

active = testRunner.testCase.getPropertyValue("active")
if(active == 't') active = 'true'
if(active == 'f') active = 'false'
testRunner.testCase.setPropertyValue("active", active)

Date startDate = Date.parse( "yyyy-MM-dd' 'hh:mm:ss.SSS", testRunner.testCase.getPropertyValue('startDate'))
sdf = new SimpleDateFormat("yyyy-MM-dd'T'hh:mm:ss.SSS'Z'")
def startDateNewFormat = sdf.format(startDate)
testRunner.testCase.setPropertyValue("startDate", startDateNewFormat.toString())

Date endDate = Date.parse( "yyyy-MM-dd' 'hh:mm:ss.SSS", testRunner.testCase.getPropertyValue('endDate'))
def endDateNewFormat = sdf.format(endDate)
testRunner.testCase.setPropertyValue("endDate", endDateNewFormat.toString())</script></con:config></con:testStep><con:testStep type="restrequest" name="update - вернуть первоначальные значения" id="a9c98a66-2c1e-4cba-910c-92d80b1308f8"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/update" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="update - вернуть первоначальные значения" id="bda6dd6a-a013-4c35-9c22-e52261ba5ab8" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerCode": "${#TestCase#bannerCode}",
	"banner": {
		"title": "${#TestCase#title}",
		"body": "${#TestCase#body}",
		"closable": "${#TestCase#closable}",
		"authentication": "${#TestCase#authentication}",
		"startDate": "${#TestCase#startDate}",
		"endDate": "${#TestCase#endDate}",
		"location": "${#TestCase#location}",
		"active": "${#TestCase#active}"
		},
	"infoscreen": {
		"title": "${#TestCase#titleInfoscreen}",
		"text": "${#TestCase#textInfoscreen}",
		"buttonText": "${#TestCase#buttonTitle}",
		"buttonLink": "${#TestCase#buttonLink}"
		}
	}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/update</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="edee3d73-15ae-455c-9bad-f0a3b3e601ec" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>3</con:value></con:property><con:property><con:name>title</con:name><con:value>Тестовый баннер не закрываемый</con:value></con:property><con:property><con:name>body</con:name><con:value>Тело баннера 2</con:value></con:property><con:property><con:name>closable</con:name><con:value>false</con:value></con:property><con:property><con:name>infoscreen</con:name><con:value>t</con:value></con:property><con:property><con:name>authenticationCheck</con:name><con:value>true</con:value></con:property><con:property><con:name>startDate</con:name><con:value>2024-04-03T08:38:53.943Z</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2024-04-15T09:38:53.943Z</con:value></con:property><con:property><con:name>location</con:name><con:value>homeAboveForYou</con:value></con:property><con:property><con:name>userUpload</con:name><con:value>f</con:value></con:property><con:property><con:name>uploadStatus</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>active</con:name><con:value>true</con:value></con:property><con:property><con:name>titleInfoscreen</con:name><con:value>Заголовок инфоскрина</con:value></con:property><con:property><con:name>textInfoscreen</con:name><con:value>HTML-содержание инфоскрина</con:value></con:property><con:property><con:name>buttonTitle</con:name><con:value>ОК</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>https://example/</con:value></con:property><con:property><con:name>titleChanged</con:name><con:value>Тестовый баннер не закрываемый_changed</con:value></con:property><con:property><con:name>bodyChanged</con:name><con:value>Тело баннера 2_changed</con:value></con:property><con:property><con:name>closableChanged</con:name><con:value>true</con:value></con:property><con:property><con:name>authenticationChanged</con:name><con:value>false</con:value></con:property><con:property><con:name>startDateChanged</con:name><con:value>2024-04-08T02:10:16.884Z</con:value></con:property><con:property><con:name>endDateChanged</con:name><con:value>2024-04-08T02:11:16.884Z</con:value></con:property><con:property><con:name>locationChanged</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>activeChanged</con:name><con:value>false</con:value></con:property><con:property><con:name>titleInfoscreenChanged</con:name><con:value>Заголовок инфоскрина_changed</con:value></con:property><con:property><con:name>textInfoscreenChanged</con:name><con:value>HTML-содержание инфоскрина_changed</con:value></con:property><con:property><con:name>buttonTitleChanged</con:name><con:value>ОК_changed</con:value></con:property><con:property><con:name>buttonLinkChanged</con:name><con:value>https://example/_changed</con:value></con:property></con:properties></con:testCase><con:testCase id="7456350b-1453-4f80-8155-2d68e98c4230" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="406992_ОС. Переданы все необязательные параметры, значения в f_banner_campaign не отличаются от переданных (нет записи в f_banner_infoscreen)" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Записать в переменную рандомное значение bannerCode" id="2834cc3a-252b-4413-a40d-062250862633"><con:settings/><con:config><script>text = (('a'..'z')+('A'..'Z')).shuffled().take(20).join()
testRunner.testCase.setPropertyValue("bannerCode", text)</script></con:config></con:testStep><con:testStep type="restrequest" name="create" id="97f234ff-c5ec-4a7d-8cb3-bb1b42e1c0a1"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="create" id="f5bf0dda-58c5-407b-8d87-33c221086922" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerObject": {
    "bannerCode": "${#TestCase#bannerCode}",
    "title": "${#TestCase#title}",
    "body": "${#TestCase#body}",
    "closable": "${#TestCase#closable}",
    "authentication": "${#TestCase#authenticationCheck}",
    "startDate": "${#TestCase#startDate}",
    "endDate": "${#TestCase#endDate}",
    "location": "${#TestCase#location}",
    "userUpload": "${#TestCase#userUpload}"
    }
  }
}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="3d7d690a-eeb6-4934-a66f-c580a66634c0" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_campaign" id="72de297f-6630-4774-8b89-4499e20a472a"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="Simple Contains" id="c9ee01cd-6837-46aa-9191-55e3ed4ede70" name="Contains Results"><con:configuration><token>Results</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign" id="2da59686-4c98-4b12-aef7-cd9b8ec77dbd"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_code</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BANNER_CODE</con:sourcePath><con:targetType>bannerCode</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>titleAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>bodyAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closableAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreenAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authenticationCheckAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDateAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDateAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>locationAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUploadAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatusAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>activeAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_campaig_id</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ID</con:sourcePath><con:targetType>bannerId</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="Проверить отсутствие записи в f_banner_infoscreen" id="53d51cef-09f0-415f-9e9e-c3a6c64db178"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple NotContains" id="bc346890-9c06-468b-afb4-5e423fee30ab" name="Not Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="update" id="6ece4bfe-c7ab-46e9-b80d-5789ef64e632"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/update" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="update" id="bda6dd6a-a013-4c35-9c22-e52261ba5ab8" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerCode": "${#TestCase#bannerCode}",
	"banner": {
		"title": "${#TestCase#title}",
		"body": "${#TestCase#body}",
		"closable": "${#TestCase#closable}",
		"authentication": "${#TestCase#authenticationCheck}",
		"startDate": "${#TestCase#startDate}",
		"endDate": "${#TestCase#endDate}",
		"location": "${#TestCase#location}",
		"active": "${#TestCase#active}"
		},
	"infoscreen": {
		"title": "${#TestCase#titleInfoscreen}",
		"text": "${#TestCase#textInfoscreen}",
		"buttonText": "${#TestCase#buttonTitle}",
		"buttonLink": "${#TestCase#buttonLink}"
		}
	}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/update</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="edee3d73-15ae-455c-9bad-f0a3b3e601ec" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_campaign после update" id="763faefa-0ba3-4736-b8b7-3b3875a72cc2"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple Contains" id="c9ee01cd-6837-46aa-9191-55e3ed4ede70" name="Contains Results"><con:configuration><token>Results</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign после update" id="0b2597fc-2512-49bf-9a6c-f22f1482bb9b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>titleAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>bodyAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closableAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="true" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreenAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authenticationCheckAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDateAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDateAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>locationAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUploadAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatusAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>activeAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Проверить изменения в f_banner_campaign" id="8183412c-6b60-41a7-8596-c22ab84b21ca"><con:settings/><con:config><script>titleAfterCreate = testRunner.testCase.getPropertyValue("titleAfterCreate")
bodyAfterCreate = testRunner.testCase.getPropertyValue("bodyAfterCreate")
closableAfterCreate = testRunner.testCase.getPropertyValue("closableAfterCreate")
authenticationCheckAfterCreate = testRunner.testCase.getPropertyValue("authenticationCheckAfterCreate")
startDateAfterCreate = testRunner.testCase.getPropertyValue("startDateAfterCreate")
endDateAfterCreate = testRunner.testCase.getPropertyValue("endDateAfterCreate")
locationAfterCreate = testRunner.testCase.getPropertyValue("locationAfterCreate")
userUploadAfterCreate = testRunner.testCase.getPropertyValue("userUploadAfterCreate")
uploadStatusAfterCreate = testRunner.testCase.getPropertyValue("uploadStatusAfterCreate")
activeAfterCreate = testRunner.testCase.getPropertyValue("activeAfterCreate")

titleAfterUpdate = testRunner.testCase.getPropertyValue("titleAfterUpdate")
bodyAfterUpdate = testRunner.testCase.getPropertyValue("bodyAfterUpdate")
closableAfterUpdate = testRunner.testCase.getPropertyValue("closableAfterUpdate")
infoscreenAfterUpdate = testRunner.testCase.getPropertyValue("infoscreenAfterUpdate")
authenticationCheckAfterUpdate = testRunner.testCase.getPropertyValue("authenticationCheckAfterUpdate")
startDateAfterUpdate = testRunner.testCase.getPropertyValue("startDateAfterUpdate")
endDateAfterUpdate = testRunner.testCase.getPropertyValue("endDateAfterUpdate")
locationAfterUpdate = testRunner.testCase.getPropertyValue("locationAfterUpdate")
userUploadAfterUpdate = testRunner.testCase.getPropertyValue("userUploadAfterUpdate")
uploadStatusAfterUpdate = testRunner.testCase.getPropertyValue("uploadStatusAfterUpdate")
activeAfterUpdate = testRunner.testCase.getPropertyValue("activeAfterUpdate")

assert titleAfterCreate == titleAfterUpdate
assert bodyAfterCreate == bodyAfterUpdate
assert closableAfterCreate == closableAfterUpdate
assert infoscreenAfterUpdate == 't'
assert authenticationCheckAfterCreate == authenticationCheckAfterUpdate
assert startDateAfterCreate == startDateAfterUpdate
assert endDateAfterCreate == endDateAfterUpdate
assert locationAfterCreate == locationAfterUpdate
assert userUploadAfterCreate == userUploadAfterUpdate
assert uploadStatusAfterCreate == uploadStatusAfterUpdate
assert activeAfterCreate == activeAfterUpdate</script></con:config></con:testStep><con:testStep type="jdbc" name="Проверить изменения в f_banner_infoscreen" id="b6e0dd28-1b18-46ac-b20a-9fd7a4d49dd4"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.TITLE соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TITLE</path><content>${#TestCase#titleInfoscreen}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.TEXT соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TEXT</path><content>${#TestCase#textInfoscreen}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.BUTTON_TITLE соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_TITLE</path><content>${#TestCase#buttonTitle}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.BUTTON_LINK соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_LINK</path><content>${#TestCase#buttonLink}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>NFokbEPdtTDglZUOIjCG</con:value></con:property><con:property><con:name>title</con:name><con:value>Title Test 406992</con:value></con:property><con:property><con:name>body</con:name><con:value>Body Test 406992</con:value></con:property><con:property><con:name>closable</con:name><con:value>false</con:value></con:property><con:property><con:name>authenticationCheck</con:name><con:value>false</con:value></con:property><con:property><con:name>startDate</con:name><con:value>2024-04-03T08:38:53.943Z</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2024-12-03T08:38:53.943Z</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>userUpload</con:name><con:value>false</con:value></con:property><con:property><con:name>active</con:name><con:value>true</con:value></con:property><con:property><con:name>titleInfoscreen</con:name><con:value>TitleInfoscreen Test 406992</con:value></con:property><con:property><con:name>textInfoscreen</con:name><con:value>BodyInfoscreen Test 406992</con:value></con:property><con:property><con:name>buttonTitle</con:name><con:value>ButtonTitle Test 406992</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>ButtonLink Test 406992</con:value></con:property><con:property><con:name>startDateAfterUpdate</con:name><con:value>2024-04-03 08:38:53.943</con:value></con:property><con:property><con:name>endDateAfterUpdate</con:name><con:value>2024-12-03 08:38:53.943</con:value></con:property><con:property><con:name>authenticationCheckAfterUpdate</con:name><con:value>f</con:value></con:property><con:property><con:name>bannerId</con:name><con:value>18</con:value></con:property><con:property><con:name>titleAfterUpdate</con:name><con:value>Title Test 406992</con:value></con:property><con:property><con:name>bodyAfterUpdate</con:name><con:value>Body Test 406992</con:value></con:property><con:property><con:name>closableAfterUpdate</con:name><con:value>f</con:value></con:property><con:property><con:name>userUploadAfterUpdate</con:name><con:value>f</con:value></con:property><con:property><con:name>uploadStatusAfterUpdate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>activeAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>infoscreenAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>locationAfterUpdate</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>titleAfterCreate</con:name><con:value>Title Test 406992</con:value></con:property><con:property><con:name>bodyAfterCreate</con:name><con:value>Body Test 406992</con:value></con:property><con:property><con:name>closableAfterCreate</con:name><con:value>f</con:value></con:property><con:property><con:name>infoscreenAfterCreate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.INFOSCREEN/></con:value></con:property><con:property><con:name>authenticationCheckAfterCreate</con:name><con:value>f</con:value></con:property><con:property><con:name>startDateAfterCreate</con:name><con:value>2024-04-03 08:38:53.943</con:value></con:property><con:property><con:name>endDateAfterCreate</con:name><con:value>2024-12-03 08:38:53.943</con:value></con:property><con:property><con:name>locationAfterCreate</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>userUploadAfterCreate</con:name><con:value>f</con:value></con:property><con:property><con:name>uploadStatusAfterCreate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>activeAfterCreate</con:name><con:value>t</con:value></con:property></con:properties></con:testCase><con:testCase id="44ab2b75-0808-447b-85c4-0f08b423e111" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="406995_ОС. Переданы пустой объект banner и 1 параметр в infoscreen (нет записи в f_banner_infoscreen)" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Записать в переменную рандомное значение bannerCode" id="b2c0fdb5-b944-44f9-88a9-0a532edcbf5b"><con:settings/><con:config><script>text = (('a'..'z')+('A'..'Z')).shuffled().take(20).join()
testRunner.testCase.setPropertyValue("bannerCode", text)</script></con:config></con:testStep><con:testStep type="restrequest" name="create" id="40c84726-6469-41e7-b052-a7f73039a0f5"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="create" id="f5bf0dda-58c5-407b-8d87-33c221086922" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerObject": {
    "bannerCode": "${#TestCase#bannerCode}",
    "title": "${#TestCase#title}",
    "body": "${#TestCase#body}",
    "closable": "${#TestCase#closable}",
    "authentication": "${#TestCase#authenticationCheck}",
    "startDate": "${#TestCase#startDate}",
    "endDate": "${#TestCase#endDate}",
    "location": "${#TestCase#location}",
    "userUpload": "${#TestCase#userUpload}"
    }
  }
}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="3d7d690a-eeb6-4934-a66f-c580a66634c0" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_campaign" id="20bd33ca-d21b-4ad5-a4c4-e80d501fafa2"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="Simple Contains" id="c9ee01cd-6837-46aa-9191-55e3ed4ede70" name="Contains Results"><con:configuration><token>Results</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign" id="2bc78919-19a7-4d4d-9411-39cbed9c379b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_code</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BANNER_CODE</con:sourcePath><con:targetType>bannerCode</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>titleAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>bodyAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closableAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreenAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authenticationCheckAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDateAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDateAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>locationAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUploadAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatusAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>activeAfterCreate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>banner_campaig_id</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ID</con:sourcePath><con:targetType>bannerId</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="jdbc" name="Проверить отсутствие записи в f_banner_infoscreen" id="3ef44b50-5694-4f64-8ec5-d5efb12b0cf0"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple NotContains" id="bc346890-9c06-468b-afb4-5e423fee30ab" name="Not Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="update" id="9c317158-306f-484f-8b37-5c1ea1ff2a4d"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/update" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="update" id="bda6dd6a-a013-4c35-9c22-e52261ba5ab8" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerCode": "${#TestCase#bannerCode}",
	"banner": {},
	"infoscreen": {
		"text": "${#TestCase#textInfoscreen}"
		}
	}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/update</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="edee3d73-15ae-455c-9bad-f0a3b3e601ec" name="Valid HTTP Status Code = 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="Найти запись в f_banner_campaign после update" id="8c5ce5d7-a947-481d-acda-14adbe38cb38"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple Contains" id="c9ee01cd-6837-46aa-9191-55e3ed4ede70" name="Contains Results"><con:configuration><token>Results</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать значения из f_banner_campaign после update" id="6a716399-b0ec-4195-8773-38e2b410f49e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>title</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE</con:sourcePath><con:targetType>titleAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>body</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY</con:sourcePath><con:targetType>bodyAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>closable</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.CLOSABLE</con:sourcePath><con:targetType>closableAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="true" entitize="true" transferChildNodes="false"><con:name>infoscreen</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.INFOSCREEN</con:sourcePath><con:targetType>infoscreenAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>authentication_check</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.AUTHENTICATION_CHECK</con:sourcePath><con:targetType>authenticationCheckAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>start_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.START_DATE</con:sourcePath><con:targetType>startDateAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>end_date</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.END_DATE</con:sourcePath><con:targetType>endDateAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>location</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION</con:sourcePath><con:targetType>locationAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>user_upload</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.USER_UPLOAD</con:sourcePath><con:targetType>userUploadAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>upload_status</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.UPLOAD_STATUS</con:sourcePath><con:targetType>uploadStatusAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>active</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в f_banner_campaign после update</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.ACTIVE</con:sourcePath><con:targetType>activeAfterUpdate</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="groovy" name="Проверить изменения в f_banner_campaign" id="6f437799-56e8-448b-942d-05f0cdc00331"><con:settings/><con:config><script>titleAfterCreate = testRunner.testCase.getPropertyValue("titleAfterCreate")
bodyAfterCreate = testRunner.testCase.getPropertyValue("bodyAfterCreate")
closableAfterCreate = testRunner.testCase.getPropertyValue("closableAfterCreate")
authenticationCheckAfterCreate = testRunner.testCase.getPropertyValue("authenticationCheckAfterCreate")
startDateAfterCreate = testRunner.testCase.getPropertyValue("startDateAfterCreate")
endDateAfterCreate = testRunner.testCase.getPropertyValue("endDateAfterCreate")
locationAfterCreate = testRunner.testCase.getPropertyValue("locationAfterCreate")
userUploadAfterCreate = testRunner.testCase.getPropertyValue("userUploadAfterCreate")
uploadStatusAfterCreate = testRunner.testCase.getPropertyValue("uploadStatusAfterCreate")
activeAfterCreate = testRunner.testCase.getPropertyValue("activeAfterCreate")

titleAfterUpdate = testRunner.testCase.getPropertyValue("titleAfterUpdate")
bodyAfterUpdate = testRunner.testCase.getPropertyValue("bodyAfterUpdate")
closableAfterUpdate = testRunner.testCase.getPropertyValue("closableAfterUpdate")
infoscreenAfterUpdate = testRunner.testCase.getPropertyValue("infoscreenAfterUpdate")
authenticationCheckAfterUpdate = testRunner.testCase.getPropertyValue("authenticationCheckAfterUpdate")
startDateAfterUpdate = testRunner.testCase.getPropertyValue("startDateAfterUpdate")
endDateAfterUpdate = testRunner.testCase.getPropertyValue("endDateAfterUpdate")
locationAfterUpdate = testRunner.testCase.getPropertyValue("locationAfterUpdate")
userUploadAfterUpdate = testRunner.testCase.getPropertyValue("userUploadAfterUpdate")
uploadStatusAfterUpdate = testRunner.testCase.getPropertyValue("uploadStatusAfterUpdate")
activeAfterUpdate = testRunner.testCase.getPropertyValue("activeAfterUpdate")

assert titleAfterCreate == titleAfterUpdate
assert bodyAfterCreate == bodyAfterUpdate
assert closableAfterCreate == closableAfterUpdate
assert infoscreenAfterUpdate == 't'
assert authenticationCheckAfterCreate == authenticationCheckAfterUpdate
assert startDateAfterCreate == startDateAfterUpdate
assert endDateAfterCreate == endDateAfterUpdate
assert locationAfterCreate == locationAfterUpdate
assert userUploadAfterCreate == userUploadAfterUpdate
assert uploadStatusAfterCreate == uploadStatusAfterUpdate
assert activeAfterCreate == activeAfterUpdate</script></con:config></con:testStep><con:testStep type="jdbc" name="Проверить изменения в f_banner_infoscreen" id="4aca3331-4ff7-4d76-928a-997af90b9cfb"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_infoscreen
WHERE
banner_campaign_id = '${#TestCase#bannerId}'</con:query><con:assertion type="Simple Contains" id="50192429-6eb2-4d08-aa14-0582bd6af932" name="Contains F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID"><con:configuration><token>F_BANNER_INFOSCREEN.BANNER_CAMPAIGN_ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.TITLE соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TITLE</path><content>&lt;F_BANNER_INFOSCREEN.TITLE/></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.TEXT соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.TEXT</path><content>${#TestCase#textInfoscreen}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.BUTTON_TITLE соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_TITLE</path><content>&lt;F_BANNER_INFOSCREEN.BUTTON_TITLE/></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="8a707029-c645-4cd6-b095-d8559ec2fb66" name="F_BANNER_INFOSCREEN.BUTTON_LINK соответствует"><con:configuration><path>//*:F_BANNER_INFOSCREEN.BUTTON_LINK</path><content>&lt;F_BANNER_INFOSCREEN.BUTTON_LINK/></content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>wSPlFbvtoHCVcLOgjdAM</con:value></con:property><con:property><con:name>title</con:name><con:value>Title Test 406992</con:value></con:property><con:property><con:name>body</con:name><con:value>Body Test 406992</con:value></con:property><con:property><con:name>closable</con:name><con:value>false</con:value></con:property><con:property><con:name>authenticationCheck</con:name><con:value>false</con:value></con:property><con:property><con:name>startDate</con:name><con:value>2024-04-03T08:38:53.943Z</con:value></con:property><con:property><con:name>endDate</con:name><con:value>2024-12-03T08:38:53.943Z</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>userUpload</con:name><con:value>false</con:value></con:property><con:property><con:name>active</con:name><con:value>true</con:value></con:property><con:property><con:name>titleInfoscreen</con:name><con:value>TitleInfoscreen Test 406992</con:value></con:property><con:property><con:name>textInfoscreen</con:name><con:value>BodyInfoscreen Test 406992</con:value></con:property><con:property><con:name>buttonTitle</con:name><con:value>ButtonTitle Test 406992</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>ButtonLink Test 406992</con:value></con:property><con:property><con:name>startDateAfterUpdate</con:name><con:value>2024-04-03 08:38:53.943</con:value></con:property><con:property><con:name>endDateAfterUpdate</con:name><con:value>2024-12-03 08:38:53.943</con:value></con:property><con:property><con:name>authenticationCheckAfterUpdate</con:name><con:value>f</con:value></con:property><con:property><con:name>bannerId</con:name><con:value>19</con:value></con:property><con:property><con:name>titleAfterUpdate</con:name><con:value>Title Test 406992</con:value></con:property><con:property><con:name>bodyAfterUpdate</con:name><con:value>Body Test 406992</con:value></con:property><con:property><con:name>closableAfterUpdate</con:name><con:value>f</con:value></con:property><con:property><con:name>userUploadAfterUpdate</con:name><con:value>f</con:value></con:property><con:property><con:name>uploadStatusAfterUpdate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>activeAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>infoscreenAfterUpdate</con:name><con:value>t</con:value></con:property><con:property><con:name>locationAfterUpdate</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>titleAfterCreate</con:name><con:value>Title Test 406992</con:value></con:property><con:property><con:name>bodyAfterCreate</con:name><con:value>Body Test 406992</con:value></con:property><con:property><con:name>closableAfterCreate</con:name><con:value>f</con:value></con:property><con:property><con:name>infoscreenAfterCreate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.INFOSCREEN/></con:value></con:property><con:property><con:name>authenticationCheckAfterCreate</con:name><con:value>f</con:value></con:property><con:property><con:name>startDateAfterCreate</con:name><con:value>2024-04-03 08:38:53.943</con:value></con:property><con:property><con:name>endDateAfterCreate</con:name><con:value>2024-12-03 08:38:53.943</con:value></con:property><con:property><con:name>locationAfterCreate</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>userUploadAfterCreate</con:name><con:value>f</con:value></con:property><con:property><con:name>uploadStatusAfterCreate</con:name><con:value>&lt;F_BANNER_CAMPAIGN.UPLOAD_STATUS/></con:value></con:property><con:property><con:name>activeAfterCreate</con:name><con:value>t</con:value></con:property></con:properties></con:testCase><con:testCase id="ef8e78ed-f50c-48d4-8344-155fd64ff4d1" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="406998_АС1. BANNER_NOT_FOUND" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Записать bannerCode, отсутствующий в БД" id="120d2eba-466f-45a8-bb22-752f41388176"><con:settings/><con:config><script>bannerCode = (('0'..'9')).shuffled().take(8).join()
testRunner.TestCase.setPropertyValue("bannerCode", bannerCode)</script></con:config></con:testStep><con:testStep type="jdbc" name="Проверить отсутствие bannerCode в БД" id="35dac3f7-8e4f-46b6-909a-2df7efb8b129"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>SELECT *
FROM public.f_banner_campaign
WHERE
banner_code = '${#TestCase#bannerCode}'</con:query><con:assertion type="Simple NotContains" id="b00b6304-1896-4ad0-b794-a018a3d4c1d0" name="Not Contains F_BANNER_CAMPAIGN.ID"><con:configuration><token>F_BANNER_CAMPAIGN.ID</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="update" id="9244c46f-38dd-45e5-964b-c552d268e70d"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/update" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="update" id="bda6dd6a-a013-4c35-9c22-e52261ba5ab8" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerCode": "${#TestCase#bannerCode}"
	}</con:request><con:originalUri>http://application-emiasinfo3.emias.solit-clouds.ru/api/v1/banners/update</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="edee3d73-15ae-455c-9bad-f0a3b3e601ec" name="Valid HTTP Status Code = 404"><con:configuration><codes>404</codes></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="c7515388-d535-419f-bdb0-132cc1862f47" name="error.code = BANNER_NOT_FOUND"><con:configuration><path>$.error.code</path><content>BANNER_NOT_FOUND</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="c7515388-d535-419f-bdb0-132cc1862f47" name="error.description = Баннер с таким кодом не найден"><con:configuration><path>$.error.description</path><content>Баннер с таким кодом не найден</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="c7515388-d535-419f-bdb0-132cc1862f47" name="error.type = BUSINESS"><con:configuration><path>$.error.type</path><content>BUSINESS</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>65924087</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:testSuite id="2cf6e64b-3039-408d-ba0b-5924bcb36f8c" name="POST banners/check"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="3026f19c-0509-49b8-a39a-5b509bd5aeee" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Получен пустой ответ. 407930" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="328bb386-8913-4404-9cd1-3869904aac6a"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "BC321444ff"
  ],
  "userInfo": {
    "omsNumber": "241209498214891",
    "birthDate": "2001-01-01",
    "patientId": 2414214
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="dcfd46e2-a4f5-437d-b9c2-04b4234c0d81" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="c1cd00e6-5517-4c4b-be94-ee4c565c75d5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Вернулся title и только обязательные параметры. 408016" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="b9f84123-c9dc-4f4b-b3ed-b35a895e8bae"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Добавить баннер на главную страницу" id="afe78956-de22-43f0-bb14-faa55c1e951c"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Добавить баннер на главную страницу" id="bc5bfd02-a32e-4b7b-a9a0-1428f58898e9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"title": "${#TestCase#bannerTitle}",
		"closable": true,
		"authentication": true,
		"location": "${#TestCase#location}",
		"userUpload": false
	}
}</con:request><con:originalUri>http://application-emiasinfo4.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="f1b704ce-8846-42a9-bc0e-581f1780770d" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="ed398f38-186e-4f38-95c7-a30a52b080dc"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "${#TestCase#bannerCode}"
  ],
  "userInfo": {
    "omsNumber": "${#TestCase#oms}",
    "birthDate": "${#TestCase#birthDate}",
    "patientId": ${#TestCase#patientId}
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="265795e3-f82e-4090-9018-88c254fe0862" name="Код ответа 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="3a93b953-2aa6-4fcb-957a-14cc61315f2e" name="Отсутствует body"><con:configuration><token>body</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="3a93b953-2aa6-4fcb-957a-14cc61315f2e" name="Отсутствует infoscreen"><con:configuration><token>infoscreen</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Проверить ответ" id="7e5f1b7b-0108-49a9-b41f-6ae6ec9ccd87"><con:settings/><con:config><script>import groovy.json.JsonSlurper

def restResponse = context.expand('${Проверить участие пользователя по отображению баннера#Response}')
def check =  new JsonSlurper().parseText(restResponse)

bannerCode = testRunner.testCase.getPropertyValue('bannerCode')
bannerTitle = testRunner.testCase.getPropertyValue('bannerTitle')
bannerBody = testRunner.testCase.getPropertyValue('bannerBody')
infoTitle = testRunner.testCase.getPropertyValue('infoTitle')
infoText = testRunner.testCase.getPropertyValue('infoText')
buttonText = testRunner.testCase.getPropertyValue('buttonText')
buttonLink = testRunner.testCase.getPropertyValue('buttonLink')
location = testRunner.testCase.getPropertyValue('location')

assert check.bannerInfo[0].bannerCode == bannerCode // проверяем bannerCode
assert check.bannerInfo[0].title == bannerTitle // проверяем title
assert check.bannerInfo[0].closable == true // проверяем closable
assert check.bannerInfo[0].location == location // проверяем location</script></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>gvde0pn</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>jFkuKYfJWDGOQam</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>xIvCdYpEhNwPusXjikFVLzHgbOanKM</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-12T09:13:42</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-12 09:13:42</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-12T09:15:42</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-12 09:15:42</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>yAIlUijCZnMLPoV</con:value></con:property><con:property><con:name>infoText</con:name><con:value>gECmFsvkYczdBaDQtlXZxoWnpuSKwR</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>CgnepVmrljMfovhUucEIwHxstdGXFO</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://YEBALbIfxygQUsahOvJTKlmqDSHNPW.ru</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>oms</con:name><con:value>7700000000000010</con:value></con:property><con:property><con:name>patientId</con:name><con:value>12000</con:value></con:property><con:property><con:name>birthDate</con:name><con:value>1939-10-23</con:value></con:property></con:properties></con:testCase><con:testCase id="7d2d1364-5ceb-4b9e-b134-96129fa2c0f6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Вернулись все необязательные параметры. 408107" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="e0658c26-7dec-4820-b3d5-d9436eecbb00"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Добавить баннер на главную страницу" id="8ddc73d2-a95f-48d0-8711-2cc2c2e2f686"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Добавить баннер на главную страницу" id="bc5bfd02-a32e-4b7b-a9a0-1428f58898e9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"title": "${#TestCase#bannerTitle}",
		"body": "${#TestCase#bannerBody}",
		"closable": false,
		"authentication": true,
		"startDate": "${#TestCase#startTime}",
		"endDate": "${#TestCase#endTime}",
		"location": "${#TestCase#location}",
		"userUpload": false,
		"infoscreenObject": {
			"title": "${#TestCase#infoTitle}",
			"text": "${#TestCase#infoText}",
			"button": {
				"text": "${#TestCase#buttonText}",
				"link": "${#TestCase#buttonLink}"
			}
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo4.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="f1b704ce-8846-42a9-bc0e-581f1780770d" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="4b8578e3-cd06-499a-bfd1-15afa7ba2376"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "${#TestCase#bannerCode}"
  ],
  "userInfo": {
    "omsNumber": "${#TestCase#oms}",
    "birthDate": "${#TestCase#birthDate}",
    "patientId": ${#TestCase#patientId}
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="265795e3-f82e-4090-9018-88c254fe0862" name="Код ответа 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Проверить ответ" id="0b1641f3-5565-429b-8c19-1a8dcdd1b10c"><con:settings/><con:config><script>import groovy.json.JsonSlurper

def restResponse = context.expand('${Проверить участие пользователя по отображению баннера#Response}')
def check =  new JsonSlurper().parseText(restResponse)

bannerCode = testRunner.testCase.getPropertyValue('bannerCode')
bannerTitle = testRunner.testCase.getPropertyValue('bannerTitle')
bannerBody = testRunner.testCase.getPropertyValue('bannerBody')
infoTitle = testRunner.testCase.getPropertyValue('infoTitle')
infoText = testRunner.testCase.getPropertyValue('infoText')
buttonText = testRunner.testCase.getPropertyValue('buttonText')
buttonLink = testRunner.testCase.getPropertyValue('buttonLink')
location = testRunner.testCase.getPropertyValue('location')

assert check.bannerInfo[0].bannerCode == bannerCode // проверяем bannerCode
assert check.bannerInfo[0].title == bannerTitle // проверяем title
assert check.bannerInfo[0].body == bannerBody // проверяем title
assert check.bannerInfo[0].closable == false // проверяем closable
assert check.bannerInfo[0].location == location // проверяем location
assert check.bannerInfo[0].infoscreen.title == infoTitle // проверяем infoscreen.title
assert check.bannerInfo[0].infoscreen.text == infoText // проверяем infoscreen.text
assert check.bannerInfo[0].infoscreen.button.text == buttonText // проверяем button.text
assert check.bannerInfo[0].infoscreen.button.link == buttonLink // проверяем button.link
</script></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>zef4ar8</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>duKEGyNptFLrSIi</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>htujVKfvLXJyRrFPQYmxskdTgBEIwU</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-12T09:13:42</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-12 09:13:42</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-12T09:15:42</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-12 09:15:42</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>vBTafrndhUVxbGq</con:value></con:property><con:property><con:name>infoText</con:name><con:value>ntbZFLBclypigzTkHPCREVoNsvqrfK</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>fiwqXGtevLKygphYIjDOMxakQUmcJR</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://mcLxkivOUgIfbYAsnFazZVuMBNtprR.ru</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUnderReferral</con:value></con:property><con:property><con:name>oms</con:name><con:value>7700000000000010</con:value></con:property><con:property><con:name>patientId</con:name><con:value>12000</con:value></con:property><con:property><con:name>birthDate</con:name><con:value>1939-10-23</con:value></con:property><con:property><con:name>true</con:name><con:value>fdshfdhfd</con:value></con:property></con:properties></con:testCase><con:testCase id="440fe45d-dad9-4b73-9031-914cc3c8ca25" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Проверить участие пользователя по отображению баннера с user_upload=true. В f_user не найден пользователь. 408234" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="dc61bb0f-990d-43b0-89bc-a8eedc4cf71a"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Добавить баннер на главную страницу" id="bb67e824-44c6-4d06-8c42-60a5bda29ab4"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Добавить баннер на главную страницу" id="bc5bfd02-a32e-4b7b-a9a0-1428f58898e9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"title": "${#TestCase#bannerTitle}",
		"body": "${#TestCase#bannerBody}",
		"closable": false,
		"authentication": true,
		"startDate": "${#TestCase#startTime}",
		"endDate": "${#TestCase#endTime}",
		"location": "${#TestCase#location}",
		"userUpload": true,
		"infoscreenObject": {
			"title": "${#TestCase#infoTitle}",
			"text": "${#TestCase#infoText}",
			"button": {
				"text": "${#TestCase#buttonText}",
				"link": "${#TestCase#buttonLink}"
			}
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo4.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="f1b704ce-8846-42a9-bc0e-581f1780770d" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="f5df4b01-ae09-4c44-b0a9-26eead5337d9"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "${#TestCase#bannerCode}"
  ],
  "userInfo": {
    "omsNumber": "${#TestCase#oms}",
    "birthDate": "${#TestCase#birthDate}",
    "patientId": ${#TestCase#patientId}
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="265795e3-f82e-4090-9018-88c254fe0862" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>6skrxfl</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>aJDvQYOCMkZcrnt</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>iVXDjaAEZzINrsfCLTemncRHdSQGlq</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-12T09:13:42</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-12 09:13:42</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-12T09:15:42</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-12 09:15:42</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>qZghmwbBAlGNQKP</con:value></con:property><con:property><con:name>infoText</con:name><con:value>mANOkiSqyYPrEhsJoKpDWGelVgfMzc</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>jgroiTIdcXRPfVlmKQwahNSFCeHpZz</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://tVsmDQJMuRjkPoNadChlZHKYeBcpOx.ru</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUnderReferral</con:value></con:property><con:property><con:name>oms</con:name><con:value>7700000000000010</con:value></con:property><con:property><con:name>patientId</con:name><con:value>12000</con:value></con:property><con:property><con:name>birthDate</con:name><con:value>1939-10-23</con:value></con:property></con:properties></con:testCase><con:testCase id="fdd97df6-84d4-41d4-91c5-d2cdea41a46d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Проверить участие пользователя по отображению баннера с user_upload=true. В bannerInfo.infoscreen только text. 408305" searchProperties="true"><con:settings/><con:testStep type="jdbc" name="Найти запись в бд" id="049ebf28-218d-4667-bb2b-7b70d9c6170b"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" convertColumnNamesToUpperCase="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:driver>${#Project#emiasInfoDBDriver}</con:driver><con:connectionString>${#Project#emiasInfoFullDbConnection}</con:connectionString><con:query>select fbc.banner_code, fbc.title, fbc.body, fbc.closable, fbc."location", fbi."text" from f_banner_campaign fbc
join f_banner_infoscreen fbi on fbc.id = fbi.banner_campaign_id
join f_banner_user fbu on fbc.id = fbu.campaign_banner_id
join f_user fu on fbu.user_id = fu.id
where fbc.user_upload = true
and fu.patient_id = ${#TestCase#patientId}
and fbi.title is null
and fbi.button_title is null 
and fbi.button_link is null
and fbc.title is not null
and fbc.body is not null
limit 1</con:query><con:assertion type="XPath Match" id="70790dd2-2eaa-40f7-99c3-656defa49c86" name="Вернулась 1 запись"><con:configuration><path>count(//*:Row)</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="transfer" name="Записать данные в проперти" id="2173c200-22f3-46c0-99f2-bf3f2e553854"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>BANNER_CODE</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в бд</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BANNER_CODE/text()</con:sourcePath><con:targetType>bannerCode</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>TITLE</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в бд</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.TITLE/text()</con:sourcePath><con:targetType>bannerTitle</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>BODY</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в бд</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.BODY/text()</con:sourcePath><con:targetType>bannerBody</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>TEXT</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в бд</con:sourceStep><con:sourcePath>//*:F_BANNER_INFOSCREEN.TEXT/text()</con:sourcePath><con:targetType>infoText</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>LOCATION</con:name><con:sourceType>ResponseAsXml</con:sourceType><con:sourceStep>Найти запись в бд</con:sourceStep><con:sourcePath>//*:F_BANNER_CAMPAIGN.LOCATION/text()</con:sourcePath><con:targetType>location</con:targetType><con:targetStep>#TestCase#</con:targetStep><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="274f40e2-7ce3-4ce1-8864-7ac7870d4ae8"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "${#TestCase#bannerCode}"
  ],
  "userInfo": {
    "omsNumber": "${#TestCase#oms}",
    "birthDate": "${#TestCase#birthDate}",
    "patientId": ${#TestCase#patientId}
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="265795e3-f82e-4090-9018-88c254fe0862" name="Код ответа 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="a6795006-be43-4799-a884-b413bf4af3aa" name="Not Contains"><con:configuration><token>button</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Проверить ответ" id="a3c51802-2f81-4fab-ac36-e74023680979"><con:settings/><con:config><script>import groovy.json.JsonSlurper

def restResponse = context.expand('${Проверить участие пользователя по отображению баннера#Response}')
def check =  new JsonSlurper().parseText(restResponse)

bannerCode = testRunner.testCase.getPropertyValue('bannerCode')
bannerTitle = testRunner.testCase.getPropertyValue('bannerTitle')
bannerBody = testRunner.testCase.getPropertyValue('bannerBody')
infoTitle = testRunner.testCase.getPropertyValue('infoTitle')
infoText = testRunner.testCase.getPropertyValue('infoText')
buttonText = testRunner.testCase.getPropertyValue('buttonText')
buttonLink = testRunner.testCase.getPropertyValue('buttonLink')
location = testRunner.testCase.getPropertyValue('location')

assert check.bannerInfo[0].bannerCode == bannerCode // проверяем bannerCode
assert check.bannerInfo[0].title == bannerTitle // проверяем title
assert check.bannerInfo[0].body == bannerBody // проверяем title
assert check.bannerInfo[0].location == location // проверяем location
assert check.bannerInfo[0].infoscreen.text == infoText // проверяем infoscreen.text
if (check.bannerInfo[0].infoscreen.title != null){
	testRunner.fail("В ответе вернулся infoscreen.title")
}
</script></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>BC12</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>Заголовок_баннера</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>Тело_баннера</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-11T15:01:00</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-11 15:01:00</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-11T15:03:00</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-11 15:03:00</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>vwetHlKfXcxnBIJ</con:value></con:property><con:property><con:name>infoText</con:name><con:value>Описание_инфоскрина</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>vWcKYJQkEMOpHCLsUbotGyamXzxgfF</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://DwLruEksnYCQUoStdKIMTfXNRAVblz.ru</con:value></con:property><con:property><con:name>location</con:name><con:value>homeUp</con:value></con:property><con:property><con:name>oms</con:name><con:value>7700000000000010</con:value></con:property><con:property><con:name>patientId</con:name><con:value>12000</con:value></con:property><con:property><con:name>birthDate</con:name><con:value>1939-10-23</con:value></con:property></con:properties></con:testCase><con:testCase id="03cddef6-571d-4c56-972a-0ad3d6919700" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Вернулся body и только обязательные параметры. 408310" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="322f721f-b8e6-45db-89ba-e91e495e2bc0"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

Date dateMinus = LocalDateTime.now().plusSeconds(-60).toDate()
Date datePlus = LocalDateTime.now().plusSeconds(60).toDate()

def dateStart = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(dateMinus)
def dateStartDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(dateMinus)
def dateEnd = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss").format(datePlus)
def dateEndDb = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(datePlus)
log.info dateEnd

code = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode', code)
testRunner.testCase.setPropertyValue('bannerTitle', title)
testRunner.testCase.setPropertyValue('bannerBody', body)
testRunner.testCase.setPropertyValue('startTime', dateStart)
testRunner.testCase.setPropertyValue('startTimeDb', dateStartDb)
testRunner.testCase.setPropertyValue('endTime', dateEnd)
testRunner.testCase.setPropertyValue('endTimeDb', dateEndDb)
testRunner.testCase.setPropertyValue('infoTitle', infoTitle)
testRunner.testCase.setPropertyValue('infoText', infoText)
testRunner.testCase.setPropertyValue('buttonText', buttonText)
testRunner.testCase.setPropertyValue('buttonLink', buttonLink)</script></con:config></con:testStep><con:testStep type="restrequest" name="Добавить баннер на главную страницу" id="98416679-3b4d-4890-b67e-aadbc34e082c"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Добавить баннер на главную страницу" id="bc5bfd02-a32e-4b7b-a9a0-1428f58898e9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode}",
		"body": "${#TestCase#bannerBody}",
		"closable": true,
		"authentication": true,
		"location": "${#TestCase#location}",
		"userUpload": false
	}
}</con:request><con:originalUri>http://application-emiasinfo4.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="f1b704ce-8846-42a9-bc0e-581f1780770d" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="3a00a94a-8914-456b-8d39-17f2817876ce"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "${#TestCase#bannerCode}"
  ],
  "userInfo": {
    "omsNumber": "${#TestCase#oms}",
    "birthDate": "${#TestCase#birthDate}",
    "patientId": ${#TestCase#patientId}
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="265795e3-f82e-4090-9018-88c254fe0862" name="Код ответа 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="3a93b953-2aa6-4fcb-957a-14cc61315f2e" name="Отсутствует title"><con:configuration><token>title</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="3a93b953-2aa6-4fcb-957a-14cc61315f2e" name="Отсутствует infoscreen"><con:configuration><token>infoscreen</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Проверить ответ" id="078fa836-285d-445f-9d17-1a9ddf3cfd38"><con:settings/><con:config><script>import groovy.json.JsonSlurper

def restResponse = context.expand('${Проверить участие пользователя по отображению баннера#Response}')
def check =  new JsonSlurper().parseText(restResponse)

bannerCode = testRunner.testCase.getPropertyValue('bannerCode')
bannerTitle = testRunner.testCase.getPropertyValue('bannerTitle')
bannerBody = testRunner.testCase.getPropertyValue('bannerBody')
infoTitle = testRunner.testCase.getPropertyValue('infoTitle')
infoText = testRunner.testCase.getPropertyValue('infoText')
buttonText = testRunner.testCase.getPropertyValue('buttonText')
buttonLink = testRunner.testCase.getPropertyValue('buttonLink')
location = testRunner.testCase.getPropertyValue('location')

assert check.bannerInfo[0].bannerCode == bannerCode // проверяем bannerCode
assert check.bannerInfo[0].body == bannerBody // проверяем body
assert check.bannerInfo[0].closable == true // проверяем closable
assert check.bannerInfo[0].location == location // проверяем location</script></con:config></con:testStep><con:properties><con:property><con:name>bannerCode</con:name><con:value>5lqm42f</con:value></con:property><con:property><con:name>bannerTitle</con:name><con:value>mhyugbXzxfoEFSO</con:value></con:property><con:property><con:name>bannerBody</con:name><con:value>kyvcdlNFCwEDgAqVpPTLusXtWIOnZj</con:value></con:property><con:property><con:name>startTime</con:name><con:value>2024-04-12T09:13:42</con:value></con:property><con:property><con:name>startTimeDb</con:name><con:value>2024-04-12 09:13:42</con:value></con:property><con:property><con:name>endTime</con:name><con:value>2024-04-12T09:15:42</con:value></con:property><con:property><con:name>endTimeDb</con:name><con:value>2024-04-12 09:15:42</con:value></con:property><con:property><con:name>infoTitle</con:name><con:value>xGcDpIifAkJNlyV</con:value></con:property><con:property><con:name>infoText</con:name><con:value>DBGgoChMIKXySePHbJLpYcxUadzZWi</con:value></con:property><con:property><con:name>buttonText</con:name><con:value>ojAqbVIUeWzGfOxvhRrDlNHpwQuTdZ</con:value></con:property><con:property><con:name>buttonLink</con:name><con:value>http://rYfdXlLQcFqVGapeMsJSuiIPAxTgCW.ru</con:value></con:property><con:property><con:name>location</con:name><con:value>homeAboveForYou</con:value></con:property><con:property><con:name>oms</con:name><con:value>7700000000000010</con:value></con:property><con:property><con:name>patientId</con:name><con:value>12000</con:value></con:property><con:property><con:name>birthDate</con:name><con:value>1939-10-23</con:value></con:property></con:properties></con:testCase><con:testCase id="9a31c9bc-f47f-41a3-9198-66d4c9d1f8f2" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="ОС. Проверить участие пользователя по отображению баннера по двум bannerCode. 408335" searchProperties="true"><con:settings/><con:testStep type="groovy" name="Сгенерировать данные" id="21c16d8d-145a-4402-9991-2c453b3a8eb0"><con:settings/><con:config><script>import java.text.SimpleDateFormat
import java.time.LocalDateTime

code1 = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title1 = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body1=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle1 = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText1=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText1=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink1= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode1', code1)
testRunner.testCase.setPropertyValue('bannerTitle1', title1)
testRunner.testCase.setPropertyValue('bannerBody1', body1)
testRunner.testCase.setPropertyValue('infoTitle1', infoTitle1)
testRunner.testCase.setPropertyValue('infoText1', infoText1)
testRunner.testCase.setPropertyValue('buttonText1', buttonText1)
testRunner.testCase.setPropertyValue('buttonLink1', buttonLink1)

code2 = (('a'..'z')+('0'..'9')).shuffled().take(7).join()
title2 = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
body2=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
infoTitle2 = (('a'..'z')+('A'..'Z')).shuffled().take(15).join()
infoText2=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonText2=(('a'..'z')+('A'..'Z')).shuffled().take(30).join()
buttonLink2= 'http://' + (('a'..'z')+('A'..'Z')).shuffled().take(30).join() + '.ru'

testRunner.testCase.setPropertyValue('bannerCode2', code2)
testRunner.testCase.setPropertyValue('bannerTitle2', title2)
testRunner.testCase.setPropertyValue('bannerBody2', body2)
testRunner.testCase.setPropertyValue('infoTitle2', infoTitle2)
testRunner.testCase.setPropertyValue('infoText2', infoText2)
testRunner.testCase.setPropertyValue('buttonText2', buttonText2)
testRunner.testCase.setPropertyValue('buttonLink2', buttonLink2)</script></con:config></con:testStep><con:testStep type="restrequest" name="Добавить баннер 1 на главную страницу" id="429ecb91-8aff-40f1-931f-42bbdbcdd940"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Добавить баннер 1 на главную страницу" id="bc5bfd02-a32e-4b7b-a9a0-1428f58898e9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode1}",
		"body": "${#TestCase#bannerBody1}",
		"closable": true,
		"authentication": true,
		"location": "${#TestCase#location1}",
		"userUpload": false
	}
}</con:request><con:originalUri>http://application-emiasinfo4.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="f1b704ce-8846-42a9-bc0e-581f1780770d" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Добавить баннер 2 на главную страницу" id="2c9abd7f-ee10-40c8-b297-bbbde939a98b"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/create" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Добавить баннер 2 на главную страницу" id="bc5bfd02-a32e-4b7b-a9a0-1428f58898e9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
	"bannerObject": {
		"bannerCode": "${#TestCase#bannerCode2}",
		"title": "${#TestCase#bannerTitle2}",
		"closable": false,
		"authentication": false,
		"location": "${#TestCase#location2}",
		"userUpload": false,
		"infoscreenObject": {
			"title": "${#TestCase#infoTitle2}",
			"text": "${#TestCase#infoText2}",
			"button": {
				"text": "${#TestCase#buttonText2}",
				"link": "${#TestCase#buttonLink2}"
			}
		}
	}
}</con:request><con:originalUri>http://application-emiasinfo4.emias.solit-clouds.ru/api/v1/banners/create</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="f1b704ce-8846-42a9-bc0e-581f1780770d" name="Код ответа 204"><con:configuration><codes>204</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Проверить участие пользователя по отображению баннера" id="c8b80272-5237-40f6-99dd-1454fcc54d75"><con:settings/><con:config service="http://application-emiasinfo3.emias.solit-clouds.ru" resourcePath="/api/v1/banners/check" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Проверить участие пользователя по отображению баннера" id="5da80061-c5ea-47d2-8b3d-8b7a9bdd7eb3" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>${#Project#emiasInfoEndpoint}</con:endpoint><con:request>{
  "bannerCode": [
    "${#TestCase#bannerCode1}",
    "${#TestCase#bannerCode2}"
  ],
  "userInfo": {
    "omsNumber": "${#TestCase#oms}",
    "birthDate": "${#TestCase#birthDate}",
    "patientId": ${#TestCase#patientId}
  }
} </con:request><con:originalUri>http://notification-emiasinfo1.emias.solit-clouds.ru/api/v1/banners/check</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="265795e3-f82e-4090-9018-88c254fe0862" name="Код ответа 200"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Проверить ответ" id="3a0f44c6-e819-4de8-98ff-89e0b1f5488a"><con:settings/><con:config><script>import groovy.json.JsonSlurper

def restResponse = context.expand('${Проверить участие пользователя по отображению баннера#Response}')
def check =  new JsonSlurper().parseText(restResponse)

bannerCode1 = testRunner.testCase.getPropertyValue('bannerCode1')
bannerBody1 = testRunner.testCase.getPropertyValue('bannerBody1')
location1 = testRunner.testCase.getPropertyValue('location1')

bannerCode2 = testRunner.testCase.getPropertyValue('bannerCode2')
bannerTitle2 = testRunner.testCase.getPropertyValue('bannerTitle2')
infoTitle2 = testRunner.testCase.getPropertyValue('infoTitle2')
infoText2 = testRunner.testCase.getPropertyValue('infoText2')
buttonText2 = testRunner.testCase.getPropertyValue('buttonText2')
buttonLink2 = testRunner.testCase.getPropertyValue('buttonLink2')
location2 = testRunner.testCase.getPropertyValue('location2')

for(i=0; i&lt;check.bannerInfo.size(); i++){
	if(check.bannerInfo[i].bannerCode == bannerCode1){
		assert check.bannerInfo[i].bannerCode == bannerCode1 // проверяем bannerCode
		assert check.bannerInfo[i].body == bannerBody1 // проверяем body
		assert check.bannerInfo[i].closable == true // проверяем closable
		assert check.bannerInfo[i].location == location1 // проверяем location
		if(check.bannerInfo[i].infoscreen != null){ //проверяем отсутствие infoscreen
			testRunner.fail("В bannerCode1 вернулся объект infoscreen")
		}
		if(check.bannerInfo[i].title != null){//проверяем отсутствие title
			testRunner.fail("В bannerCode1 вернулся title")
		}
	}
	else{
		assert check.bannerInfo[i].bannerCode == bannerCode2 // проверяем bannerCode
		assert check.bannerInfo[i].title == bannerTitle2 // проверяем title
		assert check.bannerInfo[i].closable == false // проверяем closable
		assert check.bannerInfo[i].location == location2 // проверяем location
		assert check.bannerInfo[i].infoscreen.title == infoTitle2 // проверяем infoscreen.title
		assert check.bannerInfo[i].infoscreen.text == infoText2 // проверяем infoscreen.text
		assert check.bannerInfo[i].infoscreen.button.text == buttonText2 // проверяем button.text
		assert check.bannerInfo[i].infoscreen.button.link == buttonLink2 // проверяем button.link
		if(check.bannerInfo[i].body != null){//проверяем отсутствие title
			testRunner.fail("В bannerCode2 вернулся body")
		}
	}
}

</script></con:config></con:testStep><con:properties><con:property><con:name>location1</con:name><con:value>homeAboveForYou</con:value></con:property><con:property><con:name>oms</con:name><con:value>7700000000000010</con:value></con:property><con:property><con:name>patientId</con:name><con:value>12000</con:value></con:property><con:property><con:name>birthDate</con:name><con:value>1939-10-23</con:value></con:property><con:property><con:name>bannerCode1</con:name><con:value>0kw4nuj</con:value></con:property><con:property><con:name>bannerTitle1</con:name><con:value>mhFaIPjOEtpNgnZ</con:value></con:property><con:property><con:name>bannerBody1</con:name><con:value>uMQDmxshGvbJHPZCaVwROUoKqfyzSj</con:value></con:property><con:property><con:name>infoTitle1</con:name><con:value>wOeJypWPcFlHnYo</con:value></con:property><con:property><con:name>infoText1</con:name><con:value>hvgsQIYzuRmALfoDOlZaWiUybEdCSG</con:value></con:property><con:property><con:name>buttonText1</con:name><con:value>bOIaTEVHMtZXdomwNAzGBSKqlLjyxU</con:value></con:property><con:property><con:name>buttonLink1</con:name><con:value>http://ygwmNKHTADpeVkRGdOWsvnztqrMiaI.ru</con:value></con:property><con:property><con:name>bannerCode2</con:name><con:value>jmczn4i</con:value></con:property><con:property><con:name>bannerTitle2</con:name><con:value>LduNjWTJFYrvhyp</con:value></con:property><con:property><con:name>bannerBody2</con:name><con:value>HteTMbmJGvjInrqLPFkhfAlRZSKyxU</con:value></con:property><con:property><con:name>infoTitle2</con:name><con:value>TnXtlfQHjCIOupA</con:value></con:property><con:property><con:name>infoText2</con:name><con:value>YUpnvrDMXzdJhgOBQNKSqEFatbGHxc</con:value></con:property><con:property><con:name>buttonText2</con:name><con:value>FjcTUoCwhrDHmYVakKpMbnWQxdILlq</con:value></con:property><con:property><con:name>buttonLink2</con:name><con:value>http://bFZlVCMARhtPOLdBQoUpTwimqXnaur.ru</con:value></con:property><con:property><con:name>location2</con:name><con:value>homeUnderReferral</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>emiasInfoEndpoint</con:name><con:value>http://application-emiasinfo4.emias.solit-clouds.ru/</con:value></con:property><con:property><con:name>emiasInfoDbConnection</con:name><con:value>172.17.5.11:29301/emiasinfoapp</con:value></con:property><con:property><con:name>emiasInfoDbLogin</con:name><con:value>emiasinfoapp</con:value></con:property><con:property><con:name>emiasInfoDbPassword</con:name><con:value>emiasinfoapp</con:value></con:property><con:property><con:name>emiasInfoFullDbConnection</con:name><con:value>jdbc:postgresql://172.17.5.11:29301/emiasinfoapp?user=emiasinfoapp&amp;password=emiasinfoapp</con:value></con:property><con:property><con:name>emiasInfoDBDriver</con:name><con:value>org.postgresql.Driver</con:value></con:property><con:property><con:name>emiasInfoNotificationsEndpoint</con:name><con:value>http://notification-emiasinfo4.emias.solit-clouds.ru</con:value></con:property><con:property><con:name>emiasInfoNotificationsDbConnection</con:name><con:value>172.17.5.11:29303/notification</con:value></con:property><con:property><con:name>emiasInfoNotificationsDbLogin</con:name><con:value>notification</con:value></con:property><con:property><con:name>emiasInfoNotificationsDbPassword</con:name><con:value>notification</con:value></con:property><con:property><con:name>emiasInfoNotificationsFullDbConnection</con:name><con:value>jdbc:postgresql://172.17.5.11:29303/notification?user=notification&amp;password=notification</con:value></con:property><con:property><con:name>emiasInfoNotificationsDBDriver</con:name><con:value>org.postgresql.Driver</con:value></con:property><con:property><con:name>topicAppointment2Bm</con:name><con:value>Appointment2Bm.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>topicAppointment2Doctor</con:name><con:value>Appointment2Doctor.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>topicAppointment2Ldp</con:name><con:value>Appointment2Ldp.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>topicBookingRecipeInfoMessage</con:name><con:value>BookingRecipeInfoMessage.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>topicMedicationAssignmentChangesPerDay</con:name><con:value>MedicationAssignmentChangesPerDay.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>topicKisNazToEmiasPublication</con:name><con:value>kisNazToEmiasPublication.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>topicTmkNotify</con:name><con:value>tmkNotify.EMIASINFO_SOLIT_TEST_4</con:value></con:property><con:property><con:name>bootstrapServers</con:name><con:value>10.2.172.24:9092</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>